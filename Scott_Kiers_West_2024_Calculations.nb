(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    252127,       6762]
NotebookOptionsPosition[    235430,       6504]
NotebookOutlinePosition[    235866,       6521]
CellTagsIndexPosition[    235823,       6518]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell["\<\
This Mathematica document contains all calculations featured in the \
Supplementary Information for Scott, Kiers & West (2024).\
\>", "Text",
 CellChangeTimes->{{3.915174872147344*^9, 3.9151749078339043`*^9}, {
   3.915174958645629*^9, 3.915175096549225*^9}, {3.915175130288045*^9, 
   3.915175181350585*^9}, {3.915201691885071*^9, 3.9152016935524*^9}, {
   3.9152055858978157`*^9, 3.9152056717803307`*^9}, 3.916911375023654*^9, 
   3.9169114123168173`*^9, 3.9169114655729303`*^9, 3.916920964235355*^9, {
   3.916923840537129*^9, 
   3.916923841396008*^9}},ExpressionUUID->"685cb5ce-8020-48ce-96b9-\
a75886698576"],

Cell[CellGroupData[{

Cell["\<\
Models A & B) Signalling; migration after population regulation\
\>", "Section",
 CellChangeTimes->{{3.915174600364295*^9, 3.91517462569272*^9}, 
   3.91517466765668*^9, {3.915175186685773*^9, 3.915175197207159*^9}, {
   3.91517755046989*^9, 3.9151775509280024`*^9}, {3.915184515366377*^9, 
   3.915184552979945*^9}},ExpressionUUID->"eef3e3db-99f7-470a-892d-\
dcbb5b19ef05"],

Cell["\<\
Neighbour-modulated fitness for the focal individual (w) is written below. \
This is Equation A6 in the SI.\
\>", "Text",
 CellChangeTimes->{{3.9151752377757063`*^9, 3.915175259620417*^9}, {
  3.915175352890313*^9, 3.9151753593515577`*^9}, {3.915201719433642*^9, 
  3.915201720074353*^9}},ExpressionUUID->"45d5df5b-96cb-462e-9b49-\
9c92bba9c003"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"w", "=", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "-", 
       RowBox[{
        RowBox[{"(", 
         FractionBox["1", "N"], ")"}], 
        RowBox[{"(", 
         RowBox[{"d", "+", 
          RowBox[{"c", " ", "xfocal"}]}], ")"}]}], "-", 
       RowBox[{
        RowBox[{"(", 
         FractionBox[
          RowBox[{"N", "-", "1"}], "N"], ")"}], 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"d", 
           RowBox[{"(", 
            RowBox[{"1", "-", "xothers"}], ")"}]}], "+", 
          RowBox[{"c", " ", "xfocal", 
           RowBox[{"(", 
            RowBox[{"1", "-", "g"}], ")"}]}], "+", 
          RowBox[{"s", " ", "xothers"}]}], ")"}]}]}], ")"}], "/", 
     RowBox[{"(", 
      RowBox[{"1", "-", 
       RowBox[{
        RowBox[{"(", 
         FractionBox["1", "N"], ")"}], 
        RowBox[{"(", 
         RowBox[{"d", "+", 
          RowBox[{"c", " ", 
           RowBox[{"(", 
            RowBox[{
             FractionBox[
              RowBox[{"xothers", 
               RowBox[{"(", 
                RowBox[{"N", "-", "1"}], ")"}]}], "N"], "+", 
             FractionBox["xfocal", "N"]}], ")"}]}]}], ")"}]}], "-", 
       RowBox[{
        RowBox[{"(", 
         FractionBox[
          RowBox[{"N", "-", "1"}], "N"], ")"}], 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"d", 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"(", 
              RowBox[{
               FractionBox[
                RowBox[{"xothers", 
                 RowBox[{"(", 
                  RowBox[{"N", "-", "1"}], ")"}]}], "N"], "+", 
               FractionBox["xfocal", "N"]}], ")"}]}], ")"}]}], "+", 
          RowBox[{"c", " ", 
           RowBox[{"(", 
            RowBox[{
             FractionBox[
              RowBox[{"xothers", 
               RowBox[{"(", 
                RowBox[{"N", "-", "1"}], ")"}]}], "N"], "+", 
             FractionBox["xfocal", "N"]}], ")"}], 
           RowBox[{"(", 
            RowBox[{"1", "-", "g"}], ")"}]}], "+", 
          RowBox[{"s", " ", 
           RowBox[{"(", 
            RowBox[{
             FractionBox[
              RowBox[{"xothers", 
               RowBox[{"(", 
                RowBox[{"N", "-", "1"}], ")"}]}], "N"], "+", 
             FractionBox["xfocal", "N"]}], ")"}]}]}], ")"}]}]}], ")"}]}]}], 
   ";"}], "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.908103877779798*^9, 3.9081039368551617`*^9}, {
   3.9082687020329027`*^9, 3.908268859066394*^9}, {3.908269883914235*^9, 
   3.908269920730289*^9}, {3.908355862871335*^9, 3.908355902589114*^9}, {
   3.9108604899938927`*^9, 3.910860560580213*^9}, {3.9113770175862293`*^9, 
   3.911377066649146*^9}, {3.911391018117175*^9, 3.911391056891016*^9}, 
   3.915175265985262*^9, {3.915177560180121*^9, 3.9151775756131973`*^9}, {
   3.916902659559713*^9, 3.9169027418006277`*^9}, {3.916911375029875*^9, 
   3.916911375031365*^9}, {3.916911412321594*^9, 3.916911412327455*^9}, {
   3.916911465577889*^9, 3.9169114655840473`*^9}},
 CellLabel->
  "In[300]:=",ExpressionUUID->"6ab4c242-b49a-4fa1-ae28-0ce77f725fde"],

Cell["\<\
The derivative of focal individual fitness, with respect to the focal \
individual trait value, evaluated at monomorphic equilibrium, is written \
below (as -cm). Note that the \[OpenCurlyQuote]cm\[CloseCurlyQuote] notation \
is used to represent the \[OpenCurlyQuote]marginal cost\[CloseCurlyQuote] of \
Hamilton\[CloseCurlyQuote]s Rule. This is Equation A9 in the SI.\
\>", "Text",
 CellChangeTimes->{{3.915175733249536*^9, 3.915175737026534*^9}, {
  3.915175857656424*^9, 3.915175883915668*^9}, {3.915201785175893*^9, 
  3.915201785787332*^9}},ExpressionUUID->"9bb87755-b4bb-4c9f-b40f-\
dfb9b9707cb4"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"cm", "=", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{"D", "[", 
       RowBox[{"w", ",", "xfocal"}], "]"}]}], "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"xpop", "->", 
        SuperscriptBox["x", "*"]}], ",", 
       RowBox[{"xothers", "->", 
        SuperscriptBox["x", "*"]}], ",", 
       RowBox[{"xfocal", "->", 
        SuperscriptBox["x", "*"]}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"TraditionalForm", "[", 
  RowBox[{"-", "cm"}], "]"}]}], "Input",
 CellChangeTimes->{{3.915177161684618*^9, 3.9151771773356667`*^9}, {
   3.916911412328679*^9, 3.916911412330186*^9}, 3.916911465585104*^9, {
   3.916911608925912*^9, 3.916911695809928*^9}},
 CellLabel->
  "In[301]:=",ExpressionUUID->"24bf0ab3-3e66-438b-8020-e04921876f38"],

Cell[BoxData[
 FormBox[
  RowBox[{"-", 
   FractionBox[
    RowBox[{
     RowBox[{"(", 
      RowBox[{"N", "-", "1"}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"c", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"g", " ", 
           RowBox[{"(", 
            RowBox[{"-", "N"}], ")"}]}], "+", "g", "+", "N"}], ")"}]}], "+", 
       "d", "-", "s"}], ")"}]}], 
    RowBox[{"N", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        SuperscriptBox["x", "*"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"N", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"c", " ", "g"}], "-", "s"}], ")"}]}], "-", 
          RowBox[{"c", " ", 
           RowBox[{"(", 
            RowBox[{"g", "+", "N"}], ")"}]}], "+", 
          RowBox[{"d", " ", 
           RowBox[{"(", 
            RowBox[{"N", "-", "1"}], ")"}]}], "+", "s"}], ")"}]}], "-", 
       RowBox[{"d", " ", "N"}], "+", "N"}], ")"}]}]]}], 
  TraditionalForm]], "Output",
 CellChangeTimes->{
  3.916911580167145*^9, {3.916911678775997*^9, 3.916911696456108*^9}, 
   3.917003744512588*^9, 3.917006906962982*^9, 3.917167951855569*^9},
 CellLabel->
  "Out[302]//TraditionalForm=",ExpressionUUID->"6383fd44-a9e5-4112-b386-\
6fa8931f4bf1"]
}, Open  ]],

Cell["\<\
The derivative of focal individual fitness, with respect to the average trait \
value of other individuals on the deme, evaluated at monomorphic equilibrium, \
is written below. Note that the \[OpenCurlyQuote]bm\[CloseCurlyQuote] \
notation is used to represent the \[OpenCurlyQuote]marginal benefit\
\[CloseCurlyQuote] of Hamilton\[CloseCurlyQuote]s Rule. This is Equation 10 \
in the SI.\
\>", "Text",
 CellChangeTimes->{{3.915175418488715*^9, 3.915175518937564*^9}, 
   3.915175722238924*^9, {3.915175920186359*^9, 3.915175930914809*^9}, {
   3.915201863902808*^9, 
   3.9152018640063953`*^9}},ExpressionUUID->"d05b3397-2c4e-443c-8583-\
32f09e2bcb9b"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TraditionalForm", "[", 
  RowBox[{"bm", "=", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{"w", ",", "xothers"}], "]"}], "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"xpop", "->", 
        SuperscriptBox["x", "*"]}], ",", 
       RowBox[{"xothers", "->", 
        SuperscriptBox["x", "*"]}], ",", 
       RowBox[{"xfocal", "->", 
        SuperscriptBox["x", "*"]}]}], "}"}]}], "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.9081039414213743`*^9, 3.9081039435052147`*^9}, {
   3.90810406510456*^9, 3.908104073589612*^9}, {3.9081043026353397`*^9, 
   3.9081043339158287`*^9}, 3.908106925554028*^9, {3.911391003528234*^9, 
   3.9113910075287848`*^9}, {3.9115423725276537`*^9, 3.911542390599454*^9}, {
   3.915175399934017*^9, 3.915175400756152*^9}, 3.915175723845454*^9, {
   3.915177193413665*^9, 3.9151771935552893`*^9}, {3.9169114123325033`*^9, 
   3.91691141233325*^9}, {3.9169114655861692`*^9, 3.916911465586907*^9}, 
   3.916911634624299*^9, 3.916911726811151*^9},
 CellLabel->
  "In[303]:=",ExpressionUUID->"a3605713-800e-4336-b1c7-0e4a604a5416"],

Cell[BoxData[
 FormBox[
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{"N", "-", "1"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"c", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"g", " ", 
          RowBox[{"(", 
           RowBox[{"-", "N"}], ")"}]}], "+", "g", "+", "N"}], ")"}]}], "+", 
      "d", "-", "s"}], ")"}]}], 
   RowBox[{"N", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SuperscriptBox["x", "*"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"N", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"c", " ", "g"}], "-", "s"}], ")"}]}], "-", 
         RowBox[{"c", " ", 
          RowBox[{"(", 
           RowBox[{"g", "+", "N"}], ")"}]}], "+", 
         RowBox[{"d", " ", 
          RowBox[{"(", 
           RowBox[{"N", "-", "1"}], ")"}]}], "+", "s"}], ")"}]}], "-", 
      RowBox[{"d", " ", "N"}], "+", "N"}], ")"}]}]], 
  TraditionalForm]], "Output",
 CellChangeTimes->{3.916911729799966*^9, 3.9170037463383303`*^9, 
  3.9170069088756657`*^9, 3.917167953293294*^9},
 CellLabel->
  "Out[303]//TraditionalForm=",ExpressionUUID->"61cb4931-f527-4816-80a5-\
f4b81907a40e"]
}, Open  ]],

Cell["\<\
The overall marginal change in neighbour-modulated fitness associated with a \
slight change in behaviour is written below, on the (false) assumption that \
relatedness is a constant (open model). The \[OpenCurlyQuote]margopen\
\[CloseCurlyQuote] notation is used to represent the marginal fitness change, \
and the open model setting. This is Equation B1 in the SI.\
\>", "Text",
 CellChangeTimes->{{3.915175958153467*^9, 3.915176040877063*^9}, {
  3.915177227882449*^9, 3.9151773535121117`*^9}, {3.9152019626637087`*^9, 
  3.915201962719282*^9}},ExpressionUUID->"f25a8219-dcda-4207-b4eb-\
94d684749939"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TraditionalForm", "[", 
  RowBox[{"margopen", "=", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{
     RowBox[{
      SuperscriptBox["r", "*"], " ", "bm"}], " ", "-", " ", "cm"}], "]"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.9081044477104807`*^9, 3.908104459241107*^9}, {
   3.908104492639288*^9, 3.9081044941536303`*^9}, {3.9081051452016487`*^9, 
   3.90810514887316*^9}, {3.9151758222548037`*^9, 3.9151758368976316`*^9}, {
   3.915177197160902*^9, 3.9151772227977467`*^9}, 3.915177266100378*^9, {
   3.917003772170973*^9, 3.917003774002141*^9}, {3.917006895782506*^9, 
   3.917006902872171*^9}},
 CellLabel->
  "In[304]:=",ExpressionUUID->"05008782-7791-4357-a2a3-c1f9668e81c2"],

Cell[BoxData[
 FormBox[
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{"N", "-", "1"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["r", "*"], "-", "1"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"c", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"g", " ", 
          RowBox[{"(", 
           RowBox[{"-", "N"}], ")"}]}], "+", "g", "+", "N"}], ")"}]}], "+", 
      "d", "-", "s"}], ")"}]}], 
   RowBox[{"N", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SuperscriptBox["x", "*"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"N", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"c", " ", "g"}], "-", "s"}], ")"}]}], "-", 
         RowBox[{"c", " ", 
          RowBox[{"(", 
           RowBox[{"g", "+", "N"}], ")"}]}], "+", 
         RowBox[{"d", " ", 
          RowBox[{"(", 
           RowBox[{"N", "-", "1"}], ")"}]}], "+", "s"}], ")"}]}], "-", 
      RowBox[{"d", " ", "N"}], "+", "N"}], ")"}]}]], 
  TraditionalForm]], "Output",
 CellChangeTimes->{
  3.916911738010305*^9, {3.91700373625091*^9, 3.9170037483137836`*^9}, 
   3.9170037844905777`*^9, 3.9170069105025053`*^9, 3.917167955511587*^9},
 CellLabel->
  "Out[304]//TraditionalForm=",ExpressionUUID->"880ea228-91a1-43e5-b898-\
e636ecec134b"]
}, Open  ]],

Cell["\<\
We ask when a slight increase in the behaviour is favoured. To do so, we \
first set the selection differential to zero, to obtain s\[Rule]c (g \
(-N)+g+N)+d. We can see that the right hand side is always greater than the \
left hand side, meaning the selection differential is always negative, and so \
the behaviour is always disfavoured.\
\>", "Text",
 CellChangeTimes->{{3.915176101958577*^9, 3.915176179387744*^9}, {
  3.915176229291583*^9, 3.915176243005365*^9}, {3.915177406063599*^9, 
  3.915177410206997*^9}, {3.915177643831272*^9, 3.915177649866047*^9}, {
  3.9169118896083317`*^9, 3.916912048834888*^9}, {3.916921398024084*^9, 
  3.916921402210896*^9}},ExpressionUUID->"1c5fee6b-d001-4e42-9b27-\
a5410b7e9ee9"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TraditionalForm", "[", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{"Solve", "[", 
    RowBox[{"margopen", "==", "0"}], "]"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.916911791734164*^9, 3.9169118096452503`*^9}},
 CellLabel->
  "In[305]:=",ExpressionUUID->"f73cbbdf-8f71-4505-a6c5-5fd2c217c1cd"],

Cell[BoxData[
 FormBox[
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"N", "\[Rule]", "1"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"s", "\[Rule]", 
      RowBox[{
       RowBox[{"c", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"g", " ", 
           RowBox[{"(", 
            RowBox[{"-", "N"}], ")"}]}], "+", "g", "+", "N"}], ")"}]}], "+", 
       "d"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      SuperscriptBox["r", "*"], "\[Rule]", "1"}], "}"}]}], "}"}], 
  TraditionalForm]], "Output",
 CellChangeTimes->{3.9169118098629103`*^9, 3.9170037532184057`*^9, 
  3.917006915300378*^9, 3.917167957532297*^9},
 CellLabel->
  "Out[305]//TraditionalForm=",ExpressionUUID->"daf1c169-d624-4fc7-b42f-\
09c0d30380e4"]
}, Open  ]],

Cell[TextData[{
 "We now undertake the \[OpenCurlyQuote]closed model\[CloseCurlyQuote] \
analysis, where relatedness is not considered a constant, but is instead \
expressed in terms of model parameters. Relatedness is given by ",
 Cell[BoxData[
  FormBox[
   RowBox[{"r", "=", 
    FractionBox["1", 
     RowBox[{"1", "-", 
      FractionBox[
       RowBox[{
        RowBox[{"(", 
         RowBox[{"m", "-", "2"}], ")"}], " ", "m", " ", "N"}], 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"m", "-", "1"}], ")"}], "2"]]}]]}], TraditionalForm]],
  CellChangeTimes->{{3.910861979123197*^9, 3.9108619999508753`*^9}, {
    3.91086222963589*^9, 3.9108622426687517`*^9}, 3.910862460959608*^9, 
    3.9108626243521233`*^9, 3.9114609992207623`*^9, 3.911461049933278*^9, 
    3.911461104221305*^9, 3.9114637937132893`*^9, {3.9114638920883408`*^9, 
    3.9114638987610273`*^9}, {3.911464017519855*^9, 3.911464020308721*^9}, 
    3.911472250412627*^9, 3.911554645377158*^9},ExpressionUUID->
  "41f6f5ba-b23f-435a-a6be-0592fab3e2ba"],
 "(Equation A17). We therefore obtain the overall marginal change in \
neighbour-modulated fitness associated with a slight change in behaviour, on \
the (true) assumption that relatedness emerges from model parameters.  The \
\[OpenCurlyQuote]margclosed\[CloseCurlyQuote] notation is used to represent \
the marginal fitness change, and the closed model setting. This is Equation \
A18 in the SI. "
}], "Text",
 CellChangeTimes->{{3.915176441285725*^9, 3.915176587713168*^9}, {
  3.915177463317815*^9, 3.9151774714126167`*^9}, {3.915201893168091*^9, 
  3.915201894284738*^9}, {3.915202007544639*^9, 
  3.9152020082622538`*^9}},ExpressionUUID->"6a37b233-19a5-434c-a5a3-\
b4d6384a34e0"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TraditionalForm", "[", 
  RowBox[{"margclosed", "=", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       SuperscriptBox["r", "*"], " ", "bm"}], " ", "-", " ", "cm"}], "/.", 
     RowBox[{"{", 
      RowBox[{
       SuperscriptBox["r", "*"], "->", 
       RowBox[{"1", "/", 
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"m", "-", "2"}], ")"}], " ", "m", " ", "N"}], ")"}], 
           "/", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"m", "-", "1"}], ")"}], "^", "2"}]}]}], ")"}]}]}], 
      "}"}]}], "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.91517659618088*^9, 3.915176615645871*^9}, 
   3.915177444830543*^9, {3.915177479766621*^9, 3.915177481869033*^9}, {
   3.91700371130721*^9, 3.917003713024507*^9}, {3.917008545430057*^9, 
   3.917008555707427*^9}},
 CellLabel->
  "In[306]:=",ExpressionUUID->"501e4be6-f164-4fcd-81f3-e5b1586b63ad"],

Cell[BoxData[
 FormBox[
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{"m", "-", "2"}], ")"}], " ", "m", " ", 
    RowBox[{"(", 
     RowBox[{"N", "-", "1"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"c", " ", 
       RowBox[{"(", 
        RowBox[{"g", "-", "1"}], ")"}], " ", "N"}], "-", 
      RowBox[{"c", " ", "g"}], "-", "d", "+", "s"}], ")"}]}], 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"m", "-", "2"}], ")"}], " ", "m", " ", 
       RowBox[{"(", 
        RowBox[{"N", "-", "1"}], ")"}]}], "-", "1"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SuperscriptBox["x", "*"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"N", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"c", " ", "g"}], "-", "s"}], ")"}]}], "-", 
         RowBox[{"c", " ", 
          RowBox[{"(", 
           RowBox[{"g", "+", "N"}], ")"}]}], "+", 
         RowBox[{"d", " ", 
          RowBox[{"(", 
           RowBox[{"N", "-", "1"}], ")"}]}], "+", "s"}], ")"}]}], "-", 
      RowBox[{"d", " ", "N"}], "+", "N"}], ")"}]}]], 
  TraditionalForm]], "Output",
 CellChangeTimes->{
  3.9169121061689577`*^9, {3.9170037227399893`*^9, 3.917003724466658*^9}, 
   3.917003758054388*^9, 3.917004076921381*^9, 3.917004112438052*^9, 
   3.917006956026813*^9, 3.917167959540667*^9},
 CellLabel->
  "Out[306]//TraditionalForm=",ExpressionUUID->"c74482c2-af46-46cc-b40d-\
ebbf6bdb177a"]
}, Open  ]],

Cell["\<\
We ask when a slight increase in the behaviour is favoured. To do so, we \
first set the selection differential to zero, to obtain s\[Rule]c (g \
(-N)+g+N)+d, as we did for the open model setting, meaning the behaviour is \
disfavoured. The behaviour is favoured in neither the open nor closed model \
setting.\
\>", "Text",
 CellChangeTimes->{{3.9151769454838057`*^9, 3.9151769716502733`*^9}, {
  3.91517770399575*^9, 3.9151777276819963`*^9}, {3.9169121268830423`*^9, 
  3.916912182303183*^9}, {3.91692195367419*^9, 
  3.916921967125901*^9}},ExpressionUUID->"3766a80a-e8dd-4ce5-86a6-\
6c26e8d93045"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TraditionalForm", "[", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{"Solve", "[", 
    RowBox[{"margclosed", "==", "0"}], "]"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.91086262736821*^9, 3.910862678869877*^9}, 
   3.911472300688035*^9, {3.911472332014091*^9, 3.911472344399435*^9}, {
   3.911548186771056*^9, 3.911548189170001*^9}, 3.9115482347234707`*^9, {
   3.9115482852122593`*^9, 3.9115483160155067`*^9}, {3.915176872170781*^9, 
   3.9151769012207336`*^9}, {3.915177491578352*^9, 3.9151774916856956`*^9}, {
   3.91690359743087*^9, 3.916903621292493*^9}, 3.916911375063733*^9, 
   3.916911412338291*^9, {3.9169121376276073`*^9, 3.916912141157288*^9}},
 CellLabel->
  "In[307]:=",ExpressionUUID->"6d5f0305-1b66-4d15-a0f2-8af35835d611"],

Cell[BoxData[
 FormBox[
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"m", "\[Rule]", "0"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"m", "\[Rule]", "2"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"N", "\[Rule]", "1"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"s", "\[Rule]", 
      RowBox[{
       RowBox[{"c", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"g", " ", 
           RowBox[{"(", 
            RowBox[{"-", "N"}], ")"}]}], "+", "g", "+", "N"}], ")"}]}], "+", 
       "d"}]}], "}"}]}], "}"}], TraditionalForm]], "Output",
 CellChangeTimes->{
  3.910862634126298*^9, 3.910862679713876*^9, 3.911377178731172*^9, {
   3.911472315555702*^9, 3.911472345188623*^9}, 3.911548193938794*^9, 
   3.911548237122397*^9, {3.91154829494869*^9, 3.911548316947212*^9}, 
   3.9115546458318996`*^9, 3.9151769039327383`*^9, 3.915177492573509*^9, 
   3.915177527058111*^9, 3.9151777092089453`*^9, 3.915205744985972*^9, 
   3.9169036278410873`*^9, 3.916912141621896*^9, 3.917006958987402*^9, 
   3.9171679624357147`*^9},
 CellLabel->
  "Out[307]//TraditionalForm=",ExpressionUUID->"1810a375-bb6c-4e5d-824e-\
242a79bb193f"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
Models C & D) Signalling; migration before population regulation\
\>", "Section",
 CellChangeTimes->{{3.915174600364295*^9, 3.91517462569272*^9}, 
   3.91517466765668*^9, {3.915175186685773*^9, 3.915175197207159*^9}, {
   3.9151845315098667`*^9, 
   3.9151845554729557`*^9}},ExpressionUUID->"aa1c85bd-0246-49e0-a27e-\
a25648c6e879"],

Cell["\<\
Neighbour-modulated fitness for the focal individual (w) is written below. \
This is Equation C1 in the SI.\
\>", "Text",
 CellChangeTimes->{{3.9151752377757063`*^9, 3.915175259620417*^9}, {
  3.915175352890313*^9, 3.9151753593515577`*^9}, {3.915202060281857*^9, 
  3.915202060344359*^9}},ExpressionUUID->"f5580ae9-2638-4cb4-a379-\
650590143669"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"w", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", "m"}], ")"}], 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{
          RowBox[{"(", 
           FractionBox["1", "N"], ")"}], 
          RowBox[{"(", 
           RowBox[{"d", "+", 
            RowBox[{"c", " ", "xfocal"}]}], ")"}]}], "-", 
         RowBox[{
          RowBox[{"(", 
           FractionBox[
            RowBox[{"N", "-", "1"}], "N"], ")"}], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"d", 
             RowBox[{"(", 
              RowBox[{"1", "-", "xothers"}], ")"}]}], "+", 
            RowBox[{"c", " ", "xfocal", 
             RowBox[{"(", 
              RowBox[{"1", "-", "g"}], ")"}]}], "+", 
            RowBox[{"s", " ", "xothers"}]}], ")"}]}]}], ")"}], "/", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "-", "m"}], ")"}], 
          RowBox[{"(", 
           RowBox[{"1", "-", 
            RowBox[{
             RowBox[{"(", 
              FractionBox["1", "N"], ")"}], 
             RowBox[{"(", 
              RowBox[{"d", "+", 
               RowBox[{"c", " ", 
                RowBox[{"(", 
                 RowBox[{
                  FractionBox[
                   RowBox[{"xothers", 
                    RowBox[{"(", 
                    RowBox[{"N", "-", "1"}], ")"}]}], "N"], "+", 
                  FractionBox["xfocal", "N"]}], ")"}]}]}], ")"}]}], "-", 
            RowBox[{
             RowBox[{"(", 
              FractionBox[
               RowBox[{"N", "-", "1"}], "N"], ")"}], 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"d", 
                RowBox[{"(", 
                 RowBox[{"1", "-", 
                  RowBox[{"(", 
                   RowBox[{
                    FractionBox[
                    RowBox[{"xothers", 
                    RowBox[{"(", 
                    RowBox[{"N", "-", "1"}], ")"}]}], "N"], "+", 
                    FractionBox["xfocal", "N"]}], ")"}]}], ")"}]}], "+", 
               RowBox[{"c", " ", 
                RowBox[{"(", 
                 RowBox[{
                  FractionBox[
                   RowBox[{"xothers", 
                    RowBox[{"(", 
                    RowBox[{"N", "-", "1"}], ")"}]}], "N"], "+", 
                  FractionBox["xfocal", "N"]}], ")"}], 
                RowBox[{"(", 
                 RowBox[{"1", "-", "g"}], ")"}]}], "+", 
               RowBox[{"s", 
                RowBox[{"(", 
                 RowBox[{
                  FractionBox[
                   RowBox[{"xothers", 
                    RowBox[{"(", 
                    RowBox[{"N", "-", "1"}], ")"}]}], "N"], "+", 
                  FractionBox["xfocal", "N"]}], ")"}]}]}], ")"}]}]}], ")"}]}],
          "+", 
         RowBox[{"m", 
          RowBox[{"(", 
           RowBox[{"1", "-", 
            RowBox[{
             RowBox[{"(", 
              FractionBox["1", "N"], ")"}], 
             RowBox[{"(", 
              RowBox[{"d", "+", 
               RowBox[{"c", " ", "xpop"}]}], ")"}]}], "-", 
            RowBox[{
             RowBox[{"(", 
              FractionBox[
               RowBox[{"N", "-", "1"}], "N"], ")"}], 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"d", 
                RowBox[{"(", 
                 RowBox[{"1", "-", "xpop"}], ")"}]}], "+", 
               RowBox[{"c", " ", "xpop", 
                RowBox[{"(", 
                 RowBox[{"1", "-", "g"}], ")"}]}], "+", 
               RowBox[{"s", " ", "xpop"}]}], ")"}]}]}], ")"}]}]}], ")"}]}]}], 
     "+", 
     RowBox[{"m", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{
          RowBox[{"(", 
           FractionBox["1", "N"], ")"}], 
          RowBox[{"(", 
           RowBox[{"d", "+", 
            RowBox[{"c", " ", "xfocal"}]}], ")"}]}], "-", 
         RowBox[{
          RowBox[{"(", 
           FractionBox[
            RowBox[{"N", "-", "1"}], "N"], ")"}], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"d", 
             RowBox[{"(", 
              RowBox[{"1", "-", "xothers"}], ")"}]}], "+", 
            RowBox[{"c", " ", "xfocal", 
             RowBox[{"(", 
              RowBox[{"1", "-", "g"}], ")"}]}], "+", 
            RowBox[{"s", " ", "xothers"}]}], ")"}]}]}], ")"}], "/", 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{
          RowBox[{"(", 
           FractionBox["1", "N"], ")"}], 
          RowBox[{"(", 
           RowBox[{"d", "+", 
            RowBox[{"c", " ", "xpop"}]}], ")"}]}], "-", 
         RowBox[{
          RowBox[{"(", 
           FractionBox[
            RowBox[{"N", "-", "1"}], "N"], ")"}], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"d", 
             RowBox[{"(", 
              RowBox[{"1", "-", "xpop"}], ")"}]}], "+", 
            RowBox[{"c", " ", "xpop", 
             RowBox[{"(", 
              RowBox[{"1", "-", "g"}], ")"}]}], "+", " ", 
            RowBox[{"s", " ", "xpop"}]}], ")"}]}]}], ")"}]}]}]}]}], ";"}], 
  "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.908103877779798*^9, 3.9081039368551617`*^9}, {
   3.9082687020329027`*^9, 3.908268859066394*^9}, {3.908269883914235*^9, 
   3.908269920730289*^9}, {3.908355862871335*^9, 3.908355902589114*^9}, {
   3.9108604899938927`*^9, 3.910860560580213*^9}, {3.9113770175862293`*^9, 
   3.911377066649146*^9}, {3.911391018117175*^9, 3.911391056891016*^9}, 
   3.915175265985262*^9, {3.916903665255417*^9, 3.916903737332921*^9}, {
   3.916903780079558*^9, 3.916903784107769*^9}, {3.9169113750673647`*^9, 
   3.916911375075122*^9}, {3.916911412340334*^9, 3.916911412349597*^9}, {
   3.916911465589005*^9, 3.9169114655986567`*^9}, {3.9169115536660643`*^9, 
   3.916911553671792*^9}, {3.916920964243086*^9, 3.9169209642489967`*^9}},
 CellLabel->
  "In[308]:=",ExpressionUUID->"a21b650b-5cbd-4bbc-a541-202c40a61cec"],

Cell["\<\
The derivative of focal individual fitness, with respect to the focal \
individual trait value, evaluated at monomorphic equilibrium, is written \
below (as -cm). Note that the \[OpenCurlyQuote]cm\[CloseCurlyQuote] notation \
is used to represent the \[OpenCurlyQuote]marginal cost\[CloseCurlyQuote] of \
Hamilton\[CloseCurlyQuote]s Rule. This is Equation C2 in the SI.\
\>", "Text",
 CellChangeTimes->{{3.915175733249536*^9, 3.915175737026534*^9}, {
  3.915175857656424*^9, 3.915175883915668*^9}, {3.915202107785346*^9, 
  3.915202108337833*^9}},ExpressionUUID->"a96f95d9-564e-4b5c-a70a-\
9626482de7a4"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"cm", "=", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{"D", "[", 
       RowBox[{"w", ",", "xfocal"}], "]"}]}], "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"xpop", "->", 
        SuperscriptBox["x", "*"]}], ",", 
       RowBox[{"xothers", "->", 
        SuperscriptBox["x", "*"]}], ",", 
       RowBox[{"xfocal", "->", 
        SuperscriptBox["x", "*"]}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"TraditionalForm", "[", 
  RowBox[{"-", "cm"}], "]"}]}], "Input",
 CellChangeTimes->{{3.915177161684618*^9, 3.9151771773356667`*^9}, {
   3.9169114123507566`*^9, 3.916911412351968*^9}, 3.9169114655999727`*^9, 
   3.916911553673272*^9, 3.9169208882701902`*^9},
 CellLabel->
  "In[309]:=",ExpressionUUID->"d67c21ef-3a92-4094-98b7-603032d7a27a"],

Cell[BoxData[
 FormBox[
  RowBox[{"-", 
   FractionBox[
    RowBox[{
     RowBox[{"c", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"g", "-", "1"}], ")"}], " ", "N"}], "-", "g"}], ")"}], " ", 
      
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"m", "-", "1"}], ")"}], "2"], "-", "N"}], ")"}]}], "+", 
     RowBox[{"d", " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"m", "-", "1"}], ")"}], "2"], " ", 
      RowBox[{"(", 
       RowBox[{"N", "-", "1"}], ")"}]}], "-", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"m", "-", "1"}], ")"}], "2"], " ", 
      RowBox[{"(", 
       RowBox[{"N", "-", "1"}], ")"}], " ", "s"}]}], 
    RowBox[{"N", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        SuperscriptBox["x", "*"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"N", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"c", " ", "g"}], "-", "s"}], ")"}]}], "-", 
          RowBox[{"c", " ", 
           RowBox[{"(", 
            RowBox[{"g", "+", "N"}], ")"}]}], "+", 
          RowBox[{"d", " ", 
           RowBox[{"(", 
            RowBox[{"N", "-", "1"}], ")"}]}], "+", "s"}], ")"}]}], "-", 
       RowBox[{"d", " ", "N"}], "+", "N"}], ")"}]}]]}], 
  TraditionalForm]], "Output",
 CellChangeTimes->{3.916920972674039*^9, 3.917006431323813*^9, 
  3.917007073991768*^9, 3.9171681212103157`*^9},
 CellLabel->
  "Out[310]//TraditionalForm=",ExpressionUUID->"d8132f1b-f481-437c-8a76-\
ce87f505546f"]
}, Open  ]],

Cell["\<\
The derivative of focal individual fitness, with respect to the average trait \
value of other individuals on the deme, evaluated at monomorphic equilibrium, \
is written below. Note that the \[OpenCurlyQuote]bm\[CloseCurlyQuote] \
notation is used to represent the \[OpenCurlyQuote]marginal benefit\
\[CloseCurlyQuote] of Hamilton\[CloseCurlyQuote]s Rule. This is Equation C3 \
in the SI.\
\>", "Text",
 CellChangeTimes->{{3.915175418488715*^9, 3.915175518937564*^9}, 
   3.915175722238924*^9, {3.915175920186359*^9, 3.915175930914809*^9}, {
   3.915202112427059*^9, 
   3.915202112942956*^9}},ExpressionUUID->"7bb8876d-2031-40ad-a1c5-\
a0990cd0c3f0"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TraditionalForm", "[", 
  RowBox[{"bm", "=", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{"w", ",", "xothers"}], "]"}], "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"xpop", "->", 
        SuperscriptBox["x", "*"]}], ",", 
       RowBox[{"xothers", "->", 
        SuperscriptBox["x", "*"]}], ",", 
       RowBox[{"xfocal", "->", 
        SuperscriptBox["x", "*"]}]}], "}"}]}], "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.9081039414213743`*^9, 3.9081039435052147`*^9}, {
   3.90810406510456*^9, 3.908104073589612*^9}, {3.9081043026353397`*^9, 
   3.9081043339158287`*^9}, 3.908106925554028*^9, {3.911391003528234*^9, 
   3.9113910075287848`*^9}, {3.9115423725276537`*^9, 3.911542390599454*^9}, {
   3.915175399934017*^9, 3.915175400756152*^9}, 3.915175723845454*^9, {
   3.915177193413665*^9, 3.9151771935552893`*^9}, {3.916911412353875*^9, 
   3.916911412354452*^9}, {3.916911465600852*^9, 3.916911465601432*^9}, 
   3.916911553674254*^9, 3.916920996643852*^9},
 CellLabel->
  "In[311]:=",ExpressionUUID->"0f5499f3-9efa-4849-83aa-c55b74d53ebc"],

Cell[BoxData[
 FormBox[
  RowBox[{"-", 
   FractionBox[
    RowBox[{
     RowBox[{"(", 
      RowBox[{"N", "-", "1"}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"c", " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"m", "-", "1"}], ")"}], "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"g", "-", "1"}], ")"}], " ", "N"}], "-", "g"}], ")"}]}], 
       "+", 
       RowBox[{"d", " ", 
        RowBox[{"(", 
         RowBox[{"m", "-", "2"}], ")"}], " ", "m", " ", "N"}], "-", 
       RowBox[{"d", " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"m", "-", "1"}], ")"}], "2"]}], "-", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"m", "-", "2"}], ")"}], " ", "m", " ", 
        RowBox[{"(", 
         RowBox[{"N", "-", "1"}], ")"}], " ", "s"}], "+", "s"}], ")"}]}], 
    RowBox[{"N", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        SuperscriptBox["x", "*"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"N", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"c", " ", "g"}], "-", "s"}], ")"}]}], "-", 
          RowBox[{"c", " ", 
           RowBox[{"(", 
            RowBox[{"g", "+", "N"}], ")"}]}], "+", 
          RowBox[{"d", " ", 
           RowBox[{"(", 
            RowBox[{"N", "-", "1"}], ")"}]}], "+", "s"}], ")"}]}], "-", 
       RowBox[{"d", " ", "N"}], "+", "N"}], ")"}]}]]}], 
  TraditionalForm]], "Output",
 CellChangeTimes->{3.916920998726347*^9, 3.917006433333035*^9, 
  3.917007075679339*^9, 3.917168122794384*^9},
 CellLabel->
  "Out[311]//TraditionalForm=",ExpressionUUID->"a68c5607-8ca1-4bf1-9d5c-\
658025ae041b"]
}, Open  ]],

Cell["\<\
The overall marginal change in neighbour-modulated fitness associated with a \
slight change in behaviour is written below, on the (false) assumption that \
relatedness is a constant (open model). The \[OpenCurlyQuote]margopen\
\[CloseCurlyQuote] notation is used to represent the marginal fitness change, \
and the open model setting. This is Equation D1 in the SI.\
\>", "Text",
 CellChangeTimes->{{3.915175958153467*^9, 3.915176040877063*^9}, {
  3.915177227882449*^9, 3.9151773535121117`*^9}, {3.915202480835009*^9, 
  3.91520248145765*^9}},ExpressionUUID->"1d642f2c-5c9d-4bb4-8ac9-\
93d16e2e2944"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TraditionalForm", "[", 
  RowBox[{"margopen", "=", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{
     RowBox[{
      SuperscriptBox["r", "*"], " ", "bm"}], " ", "-", " ", "cm"}], "]"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.9081044477104807`*^9, 3.908104459241107*^9}, {
   3.908104492639288*^9, 3.9081044941536303`*^9}, {3.9081051452016487`*^9, 
   3.90810514887316*^9}, {3.9151758222548037`*^9, 3.9151758368976316`*^9}, {
   3.915177197160902*^9, 3.9151772227977467`*^9}, 3.915177266100378*^9, {
   3.917006399083518*^9, 3.917006454533423*^9}, {3.9170064855052347`*^9, 
   3.9170064866297903`*^9}},
 CellLabel->
  "In[312]:=",ExpressionUUID->"49378176-ba94-42c9-b7eb-d34187383634"],

Cell[BoxData[
 FormBox[
  RowBox[{"-", 
   FractionBox[
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"N", "-", "1"}], ")"}], " ", 
      SuperscriptBox["r", "*"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"c", " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"m", "-", "1"}], ")"}], "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"g", "-", "1"}], ")"}], " ", "N"}], "-", "g"}], ")"}]}], 
        "+", 
        RowBox[{"d", " ", 
         RowBox[{"(", 
          RowBox[{"m", "-", "2"}], ")"}], " ", "m", " ", "N"}], "-", 
        RowBox[{"d", " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"m", "-", "1"}], ")"}], "2"]}], "-", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"m", "-", "2"}], ")"}], " ", "m", " ", 
         RowBox[{"(", 
          RowBox[{"N", "-", "1"}], ")"}], " ", "s"}], "+", "s"}], ")"}]}], 
     "+", 
     RowBox[{"c", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"g", "-", "1"}], ")"}], " ", "N"}], "-", "g"}], ")"}], " ", 
      
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"m", "-", "1"}], ")"}], "2"], "-", "N"}], ")"}]}], "+", 
     RowBox[{"d", " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"m", "-", "1"}], ")"}], "2"], " ", 
      RowBox[{"(", 
       RowBox[{"N", "-", "1"}], ")"}]}], "-", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"m", "-", "1"}], ")"}], "2"], " ", 
      RowBox[{"(", 
       RowBox[{"N", "-", "1"}], ")"}], " ", "s"}]}], 
    RowBox[{"N", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        SuperscriptBox["x", "*"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"N", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"c", " ", "g"}], "-", "s"}], ")"}]}], "-", 
          RowBox[{"c", " ", 
           RowBox[{"(", 
            RowBox[{"g", "+", "N"}], ")"}]}], "+", 
          RowBox[{"d", " ", 
           RowBox[{"(", 
            RowBox[{"N", "-", "1"}], ")"}]}], "+", "s"}], ")"}]}], "-", 
       RowBox[{"d", " ", "N"}], "+", "N"}], ")"}]}]]}], 
  TraditionalForm]], "Output",
 CellChangeTimes->{3.916921024606532*^9, 3.917006414970397*^9, 
  3.9170064565066137`*^9, 3.917006487254201*^9, 3.917007077552244*^9, 
  3.917168124236874*^9},
 CellLabel->
  "Out[312]//TraditionalForm=",ExpressionUUID->"7079c320-d6c9-460d-a05e-\
cdddd8fc12ec"]
}, Open  ]],

Cell["\<\
We ask when a slight increase in the behaviour is favoured, on the assumption \
of zero migration (m=0). To do so, we  set the selection differential to \
zero, to obtain s\[Rule]c (g (-N)+g+N)+d. We can see that the right hand side \
is always greater than the left hand side, meaning the selection differential \
is always negative, and so the behaviour is  disfavoured.\
\>", "Text",
 CellChangeTimes->{{3.915176101958577*^9, 3.915176179387744*^9}, {
  3.915176229291583*^9, 3.915176243005365*^9}, {3.915177406063599*^9, 
  3.915177410206997*^9}, {3.9169211674956417`*^9, 3.916921184717087*^9}, {
  3.916921339323142*^9, 3.916921382237941*^9}, {3.916921462434651*^9, 
  3.9169214680810337`*^9}},ExpressionUUID->"814091cb-f6e2-4a7e-940b-\
e6b192478abe"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"TraditionalForm", "[", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{"margopen", "/.", 
    RowBox[{"{", 
     RowBox[{"m", "->", "0"}], "}"}]}], "]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"TraditionalForm", "[", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{"Solve", "[", 
    RowBox[{
     RowBox[{"margopen", "==", "0"}], "/.", 
     RowBox[{"{", 
      RowBox[{"m", "->", "0"}], "}"}]}], "]"}], "]"}], "]"}]}], "Input",
 CellChangeTimes->{{3.908108081357972*^9, 3.90810815886198*^9}, 
   3.9082689167181387`*^9, {3.908275020896943*^9, 3.9082750299584627`*^9}, {
   3.908275081536397*^9, 3.9082751262301083`*^9}, {3.9082751906324368`*^9, 
   3.908275193265663*^9}, {3.9082752320393248`*^9, 3.908275277398169*^9}, {
   3.908275311973724*^9, 3.9082753702498417`*^9}, {3.908275404855864*^9, 
   3.908275411310329*^9}, {3.911472199070818*^9, 3.911472202133206*^9}, {
   3.915177205821993*^9, 3.9151772059558477`*^9}, {3.915177361413143*^9, 
   3.915177361646332*^9}, {3.91690420982997*^9, 3.9169042308246803`*^9}, 
   3.916911375095974*^9, 3.916911412357128*^9, {3.9169210658871527`*^9, 
   3.916921073116468*^9}, {3.916921271319553*^9, 3.91692128963286*^9}, {
   3.9170066555903482`*^9, 3.917006688008757*^9}},
 CellLabel->
  "In[313]:=",ExpressionUUID->"29864960-ef33-4814-bb7b-347be41625c6"],

Cell[BoxData[
 FormBox[
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{"N", "-", "1"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["r", "*"], "-", "1"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"c", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"g", " ", 
          RowBox[{"(", 
           RowBox[{"-", "N"}], ")"}]}], "+", "g", "+", "N"}], ")"}]}], "+", 
      "d", "-", "s"}], ")"}]}], 
   RowBox[{"N", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SuperscriptBox["x", "*"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"N", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"c", " ", "g"}], "-", "s"}], ")"}]}], "-", 
         RowBox[{"c", " ", 
          RowBox[{"(", 
           RowBox[{"g", "+", "N"}], ")"}]}], "+", 
         RowBox[{"d", " ", 
          RowBox[{"(", 
           RowBox[{"N", "-", "1"}], ")"}]}], "+", "s"}], ")"}]}], "-", 
      RowBox[{"d", " ", "N"}], "+", "N"}], ")"}]}]], 
  TraditionalForm]], "Output",
 CellChangeTimes->{
  3.9082689189247103`*^9, {3.9082750095828257`*^9, 3.908275031642332*^9}, {
   3.908275084386447*^9, 3.908275127976161*^9}, 3.908275193877214*^9, {
   3.908275233458981*^9, 3.908275248590908*^9}, 3.908275279347251*^9, 
   3.908275380694973*^9, 3.908275413192636*^9, 3.9083559387106123`*^9, 
   3.910860622126617*^9, 3.911376898573859*^9, 3.911377143928994*^9, 
   3.9114720838680353`*^9, 3.911472229947011*^9, 3.911548109194347*^9, 
   3.911554643668841*^9, 3.915177207879016*^9, 3.9151773650375423`*^9, 
   3.9151775188673983`*^9, 3.915205762706293*^9, 3.916904268839561*^9, 
   3.916921079337216*^9, {3.916921276745158*^9, 3.9169212899054413`*^9}, 
   3.917006468813139*^9, 3.917006570992041*^9, {3.917006666988304*^9, 
   3.9170066889448833`*^9}, 3.917007079514983*^9, 3.917168126232297*^9},
 CellLabel->
  "Out[313]//TraditionalForm=",ExpressionUUID->"51c91f0e-bba8-4de5-acdc-\
422a357863c6"],

Cell[BoxData[
 FormBox[
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"N", "\[Rule]", "1"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"s", "\[Rule]", 
      RowBox[{
       RowBox[{"c", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"g", " ", 
           RowBox[{"(", 
            RowBox[{"-", "N"}], ")"}]}], "+", "g", "+", "N"}], ")"}]}], "+", 
       "d"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      SuperscriptBox["r", "*"], "\[Rule]", "1"}], "}"}]}], "}"}], 
  TraditionalForm]], "Output",
 CellChangeTimes->{
  3.9082689189247103`*^9, {3.9082750095828257`*^9, 3.908275031642332*^9}, {
   3.908275084386447*^9, 3.908275127976161*^9}, 3.908275193877214*^9, {
   3.908275233458981*^9, 3.908275248590908*^9}, 3.908275279347251*^9, 
   3.908275380694973*^9, 3.908275413192636*^9, 3.9083559387106123`*^9, 
   3.910860622126617*^9, 3.911376898573859*^9, 3.911377143928994*^9, 
   3.9114720838680353`*^9, 3.911472229947011*^9, 3.911548109194347*^9, 
   3.911554643668841*^9, 3.915177207879016*^9, 3.9151773650375423`*^9, 
   3.9151775188673983`*^9, 3.915205762706293*^9, 3.916904268839561*^9, 
   3.916921079337216*^9, {3.916921276745158*^9, 3.9169212899054413`*^9}, 
   3.917006468813139*^9, 3.917006570992041*^9, {3.917006666988304*^9, 
   3.9170066889448833`*^9}, 3.917007079514983*^9, 3.917168126237528*^9},
 CellLabel->
  "Out[314]//TraditionalForm=",ExpressionUUID->"db3a11b4-27f7-446b-a939-\
d3b74c0219e9"]
}, Open  ]],

Cell[TextData[{
 "We ask when a slight increase in the behaviour is favoured, on the \
assumption of full migration (m=1). To do so, we first set the selection \
differential to zero, to obtain ",
 Cell[BoxData[
  RowBox[{"s", "\[Rule]", 
   FractionBox[
    RowBox[{"c", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"g", " ", 
        RowBox[{"(", 
         RowBox[{"-", "N"}], ")"}]}], "+", "g", "+", "N"}], ")"}]}], 
    RowBox[{"r", "-", 
     RowBox[{"N", " ", "r"}]}]]}]],
  CellChangeTimes->{{3.916921517193231*^9, 3.916921520764381*^9}},
  ExpressionUUID->"694bfba1-37ac-4f8a-9120-5c5344f7200f"],
 ". The behaviour is favoured when the left-hand side is greater than the \
right-hand side. This is Equation D4 (slightly rearranged) in the SI."
}], "Text",
 CellChangeTimes->{{3.915176273466278*^9, 3.915176279609105*^9}, {
   3.915176337851461*^9, 3.915176359760262*^9}, {3.915177400639497*^9, 
   3.915177402013357*^9}, {3.915202520975082*^9, 3.915202521661769*^9}, {
   3.916904476370679*^9, 3.9169044782464933`*^9}, {3.916911375097795*^9, 
   3.916911375098484*^9}, {3.916921475845743*^9, 3.9169214853349543`*^9}, 
   3.9169215432682133`*^9, {3.916921596894339*^9, 3.916921622380485*^9}, {
   3.91692177560401*^9, 
   3.916921788848304*^9}},ExpressionUUID->"53ef27b6-ade9-45ec-ab9d-\
3668546edfd1"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"TraditionalForm", "[", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{"margopen", "/.", 
    RowBox[{"{", 
     RowBox[{"m", "->", "1"}], "}"}]}], "]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"TraditionalForm", "[", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{"Solve", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"margopen", "==", "0"}], "/.", 
      RowBox[{"{", 
       RowBox[{"m", "->", "1"}], "}"}]}], ",", 
     SuperscriptBox["r", "*"]}], "]"}], "]"}], "]"}]}], "Input",
 CellChangeTimes->{{3.90827547900133*^9, 3.908275526641282*^9}, {
   3.908275670152458*^9, 3.908275700588422*^9}, {3.9114722372479143`*^9, 
   3.9114722413253193`*^9}, {3.915177386188711*^9, 3.915177386585072*^9}, 
   3.916904284833131*^9, 3.916904565383276*^9, 3.916911375100438*^9, 
   3.91691141235809*^9, {3.916921494316596*^9, 3.91692152019011*^9}, {
   3.917007038277079*^9, 3.917007041534177*^9}, {3.917007331470581*^9, 
   3.917007342955291*^9}},
 CellLabel->
  "In[315]:=",ExpressionUUID->"de382b43-3f17-4a3a-9c8e-9108952c42cc"],

Cell[BoxData[
 FormBox[
  FractionBox[
   RowBox[{
    RowBox[{"c", " ", 
     RowBox[{"(", 
      RowBox[{"g", "-", "1"}], ")"}], " ", "N"}], "-", 
    RowBox[{"c", " ", "g"}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"N", "-", "1"}], ")"}], " ", 
     SuperscriptBox["r", "*"], " ", 
     RowBox[{"(", 
      RowBox[{"d", "-", "s"}], ")"}]}]}], 
   RowBox[{
    RowBox[{
     SuperscriptBox["x", "*"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"N", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"c", " ", "g"}], "-", "s"}], ")"}]}], "-", 
       RowBox[{"c", " ", 
        RowBox[{"(", 
         RowBox[{"g", "+", "N"}], ")"}]}], "+", 
       RowBox[{"d", " ", 
        RowBox[{"(", 
         RowBox[{"N", "-", "1"}], ")"}]}], "+", "s"}], ")"}]}], "-", 
    RowBox[{"d", " ", "N"}], "+", "N"}]], TraditionalForm]], "Output",
 CellChangeTimes->{{3.916921517193231*^9, 3.916921520764381*^9}, 
   3.917006475779202*^9, 3.917007043922151*^9, 3.917007082082943*^9, {
   3.917007321809005*^9, 3.917007346255299*^9}, 3.917168128553379*^9},
 CellLabel->
  "Out[315]//TraditionalForm=",ExpressionUUID->"955c8e22-1fa2-439b-9706-\
b6714032e025"],

Cell[BoxData[
 FormBox[
  RowBox[{"{", 
   RowBox[{"{", 
    RowBox[{
     SuperscriptBox["r", "*"], "\[Rule]", 
     FractionBox[
      RowBox[{"c", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"g", " ", 
          RowBox[{"(", 
           RowBox[{"-", "N"}], ")"}]}], "+", "g", "+", "N"}], ")"}]}], 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"N", "-", "1"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"d", "-", "s"}], ")"}]}]]}], "}"}], "}"}], 
  TraditionalForm]], "Output",
 CellChangeTimes->{{3.916921517193231*^9, 3.916921520764381*^9}, 
   3.917006475779202*^9, 3.917007043922151*^9, 3.917007082082943*^9, {
   3.917007321809005*^9, 3.917007346255299*^9}, 3.917168128558538*^9},
 CellLabel->
  "Out[316]//TraditionalForm=",ExpressionUUID->"96051983-0782-4a0d-894b-\
e85956f00ec8"]
}, Open  ]],

Cell[TextData[{
 "We now undertake the \[OpenCurlyQuote]closed model\[CloseCurlyQuote] \
analysis, where relatedness is not considered a constant, but is instead \
expressed in terms of model parameters. Relatedness is given by ",
 Cell[BoxData[
  FormBox[
   RowBox[{"r", "=", 
    FractionBox["1", 
     RowBox[{"1", "-", 
      FractionBox[
       RowBox[{
        RowBox[{"(", 
         RowBox[{"m", "-", "2"}], ")"}], " ", "m", " ", "N"}], 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"m", "-", "1"}], ")"}], "2"]]}]]}], TraditionalForm]],
  CellChangeTimes->{{3.910861979123197*^9, 3.9108619999508753`*^9}, {
    3.91086222963589*^9, 3.9108622426687517`*^9}, 3.910862460959608*^9, 
    3.9108626243521233`*^9, 3.9114609992207623`*^9, 3.911461049933278*^9, 
    3.911461104221305*^9, 3.9114637937132893`*^9, {3.9114638920883408`*^9, 
    3.9114638987610273`*^9}, {3.911464017519855*^9, 3.911464020308721*^9}, 
    3.911472250412627*^9, 3.911554645377158*^9},ExpressionUUID->
  "88e9a451-7b65-4ef5-ad2b-ae678ec82321"],
 "(Equation A17). We therefore obtain the overall marginal change in \
neighbour-modulated fitness associated with a slight change in behaviour, on \
the (true) assumption that relatedness emerges from model parameters.  The \
\[OpenCurlyQuote]margclosed\[CloseCurlyQuote] notation is used to represent \
the marginal fitness change, and the closed model setting. This is Equation \
C4 in the SI. "
}], "Text",
 CellChangeTimes->{{3.915176441285725*^9, 3.915176587713168*^9}, {
  3.915177463317815*^9, 3.9151774714126167`*^9}, {3.915202162057556*^9, 
  3.9152021995216208`*^9}},ExpressionUUID->"5ebf40e9-1778-43c5-be7a-\
7405ac196882"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TraditionalForm", "[", 
  RowBox[{"margclosed", "=", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       SuperscriptBox["r", "*"], " ", "bm"}], " ", "-", " ", "cm"}], "/.", 
     RowBox[{"{", 
      RowBox[{
       SuperscriptBox["r", "*"], "->", 
       RowBox[{"1", "/", 
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"m", "-", "2"}], ")"}], " ", "m", " ", "N"}], ")"}], 
           "/", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"m", "-", "1"}], ")"}], "^", "2"}]}]}], ")"}]}]}], 
      "}"}]}], "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.91517659618088*^9, 3.915176615645871*^9}, 
   3.915177444830543*^9, {3.915177479766621*^9, 3.915177481869033*^9}, {
   3.917008585431531*^9, 3.917008591437913*^9}},
 CellLabel->
  "In[317]:=",ExpressionUUID->"ea10e739-a763-45e3-b542-84d1f16d9f27"],

Cell[BoxData[
 FormBox[
  FractionBox[
   RowBox[{"c", " ", 
    RowBox[{"(", 
     RowBox[{"m", "-", "2"}], ")"}], " ", "m", " ", "N", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"g", " ", 
       RowBox[{"(", 
        RowBox[{"N", "-", "1"}], ")"}]}], "-", "N"}], ")"}]}], 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"m", "-", "2"}], ")"}], " ", "m", " ", 
       RowBox[{"(", 
        RowBox[{"N", "-", "1"}], ")"}]}], "-", "1"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SuperscriptBox["x", "*"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"N", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"c", " ", "g"}], "-", "s"}], ")"}]}], "-", 
         RowBox[{"c", " ", 
          RowBox[{"(", 
           RowBox[{"g", "+", "N"}], ")"}]}], "+", 
         RowBox[{"d", " ", 
          RowBox[{"(", 
           RowBox[{"N", "-", "1"}], ")"}]}], "+", "s"}], ")"}]}], "-", 
      RowBox[{"d", " ", "N"}], "+", "N"}], ")"}]}]], 
  TraditionalForm]], "Output",
 CellChangeTimes->{3.9169217998445807`*^9, 3.917168131575746*^9},
 CellLabel->
  "Out[317]//TraditionalForm=",ExpressionUUID->"deeea19e-5d61-474a-91ff-\
0d66c8237132"]
}, Open  ]],

Cell[TextData[{
 "We ask when a slight increase in the behaviour is favoured. To do so, we \
first set the selection differential to zero, to obtain ",
 Cell[BoxData[
  FormBox[
   RowBox[{"N", "\[Rule]", 
    FractionBox["g", 
     RowBox[{"g", "-", "1"}]]}], TraditionalForm]],
  CellChangeTimes->{
   3.910862634126298*^9, 3.910862679713876*^9, 3.911377178731172*^9, {
    3.911472315555702*^9, 3.911472345188623*^9}, 3.911548193938794*^9, 
    3.911548237122397*^9, {3.91154829494869*^9, 3.911548316947212*^9}, 
    3.9115546458318996`*^9, 3.9151769039327383`*^9, 3.915177492573509*^9, 
    3.915177527058111*^9, 3.91520576940941*^9, 3.9169046757511387`*^9, {
    3.91692181322268*^9, 3.916921825090461*^9}},ExpressionUUID->
  "4078cfa2-9e3d-4616-aedc-c874c59b8652"],
 ". The left-hand side is always greater than the right-hand side, meaning \
the behaviour is disfavoured."
}], "Text",
 CellChangeTimes->{{3.9151769454838057`*^9, 3.9151769716502733`*^9}, {
  3.916921879569149*^9, 
  3.916921918568274*^9}},ExpressionUUID->"7819eeb0-1f08-466f-b046-\
51cb1b22efc3"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TraditionalForm", "[", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{"Solve", "[", 
    RowBox[{"margclosed", "==", "0"}], "]"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.91086262736821*^9, 3.910862678869877*^9}, 
   3.911472300688035*^9, {3.911472332014091*^9, 3.911472344399435*^9}, {
   3.911548186771056*^9, 3.911548189170001*^9}, 3.9115482347234707`*^9, {
   3.9115482852122593`*^9, 3.9115483160155067`*^9}, {3.915176872170781*^9, 
   3.9151769012207336`*^9}, {3.915177491578352*^9, 3.9151774916856956`*^9}, {
   3.916904602331162*^9, 3.9169046174555693`*^9}, 3.916911375107368*^9, 
   3.916911412359993*^9, {3.9169218120408077`*^9, 3.91692182363475*^9}},
 CellLabel->
  "In[318]:=",ExpressionUUID->"8ffffd61-8406-434f-87f4-617d3d00c477"],

Cell[BoxData[
 FormBox[
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"c", "\[Rule]", "0"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"m", "\[Rule]", "0"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"m", "\[Rule]", "2"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"N", "\[Rule]", "0"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"N", "\[Rule]", 
      FractionBox["g", 
       RowBox[{"g", "-", "1"}]]}], "}"}]}], "}"}], TraditionalForm]], "Output",\

 CellChangeTimes->{
  3.910862634126298*^9, 3.910862679713876*^9, 3.911377178731172*^9, {
   3.911472315555702*^9, 3.911472345188623*^9}, 3.911548193938794*^9, 
   3.911548237122397*^9, {3.91154829494869*^9, 3.911548316947212*^9}, 
   3.9115546458318996`*^9, 3.9151769039327383`*^9, 3.915177492573509*^9, 
   3.915177527058111*^9, 3.91520576940941*^9, 3.9169046757511387`*^9, {
   3.91692181322268*^9, 3.916921825090461*^9}, 3.917168135464245*^9},
 CellLabel->
  "Out[318]//TraditionalForm=",ExpressionUUID->"1f08f3c4-5629-4ff9-83cd-\
98a6b72eda1f"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
Models E & F) Cue-suppression; migration after population regulation\
\>", "Section",
 CellChangeTimes->{{3.915174600364295*^9, 3.91517462569272*^9}, 
   3.91517466765668*^9, {3.915175186685773*^9, 3.915175197207159*^9}, {
   3.91517755046989*^9, 3.9151775509280024`*^9}, {3.915178174251244*^9, 
   3.915178176160171*^9}, {3.915184562918439*^9, 
   3.915184568372199*^9}},ExpressionUUID->"040398a3-4a45-46e3-9cd1-\
865e1abed546"],

Cell["\<\
Neighbour-modulated fitness for the focal individual (w) is written below.\
\>", "Text",
 CellChangeTimes->{{3.9151752377757063`*^9, 3.915175259620417*^9}, {
  3.915175352890313*^9, 3.9151753593515577`*^9}, {3.915202580661879*^9, 
  3.915202581910602*^9}},ExpressionUUID->"50c16f6b-77bd-401d-81a4-\
4ae4d681c945"],

Cell[BoxData[
 RowBox[{
  RowBox[{"w", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"1", "-", 
      RowBox[{
       RowBox[{"(", 
        FractionBox["1", "N"], ")"}], 
       RowBox[{"(", 
        RowBox[{"d", "+", 
         RowBox[{"c", " ", "xfocal"}]}], ")"}]}], "-", 
      RowBox[{
       RowBox[{"(", 
        FractionBox[
         RowBox[{"N", "-", "1"}], "N"], ")"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"d", 
          RowBox[{"(", "xothers", ")"}]}], "+", 
         RowBox[{"c", " ", "xfocal", 
          RowBox[{"(", 
           RowBox[{"1", "-", "g"}], ")"}]}], "+", 
         RowBox[{"s", 
          RowBox[{"(", 
           RowBox[{"1", "-", "xothers"}], ")"}]}]}], ")"}]}]}], ")"}], "/", 
    RowBox[{"(", 
     RowBox[{"1", "-", 
      RowBox[{
       RowBox[{"(", 
        FractionBox["1", "N"], ")"}], 
       RowBox[{"(", 
        RowBox[{"d", "+", 
         RowBox[{"c", " ", 
          RowBox[{"(", 
           RowBox[{
            FractionBox[
             RowBox[{"xothers", 
              RowBox[{"(", 
               RowBox[{"N", "-", "1"}], ")"}]}], "N"], "+", 
            FractionBox["xfocal", "N"]}], ")"}]}]}], ")"}]}], "-", 
      RowBox[{
       RowBox[{"(", 
        FractionBox[
         RowBox[{"N", "-", "1"}], "N"], ")"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"d", 
          RowBox[{"(", 
           RowBox[{"(", 
            RowBox[{
             FractionBox[
              RowBox[{"xothers", 
               RowBox[{"(", 
                RowBox[{"N", "-", "1"}], ")"}]}], "N"], "+", 
             FractionBox["xfocal", "N"]}], ")"}], ")"}]}], "+", 
         RowBox[{"c", " ", 
          RowBox[{"(", 
           RowBox[{
            FractionBox[
             RowBox[{"xothers", 
              RowBox[{"(", 
               RowBox[{"N", "-", "1"}], ")"}]}], "N"], "+", 
            FractionBox["xfocal", "N"]}], ")"}], 
          RowBox[{"(", 
           RowBox[{"1", "-", "g"}], ")"}]}], "+", 
         RowBox[{"s", 
          RowBox[{"(", 
           RowBox[{"1", "-", 
            FractionBox[
             RowBox[{"xothers", 
              RowBox[{"(", 
               RowBox[{"N", "-", "1"}], ")"}]}], "N"], "-", 
            FractionBox["xfocal", "N"]}], ")"}]}]}], ")"}]}]}], ")"}]}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.908103877779798*^9, 3.9081039368551617`*^9}, {
   3.9082687020329027`*^9, 3.908268859066394*^9}, {3.908269883914235*^9, 
   3.908269920730289*^9}, {3.908355862871335*^9, 3.908355902589114*^9}, {
   3.9108604899938927`*^9, 3.910860560580213*^9}, {3.9113770175862293`*^9, 
   3.911377066649146*^9}, {3.911391018117175*^9, 3.911391056891016*^9}, 
   3.915175265985262*^9, {3.915177560180121*^9, 3.9151775756131973`*^9}, {
   3.915178200264545*^9, 3.915178239018537*^9}, {3.9169047130418262`*^9, 
   3.9169047172647753`*^9}, {3.916904798095763*^9, 3.916904806290079*^9}, {
   3.91690484880543*^9, 3.91690485477936*^9}, {3.916911375110134*^9, 
   3.916911375111356*^9}, {3.916911412361319*^9, 3.9169114123655043`*^9}, {
   3.916911465602859*^9, 3.916911465607473*^9}},
 CellLabel->
  "In[191]:=",ExpressionUUID->"4104c392-96b6-4c29-ab36-52d0aba19d49"],

Cell["\<\
The derivative of focal individual fitness, with respect to the focal \
individual trait value, evaluated at monomorphic equilibrium, is written \
below (as -cm). Note that the \[OpenCurlyQuote]cm\[CloseCurlyQuote] notation \
is used to represent the \[OpenCurlyQuote]marginal cost\[CloseCurlyQuote] of \
Hamilton\[CloseCurlyQuote]s Rule. This is Equation E4 in the SI.\
\>", "Text",
 CellChangeTimes->{{3.915175733249536*^9, 3.915175737026534*^9}, {
  3.915175857656424*^9, 3.915175883915668*^9}, {3.915202602421441*^9, 
  3.915202602808991*^9}},ExpressionUUID->"a952d5f5-de64-4dce-92fd-\
00031a61f240"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"cm", "=", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{"D", "[", 
       RowBox[{"w", ",", "xfocal"}], "]"}]}], "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"xpop", "->", 
        SuperscriptBox["x", "*"]}], ",", 
       RowBox[{"xothers", "->", 
        SuperscriptBox["x", "*"]}], ",", 
       RowBox[{"xfocal", "->", 
        SuperscriptBox["x", "*"]}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"TraditionalForm", "[", 
  RowBox[{"-", "cm"}], "]"}]}], "Input",
 CellChangeTimes->{{3.915177161684618*^9, 3.9151771773356667`*^9}, {
   3.916911412366617*^9, 3.9169114123678703`*^9}, 3.916911465608355*^9, 
   3.916911553675412*^9, 3.9169227267665663`*^9},
 CellLabel->
  "In[192]:=",ExpressionUUID->"fe76039b-3638-4c90-808f-c65e0a2cc2e9"],

Cell[BoxData[
 FormBox[
  RowBox[{"-", 
   FractionBox[
    RowBox[{
     RowBox[{"(", 
      RowBox[{"N", "-", "1"}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"c", " ", 
        RowBox[{"(", 
         RowBox[{"g", "-", "1"}], ")"}], " ", "N"}], "-", 
       RowBox[{"c", " ", "g"}], "+", "d", "-", "s"}], ")"}]}], 
    RowBox[{"N", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        SuperscriptBox["x", "*"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", 
           RowBox[{"N", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"c", " ", "g"}], "+", "s"}], ")"}]}]}], "+", 
          RowBox[{"c", " ", 
           RowBox[{"(", 
            RowBox[{"g", "+", "N"}], ")"}]}], "+", 
          RowBox[{"d", " ", 
           RowBox[{"(", 
            RowBox[{"N", "-", "1"}], ")"}]}], "+", "s"}], ")"}]}], "+", "d", 
       "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"N", "-", "1"}], ")"}], " ", "s"}], "-", "N"}], ")"}]}]]}], 
  TraditionalForm]], "Output",
 CellChangeTimes->{{3.9169227113069973`*^9, 3.916922728460099*^9}, 
   3.917008471358342*^9, 3.9170086040876837`*^9, 3.91701000823407*^9},
 CellLabel->
  "Out[193]//TraditionalForm=",ExpressionUUID->"e234d016-ba81-4bbf-85b8-\
5e3d847f19c6"]
}, Open  ]],

Cell["\<\
The derivative of focal individual fitness, with respect to the average trait \
value of other individuals on the deme, evaluated at monomorphic equilibrium, \
is written below. Note that the \[OpenCurlyQuote]bm\[CloseCurlyQuote] \
notation is used to represent the \[OpenCurlyQuote]marginal benefit\
\[CloseCurlyQuote] of Hamilton\[CloseCurlyQuote]s Rule. This is Equation E5 \
in the SI.\
\>", "Text",
 CellChangeTimes->{{3.915175418488715*^9, 3.915175518937564*^9}, 
   3.915175722238924*^9, {3.915175920186359*^9, 3.915175930914809*^9}, {
   3.915202609953712*^9, 
   3.915202610239882*^9}},ExpressionUUID->"4c2c2ffb-e217-490f-8eb3-\
5e5f469f813c"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TraditionalForm", "[", 
  RowBox[{"bm", "=", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{"w", ",", "xothers"}], "]"}], "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"xpop", "->", 
        SuperscriptBox["x", "*"]}], ",", 
       RowBox[{"xothers", "->", 
        SuperscriptBox["x", "*"]}], ",", 
       RowBox[{"xfocal", "->", 
        SuperscriptBox["x", "*"]}]}], "}"}]}], "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.9081039414213743`*^9, 3.9081039435052147`*^9}, {
   3.90810406510456*^9, 3.908104073589612*^9}, {3.9081043026353397`*^9, 
   3.9081043339158287`*^9}, 3.908106925554028*^9, {3.911391003528234*^9, 
   3.9113910075287848`*^9}, {3.9115423725276537`*^9, 3.911542390599454*^9}, {
   3.915175399934017*^9, 3.915175400756152*^9}, 3.915175723845454*^9, {
   3.915177193413665*^9, 3.9151771935552893`*^9}, {3.916911412369804*^9, 
   3.916911412370419*^9}, {3.916911465609292*^9, 3.916911465609918*^9}, 
   3.916911553676111*^9, 3.9169227397657337`*^9},
 CellLabel->
  "In[194]:=",ExpressionUUID->"90659cd5-c69b-42dc-8612-66b47068ad11"],

Cell[BoxData[
 FormBox[
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{"N", "-", "1"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"c", " ", 
       RowBox[{"(", 
        RowBox[{"g", "-", "1"}], ")"}], " ", "N"}], "-", 
      RowBox[{"c", " ", "g"}], "+", "d", "-", "s"}], ")"}]}], 
   RowBox[{"N", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SuperscriptBox["x", "*"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", 
          RowBox[{"N", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"c", " ", "g"}], "+", "s"}], ")"}]}]}], "+", 
         RowBox[{"c", " ", 
          RowBox[{"(", 
           RowBox[{"g", "+", "N"}], ")"}]}], "+", 
         RowBox[{"d", " ", 
          RowBox[{"(", 
           RowBox[{"N", "-", "1"}], ")"}]}], "+", "s"}], ")"}]}], "+", "d", 
      "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"N", "-", "1"}], ")"}], " ", "s"}], "-", "N"}], ")"}]}]], 
  TraditionalForm]], "Output",
 CellChangeTimes->{3.9169227409244127`*^9, 3.917008473207049*^9, 
  3.917008608447404*^9, 3.917010009620878*^9},
 CellLabel->
  "Out[194]//TraditionalForm=",ExpressionUUID->"93026e50-c110-484e-9ef4-\
baa984c17757"]
}, Open  ]],

Cell["\<\
The overall marginal change in neighbour-modulated fitness associated with a \
slight change in behaviour is written below, on the (false) assumption that \
relatedness is a constant (open model). The \[OpenCurlyQuote]margopen\
\[CloseCurlyQuote] notation is used to represent the marginal fitness change, \
and the open model setting. This is Equation F1 in the SI.\
\>", "Text",
 CellChangeTimes->{{3.915175958153467*^9, 3.915176040877063*^9}, {
  3.915177227882449*^9, 3.9151773535121117`*^9}, {3.915202648822825*^9, 
  3.9152026494999847`*^9}},ExpressionUUID->"cddfbd31-7bed-42b9-bcc7-\
cd4999122f0a"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TraditionalForm", "[", 
  RowBox[{"margopen", "=", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{
     RowBox[{
      SuperscriptBox["r", "*"], " ", "bm"}], " ", "-", " ", "cm"}], "]"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.9081044477104807`*^9, 3.908104459241107*^9}, {
   3.908104492639288*^9, 3.9081044941536303`*^9}, {3.9081051452016487`*^9, 
   3.90810514887316*^9}, {3.9151758222548037`*^9, 3.9151758368976316`*^9}, {
   3.915177197160902*^9, 3.9151772227977467`*^9}, 3.915177266100378*^9, {
   3.917008480333598*^9, 3.917008481382784*^9}},
 CellLabel->
  "In[110]:=",ExpressionUUID->"0af63682-ff07-472f-86b3-c74d732ea5ea"],

Cell[BoxData[
 FormBox[
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{"N", "-", "1"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["r", "*"], "-", "1"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"c", " ", 
       RowBox[{"(", 
        RowBox[{"g", "-", "1"}], ")"}], " ", "N"}], "-", 
      RowBox[{"c", " ", "g"}], "+", "d", "-", "s"}], ")"}]}], 
   RowBox[{"N", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SuperscriptBox["x", "*"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", 
          RowBox[{"N", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"c", " ", "g"}], "+", "s"}], ")"}]}]}], "+", 
         RowBox[{"c", " ", 
          RowBox[{"(", 
           RowBox[{"g", "+", "N"}], ")"}]}], "+", 
         RowBox[{"d", " ", 
          RowBox[{"(", 
           RowBox[{"N", "-", "1"}], ")"}]}], "+", "s"}], ")"}]}], "+", "d", 
      "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"N", "-", "1"}], ")"}], " ", "s"}], "-", "N"}], ")"}]}]], 
  TraditionalForm]], "Output",
 CellChangeTimes->{3.916922749128614*^9, 3.917008482645234*^9, 
  3.917008610279105*^9},
 CellLabel->
  "Out[110]//TraditionalForm=",ExpressionUUID->"67982d37-1cd5-4429-a9b9-\
c50ef1fd809d"]
}, Open  ]],

Cell["\<\
We ask when a slight increase in the behaviour is favoured. To do so, we \
first set the selection differential to zero, to obtain s\[Rule]c (g-1) N-c \
g+d. The behaviour is favoured when the right-hand side is greater than the \
left-hand side. This is Equation E7 (rearranged) in the SI. \
\>", "Text",
 CellChangeTimes->{{3.915176101958577*^9, 3.915176179387744*^9}, {
  3.915176229291583*^9, 3.915176243005365*^9}, {3.915177406063599*^9, 
  3.915177410206997*^9}, {3.915177643831272*^9, 3.915177649866047*^9}, {
  3.915178282165604*^9, 3.915178310651388*^9}, {3.915202988218347*^9, 
  3.915202988304565*^9}, {3.916911375130149*^9, 3.916911375130191*^9}, {
  3.916922842138954*^9, 3.916922861496777*^9}, {3.91692292975881*^9, 
  3.9169229525467663`*^9}, {3.9171688558487463`*^9, 
  3.9171688592811947`*^9}},ExpressionUUID->"30346f09-b0fa-4497-a9f2-\
d5ce3da08d84"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TraditionalForm", "[", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{"Solve", "[", 
    RowBox[{"margopen", "==", "0"}], "]"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.916905090812405*^9, 3.916905124722721*^9}},
 CellLabel->
  "In[111]:=",ExpressionUUID->"92a151a7-dca6-4277-b18f-2a6a59b34fc0"],

Cell[BoxData[
 FormBox[
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"N", "\[Rule]", "1"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"s", "\[Rule]", 
      RowBox[{
       RowBox[{"c", " ", 
        RowBox[{"(", 
         RowBox[{"g", "-", "1"}], ")"}], " ", "N"}], "-", 
       RowBox[{"c", " ", "g"}], "+", "d"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      SuperscriptBox["r", "*"], "\[Rule]", "1"}], "}"}]}], "}"}], 
  TraditionalForm]], "Output",
 CellChangeTimes->{3.9169227602462397`*^9, 3.9170084860796957`*^9, 
  3.9170086132040043`*^9},
 CellLabel->
  "Out[111]//TraditionalForm=",ExpressionUUID->"71875b7a-85b2-4fce-8edc-\
6183f9e1f4cc"]
}, Open  ]],

Cell[TextData[{
 "We now undertake the \[OpenCurlyQuote]closed model\[CloseCurlyQuote] \
analysis, where relatedness is not considered a constant, but is instead \
expressed in terms of model parameters. Relatedness is given by ",
 Cell[BoxData[
  FormBox[
   RowBox[{"r", "=", 
    FractionBox["1", 
     RowBox[{"1", "-", 
      FractionBox[
       RowBox[{
        RowBox[{"(", 
         RowBox[{"m", "-", "2"}], ")"}], " ", "m", " ", "N"}], 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"m", "-", "1"}], ")"}], "2"]]}]]}], TraditionalForm]],
  CellChangeTimes->{{3.910861979123197*^9, 3.9108619999508753`*^9}, {
    3.91086222963589*^9, 3.9108622426687517`*^9}, 3.910862460959608*^9, 
    3.9108626243521233`*^9, 3.9114609992207623`*^9, 3.911461049933278*^9, 
    3.911461104221305*^9, 3.9114637937132893`*^9, {3.9114638920883408`*^9, 
    3.9114638987610273`*^9}, {3.911464017519855*^9, 3.911464020308721*^9}, 
    3.911472250412627*^9, 3.911554645377158*^9},ExpressionUUID->
  "99c359a9-713a-43e5-a3be-2dc49a0057ec"],
 "(Equation A17). We therefore obtain the overall marginal change in \
neighbour-modulated fitness associated with a slight change in behaviour, on \
the (true) assumption that relatedness emerges from model parameters.  The \
\[OpenCurlyQuote]margclosed\[CloseCurlyQuote] notation is used to represent \
the marginal fitness change, and the closed model setting. This is Equation \
E6 in the SI. "
}], "Text",
 CellChangeTimes->{{3.915176441285725*^9, 3.915176587713168*^9}, {
  3.915177463317815*^9, 3.9151774714126167`*^9}, {3.915202670777313*^9, 
  3.915202671273993*^9}, {3.9152029790009317`*^9, 
  3.915202979718953*^9}},ExpressionUUID->"9841d958-651f-40e3-8193-\
0acb8b57e09b"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TraditionalForm", "[", 
  RowBox[{"margclosed", "=", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       SuperscriptBox["r", "*"], " ", "bm"}], " ", "-", " ", "cm"}], "/.", 
     RowBox[{"{", 
      RowBox[{
       SuperscriptBox["r", "*"], "->", 
       RowBox[{"1", "/", 
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"m", "-", "2"}], ")"}], " ", "m", " ", "N"}], ")"}], 
           "/", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"m", "-", "1"}], ")"}], "^", "2"}]}]}], ")"}]}]}], 
      "}"}]}], "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.91517659618088*^9, 3.915176615645871*^9}, 
   3.915177444830543*^9, {3.915177479766621*^9, 3.915177481869033*^9}, {
   3.917008491079932*^9, 3.917008503492703*^9}},
 CellLabel->
  "In[112]:=",ExpressionUUID->"9f8da327-e8ab-4d0b-9265-46ebb86d51ca"],

Cell[BoxData[
 FormBox[
  RowBox[{"-", 
   FractionBox[
    RowBox[{
     RowBox[{"(", 
      RowBox[{"m", "-", "2"}], ")"}], " ", "m", " ", 
     RowBox[{"(", 
      RowBox[{"N", "-", "1"}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"c", " ", 
        RowBox[{"(", 
         RowBox[{"g", "-", "1"}], ")"}], " ", "N"}], "-", 
       RowBox[{"c", " ", "g"}], "+", "d", "-", "s"}], ")"}]}], 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"m", "-", "2"}], ")"}], " ", "m", " ", 
        RowBox[{"(", 
         RowBox[{"N", "-", "1"}], ")"}]}], "-", "1"}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        SuperscriptBox["x", "*"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", 
           RowBox[{"N", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"c", " ", "g"}], "+", "s"}], ")"}]}]}], "+", 
          RowBox[{"c", " ", 
           RowBox[{"(", 
            RowBox[{"g", "+", "N"}], ")"}]}], "+", 
          RowBox[{"d", " ", 
           RowBox[{"(", 
            RowBox[{"N", "-", "1"}], ")"}]}], "+", "s"}], ")"}]}], "+", "d", 
       "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"N", "-", "1"}], ")"}], " ", "s"}], "-", "N"}], ")"}]}]]}], 
  TraditionalForm]], "Output",
 CellChangeTimes->{
  3.91692278763568*^9, {3.917008494628525*^9, 3.9170085042236443`*^9}, 
   3.9170086151559973`*^9},
 CellLabel->
  "Out[112]//TraditionalForm=",ExpressionUUID->"69cc473f-1c3b-4c55-a837-\
fc02b045383a"]
}, Open  ]],

Cell["\<\
We ask when a slight increase in the behaviour is favoured. To do so, we \
first set the selection differential to zero, to obtain s\[Rule]c (g-1) N-c \
g+d. The behaviour is favoured when the right-hand side is greater than the \
left-hand side. This is Equation E7 (rearranged) in the SI. We see that the \
behaviour is favoured under the same condition in both the open and closed \
versions of the model, and this is essentially because relatedness is \
unimportant for evolutionary outcomes in this lifecycle.\
\>", "Text",
 CellChangeTimes->{{3.9151769454838057`*^9, 3.9151769716502733`*^9}, {
   3.91517770399575*^9, 3.9151777276819963`*^9}, {3.915178376688755*^9, 
   3.915178465945472*^9}, {3.9152029998081284`*^9, 3.915203000349091*^9}, {
   3.916911375143531*^9, 3.916911375143549*^9}, 3.916923075427209*^9, {
   3.917168866824984*^9, 
   3.917168870314743*^9}},ExpressionUUID->"00d7ef1d-e8ae-44e1-8141-\
fd0e3cf02d64"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TraditionalForm", "[", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{"Solve", "[", 
    RowBox[{"margclosed", "==", "0"}], "]"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.916905162374346*^9, 3.916905162993431*^9}},
 CellLabel->
  "In[113]:=",ExpressionUUID->"4a7206e0-0de6-4437-a6b8-70035634ac0c"],

Cell[BoxData[
 FormBox[
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"m", "\[Rule]", "0"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"m", "\[Rule]", "2"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"N", "\[Rule]", "1"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"s", "\[Rule]", 
      RowBox[{
       RowBox[{"c", " ", 
        RowBox[{"(", 
         RowBox[{"g", "-", "1"}], ")"}], " ", "N"}], "-", 
       RowBox[{"c", " ", "g"}], "+", "d"}]}], "}"}]}], "}"}], 
  TraditionalForm]], "Output",
 CellChangeTimes->{3.916922811293124*^9, 3.917008510213292*^9, 
  3.917008617652815*^9},
 CellLabel->
  "Out[113]//TraditionalForm=",ExpressionUUID->"d02061ca-5fbc-4d0e-a470-\
014304158daa"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
Models G & H) Cue-suppression; migration before population regulation\
\>", "Section",
 CellChangeTimes->{{3.915174600364295*^9, 3.91517462569272*^9}, 
   3.91517466765668*^9, {3.915175186685773*^9, 3.915175197207159*^9}, 
   3.915177935400619*^9, {3.915184565003374*^9, 
   3.915184571753236*^9}},ExpressionUUID->"5e6dbf40-4a8f-4fe4-93ed-\
1ed86cbee34d"],

Cell["\<\
Neighbour-modulated fitness for the focal individual (w) is written below. \
\>", "Text",
 CellChangeTimes->{{3.9151752377757063`*^9, 3.915175259620417*^9}, {
   3.915175352890313*^9, 3.9151753593515577`*^9}, 
   3.9152034697990303`*^9},ExpressionUUID->"179394d0-db8a-43a2-8181-\
6dfaa582789e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"w", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "-", "m"}], ")"}], 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{
         RowBox[{"(", 
          FractionBox["1", "N"], ")"}], 
         RowBox[{"(", 
          RowBox[{"d", "+", 
           RowBox[{"c", " ", "xfocal"}]}], ")"}]}], "-", 
        RowBox[{
         RowBox[{"(", 
          FractionBox[
           RowBox[{"N", "-", "1"}], "N"], ")"}], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"d", 
            RowBox[{"(", "xothers", ")"}]}], "+", 
           RowBox[{"c", " ", "xfocal", 
            RowBox[{"(", 
             RowBox[{"1", "-", "g"}], ")"}]}], "+", 
           RowBox[{"s", 
            RowBox[{"(", 
             RowBox[{"1", "-", "xothers"}], ")"}]}]}], ")"}]}]}], ")"}], "/", 
      
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", "m"}], ")"}], 
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{
            RowBox[{"(", 
             FractionBox["1", "N"], ")"}], 
            RowBox[{"(", 
             RowBox[{"d", "+", 
              RowBox[{"c", " ", 
               RowBox[{"(", 
                RowBox[{
                 FractionBox[
                  RowBox[{"xothers", 
                   RowBox[{"(", 
                    RowBox[{"N", "-", "1"}], ")"}]}], "N"], "+", 
                 FractionBox["xfocal", "N"]}], ")"}]}]}], ")"}]}], "-", 
           RowBox[{
            RowBox[{"(", 
             FractionBox[
              RowBox[{"N", "-", "1"}], "N"], ")"}], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"d", 
               RowBox[{"(", 
                RowBox[{"(", 
                 RowBox[{
                  FractionBox[
                   RowBox[{"xothers", 
                    RowBox[{"(", 
                    RowBox[{"N", "-", "1"}], ")"}]}], "N"], "+", 
                  FractionBox["xfocal", "N"]}], ")"}], ")"}]}], "+", 
              RowBox[{"c", " ", 
               RowBox[{"(", 
                RowBox[{
                 FractionBox[
                  RowBox[{"xothers", 
                   RowBox[{"(", 
                    RowBox[{"N", "-", "1"}], ")"}]}], "N"], "+", 
                 FractionBox["xfocal", "N"]}], ")"}], 
               RowBox[{"(", 
                RowBox[{"1", "-", "g"}], ")"}]}], "+", 
              RowBox[{"s", 
               RowBox[{"(", 
                RowBox[{"1", "-", 
                 FractionBox[
                  RowBox[{"xothers", 
                   RowBox[{"(", 
                    RowBox[{"N", "-", "1"}], ")"}]}], "N"], "-", 
                 FractionBox["xfocal", "N"]}], ")"}]}]}], ")"}]}]}], ")"}]}], 
        "+", 
        RowBox[{"m", 
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{
            RowBox[{"(", 
             FractionBox["1", "N"], ")"}], 
            RowBox[{"(", 
             RowBox[{"d", "+", 
              RowBox[{"c", " ", "xpop"}]}], ")"}]}], "-", 
           RowBox[{
            RowBox[{"(", 
             FractionBox[
              RowBox[{"N", "-", "1"}], "N"], ")"}], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"d", 
               RowBox[{"(", "xpop", ")"}]}], "+", 
              RowBox[{"c", " ", "xpop", 
               RowBox[{"(", 
                RowBox[{"1", "-", "g"}], ")"}]}], "+", 
              RowBox[{"s", 
               RowBox[{"(", 
                RowBox[{"1", "-", "xpop"}], ")"}]}]}], ")"}]}]}], ")"}]}]}], 
       ")"}]}]}], "+", 
    RowBox[{"m", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{
         RowBox[{"(", 
          FractionBox["1", "N"], ")"}], 
         RowBox[{"(", 
          RowBox[{"d", "+", 
           RowBox[{"c", " ", "xfocal"}]}], ")"}]}], "-", 
        RowBox[{
         RowBox[{"(", 
          FractionBox[
           RowBox[{"N", "-", "1"}], "N"], ")"}], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"d", 
            RowBox[{"(", "xothers", ")"}]}], "+", 
           RowBox[{"c", " ", "xfocal", 
            RowBox[{"(", 
             RowBox[{"1", "-", "g"}], ")"}]}], "+", 
           RowBox[{"s", 
            RowBox[{"(", 
             RowBox[{"1", "-", "xothers"}], ")"}]}]}], ")"}]}]}], ")"}], "/", 
      
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{
         RowBox[{"(", 
          FractionBox["1", "N"], ")"}], 
         RowBox[{"(", 
          RowBox[{"d", "+", 
           RowBox[{"c", " ", "xpop"}]}], ")"}]}], "-", 
        RowBox[{
         RowBox[{"(", 
          FractionBox[
           RowBox[{"N", "-", "1"}], "N"], ")"}], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"d", 
            RowBox[{"(", "xpop", ")"}]}], "+", 
           RowBox[{"c", " ", "xpop", 
            RowBox[{"(", 
             RowBox[{"1", "-", "g"}], ")"}]}], "+", 
           RowBox[{"s", 
            RowBox[{"(", 
             RowBox[{"1", "-", "xpop"}], ")"}]}]}], ")"}]}]}], ")"}]}]}]}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.908103877779798*^9, 3.9081039368551617`*^9}, {
   3.9082687020329027`*^9, 3.908268859066394*^9}, {3.908269883914235*^9, 
   3.908269920730289*^9}, {3.908355862871335*^9, 3.908355902589114*^9}, {
   3.9108604899938927`*^9, 3.910860560580213*^9}, {3.9113770175862293`*^9, 
   3.911377066649146*^9}, {3.911391018117175*^9, 3.911391056891016*^9}, 
   3.915175265985262*^9, {3.91517795501114*^9, 3.915177969866983*^9}, {
   3.9169113751561823`*^9, 3.9169113751619864`*^9}, {3.9169114123777323`*^9, 
   3.916911412384989*^9}, {3.916911465611814*^9, 3.9169114656166077`*^9}, {
   3.916911553677781*^9, 3.9169115536843767`*^9}, 3.9170112771632643`*^9, {
   3.917011312366989*^9, 3.917011378897896*^9}},
 CellLabel->
  "In[320]:=",ExpressionUUID->"c9b86c00-c65a-4e56-9b5f-c789e091a106"],

Cell["\<\
The derivative of focal individual fitness, with respect to the focal \
individual trait value, evaluated at monomorphic equilibrium, is written \
below (as -cm). Note that the \[OpenCurlyQuote]cm\[CloseCurlyQuote] notation \
is used to represent the \[OpenCurlyQuote]marginal cost\[CloseCurlyQuote] of \
Hamilton\[CloseCurlyQuote]s Rule. This is Equation G1 in the SI.\
\>", "Text",
 CellChangeTimes->{{3.915175733249536*^9, 3.915175737026534*^9}, {
  3.915175857656424*^9, 3.915175883915668*^9}, {3.915203490603609*^9, 
  3.915203495714188*^9}},ExpressionUUID->"725accf9-794f-475c-b7b9-\
29ca28733c18"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"cm", "=", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{"D", "[", 
       RowBox[{"w", ",", "xfocal"}], "]"}]}], "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"xpop", "->", 
        SuperscriptBox["x", "*"]}], ",", 
       RowBox[{"xothers", "->", 
        SuperscriptBox["x", "*"]}], ",", 
       RowBox[{"xfocal", "->", 
        SuperscriptBox["x", "*"]}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"TraditionalForm", "[", 
  RowBox[{"-", "cm"}], "]"}]}], "Input",
 CellChangeTimes->{{3.915177161684618*^9, 3.9151771773356667`*^9}, {
   3.9169114123860893`*^9, 3.916911412387311*^9}, 3.916911465617879*^9, 
   3.91691155368524*^9, 3.9169231337290573`*^9},
 CellLabel->
  "In[321]:=",ExpressionUUID->"c4be2823-9b43-489e-80e0-b90c9ed5ef61"],

Cell[BoxData[
 FormBox[
  RowBox[{"-", 
   FractionBox[
    RowBox[{
     RowBox[{"-", 
      RowBox[{"c", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"g", "-", "1"}], ")"}], " ", "N"}], "-", "g"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"m", "-", "1"}], ")"}], "2"], "-", "N"}], ")"}]}]}], "+", 
     RowBox[{"d", " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"m", "-", "1"}], ")"}], "2"], " ", 
      RowBox[{"(", 
       RowBox[{"N", "-", "1"}], ")"}]}], "-", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"m", "-", "1"}], ")"}], "2"], " ", 
      RowBox[{"(", 
       RowBox[{"N", "-", "1"}], ")"}], " ", "s"}]}], 
    RowBox[{"N", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        SuperscriptBox["x", "*"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", 
           RowBox[{"N", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"c", " ", "g"}], "+", "s"}], ")"}]}]}], "+", 
          RowBox[{"c", " ", 
           RowBox[{"(", 
            RowBox[{"g", "+", "N"}], ")"}]}], "+", 
          RowBox[{"d", " ", 
           RowBox[{"(", 
            RowBox[{"N", "-", "1"}], ")"}]}], "+", "s"}], ")"}]}], "+", "d", 
       "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"N", "-", "1"}], ")"}], " ", "s"}], "-", "N"}], ")"}]}]]}], 
  TraditionalForm]], "Output",
 CellChangeTimes->{3.9169231372985353`*^9, 3.9170086349037943`*^9, 
  3.917011230529459*^9, 3.9170113867412663`*^9, 3.91716843263445*^9},
 CellLabel->
  "Out[322]//TraditionalForm=",ExpressionUUID->"37802015-4885-4194-91c1-\
28c0653d234c"]
}, Open  ]],

Cell["\<\
The derivative of focal individual fitness, with respect to the average trait \
value of other individuals on the deme, evaluated at monomorphic equilibrium, \
is written below. Note that the \[OpenCurlyQuote]bm\[CloseCurlyQuote] \
notation is used to represent the \[OpenCurlyQuote]marginal benefit\
\[CloseCurlyQuote] of Hamilton\[CloseCurlyQuote]s Rule. This is Equation G2 \
in the SI.\
\>", "Text",
 CellChangeTimes->{{3.915175418488715*^9, 3.915175518937564*^9}, 
   3.915175722238924*^9, {3.915175920186359*^9, 3.915175930914809*^9}, {
   3.915203501107039*^9, 
   3.915203501387886*^9}},ExpressionUUID->"d8f09699-d5da-46db-bba5-\
ad240c940a93"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TraditionalForm", "[", 
  RowBox[{"bm", "=", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{"w", ",", "xothers"}], "]"}], "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"xpop", "->", 
        SuperscriptBox["x", "*"]}], ",", 
       RowBox[{"xothers", "->", 
        SuperscriptBox["x", "*"]}], ",", 
       RowBox[{"xfocal", "->", 
        SuperscriptBox["x", "*"]}]}], "}"}]}], "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.9081039414213743`*^9, 3.9081039435052147`*^9}, {
   3.90810406510456*^9, 3.908104073589612*^9}, {3.9081043026353397`*^9, 
   3.9081043339158287`*^9}, 3.908106925554028*^9, {3.911391003528234*^9, 
   3.9113910075287848`*^9}, {3.9115423725276537`*^9, 3.911542390599454*^9}, {
   3.915175399934017*^9, 3.915175400756152*^9}, 3.915175723845454*^9, {
   3.915177193413665*^9, 3.9151771935552893`*^9}, {3.916911412389732*^9, 
   3.9169114123903093`*^9}, {3.9169114656188583`*^9, 3.916911465619519*^9}, 
   3.916911553685988*^9, 3.9169231466562233`*^9},
 CellLabel->
  "In[323]:=",ExpressionUUID->"adc28761-8fbb-4d25-b2d6-06cc58d79bc4"],

Cell[BoxData[
 FormBox[
  RowBox[{"-", 
   FractionBox[
    RowBox[{
     RowBox[{"(", 
      RowBox[{"N", "-", "1"}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"c", " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"m", "-", "1"}], ")"}], "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"g", "-", "1"}], ")"}], " ", "N"}], "-", "g"}], 
          ")"}]}]}], "+", 
       RowBox[{"d", " ", 
        RowBox[{"(", 
         RowBox[{"m", "-", "2"}], ")"}], " ", "m", " ", "N"}], "-", 
       RowBox[{"d", " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"m", "-", "1"}], ")"}], "2"]}], "-", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"m", "-", "2"}], ")"}], " ", "m", " ", 
        RowBox[{"(", 
         RowBox[{"N", "-", "1"}], ")"}], " ", "s"}], "+", "s"}], ")"}]}], 
    RowBox[{"N", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        SuperscriptBox["x", "*"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", 
           RowBox[{"N", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"c", " ", "g"}], "+", "s"}], ")"}]}]}], "+", 
          RowBox[{"c", " ", 
           RowBox[{"(", 
            RowBox[{"g", "+", "N"}], ")"}]}], "+", 
          RowBox[{"d", " ", 
           RowBox[{"(", 
            RowBox[{"N", "-", "1"}], ")"}]}], "+", "s"}], ")"}]}], "+", "d", 
       "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"N", "-", "1"}], ")"}], " ", "s"}], "-", "N"}], ")"}]}]]}], 
  TraditionalForm]], "Output",
 CellChangeTimes->{3.91692314888769*^9, 3.917008636657955*^9, 
  3.9170114212244043`*^9, 3.917011510453504*^9, 3.917168434523019*^9},
 CellLabel->
  "Out[323]//TraditionalForm=",ExpressionUUID->"4c25de8b-843b-406e-9eca-\
d08eed543b94"]
}, Open  ]],

Cell["\<\
The overall marginal change in neighbour-modulated fitness associated with a \
slight change in behaviour is written below, on the (false) assumption that \
relatedness is a constant (open model). The \[OpenCurlyQuote]margopen\
\[CloseCurlyQuote] notation is used to represent the marginal fitness change, \
and the open model setting. This is Equation H1 in the SI.\
\>", "Text",
 CellChangeTimes->{{3.915175958153467*^9, 3.915176040877063*^9}, {
  3.915177227882449*^9, 3.9151773535121117`*^9}, {3.915203566489521*^9, 
  3.915203566567294*^9}},ExpressionUUID->"4b7fc4aa-a658-49b6-8cca-\
d93440e90155"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TraditionalForm", "[", 
  RowBox[{"margopen", "=", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{
     RowBox[{
      SuperscriptBox["r", "*"], " ", "bm"}], " ", "-", " ", "cm"}], "]"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.9081044477104807`*^9, 3.908104459241107*^9}, {
   3.908104492639288*^9, 3.9081044941536303`*^9}, {3.9081051452016487`*^9, 
   3.90810514887316*^9}, {3.9151758222548037`*^9, 3.9151758368976316`*^9}, {
   3.915177197160902*^9, 3.9151772227977467`*^9}, 3.915177266100378*^9, {
   3.917008629469569*^9, 3.917008629842537*^9}},
 CellLabel->
  "In[325]:=",ExpressionUUID->"0225feb0-71ca-4190-b536-c9cbee7cacb3"],

Cell[BoxData[
 FormBox[
  FractionBox[
   RowBox[{
    RowBox[{"-", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"N", "-", "1"}], ")"}], " ", 
      SuperscriptBox["r", "*"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{"c", " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"m", "-", "1"}], ")"}], "2"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"g", "-", "1"}], ")"}], " ", "N"}], "-", "g"}], 
           ")"}]}]}], "+", 
        RowBox[{"d", " ", 
         RowBox[{"(", 
          RowBox[{"m", "-", "2"}], ")"}], " ", "m", " ", "N"}], "-", 
        RowBox[{"d", " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"m", "-", "1"}], ")"}], "2"]}], "-", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"m", "-", "2"}], ")"}], " ", "m", " ", 
         RowBox[{"(", 
          RowBox[{"N", "-", "1"}], ")"}], " ", "s"}], "+", "s"}], ")"}]}]}], 
    "+", 
    RowBox[{"c", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"g", "-", "1"}], ")"}], " ", "N"}], "-", "g"}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"m", "-", "1"}], ")"}], "2"], "-", "N"}], ")"}]}], "-", 
    RowBox[{"d", " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"m", "-", "1"}], ")"}], "2"], " ", 
     RowBox[{"(", 
      RowBox[{"N", "-", "1"}], ")"}]}], "+", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"m", "-", "1"}], ")"}], "2"], " ", 
     RowBox[{"(", 
      RowBox[{"N", "-", "1"}], ")"}], " ", "s"}]}], 
   RowBox[{"N", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SuperscriptBox["x", "*"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", 
          RowBox[{"N", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"c", " ", "g"}], "+", "s"}], ")"}]}]}], "+", 
         RowBox[{"c", " ", 
          RowBox[{"(", 
           RowBox[{"g", "+", "N"}], ")"}]}], "+", 
         RowBox[{"d", " ", 
          RowBox[{"(", 
           RowBox[{"N", "-", "1"}], ")"}]}], "+", "s"}], ")"}]}], "+", "d", 
      "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"N", "-", "1"}], ")"}], " ", "s"}], "-", "N"}], ")"}]}]], 
  TraditionalForm]], "Output",
 CellChangeTimes->{
  3.9169231562805777`*^9, 3.917008638525384*^9, 3.9170115156825438`*^9, 
   3.917012023186346*^9, {3.917168436441044*^9, 3.9171684429026747`*^9}},
 CellLabel->
  "Out[325]//TraditionalForm=",ExpressionUUID->"5a569d19-da13-4fda-9056-\
95e67b2cd310"]
}, Open  ]],

Cell[TextData[{
 "We ask when a slight increase in the behaviour is favoured, on the \
assumption of full migration (m=1). To do so, we  set the selection \
differential to zero, to obtain ",
 Cell[BoxData[
  FormBox[
   RowBox[{"s", "\[Rule]", 
    RowBox[{
     FractionBox[
      RowBox[{"c", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"g", " ", 
          RowBox[{"(", 
           RowBox[{"-", "N"}], ")"}]}], "+", "g", "+", "N"}], ")"}]}], 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"N", "-", "1"}], ")"}], " ", 
       SuperscriptBox["r", "*"]}]], "+", "d"}]}], TraditionalForm]],
  CellChangeTimes->{
   3.9082689189247103`*^9, {3.9082750095828257`*^9, 3.908275031642332*^9}, {
    3.908275084386447*^9, 3.908275127976161*^9}, 3.908275193877214*^9, {
    3.908275233458981*^9, 3.908275248590908*^9}, 3.908275279347251*^9, 
    3.908275380694973*^9, 3.908275413192636*^9, 3.9083559387106123`*^9, 
    3.910860622126617*^9, 3.911376898573859*^9, 3.911377143928994*^9, 
    3.9114720838680353`*^9, 3.911472229947011*^9, 3.911548109194347*^9, 
    3.911554643668841*^9, 3.915177207879016*^9, 3.9151773650375423`*^9, 
    3.9151775188673983`*^9, 3.915178011045245*^9, 3.915205810872473*^9, 
    3.916923231741188*^9},ExpressionUUID->
  "134605b6-7a94-40e6-aa78-3f7266224f13"],
 ". We can see that the right hand side is always greater than the left hand \
side, meaning the selection differential is always negative, and so the \
behaviour is  disfavoured."
}], "Text",
 CellChangeTimes->{{3.915176101958577*^9, 3.915176179387744*^9}, {
  3.915176229291583*^9, 3.915176243005365*^9}, {3.915177406063599*^9, 
  3.915177410206997*^9}, {3.915178003532593*^9, 3.915178009277268*^9}, {
  3.916923292588077*^9, 3.9169233218889637`*^9}, {3.917168515868033*^9, 
  3.917168541521164*^9}},ExpressionUUID->"f9e653d0-4271-46db-8c5f-\
f52d1960fd8e"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"TraditionalForm", "[", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{"margopen", "/.", 
    RowBox[{"{", 
     RowBox[{"m", "->", "1"}], "}"}]}], "]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"TraditionalForm", "[", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{"Solve", "[", 
    RowBox[{
     RowBox[{"margopen", "==", "0"}], "/.", 
     RowBox[{"{", 
      RowBox[{"m", "->", "1"}], "}"}]}], "]"}], "]"}], "]"}]}], "Input",
 CellChangeTimes->{{3.908108081357972*^9, 3.90810815886198*^9}, 
   3.9082689167181387`*^9, {3.908275020896943*^9, 3.9082750299584627`*^9}, {
   3.908275081536397*^9, 3.9082751262301083`*^9}, {3.9082751906324368`*^9, 
   3.908275193265663*^9}, {3.9082752320393248`*^9, 3.908275277398169*^9}, {
   3.908275311973724*^9, 3.9082753702498417`*^9}, {3.908275404855864*^9, 
   3.908275411310329*^9}, {3.911472199070818*^9, 3.911472202133206*^9}, {
   3.915177205821993*^9, 3.9151772059558477`*^9}, {3.915177361413143*^9, 
   3.915177361646332*^9}, {3.915178001412785*^9, 3.915178001471287*^9}, 
   3.916911375177553*^9, 3.916911412394047*^9, {3.91692322283072*^9, 
   3.916923230027397*^9}, {3.9170121748254347`*^9, 3.917012186634247*^9}},
 CellLabel->
  "In[326]:=",ExpressionUUID->"64b5d706-b0a7-4a82-bf91-c0e42723d69e"],

Cell[BoxData[
 FormBox[
  FractionBox[
   RowBox[{
    RowBox[{"c", " ", 
     RowBox[{"(", 
      RowBox[{"g", "-", "1"}], ")"}], " ", "N"}], "-", 
    RowBox[{"c", " ", "g"}], "-", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"N", "-", "1"}], ")"}], " ", 
     SuperscriptBox["r", "*"], " ", 
     RowBox[{"(", 
      RowBox[{"d", "-", "s"}], ")"}]}]}], 
   RowBox[{
    RowBox[{"-", 
     RowBox[{
      SuperscriptBox["x", "*"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{"N", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"c", " ", "g"}], "+", "s"}], ")"}]}]}], "+", 
        RowBox[{"c", " ", 
         RowBox[{"(", 
          RowBox[{"g", "+", "N"}], ")"}]}], "+", 
        RowBox[{"d", " ", 
         RowBox[{"(", 
          RowBox[{"N", "-", "1"}], ")"}]}], "+", "s"}], ")"}]}]}], "-", "d", 
    "-", 
    RowBox[{"N", " ", "s"}], "+", "N", "+", "s"}]], 
  TraditionalForm]], "Output",
 CellChangeTimes->{
  3.9082689189247103`*^9, {3.9082750095828257`*^9, 3.908275031642332*^9}, {
   3.908275084386447*^9, 3.908275127976161*^9}, 3.908275193877214*^9, {
   3.908275233458981*^9, 3.908275248590908*^9}, 3.908275279347251*^9, 
   3.908275380694973*^9, 3.908275413192636*^9, 3.9083559387106123`*^9, 
   3.910860622126617*^9, 3.911376898573859*^9, 3.911377143928994*^9, 
   3.9114720838680353`*^9, 3.911472229947011*^9, 3.911548109194347*^9, 
   3.911554643668841*^9, 3.915177207879016*^9, 3.9151773650375423`*^9, 
   3.9151775188673983`*^9, 3.915178011045245*^9, 3.915205810872473*^9, 
   3.916923231741188*^9, 3.917008645537665*^9, 3.9170115208188353`*^9, {
   3.917012164226644*^9, 3.917012188930409*^9}, 3.9171684466449738`*^9},
 CellLabel->
  "Out[326]//TraditionalForm=",ExpressionUUID->"d8b03890-cb79-4e63-a00c-\
78ffd7f4d541"],

Cell[BoxData[
 FormBox[
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"s", "\[Rule]", 
      RowBox[{
       FractionBox[
        RowBox[{"c", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"g", " ", 
            RowBox[{"(", 
             RowBox[{"-", "N"}], ")"}]}], "+", "g", "+", "N"}], ")"}]}], 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"N", "-", "1"}], ")"}], " ", 
         SuperscriptBox["r", "*"]}]], "+", "d"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"c", "\[Rule]", "0"}], ",", 
      RowBox[{"N", "\[Rule]", "1"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"c", "\[Rule]", "0"}], ",", 
      RowBox[{
       SuperscriptBox["r", "*"], "\[Rule]", "0"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"g", "\[Rule]", 
       FractionBox["N", 
        RowBox[{"N", "-", "1"}]]}], ",", 
      RowBox[{
       SuperscriptBox["r", "*"], "\[Rule]", "0"}]}], "}"}]}], "}"}], 
  TraditionalForm]], "Output",
 CellChangeTimes->{
  3.9082689189247103`*^9, {3.9082750095828257`*^9, 3.908275031642332*^9}, {
   3.908275084386447*^9, 3.908275127976161*^9}, 3.908275193877214*^9, {
   3.908275233458981*^9, 3.908275248590908*^9}, 3.908275279347251*^9, 
   3.908275380694973*^9, 3.908275413192636*^9, 3.9083559387106123`*^9, 
   3.910860622126617*^9, 3.911376898573859*^9, 3.911377143928994*^9, 
   3.9114720838680353`*^9, 3.911472229947011*^9, 3.911548109194347*^9, 
   3.911554643668841*^9, 3.915177207879016*^9, 3.9151773650375423`*^9, 
   3.9151775188673983`*^9, 3.915178011045245*^9, 3.915205810872473*^9, 
   3.916923231741188*^9, 3.917008645537665*^9, 3.9170115208188353`*^9, {
   3.917012164226644*^9, 3.917012188930409*^9}, 3.917168446687549*^9},
 CellLabel->
  "Out[327]//TraditionalForm=",ExpressionUUID->"3b6b8d4d-63f3-4f66-aedb-\
64411c336881"]
}, Closed]],

Cell["\<\
We ask when a slight increase in the behaviour is favoured, on the assumption \
of zero migration (m=0). To do so, we first set the selection differential to \
zero, to obtain s\[Rule]c (g-1) N-c g+d. The behaviour is favoured when the \
right-hand side is greater than the left-hand side. This is Equation E7 \
(rearranged) in the SI.\
\>", "Text",
 CellChangeTimes->{{3.915176273466278*^9, 3.915176279609105*^9}, {
   3.915176337851461*^9, 3.915176359760262*^9}, {3.915177400639497*^9, 
   3.915177402013357*^9}, {3.915178013962927*^9, 3.915178016675682*^9}, 
   3.9151780655440397`*^9, {3.915178105500216*^9, 3.915178107023058*^9}, {
   3.915203656179706*^9, 3.915203659734796*^9}, {3.9169113751788893`*^9, 
   3.916911375178904*^9}, {3.916923396008024*^9, 3.9169234227394876`*^9}, {
   3.916923519835164*^9, 3.916923539315836*^9}, 
   3.917168564144491*^9},ExpressionUUID->"55c2aa31-f5bf-43bb-bb55-\
1c34a3a80b43"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TraditionalForm", "[", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{"Solve", "[", 
    RowBox[{
     RowBox[{"margopen", "==", "0"}], "/.", 
     RowBox[{"{", 
      RowBox[{"m", "->", "0"}], "}"}]}], "]"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.90827547900133*^9, 3.908275526641282*^9}, {
   3.908275670152458*^9, 3.908275700588422*^9}, {3.9114722372479143`*^9, 
   3.9114722413253193`*^9}, {3.915177386188711*^9, 3.915177386585072*^9}, 
   3.915178039525638*^9, 3.91691137517977*^9, 3.916911412394967*^9, 
   3.916923370284152*^9},
 CellLabel->
  "In[205]:=",ExpressionUUID->"677d8d81-1c11-4a10-8af1-2befe2e38179"],

Cell[BoxData[
 FormBox[
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"N", "\[Rule]", "1"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"s", "\[Rule]", 
      RowBox[{
       RowBox[{"c", " ", 
        RowBox[{"(", 
         RowBox[{"g", "-", "1"}], ")"}], " ", "N"}], "-", 
       RowBox[{"c", " ", "g"}], "+", "d"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      SuperscriptBox["r", "*"], "\[Rule]", "1"}], "}"}]}], "}"}], 
  TraditionalForm]], "Output",
 CellChangeTimes->{3.916923378242713*^9, 3.9170086497896347`*^9, 
  3.9170115231966352`*^9},
 CellLabel->
  "Out[205]//TraditionalForm=",ExpressionUUID->"9916b4d4-0fe1-479a-9f2e-\
e4acc7849823"]
}, Open  ]],

Cell[TextData[{
 "We now undertake the \[OpenCurlyQuote]closed model\[CloseCurlyQuote] \
analysis, where relatedness is not considered a constant, but is instead \
expressed in terms of model parameters. Relatedness is given by ",
 Cell[BoxData[
  FormBox[
   RowBox[{"r", "=", 
    FractionBox["1", 
     RowBox[{"1", "-", 
      FractionBox[
       RowBox[{
        RowBox[{"(", 
         RowBox[{"m", "-", "2"}], ")"}], " ", "m", " ", "N"}], 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"m", "-", "1"}], ")"}], "2"]]}]]}], TraditionalForm]],
  CellChangeTimes->{{3.910861979123197*^9, 3.9108619999508753`*^9}, {
    3.91086222963589*^9, 3.9108622426687517`*^9}, 3.910862460959608*^9, 
    3.9108626243521233`*^9, 3.9114609992207623`*^9, 3.911461049933278*^9, 
    3.911461104221305*^9, 3.9114637937132893`*^9, {3.9114638920883408`*^9, 
    3.9114638987610273`*^9}, {3.911464017519855*^9, 3.911464020308721*^9}, 
    3.911472250412627*^9, 3.911554645377158*^9},ExpressionUUID->
  "8632e220-702c-4b01-b211-af5afc459f78"],
 "(Equation A17). We therefore obtain the overall marginal change in \
neighbour-modulated fitness associated with a slight change in behaviour, on \
the (true) assumption that relatedness emerges from model parameters.  The \
\[OpenCurlyQuote]margclosed\[CloseCurlyQuote] notation is used to represent \
the marginal fitness change, and the closed model setting. This is Equation \
G3 in the SI. "
}], "Text",
 CellChangeTimes->{{3.915176441285725*^9, 3.915176587713168*^9}, {
  3.915177463317815*^9, 3.9151774714126167`*^9}, {3.915203527275138*^9, 
  3.915203542206978*^9}},ExpressionUUID->"896dd8e5-f168-4eb7-ab14-\
135cb5ea234b"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TraditionalForm", "[", 
  RowBox[{"margclosed", "=", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       SuperscriptBox["r", "*"], " ", "bm"}], " ", "-", " ", "cm"}], "/.", 
     RowBox[{"{", 
      RowBox[{
       SuperscriptBox["r", "*"], "->", 
       RowBox[{"1", "/", 
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"m", "-", "2"}], ")"}], " ", "m", " ", "N"}], ")"}], 
           "/", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"m", "-", "1"}], ")"}], "^", "2"}]}]}], ")"}]}]}], 
      "}"}]}], "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.91517659618088*^9, 3.915176615645871*^9}, 
   3.915177444830543*^9, {3.915177479766621*^9, 3.915177481869033*^9}, {
   3.917008654545506*^9, 3.9170086609259872`*^9}},
 CellLabel->
  "In[208]:=",ExpressionUUID->"9cac7589-1abc-41d4-8acb-6f3b95750918"],

Cell[BoxData[
 FormBox[
  RowBox[{"-", 
   FractionBox[
    RowBox[{"c", " ", 
     RowBox[{"(", 
      RowBox[{"m", "-", "2"}], ")"}], " ", "m", " ", "N", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"g", " ", 
        RowBox[{"(", 
         RowBox[{"N", "-", "1"}], ")"}]}], "-", "N"}], ")"}]}], 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"m", "-", "2"}], ")"}], " ", "m", " ", 
        RowBox[{"(", 
         RowBox[{"N", "-", "1"}], ")"}]}], "-", "1"}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        SuperscriptBox["x", "*"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", 
           RowBox[{"N", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"c", " ", "g"}], "+", "s"}], ")"}]}]}], "+", 
          RowBox[{"c", " ", 
           RowBox[{"(", 
            RowBox[{"g", "+", "N"}], ")"}]}], "+", 
          RowBox[{"d", " ", 
           RowBox[{"(", 
            RowBox[{"N", "-", "1"}], ")"}]}], "+", "s"}], ")"}]}], "+", "d", 
       "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"N", "-", "1"}], ")"}], " ", "s"}], "-", "N"}], ")"}]}]]}], 
  TraditionalForm]], "Output",
 CellChangeTimes->{3.916923550619752*^9, 3.9170086617474413`*^9, 
  3.917011525504067*^9, 3.917011968859572*^9},
 CellLabel->
  "Out[208]//TraditionalForm=",ExpressionUUID->"f0aa47be-5fba-4d80-b4bb-\
b323efdc45b7"]
}, Open  ]],

Cell[TextData[{
 "We ask when a slight increase in the behaviour is favoured. To do so, we \
first set the selection differential to zero, to obtain ",
 Cell[BoxData[
  FormBox[
   RowBox[{"N", "\[Rule]", 
    FractionBox["g", 
     RowBox[{"g", "-", "1"}]]}], TraditionalForm]],
  CellChangeTimes->{
   3.910862634126298*^9, 3.910862679713876*^9, 3.911377178731172*^9, {
    3.911472315555702*^9, 3.911472345188623*^9}, 3.911548193938794*^9, 
    3.911548237122397*^9, {3.91154829494869*^9, 3.911548316947212*^9}, 
    3.9115546458318996`*^9, 3.9151769039327383`*^9, 3.915177492573509*^9, 
    3.915177527058111*^9, 3.91520576940941*^9, 3.9169046757511387`*^9, {
    3.91692181322268*^9, 3.916921825090461*^9}},ExpressionUUID->
  "6959b2b1-66be-42a4-8816-cd6bcd5cf5b3"],
 ". The left-hand side is always greater than the right-hand side, meaning \
the behaviour is disfavoured."
}], "Text",
 CellChangeTimes->{{3.9151769454838057`*^9, 3.9151769716502733`*^9}, 
   3.916923578449094*^9},ExpressionUUID->"e1479d8b-1cd7-4569-aa43-\
c1acec44fa44"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TraditionalForm", "[", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{"Solve", "[", 
    RowBox[{"margclosed", "==", "0"}], "]"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.91086262736821*^9, 3.910862678869877*^9}, 
   3.911472300688035*^9, {3.911472332014091*^9, 3.911472344399435*^9}, {
   3.911548186771056*^9, 3.911548189170001*^9}, 3.9115482347234707`*^9, {
   3.9115482852122593`*^9, 3.9115483160155067`*^9}, {3.915176872170781*^9, 
   3.9151769012207336`*^9}, {3.915177491578352*^9, 3.9151774916856956`*^9}, {
   3.9169113751903687`*^9, 3.916911394930376*^9}, 3.916923588551108*^9},
 CellLabel->
  "In[209]:=",ExpressionUUID->"298abba8-bee2-4107-bcf1-5eee032e0b0d"],

Cell[BoxData[
 FormBox[
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"c", "\[Rule]", "0"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"m", "\[Rule]", "0"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"m", "\[Rule]", "2"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"N", "\[Rule]", "0"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"N", "\[Rule]", 
      FractionBox["g", 
       RowBox[{"g", "-", "1"}]]}], "}"}]}], "}"}], TraditionalForm]], "Output",\

 CellChangeTimes->{
  3.910862634126298*^9, 3.910862679713876*^9, 3.911377178731172*^9, {
   3.911472315555702*^9, 3.911472345188623*^9}, 3.911548193938794*^9, 
   3.911548237122397*^9, {3.91154829494869*^9, 3.911548316947212*^9}, 
   3.9115546458318996`*^9, 3.9151769039327383`*^9, 3.915177492573509*^9, 
   3.915177527058111*^9, 3.915178142722644*^9, 3.915205817122501*^9, 
   3.916923589773978*^9, 3.917008663930058*^9, 3.9170115289015303`*^9, 
   3.917011972113017*^9},
 CellLabel->
  "Out[209]//TraditionalForm=",ExpressionUUID->"07a369d1-d046-47d3-a957-\
ba8ecc5f0047"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
Model J) Signalling; migration after population regulation; signal response \
and dishonesty can evolve\
\>", "Section",
 CellChangeTimes->{{3.915174600364295*^9, 3.91517462569272*^9}, 
   3.91517466765668*^9, {3.915175186685773*^9, 3.915175197207159*^9}, {
   3.91517755046989*^9, 3.9151775509280024`*^9}, {3.915184515366377*^9, 
   3.915184552979945*^9}, {3.916923876040818*^9, 3.9169239091422167`*^9}, {
   3.916926135487589*^9, 3.916926139267849*^9}, {3.9171679997466803`*^9, 
   3.917168002383638*^9}},ExpressionUUID->"600d8c9a-9480-4c1c-94b8-\
ccb9d1a53acb"],

Cell["\<\
Neighbour-modulated fitness for the focal individual (w) is written below. \
This is given by Equations J3, J5 & A6 in the SI.\
\>", "Text",
 CellChangeTimes->{{3.9151752377757063`*^9, 3.915175259620417*^9}, {
   3.915175352890313*^9, 3.9151753593515577`*^9}, {3.915201719433642*^9, 
   3.915201720074353*^9}, 3.9169239389872704`*^9, {3.917168940574061*^9, 
   3.9171690118167477`*^9}},ExpressionUUID->"52096bc2-8450-4cc3-ab49-\
055ac6c35be8"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ffocal", " ", "=", " ", 
   RowBox[{"1", "-", 
    RowBox[{"p", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        FractionBox["1", "N"], 
        RowBox[{"(", 
         RowBox[{"d", "+", 
          RowBox[{"c", " ", "xfocal"}]}], ")"}]}], "+", 
       RowBox[{
        FractionBox[
         RowBox[{"N", "-", "1"}], "N"], 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"d", 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"xothers", " ", "yfocal"}]}], ")"}]}], "+", 
          RowBox[{"c", " ", "xfocal", 
           RowBox[{"(", 
            RowBox[{"1", "-", "g"}], ")"}]}], "+", 
          RowBox[{"s", " ", "xothers", " ", "yfocal"}]}], ")"}]}]}], ")"}]}], 
    "-", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "-", "p"}], ")"}], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        FractionBox["1", "N"], 
        RowBox[{"(", 
         RowBox[{"c", " ", "xfocal", " ", "zfocal"}], ")"}]}], "+", 
       RowBox[{
        FractionBox[
         RowBox[{"N", "-", "1"}], "N"], 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"c", " ", "xfocal", " ", "zfocal", 
           RowBox[{"(", 
            RowBox[{"1", "-", "g"}], ")"}]}], "+", 
          RowBox[{"s", " ", "xothers", " ", "yfocal", " ", "zothers"}]}], 
         ")"}]}]}], ")"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"xdeme", "=", 
   RowBox[{
    RowBox[{
     FractionBox["1", "N"], "xfocal"}], "+", 
    RowBox[{
     FractionBox[
      RowBox[{"N", "-", "1"}], "N"], "xothers"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ydeme", "=", 
   RowBox[{
    RowBox[{
     FractionBox["1", "N"], "yfocal"}], "+", 
    RowBox[{
     FractionBox[
      RowBox[{"N", "-", "1"}], "N"], "yothers"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"zdeme", "=", 
   RowBox[{
    RowBox[{
     FractionBox["1", "N"], "zfocal"}], "+", 
    RowBox[{
     FractionBox[
      RowBox[{"N", "-", "1"}], "N"], "zothers"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fdeme", " ", "=", " ", 
   RowBox[{"1", "-", 
    RowBox[{"p", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        FractionBox["1", "N"], 
        RowBox[{"(", 
         RowBox[{"d", "+", 
          RowBox[{"c", " ", "xdeme"}]}], ")"}]}], "+", 
       RowBox[{
        FractionBox[
         RowBox[{"N", "-", "1"}], "N"], 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"d", 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"xdeme", " ", "ydeme"}]}], ")"}]}], "+", 
          RowBox[{"c", " ", "xdeme", 
           RowBox[{"(", 
            RowBox[{"1", "-", "g"}], ")"}]}], "+", 
          RowBox[{"s", " ", "xdeme", " ", "ydeme"}]}], ")"}]}]}], ")"}]}], 
    "-", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "-", "p"}], ")"}], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        FractionBox["1", "N"], 
        RowBox[{"(", 
         RowBox[{"c", " ", "xdeme", " ", "zdeme"}], ")"}]}], "+", 
       RowBox[{
        FractionBox[
         RowBox[{"N", "-", "1"}], "N"], 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"c", " ", "xdeme", " ", "zdeme", 
           RowBox[{"(", 
            RowBox[{"1", "-", "g"}], ")"}]}], "+", 
          RowBox[{"s", " ", "xdeme", " ", "ydeme", " ", "zdeme"}]}], 
         ")"}]}]}], ")"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"w", "=", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{"ffocal", " ", "/", " ", "fdeme"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.908103877779798*^9, 3.9081039368551617`*^9}, {
   3.9082687020329027`*^9, 3.908268859066394*^9}, {3.908269883914235*^9, 
   3.908269920730289*^9}, {3.908355862871335*^9, 3.908355902589114*^9}, {
   3.9108604899938927`*^9, 3.910860560580213*^9}, {3.9113770175862293`*^9, 
   3.911377066649146*^9}, {3.911391018117175*^9, 3.911391056891016*^9}, 
   3.915175265985262*^9, {3.915177560180121*^9, 3.9151775756131973`*^9}, {
   3.916477684098556*^9, 3.9164779154054203`*^9}, {3.916477958436911*^9, 
   3.916477985459425*^9}, {3.916478030965603*^9, 3.916478110056409*^9}, {
   3.916481286064456*^9, 3.9164813699923067`*^9}, {3.91648140307764*^9, 
   3.916481407874761*^9}, {3.916481619186276*^9, 3.916481623322246*^9}, {
   3.916481680406053*^9, 3.916481737519289*^9}, {3.916481914634831*^9, 
   3.916481918918346*^9}, {3.916923969477807*^9, 3.9169239903443813`*^9}, 
   3.9169244507737093`*^9},
 CellLabel->"In[1]:=",ExpressionUUID->"d743a551-f29e-461f-98d6-9dce6216e767"],

Cell["\<\
The derivative of focal individual fitness, with respect to the focal \
individual\[CloseCurlyQuote]s investment in signalling,  evaluated at \
monomorphic equilibrium, is written below as -cmx. This is Equation J22 in \
the SI. The derivative of focal individual fitness, with respect to the focal \
individual\[CloseCurlyQuote]s level of signal-response,  evaluated at \
monomorphic equilibrium, is written below as -cmy. This is Equation J16  in \
the SI. The derivative of focal individual fitness, with respect to the focal \
individual\[CloseCurlyQuote]s level of dishonesty,  evaluated at monomorphic \
equilibrium, is written below as -cmz. This is Equation J9 in the SI. Note \
that the \[OpenCurlyQuote]cm\[CloseCurlyQuote] notation is used to represent \
the \[OpenCurlyQuote]marginal cost\[CloseCurlyQuote] of Hamilton\
\[CloseCurlyQuote]s Rule. \
\>", "Text",
 CellChangeTimes->{{3.915175733249536*^9, 3.915175737026534*^9}, {
  3.915175857656424*^9, 3.915175883915668*^9}, {3.915201785175893*^9, 
  3.915201785787332*^9}, {3.9169243383213587`*^9, 3.916924540689454*^9}, {
  3.917169045808907*^9, 
  3.917169122094307*^9}},ExpressionUUID->"fce3e85e-8fb1-496d-a817-\
8d857d339c45"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"cmx", "=", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{"D", "[", 
       RowBox[{"w", ",", "xfocal"}], "]"}]}], "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"xfocal", "->", 
        SuperscriptBox["x", "*"]}], ",", 
       RowBox[{"xothers", "->", 
        SuperscriptBox["x", "*"]}], ",", 
       RowBox[{"xpop", "->", 
        SuperscriptBox["x", "*"]}], ",", 
       RowBox[{"yfocal", "->", 
        SuperscriptBox["y", "*"]}], ",", 
       RowBox[{"yothers", "->", 
        SuperscriptBox["y", "*"]}], ",", 
       RowBox[{"ypop", "->", 
        SuperscriptBox["y", "*"]}], ",", 
       RowBox[{"zfocal", "->", 
        SuperscriptBox["z", "*"]}], ",", 
       RowBox[{"zothers", "->", 
        SuperscriptBox["z", "*"]}], ",", 
       RowBox[{"zpop", "->", 
        SuperscriptBox["z", "*"]}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"TraditionalForm", "[", 
  RowBox[{"-", "cmx"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cmy", "=", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{"D", "[", 
       RowBox[{"w", ",", "yfocal"}], "]"}]}], "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"xfocal", "->", 
        SuperscriptBox["x", "*"]}], ",", 
       RowBox[{"xothers", "->", 
        SuperscriptBox["x", "*"]}], ",", 
       RowBox[{"xpop", "->", 
        SuperscriptBox["x", "*"]}], ",", 
       RowBox[{"yfocal", "->", 
        SuperscriptBox["y", "*"]}], ",", 
       RowBox[{"yothers", "->", 
        SuperscriptBox["y", "*"]}], ",", 
       RowBox[{"ypop", "->", 
        SuperscriptBox["y", "*"]}], ",", 
       RowBox[{"zfocal", "->", 
        SuperscriptBox["z", "*"]}], ",", 
       RowBox[{"zothers", "->", 
        SuperscriptBox["z", "*"]}], ",", 
       RowBox[{"zpop", "->", 
        SuperscriptBox["z", "*"]}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"TraditionalForm", "[", 
  RowBox[{"-", "cmx"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cmz", "=", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{"D", "[", 
       RowBox[{"w", ",", "zfocal"}], "]"}]}], "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"xfocal", "->", 
        SuperscriptBox["x", "*"]}], ",", 
       RowBox[{"xothers", "->", 
        SuperscriptBox["x", "*"]}], ",", 
       RowBox[{"xpop", "->", 
        SuperscriptBox["x", "*"]}], ",", 
       RowBox[{"yfocal", "->", 
        SuperscriptBox["y", "*"]}], ",", 
       RowBox[{"yothers", "->", 
        SuperscriptBox["y", "*"]}], ",", 
       RowBox[{"ypop", "->", 
        SuperscriptBox["y", "*"]}], ",", 
       RowBox[{"zfocal", "->", 
        SuperscriptBox["z", "*"]}], ",", 
       RowBox[{"zothers", "->", 
        SuperscriptBox["z", "*"]}], ",", 
       RowBox[{"zpop", "->", 
        SuperscriptBox["z", "*"]}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"TraditionalForm", "[", 
  RowBox[{"-", "cmx"}], "]"}]}], "Input",
 CellChangeTimes->{{3.915177161684618*^9, 3.9151771773356667`*^9}, {
   3.916481483253688*^9, 3.916481552430945*^9}, {3.91648160244484*^9, 
   3.9164816118925*^9}, {3.916481759966824*^9, 3.916481788106379*^9}, 
   3.916481934096526*^9, {3.9164822989840403`*^9, 3.9164823223519583`*^9}, {
   3.916482356877144*^9, 3.916482367589439*^9}, {3.916897535989539*^9, 
   3.9168975825045357`*^9}, {3.916897664196308*^9, 3.916897685271616*^9}, {
   3.916924011307473*^9, 3.916924066960389*^9}},
 CellLabel->"In[7]:=",ExpressionUUID->"eb4e5a5e-1e19-473b-85b6-9bb00a5dd6e2"],

Cell[BoxData[
 FormBox[
  RowBox[{"-", 
   FractionBox[
    RowBox[{
     RowBox[{"(", 
      RowBox[{"N", "-", "1"}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"c", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"g", " ", 
           RowBox[{"(", 
            RowBox[{"N", "-", "1"}], ")"}]}], "-", "N"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"p", "-", "1"}], ")"}], " ", 
           SuperscriptBox["z", "*"]}], "-", "p"}], ")"}]}], "+", 
       RowBox[{
        SuperscriptBox["y", "*"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"p", " ", 
           RowBox[{"(", 
            RowBox[{"d", "-", "s"}], ")"}]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"p", "-", "1"}], ")"}], " ", "s", " ", 
           SuperscriptBox["z", "*"]}]}], ")"}]}]}], ")"}]}], 
    RowBox[{"N", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        SuperscriptBox["x", "*"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"N", "-", "1"}], ")"}], " ", 
           SuperscriptBox["y", "*"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"p", " ", 
              RowBox[{"(", 
               RowBox[{"d", "-", "s"}], ")"}]}], "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"p", "-", "1"}], ")"}], " ", "s", " ", 
              SuperscriptBox["z", "*"]}]}], ")"}]}], "-", 
          RowBox[{"c", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"g", "-", "1"}], ")"}], " ", "N"}], "-", "g"}], ")"}], 
           " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"p", "-", "1"}], ")"}], " ", 
              SuperscriptBox["z", "*"]}], "-", "p"}], ")"}]}]}], ")"}]}], "-", 
       RowBox[{"d", " ", "N", " ", "p"}], "+", "N"}], ")"}]}]]}], 
  TraditionalForm]], "Output",
 CellChangeTimes->{{3.915175743038382*^9, 3.915175768128035*^9}, 
   3.915175936434854*^9, 3.915177190897686*^9, 3.915177506724401*^9, 
   3.91517759649308*^9, 3.915185308457467*^9, 3.9151854454804688`*^9, 
   3.9152057318463173`*^9, 3.916481442342709*^9, {3.9164815393717117`*^9, 
   3.916481552674883*^9}, {3.916481586104621*^9, 3.9164816546079397`*^9}, {
   3.9164817755564833`*^9, 3.916481808975319*^9}, {3.9164819310673447`*^9, 
   3.9164819343561277`*^9}, 3.9164821102923717`*^9, 3.916482441344426*^9, 
   3.91681723672745*^9, 3.916897391167815*^9, {3.91689755154731*^9, 
   3.916897582715363*^9}, {3.916897667376539*^9, 3.916897685486547*^9}, 
   3.916924190750946*^9, 3.917008688450069*^9, 3.9170727057502193`*^9, 
   3.9171696231830893`*^9},
 CellLabel->
  "Out[8]//TraditionalForm=",ExpressionUUID->"646e24bb-5936-4654-8fd2-\
4c50464e25b5"],

Cell[BoxData[
 FormBox[
  RowBox[{"-", 
   FractionBox[
    RowBox[{
     RowBox[{"(", 
      RowBox[{"N", "-", "1"}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"c", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"g", " ", 
           RowBox[{"(", 
            RowBox[{"N", "-", "1"}], ")"}]}], "-", "N"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"p", "-", "1"}], ")"}], " ", 
           SuperscriptBox["z", "*"]}], "-", "p"}], ")"}]}], "+", 
       RowBox[{
        SuperscriptBox["y", "*"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"p", " ", 
           RowBox[{"(", 
            RowBox[{"d", "-", "s"}], ")"}]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"p", "-", "1"}], ")"}], " ", "s", " ", 
           SuperscriptBox["z", "*"]}]}], ")"}]}]}], ")"}]}], 
    RowBox[{"N", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        SuperscriptBox["x", "*"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"N", "-", "1"}], ")"}], " ", 
           SuperscriptBox["y", "*"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"p", " ", 
              RowBox[{"(", 
               RowBox[{"d", "-", "s"}], ")"}]}], "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"p", "-", "1"}], ")"}], " ", "s", " ", 
              SuperscriptBox["z", "*"]}]}], ")"}]}], "-", 
          RowBox[{"c", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"g", "-", "1"}], ")"}], " ", "N"}], "-", "g"}], ")"}], 
           " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"p", "-", "1"}], ")"}], " ", 
              SuperscriptBox["z", "*"]}], "-", "p"}], ")"}]}]}], ")"}]}], "-", 
       RowBox[{"d", " ", "N", " ", "p"}], "+", "N"}], ")"}]}]]}], 
  TraditionalForm]], "Output",
 CellChangeTimes->{{3.915175743038382*^9, 3.915175768128035*^9}, 
   3.915175936434854*^9, 3.915177190897686*^9, 3.915177506724401*^9, 
   3.91517759649308*^9, 3.915185308457467*^9, 3.9151854454804688`*^9, 
   3.9152057318463173`*^9, 3.916481442342709*^9, {3.9164815393717117`*^9, 
   3.916481552674883*^9}, {3.916481586104621*^9, 3.9164816546079397`*^9}, {
   3.9164817755564833`*^9, 3.916481808975319*^9}, {3.9164819310673447`*^9, 
   3.9164819343561277`*^9}, 3.9164821102923717`*^9, 3.916482441344426*^9, 
   3.91681723672745*^9, 3.916897391167815*^9, {3.91689755154731*^9, 
   3.916897582715363*^9}, {3.916897667376539*^9, 3.916897685486547*^9}, 
   3.916924190750946*^9, 3.917008688450069*^9, 3.9170727057502193`*^9, 
   3.917169623288026*^9},
 CellLabel->
  "Out[10]//TraditionalForm=",ExpressionUUID->"5d527c82-56bd-448a-a37c-\
87269021a042"],

Cell[BoxData[
 FormBox[
  RowBox[{"-", 
   FractionBox[
    RowBox[{
     RowBox[{"(", 
      RowBox[{"N", "-", "1"}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"c", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"g", " ", 
           RowBox[{"(", 
            RowBox[{"N", "-", "1"}], ")"}]}], "-", "N"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"p", "-", "1"}], ")"}], " ", 
           SuperscriptBox["z", "*"]}], "-", "p"}], ")"}]}], "+", 
       RowBox[{
        SuperscriptBox["y", "*"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"p", " ", 
           RowBox[{"(", 
            RowBox[{"d", "-", "s"}], ")"}]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"p", "-", "1"}], ")"}], " ", "s", " ", 
           SuperscriptBox["z", "*"]}]}], ")"}]}]}], ")"}]}], 
    RowBox[{"N", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        SuperscriptBox["x", "*"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"N", "-", "1"}], ")"}], " ", 
           SuperscriptBox["y", "*"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"p", " ", 
              RowBox[{"(", 
               RowBox[{"d", "-", "s"}], ")"}]}], "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"p", "-", "1"}], ")"}], " ", "s", " ", 
              SuperscriptBox["z", "*"]}]}], ")"}]}], "-", 
          RowBox[{"c", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"g", "-", "1"}], ")"}], " ", "N"}], "-", "g"}], ")"}], 
           " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"p", "-", "1"}], ")"}], " ", 
              SuperscriptBox["z", "*"]}], "-", "p"}], ")"}]}]}], ")"}]}], "-", 
       RowBox[{"d", " ", "N", " ", "p"}], "+", "N"}], ")"}]}]]}], 
  TraditionalForm]], "Output",
 CellChangeTimes->{{3.915175743038382*^9, 3.915175768128035*^9}, 
   3.915175936434854*^9, 3.915177190897686*^9, 3.915177506724401*^9, 
   3.91517759649308*^9, 3.915185308457467*^9, 3.9151854454804688`*^9, 
   3.9152057318463173`*^9, 3.916481442342709*^9, {3.9164815393717117`*^9, 
   3.916481552674883*^9}, {3.916481586104621*^9, 3.9164816546079397`*^9}, {
   3.9164817755564833`*^9, 3.916481808975319*^9}, {3.9164819310673447`*^9, 
   3.9164819343561277`*^9}, 3.9164821102923717`*^9, 3.916482441344426*^9, 
   3.91681723672745*^9, 3.916897391167815*^9, {3.91689755154731*^9, 
   3.916897582715363*^9}, {3.916897667376539*^9, 3.916897685486547*^9}, 
   3.916924190750946*^9, 3.917008688450069*^9, 3.9170727057502193`*^9, 
   3.9171696235953293`*^9},
 CellLabel->
  "Out[12]//TraditionalForm=",ExpressionUUID->"1efdaae0-ec8f-4749-9b98-\
24edd7aa4d29"]
}, Open  ]],

Cell["\<\
The derivative of focal individual fitness, with respect to the average \
signal investment of other individuals on the deme, evaluated at monomorphic \
equilibrium, is written below as bmx. This is Equation J23 in the SI. The \
derivative of focal individual fitness, with respect to the average \
signal-response level of other individuals on the deme, evaluated at \
monomorphic equilibrium, is written below as bmy. This is Equation J17 in the \
SI. The derivative of focal individual fitness, with respect to the average \
signal dishonesty level of other individuals on the deme, evaluated at \
monomorphic equilibrium, is written below as bmz. This is Equation J10 in the \
SI. Note that the \[OpenCurlyQuote]bm\[CloseCurlyQuote] notation is used to \
represent the \[OpenCurlyQuote]marginal benefit\[CloseCurlyQuote] of Hamilton\
\[CloseCurlyQuote]s Rule. \
\>", "Text",
 CellChangeTimes->{{3.915175418488715*^9, 3.915175518937564*^9}, 
   3.915175722238924*^9, {3.915175920186359*^9, 3.915175930914809*^9}, {
   3.915201863902808*^9, 3.9152018640063953`*^9}, {3.916924737050666*^9, 
   3.916924834839422*^9}, {3.917169140804325*^9, 
   3.917169197401903*^9}},ExpressionUUID->"ae18ee5f-537b-42c2-986a-\
fcb68167ff09"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"TraditionalForm", "[", 
  RowBox[{"bmx", "=", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{"w", ",", "xothers"}], "]"}], "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"xfocal", "->", 
        SuperscriptBox["x", "*"]}], ",", 
       RowBox[{"xothers", "->", 
        SuperscriptBox["x", "*"]}], ",", 
       RowBox[{"xpop", "->", 
        SuperscriptBox["x", "*"]}], ",", 
       RowBox[{"yfocal", "->", 
        SuperscriptBox["y", "*"]}], ",", 
       RowBox[{"yothers", "->", 
        SuperscriptBox["y", "*"]}], ",", 
       RowBox[{"ypop", "->", 
        SuperscriptBox["y", "*"]}], ",", 
       RowBox[{"zfocal", "->", 
        SuperscriptBox["z", "*"]}], ",", 
       RowBox[{"zothers", "->", 
        SuperscriptBox["z", "*"]}], ",", 
       RowBox[{"zpop", "->", 
        SuperscriptBox["z", "*"]}]}], "}"}]}], "]"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"TraditionalForm", "[", 
  RowBox[{"bmy", "=", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{"w", ",", "yothers"}], "]"}], "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"xfocal", "->", 
        SuperscriptBox["x", "*"]}], ",", 
       RowBox[{"xothers", "->", 
        SuperscriptBox["x", "*"]}], ",", 
       RowBox[{"xpop", "->", 
        SuperscriptBox["x", "*"]}], ",", 
       RowBox[{"yfocal", "->", 
        SuperscriptBox["y", "*"]}], ",", 
       RowBox[{"yothers", "->", 
        SuperscriptBox["y", "*"]}], ",", 
       RowBox[{"ypop", "->", 
        SuperscriptBox["y", "*"]}], ",", 
       RowBox[{"zfocal", "->", 
        SuperscriptBox["z", "*"]}], ",", 
       RowBox[{"zothers", "->", 
        SuperscriptBox["z", "*"]}], ",", 
       RowBox[{"zpop", "->", 
        SuperscriptBox["z", "*"]}]}], "}"}]}], "]"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"TraditionalForm", "[", 
  RowBox[{"bmz", "=", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{"w", ",", "zothers"}], "]"}], "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"xfocal", "->", 
        SuperscriptBox["x", "*"]}], ",", 
       RowBox[{"xothers", "->", 
        SuperscriptBox["x", "*"]}], ",", 
       RowBox[{"xpop", "->", 
        SuperscriptBox["x", "*"]}], ",", 
       RowBox[{"yfocal", "->", 
        SuperscriptBox["y", "*"]}], ",", 
       RowBox[{"yothers", "->", 
        SuperscriptBox["y", "*"]}], ",", 
       RowBox[{"ypop", "->", 
        SuperscriptBox["y", "*"]}], ",", 
       RowBox[{"zfocal", "->", 
        SuperscriptBox["z", "*"]}], ",", 
       RowBox[{"zothers", "->", 
        SuperscriptBox["z", "*"]}], ",", 
       RowBox[{"zpop", "->", 
        SuperscriptBox["z", "*"]}]}], "}"}]}], "]"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.9081039414213743`*^9, 3.9081039435052147`*^9}, {
   3.90810406510456*^9, 3.908104073589612*^9}, {3.9081043026353397`*^9, 
   3.9081043339158287`*^9}, 3.908106925554028*^9, {3.911391003528234*^9, 
   3.9113910075287848`*^9}, {3.9115423725276537`*^9, 3.911542390599454*^9}, {
   3.915175399934017*^9, 3.915175400756152*^9}, 3.915175723845454*^9, {
   3.915177193413665*^9, 3.9151771935552893`*^9}, {3.9164819598739023`*^9, 
   3.916481970547638*^9}, 3.91648230585422*^9, {3.916482371868814*^9, 
   3.916482381088786*^9}, {3.916924211383026*^9, 3.916924219763884*^9}},
 CellLabel->"In[13]:=",ExpressionUUID->"39673324-5332-4b28-ad78-d5381040ef45"],

Cell[BoxData[
 FormBox[
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{"N", "-", "1"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"c", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"g", " ", 
          RowBox[{"(", 
           RowBox[{"N", "-", "1"}], ")"}]}], "-", "N"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"p", "-", "1"}], ")"}], " ", 
          SuperscriptBox["z", "*"]}], "-", "p"}], ")"}]}], "+", 
      RowBox[{
       SuperscriptBox["y", "*"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"p", " ", 
          RowBox[{"(", 
           RowBox[{"d", "-", "s"}], ")"}]}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"p", "-", "1"}], ")"}], " ", "s", " ", 
          SuperscriptBox["z", "*"]}]}], ")"}]}]}], ")"}]}], 
   RowBox[{"N", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SuperscriptBox["x", "*"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"N", "-", "1"}], ")"}], " ", 
          SuperscriptBox["y", "*"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"p", " ", 
             RowBox[{"(", 
              RowBox[{"d", "-", "s"}], ")"}]}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"p", "-", "1"}], ")"}], " ", "s", " ", 
             SuperscriptBox["z", "*"]}]}], ")"}]}], "-", 
         RowBox[{"c", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"g", "-", "1"}], ")"}], " ", "N"}], "-", "g"}], ")"}], 
          " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"p", "-", "1"}], ")"}], " ", 
             SuperscriptBox["z", "*"]}], "-", "p"}], ")"}]}]}], ")"}]}], "-", 
      
      RowBox[{"d", " ", "N", " ", "p"}], "+", "N"}], ")"}]}]], 
  TraditionalForm]], "Output",
 CellChangeTimes->{{3.908104066438794*^9, 3.908104073995747*^9}, {
   3.908104334637701*^9, 3.908104339447672*^9}, 3.908104424387844*^9, 
   3.90810793331876*^9, 3.908268880209581*^9, 3.9083559231030807`*^9, 
   3.9108605734536858`*^9, 3.911376842118787*^9, 3.911377086620686*^9, 
   3.9113911571237173`*^9, 3.911471811646303*^9, 3.911542455073489*^9, 
   3.9115545156811333`*^9, 3.911555059549644*^9, 3.915175584540079*^9, 
   3.915175770181059*^9, {3.915175934655409*^9, 3.915175941825774*^9}, 
   3.915177194903661*^9, 3.915177508380785*^9, 3.915177613264398*^9, 
   3.9151854491434717`*^9, 3.915205736861938*^9, 3.91648197268186*^9, 
   3.916482112689074*^9, 3.916482454211854*^9, 3.916817238961383*^9, 
   3.916897399110004*^9, 3.916924221003422*^9, 3.917008690775882*^9, 
   3.917072844153636*^9, 3.9171696236729403`*^9},
 CellLabel->
  "Out[13]//TraditionalForm=",ExpressionUUID->"a9d2faf8-51a9-474a-9470-\
6c79f88ff4ed"],

Cell[BoxData[
 FormBox[
  RowBox[{"-", 
   FractionBox[
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"N", "-", "1"}], ")"}], "2"], " ", 
     SuperscriptBox["x", "*"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"p", " ", 
        RowBox[{"(", 
         RowBox[{"d", "-", "s"}], ")"}]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"p", "-", "1"}], ")"}], " ", "s", " ", 
        SuperscriptBox["z", "*"]}]}], ")"}]}], 
    RowBox[{"N", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        SuperscriptBox["x", "*"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"N", "-", "1"}], ")"}], " ", 
           SuperscriptBox["y", "*"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"p", " ", 
              RowBox[{"(", 
               RowBox[{"d", "-", "s"}], ")"}]}], "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"p", "-", "1"}], ")"}], " ", "s", " ", 
              SuperscriptBox["z", "*"]}]}], ")"}]}], "-", 
          RowBox[{"c", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"g", "-", "1"}], ")"}], " ", "N"}], "-", "g"}], ")"}], 
           " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"p", "-", "1"}], ")"}], " ", 
              SuperscriptBox["z", "*"]}], "-", "p"}], ")"}]}]}], ")"}]}], "-", 
       RowBox[{"d", " ", "N", " ", "p"}], "+", "N"}], ")"}]}]]}], 
  TraditionalForm]], "Output",
 CellChangeTimes->{{3.908104066438794*^9, 3.908104073995747*^9}, {
   3.908104334637701*^9, 3.908104339447672*^9}, 3.908104424387844*^9, 
   3.90810793331876*^9, 3.908268880209581*^9, 3.9083559231030807`*^9, 
   3.9108605734536858`*^9, 3.911376842118787*^9, 3.911377086620686*^9, 
   3.9113911571237173`*^9, 3.911471811646303*^9, 3.911542455073489*^9, 
   3.9115545156811333`*^9, 3.911555059549644*^9, 3.915175584540079*^9, 
   3.915175770181059*^9, {3.915175934655409*^9, 3.915175941825774*^9}, 
   3.915177194903661*^9, 3.915177508380785*^9, 3.915177613264398*^9, 
   3.9151854491434717`*^9, 3.915205736861938*^9, 3.91648197268186*^9, 
   3.916482112689074*^9, 3.916482454211854*^9, 3.916817238961383*^9, 
   3.916897399110004*^9, 3.916924221003422*^9, 3.917008690775882*^9, 
   3.917072844153636*^9, 3.917169623688849*^9},
 CellLabel->
  "Out[14]//TraditionalForm=",ExpressionUUID->"3161d497-ae08-40ca-93bf-\
2032ba97a920"],

Cell[BoxData[
 FormBox[
  RowBox[{"-", 
   FractionBox[
    RowBox[{
     RowBox[{"(", 
      RowBox[{"N", "-", "1"}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"p", "-", "1"}], ")"}], " ", 
     SuperscriptBox["x", "*"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"c", " ", 
        RowBox[{"(", 
         RowBox[{"g", "-", "1"}], ")"}], " ", "N"}], "-", 
       RowBox[{"c", " ", "g"}], "+", 
       RowBox[{"s", " ", 
        SuperscriptBox["y", "*"]}]}], ")"}]}], 
    RowBox[{"N", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        SuperscriptBox["x", "*"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"c", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"g", "-", "1"}], ")"}], " ", "N"}], "-", "g"}], ")"}], 
           " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"p", "-", "1"}], ")"}], " ", 
              SuperscriptBox["z", "*"]}], "-", "p"}], ")"}]}], "-", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"N", "-", "1"}], ")"}], " ", 
           SuperscriptBox["y", "*"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"p", " ", 
              RowBox[{"(", 
               RowBox[{"d", "-", "s"}], ")"}]}], "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"p", "-", "1"}], ")"}], " ", "s", " ", 
              SuperscriptBox["z", "*"]}]}], ")"}]}]}], ")"}]}], "+", 
       RowBox[{"N", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"d", " ", "p"}], "-", "1"}], ")"}]}]}], ")"}]}]]}], 
  TraditionalForm]], "Output",
 CellChangeTimes->{{3.908104066438794*^9, 3.908104073995747*^9}, {
   3.908104334637701*^9, 3.908104339447672*^9}, 3.908104424387844*^9, 
   3.90810793331876*^9, 3.908268880209581*^9, 3.9083559231030807`*^9, 
   3.9108605734536858`*^9, 3.911376842118787*^9, 3.911377086620686*^9, 
   3.9113911571237173`*^9, 3.911471811646303*^9, 3.911542455073489*^9, 
   3.9115545156811333`*^9, 3.911555059549644*^9, 3.915175584540079*^9, 
   3.915175770181059*^9, {3.915175934655409*^9, 3.915175941825774*^9}, 
   3.915177194903661*^9, 3.915177508380785*^9, 3.915177613264398*^9, 
   3.9151854491434717`*^9, 3.915205736861938*^9, 3.91648197268186*^9, 
   3.916482112689074*^9, 3.916482454211854*^9, 3.916817238961383*^9, 
   3.916897399110004*^9, 3.916924221003422*^9, 3.917008690775882*^9, 
   3.917072844153636*^9, 3.9171696237044573`*^9},
 CellLabel->
  "Out[15]//TraditionalForm=",ExpressionUUID->"403d3a08-6444-405c-a41f-\
98a3494e38a2"]
}, Open  ]],

Cell["\<\
The overall marginal change in neighbour-modulated fitness associated with a \
slight change in signalling investment is written below as margopenx. The \
overall marginal change in neighbour-modulated fitness associated with a \
slight change in signal-response is written below as margopeny. The overall \
marginal change in neighbour-modulated fitness associated with a slight \
change in signal dishonesty is written below as margopenz. The \
\[OpenCurlyQuote]margopen\[CloseCurlyQuote] notation is used to represent the \
marginal fitness change, and the open model setting. \
\>", "Text",
 CellChangeTimes->{{3.915175958153467*^9, 3.915176040877063*^9}, {
  3.915177227882449*^9, 3.9151773535121117`*^9}, {3.9152019626637087`*^9, 
  3.915201962719282*^9}, {3.916924848430903*^9, 
  3.9169249480354433`*^9}},ExpressionUUID->"b72be7b4-4cfd-417f-ab29-\
81581f670046"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"TraditionalForm", "[", 
  RowBox[{"margopenx", "=", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{
     RowBox[{
      SuperscriptBox["r", "*"], " ", "bmx"}], " ", "-", " ", "cmx"}], "]"}]}],
   "]"}], "\[IndentingNewLine]", 
 RowBox[{"TraditionalForm", "[", 
  RowBox[{"margopeny", "=", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{
     RowBox[{
      SuperscriptBox["r", "*"], " ", "bmy"}], " ", "-", " ", "cmy"}], "]"}]}],
   "]"}], "\[IndentingNewLine]", 
 RowBox[{"TraditionalForm", "[", 
  RowBox[{"margopenz", "=", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{
     RowBox[{
      SuperscriptBox["r", "*"], " ", "bmz"}], " ", "-", " ", "cmz"}], "]"}]}],
   "]"}]}], "Input",
 CellChangeTimes->{{3.9081044477104807`*^9, 3.908104459241107*^9}, {
   3.908104492639288*^9, 3.9081044941536303`*^9}, {3.9081051452016487`*^9, 
   3.90810514887316*^9}, {3.9151758222548037`*^9, 3.9151758368976316`*^9}, {
   3.915177197160902*^9, 3.9151772227977467`*^9}, 3.915177266100378*^9, {
   3.91648233432502*^9, 3.916482342389292*^9}, {3.916482411368557*^9, 
   3.916482421649559*^9}, {3.917008695470492*^9, 3.917008702573369*^9}},
 CellLabel->"In[16]:=",ExpressionUUID->"6f7794fb-7f9c-466e-be51-fe277bb00d5c"],

Cell[BoxData[
 FormBox[
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{"N", "-", "1"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["r", "*"], "-", "1"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"c", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"g", " ", 
          RowBox[{"(", 
           RowBox[{"N", "-", "1"}], ")"}]}], "-", "N"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"p", "-", "1"}], ")"}], " ", 
          SuperscriptBox["z", "*"]}], "-", "p"}], ")"}]}], "+", 
      RowBox[{
       SuperscriptBox["y", "*"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"p", " ", 
          RowBox[{"(", 
           RowBox[{"d", "-", "s"}], ")"}]}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"p", "-", "1"}], ")"}], " ", "s", " ", 
          SuperscriptBox["z", "*"]}]}], ")"}]}]}], ")"}]}], 
   RowBox[{"N", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SuperscriptBox["x", "*"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"N", "-", "1"}], ")"}], " ", 
          SuperscriptBox["y", "*"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"p", " ", 
             RowBox[{"(", 
              RowBox[{"d", "-", "s"}], ")"}]}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"p", "-", "1"}], ")"}], " ", "s", " ", 
             SuperscriptBox["z", "*"]}]}], ")"}]}], "-", 
         RowBox[{"c", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"g", "-", "1"}], ")"}], " ", "N"}], "-", "g"}], ")"}], 
          " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"p", "-", "1"}], ")"}], " ", 
             SuperscriptBox["z", "*"]}], "-", "p"}], ")"}]}]}], ")"}]}], "-", 
      
      RowBox[{"d", " ", "N", " ", "p"}], "+", "N"}], ")"}]}]], 
  TraditionalForm]], "Output",
 CellChangeTimes->{
  3.9081044594986353`*^9, 3.908104494901422*^9, 3.908105149718433*^9, 
   3.9081079426689453`*^9, 3.908268887184318*^9, 3.908355930776684*^9, 
   3.910860606912422*^9, 3.911376884182818*^9, 3.9113771335928373`*^9, 
   3.911471977218416*^9, 3.91154771336239*^9, 3.911554641393799*^9, 
   3.9115551823599377`*^9, {3.9151758295380363`*^9, 3.915175837301425*^9}, 
   3.915175945948777*^9, 3.91517605612919*^9, 3.915177202186002*^9, 
   3.915177356595026*^9, 3.9151775111263103`*^9, 3.915177625624977*^9, 
   3.91518566158922*^9, 3.915186018478601*^9, 3.915205738524659*^9, 
   3.9164819989330893`*^9, 3.9164821167929287`*^9, 3.916482535622197*^9, 
   3.916817241448886*^9, 3.916924226240726*^9, 3.917008704527029*^9, 
   3.917169623881089*^9},
 CellLabel->
  "Out[16]//TraditionalForm=",ExpressionUUID->"79f86600-add3-4bf0-a438-\
de161778c5d0"],

Cell[BoxData[
 FormBox[
  RowBox[{"-", 
   FractionBox[
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"N", "-", "1"}], ")"}], "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["r", "*"], "-", "1"}], ")"}], " ", 
     SuperscriptBox["x", "*"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"p", " ", 
        RowBox[{"(", 
         RowBox[{"d", "-", "s"}], ")"}]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"p", "-", "1"}], ")"}], " ", "s", " ", 
        SuperscriptBox["z", "*"]}]}], ")"}]}], 
    RowBox[{"N", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        SuperscriptBox["x", "*"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"N", "-", "1"}], ")"}], " ", 
           SuperscriptBox["y", "*"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"p", " ", 
              RowBox[{"(", 
               RowBox[{"d", "-", "s"}], ")"}]}], "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"p", "-", "1"}], ")"}], " ", "s", " ", 
              SuperscriptBox["z", "*"]}]}], ")"}]}], "-", 
          RowBox[{"c", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"g", "-", "1"}], ")"}], " ", "N"}], "-", "g"}], ")"}], 
           " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"p", "-", "1"}], ")"}], " ", 
              SuperscriptBox["z", "*"]}], "-", "p"}], ")"}]}]}], ")"}]}], "-", 
       RowBox[{"d", " ", "N", " ", "p"}], "+", "N"}], ")"}]}]]}], 
  TraditionalForm]], "Output",
 CellChangeTimes->{
  3.9081044594986353`*^9, 3.908104494901422*^9, 3.908105149718433*^9, 
   3.9081079426689453`*^9, 3.908268887184318*^9, 3.908355930776684*^9, 
   3.910860606912422*^9, 3.911376884182818*^9, 3.9113771335928373`*^9, 
   3.911471977218416*^9, 3.91154771336239*^9, 3.911554641393799*^9, 
   3.9115551823599377`*^9, {3.9151758295380363`*^9, 3.915175837301425*^9}, 
   3.915175945948777*^9, 3.91517605612919*^9, 3.915177202186002*^9, 
   3.915177356595026*^9, 3.9151775111263103`*^9, 3.915177625624977*^9, 
   3.91518566158922*^9, 3.915186018478601*^9, 3.915205738524659*^9, 
   3.9164819989330893`*^9, 3.9164821167929287`*^9, 3.916482535622197*^9, 
   3.916817241448886*^9, 3.916924226240726*^9, 3.917008704527029*^9, 
   3.9171696239578238`*^9},
 CellLabel->
  "Out[17]//TraditionalForm=",ExpressionUUID->"2198b3ca-b497-49f0-b3ca-\
3a8bca4d935f"],

Cell[BoxData[
 FormBox[
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{"N", "-", "1"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{"p", "-", "1"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{"1", "-", 
      SuperscriptBox["r", "*"]}], ")"}], " ", 
    SuperscriptBox["x", "*"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"c", " ", 
       RowBox[{"(", 
        RowBox[{"g", "-", "1"}], ")"}], " ", "N"}], "-", 
      RowBox[{"c", " ", "g"}], "+", 
      RowBox[{"s", " ", 
       SuperscriptBox["y", "*"]}]}], ")"}]}], 
   RowBox[{"N", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SuperscriptBox["x", "*"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"c", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"g", "-", "1"}], ")"}], " ", "N"}], "-", "g"}], ")"}], 
          " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"p", "-", "1"}], ")"}], " ", 
             SuperscriptBox["z", "*"]}], "-", "p"}], ")"}]}], "-", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"N", "-", "1"}], ")"}], " ", 
          SuperscriptBox["y", "*"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"p", " ", 
             RowBox[{"(", 
              RowBox[{"d", "-", "s"}], ")"}]}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"p", "-", "1"}], ")"}], " ", "s", " ", 
             SuperscriptBox["z", "*"]}]}], ")"}]}]}], ")"}]}], "+", 
      RowBox[{"N", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"d", " ", "p"}], "-", "1"}], ")"}]}]}], ")"}]}]], 
  TraditionalForm]], "Output",
 CellChangeTimes->{
  3.9081044594986353`*^9, 3.908104494901422*^9, 3.908105149718433*^9, 
   3.9081079426689453`*^9, 3.908268887184318*^9, 3.908355930776684*^9, 
   3.910860606912422*^9, 3.911376884182818*^9, 3.9113771335928373`*^9, 
   3.911471977218416*^9, 3.91154771336239*^9, 3.911554641393799*^9, 
   3.9115551823599377`*^9, {3.9151758295380363`*^9, 3.915175837301425*^9}, 
   3.915175945948777*^9, 3.91517605612919*^9, 3.915177202186002*^9, 
   3.915177356595026*^9, 3.9151775111263103`*^9, 3.915177625624977*^9, 
   3.91518566158922*^9, 3.915186018478601*^9, 3.915205738524659*^9, 
   3.9164819989330893`*^9, 3.9164821167929287`*^9, 3.916482535622197*^9, 
   3.916817241448886*^9, 3.916924226240726*^9, 3.917008704527029*^9, 
   3.9171696240437183`*^9},
 CellLabel->
  "Out[18]//TraditionalForm=",ExpressionUUID->"de7ec33f-680e-4c9c-bff8-\
29dcc7bed96e"]
}, Open  ]],

Cell[TextData[{
 "We obtain a condition for signal-dishonesty being at an ESS by setting \
margopenz to equal zero, to obtain ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SuperscriptBox["y", "*"], "\[Rule]", 
    FractionBox[
     RowBox[{"c", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"g", " ", 
         RowBox[{"(", 
          RowBox[{"-", "N"}], ")"}]}], "+", "g", "+", "N"}], ")"}]}], "s"]}], 
   TraditionalForm]],
  CellChangeTimes->{3.9168193414187*^9, 3.9168275118005867`*^9, 
   3.916924240351778*^9},ExpressionUUID->
  "50916b3a-4fa0-4444-b26e-b245609ed4c3"],
 ". Signal-dishonesty is at an ESS (z=z*) when this condition is satisfied. \
This is Equation J13 in the SI. "
}], "Text",
 CellChangeTimes->{{3.916925405730946*^9, 3.9169254139292717`*^9}, {
   3.9169254444444304`*^9, 3.916925444444467*^9}, {3.916925616595517*^9, 
   3.916925670890792*^9}, {3.916926403105534*^9, 3.916926421929783*^9}, {
   3.916926508876215*^9, 3.916926515776126*^9}, 3.916985469976035*^9, {
   3.917169375647493*^9, 3.91716946483741*^9}, 
   3.917169502590571*^9},ExpressionUUID->"1a512985-5fff-4041-a9e5-\
e702c66675a1"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"FullSimplify", "[", 
  RowBox[{"Solve", "[", 
   RowBox[{
    RowBox[{"margopenz", "==", "0"}], ",", 
    SuperscriptBox["y", "*"]}], "]"}], "]"}]], "Input",
 CellChangeTimes->{
  3.916819346510264*^9, {3.916827517292119*^9, 3.9168275197514668`*^9}, {
   3.91698549685701*^9, 3.91698550525738*^9}, {3.9169916289956493`*^9, 
   3.91699163084838*^9}},
 CellLabel->"In[19]:=",ExpressionUUID->"d009c62b-bb35-4c68-8c74-a52f0bfa684f"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    SuperscriptBox["y", "*"], "\[Rule]", 
    FractionBox[
     RowBox[{"c", " ", 
      RowBox[{"(", 
       RowBox[{"g", "+", "N", "-", 
        RowBox[{"g", " ", "N"}]}], ")"}]}], "s"]}], "}"}], "}"}]], "Output",
 CellChangeTimes->{3.9168193469289417`*^9, 3.916827520046818*^9, 
  3.9169242437882566`*^9, 3.9169254315367804`*^9, 3.916985506206353*^9, 
  3.916991631098401*^9, 3.917008711976697*^9, 3.917169624132285*^9},
 CellLabel->"Out[19]=",ExpressionUUID->"89008f56-d965-46f4-965a-d9a5d7c5e00a"]
}, Open  ]],

Cell[TextData[{
 "We obtain a condition for signal-response being at an ESS by setting \
margopeny to equal zero, to obtain ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SuperscriptBox["z", "*"], "\[Rule]", 
    FractionBox[
     RowBox[{"p", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "d"}], "+", "s"}], ")"}]}], 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "p"}], ")"}], " ", "s"}]]}], 
   TraditionalForm]],
  CellChangeTimes->{3.9168193414187*^9, 3.9168275118005867`*^9, 
   3.916924240351778*^9},ExpressionUUID->
  "c400b85a-02fa-4830-a6ae-8d9060bee644"],
 ". Signal-response is at an ESS (y=y*) when this condition is satisfied. \
This is Equation J20 in the SI. "
}], "Text",
 CellChangeTimes->{{3.916925368926862*^9, 3.916925390412713*^9}, {
  3.917169489795814*^9, 3.917169539996696*^9}, {3.917170424492074*^9, 
  3.917170428290436*^9}},ExpressionUUID->"5cbbf18a-a18d-4401-b02e-\
f9ebee2fa215"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"FullSimplify", "[", 
  RowBox[{"Solve", "[", 
   RowBox[{
    RowBox[{"margopeny", "==", "0"}], ",", 
    SuperscriptBox["z", "*"]}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.916819340783867*^9, 3.916819340845152*^9}, {
  3.916827508768277*^9, 3.916827511389678*^9}, {3.9169854843460693`*^9, 
  3.916985488809363*^9}, {3.916991623237121*^9, 3.916991625352806*^9}},
 CellLabel->"In[20]:=",ExpressionUUID->"ecb3cc8e-1fe9-4b11-b343-64bab0747cda"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    SuperscriptBox["z", "*"], "\[Rule]", 
    FractionBox[
     RowBox[{"p", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "d"}], "+", "s"}], ")"}]}], 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "p"}], ")"}], " ", "s"}]]}], "}"}], 
  "}"}]], "Output",
 CellChangeTimes->{3.9168193414187*^9, 3.9168275118005867`*^9, 
  3.916924240351778*^9, 3.916985489760758*^9, 3.916991625582993*^9, 
  3.917008710583263*^9, 3.917169624202911*^9},
 CellLabel->"Out[20]=",ExpressionUUID->"5cf877e0-4dd1-4ea3-a9f0-40c74da97446"]
}, Open  ]],

Cell[TextData[{
 "We ask when a slight increase in signalling is favoured. To do so, we first \
set the margopenx to zero, to obtain ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SuperscriptBox["y", "*"], "\[Rule]", 
    RowBox[{"-", 
     FractionBox[
      RowBox[{"c", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"g", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "N"}], ")"}]}], "-", "N"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "p"}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "p"}], ")"}], " ", 
          SuperscriptBox["z", "*"]}]}], ")"}]}], 
      RowBox[{
       RowBox[{"p", " ", 
        RowBox[{"(", 
         RowBox[{"d", "-", "s"}], ")"}]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "p"}], ")"}], " ", "s", " ", 
        SuperscriptBox["z", "*"]}]}]]}]}], TraditionalForm]],
  CellChangeTimes->{
   3.91681932997968*^9, {3.9168193708872013`*^9, 3.916819377676259*^9}, 
    3.9169242352947397`*^9},ExpressionUUID->
  "b1c7465c-e3e0-4050-8779-188508be244f"],
 ". Signalling is favoured when the left-hand side is greater than the \
right-hand side. This is Equation J26 (rearranged) in the SI. We then \
substitute into margopenx our ESS values for ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["y", "*"], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "26a2d164-a01e-4273-9c7d-718e54f9f60d"],
 "and ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["z", "*"], TraditionalForm]],ExpressionUUID->
  "7fc204e5-78a6-45c4-8f9e-72046df947fd"],
 " and obtain ",
 Cell[BoxData[
  FractionBox[
   RowBox[{"c", " ", "d", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"g", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "N"}], ")"}]}], "-", "N"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "N"}], ")"}], " ", "p", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", 
      SuperscriptBox["r", "*"]}], ")"}]}], 
   RowBox[{"N", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"N", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", 
         RowBox[{"d", " ", "p"}]}], ")"}], " ", "s"}], "+", 
      RowBox[{"c", " ", "d", " ", 
       RowBox[{"(", 
        RowBox[{"g", "+", "N", "-", 
         RowBox[{"g", " ", "N"}]}], ")"}], " ", "p", " ", 
       SuperscriptBox["x", "*"]}]}], ")"}]}]]],
  CellChangeTimes->{
   3.916995038374185*^9, 3.91699513183324*^9, {3.916995166521688*^9, 
    3.9169951901365023`*^9}, 3.916995241138644*^9, {3.916995275123004*^9, 
    3.9169952871546173`*^9}, 3.917008717942792*^9},ExpressionUUID->
  "525d86e3-2eda-43e6-b188-322bdca269be"],
 ", which we can see by inspection is always negative. This means that \
signalling is disfavoured at equilibrium, leading to x*=0."
}], "Text",
 CellChangeTimes->{{3.915176101958577*^9, 3.915176179387744*^9}, {
  3.915176229291583*^9, 3.915176243005365*^9}, {3.915177406063599*^9, 
  3.915177410206997*^9}, {3.915177643831272*^9, 3.915177649866047*^9}, {
  3.916925020263899*^9, 3.91692502865641*^9}, {3.91692516531522*^9, 
  3.916925175033794*^9}, {3.9169252289730663`*^9, 3.916925243873952*^9}, {
  3.916925313939077*^9, 3.916925356059578*^9}, {3.917169315385355*^9, 
  3.917169324958881*^9}, {3.9171695715163097`*^9, 3.917169574485723*^9}, {
  3.917169650175866*^9, 
  3.917169837557352*^9}},ExpressionUUID->"53748a7d-4843-43f4-bcd1-\
a786586ca1bf"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"FullSimplify", "[", 
  RowBox[{"Solve", "[", 
   RowBox[{
    RowBox[{"margopenx", "==", "0"}], ",", 
    SuperscriptBox["y", "*"]}], "]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"FullSimplify", "[", 
  RowBox[{"margopenx", "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      SuperscriptBox["y", "*"], "\[Rule]", 
      FractionBox[
       RowBox[{"c", " ", 
        RowBox[{"(", 
         RowBox[{"g", "+", "N", "-", 
          RowBox[{"g", " ", "N"}]}], ")"}]}], "s"]}], ",", 
     RowBox[{
      SuperscriptBox["z", "*"], "\[Rule]", 
      FractionBox[
       RowBox[{"p", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "d"}], "+", "s"}], ")"}]}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "p"}], ")"}], " ", "s"}]]}]}], "}"}]}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.9168192463935623`*^9, 3.916819258916613*^9}, {
  3.916819365377577*^9, 3.916819377273843*^9}, {3.916985544152729*^9, 
  3.916985562760304*^9}, {3.91699161642218*^9, 3.916991618562194*^9}, {
  3.917169599741001*^9, 3.9171696014622173`*^9}, {3.917169634646111*^9, 
  3.9171696384704*^9}, {3.91716984423207*^9, 3.9171698444705477`*^9}},
 CellLabel->"In[23]:=",ExpressionUUID->"f5948c10-ce5e-4680-9bd2-81685c03947d"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    SuperscriptBox["y", "*"], "\[Rule]", 
    RowBox[{"-", 
     FractionBox[
      RowBox[{"c", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"g", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "N"}], ")"}]}], "-", "N"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "p"}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "p"}], ")"}], " ", 
          SuperscriptBox["z", "*"]}]}], ")"}]}], 
      RowBox[{
       RowBox[{"p", " ", 
        RowBox[{"(", 
         RowBox[{"d", "-", "s"}], ")"}]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "p"}], ")"}], " ", "s", " ", 
        SuperscriptBox["z", "*"]}]}]]}]}], "}"}], "}"}]], "Output",
 CellChangeTimes->{
  3.91681932997968*^9, {3.9168193708872013`*^9, 3.916819377676259*^9}, 
   3.9169242352947397`*^9, 3.9169855635265627`*^9, 3.916991618814695*^9, 
   3.917008708959016*^9, {3.9171696291265182`*^9, 3.917169639164115*^9}, 
   3.917169845158881*^9},
 CellLabel->"Out[23]=",ExpressionUUID->"50e20c20-2735-41cc-aae5-7e30b9d3853c"],

Cell[BoxData[
 FractionBox[
  RowBox[{"c", " ", "d", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"g", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "N"}], ")"}]}], "-", "N"}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "+", "N"}], ")"}], " ", "p", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "+", 
     SuperscriptBox["r", "*"]}], ")"}]}], 
  RowBox[{"N", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"N", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        RowBox[{"d", " ", "p"}]}], ")"}], " ", "s"}], "+", 
     RowBox[{"c", " ", "d", " ", 
      RowBox[{"(", 
       RowBox[{"g", "+", "N", "-", 
        RowBox[{"g", " ", "N"}]}], ")"}], " ", "p", " ", 
      SuperscriptBox["x", "*"]}]}], ")"}]}]]], "Output",
 CellChangeTimes->{
  3.91681932997968*^9, {3.9168193708872013`*^9, 3.916819377676259*^9}, 
   3.9169242352947397`*^9, 3.9169855635265627`*^9, 3.916991618814695*^9, 
   3.917008708959016*^9, {3.9171696291265182`*^9, 3.917169639164115*^9}, 
   3.9171698452031603`*^9},
 CellLabel->"Out[24]=",ExpressionUUID->"da8cd3e6-23b0-44e2-9992-e36407a2862f"]
}, Open  ]],

Cell["\<\
Note that the closed model analysis is the same as this open one, since \
relatedness (r*) drops out of all of the equations obtained by setting the \
selection differentials (margopenx, margopeny, margopenz) to zero.\
\>", "Text",
 CellChangeTimes->{{3.915176441285725*^9, 3.915176587713168*^9}, {
  3.915177463317815*^9, 3.9151774714126167`*^9}, {3.915201893168091*^9, 
  3.915201894284738*^9}, {3.915202007544639*^9, 3.9152020082622538`*^9}, {
  3.916995439095326*^9, 3.91699545870647*^9}, {3.9171698773127813`*^9, 
  3.917169945385906*^9}},ExpressionUUID->"92d4765b-5a60-47c4-bae9-\
bdd20646c8da"]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
Model K) Signalling; migration before population regulation; signal response \
and dishonesty can evolve\
\>", "Section",
 CellChangeTimes->{{3.915174600364295*^9, 3.91517462569272*^9}, 
   3.91517466765668*^9, {3.915175186685773*^9, 3.915175197207159*^9}, {
   3.91517755046989*^9, 3.9151775509280024`*^9}, {3.915184515366377*^9, 
   3.915184552979945*^9}, {3.916923876040818*^9, 3.9169239091422167`*^9}, {
   3.916926135487589*^9, 3.916926139267849*^9}, {3.916995714185733*^9, 
   3.9169957194255953`*^9}, {3.917168006341456*^9, 
   3.917168009935837*^9}},ExpressionUUID->"b6ebd33b-1ca5-453f-bd09-\
41f0e66e202f"],

Cell["\<\
Neighbour-modulated fitness for the focal individual (w) is written below. \
This is given by Equations J3, J5, J6 & C1 in the SI.\
\>", "Text",
 CellChangeTimes->{{3.9151752377757063`*^9, 3.915175259620417*^9}, {
   3.915175352890313*^9, 3.9151753593515577`*^9}, {3.915201719433642*^9, 
   3.915201720074353*^9}, 3.9169239389872704`*^9, {3.916995799978519*^9, 
   3.916995804315872*^9}, {3.9171689176628027`*^9, 3.91716893310305*^9}, {
   3.9171700012256327`*^9, 
   3.917170030696865*^9}},ExpressionUUID->"41eb204a-abc1-4ef2-8090-\
823f031e2b81"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ffocal", " ", "=", " ", 
   RowBox[{"1", "-", 
    RowBox[{"p", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        FractionBox["1", "N"], 
        RowBox[{"(", 
         RowBox[{"d", "+", 
          RowBox[{"c", " ", "xfocal"}]}], ")"}]}], "+", 
       RowBox[{
        FractionBox[
         RowBox[{"N", "-", "1"}], "N"], 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"d", 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"xothers", " ", "yfocal"}]}], ")"}]}], "+", 
          RowBox[{"c", " ", "xfocal", 
           RowBox[{"(", 
            RowBox[{"1", "-", "g"}], ")"}]}], "+", 
          RowBox[{"s", " ", "xothers", " ", "yfocal"}]}], ")"}]}]}], ")"}]}], 
    "-", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "-", "p"}], ")"}], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        FractionBox["1", "N"], 
        RowBox[{"(", 
         RowBox[{"c", " ", "xfocal", " ", "zfocal"}], ")"}]}], "+", 
       RowBox[{
        FractionBox[
         RowBox[{"N", "-", "1"}], "N"], 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"c", " ", "xfocal", " ", "zfocal", 
           RowBox[{"(", 
            RowBox[{"1", "-", "g"}], ")"}]}], "+", 
          RowBox[{"s", " ", "xothers", " ", "yfocal", " ", "zothers"}]}], 
         ")"}]}]}], ")"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"xdeme", "=", 
   RowBox[{
    RowBox[{
     FractionBox["1", "N"], "xfocal"}], "+", 
    RowBox[{
     FractionBox[
      RowBox[{"N", "-", "1"}], "N"], "xothers"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ydeme", "=", 
   RowBox[{
    RowBox[{
     FractionBox["1", "N"], "yfocal"}], "+", 
    RowBox[{
     FractionBox[
      RowBox[{"N", "-", "1"}], "N"], "yothers"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"zdeme", "=", 
   RowBox[{
    RowBox[{
     FractionBox["1", "N"], "zfocal"}], "+", 
    RowBox[{
     FractionBox[
      RowBox[{"N", "-", "1"}], "N"], "zothers"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fdeme", " ", "=", " ", 
   RowBox[{"1", "-", 
    RowBox[{"p", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        FractionBox["1", "N"], 
        RowBox[{"(", 
         RowBox[{"d", "+", 
          RowBox[{"c", " ", "xdeme"}]}], ")"}]}], "+", 
       RowBox[{
        FractionBox[
         RowBox[{"N", "-", "1"}], "N"], 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"d", 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"xdeme", " ", "ydeme"}]}], ")"}]}], "+", 
          RowBox[{"c", " ", "xdeme", 
           RowBox[{"(", 
            RowBox[{"1", "-", "g"}], ")"}]}], "+", 
          RowBox[{"s", " ", "xdeme", " ", "ydeme"}]}], ")"}]}]}], ")"}]}], 
    "-", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "-", "p"}], ")"}], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        FractionBox["1", "N"], 
        RowBox[{"(", 
         RowBox[{"c", " ", "xdeme", " ", "zdeme"}], ")"}]}], "+", 
       RowBox[{
        FractionBox[
         RowBox[{"N", "-", "1"}], "N"], 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"c", " ", "xdeme", " ", "zdeme", 
           RowBox[{"(", 
            RowBox[{"1", "-", "g"}], ")"}]}], "+", 
          RowBox[{"s", " ", "xdeme", " ", "ydeme", " ", "zdeme"}]}], 
         ")"}]}]}], ")"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fpop", " ", "=", " ", 
   RowBox[{"1", "-", 
    RowBox[{"p", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        FractionBox["1", "N"], 
        RowBox[{"(", 
         RowBox[{"d", "+", 
          RowBox[{"c", " ", "xpop"}]}], ")"}]}], "+", 
       RowBox[{
        FractionBox[
         RowBox[{"N", "-", "1"}], "N"], 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"d", 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"xpop", " ", "ypop"}]}], ")"}]}], "+", 
          RowBox[{"c", " ", "xpop", 
           RowBox[{"(", 
            RowBox[{"1", "-", "g"}], ")"}]}], "+", 
          RowBox[{"s", " ", "xpop", " ", "ypop"}]}], ")"}]}]}], ")"}]}], "-", 
    
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "-", "p"}], ")"}], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        FractionBox["1", "N"], 
        RowBox[{"(", 
         RowBox[{"c", " ", "xpop", " ", "zpop"}], ")"}]}], "+", 
       RowBox[{
        FractionBox[
         RowBox[{"N", "-", "1"}], "N"], 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"c", " ", "xpop", " ", "zpop", 
           RowBox[{"(", 
            RowBox[{"1", "-", "g"}], ")"}]}], "+", 
          RowBox[{"s", " ", "xpop", " ", "ypop", " ", "zpop"}]}], ")"}]}]}], 
      ")"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"w", "=", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", "m"}], ")"}], 
      FractionBox["ffocal", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", "m"}], ")"}], "fdeme"}], "+", 
        RowBox[{"m", " ", "fpop"}]}]]}], "+", 
     RowBox[{"m", " ", 
      FractionBox["ffocal", "fpop"]}]}], " ", "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.908103877779798*^9, 3.9081039368551617`*^9}, {
   3.9082687020329027`*^9, 3.908268859066394*^9}, {3.908269883914235*^9, 
   3.908269920730289*^9}, {3.908355862871335*^9, 3.908355902589114*^9}, {
   3.9108604899938927`*^9, 3.910860560580213*^9}, {3.9113770175862293`*^9, 
   3.911377066649146*^9}, {3.911391018117175*^9, 3.911391056891016*^9}, 
   3.915175265985262*^9, {3.915177560180121*^9, 3.9151775756131973`*^9}, {
   3.916477684098556*^9, 3.9164779154054203`*^9}, {3.916477958436911*^9, 
   3.916477985459425*^9}, {3.916478030965603*^9, 3.916478110056409*^9}, {
   3.916481286064456*^9, 3.9164813699923067`*^9}, {3.91648140307764*^9, 
   3.916481407874761*^9}, {3.916481619186276*^9, 3.916481623322246*^9}, {
   3.916481680406053*^9, 3.916481737519289*^9}, {3.916481914634831*^9, 
   3.916481918918346*^9}, {3.916923969477807*^9, 3.9169239903443813`*^9}, 
   3.9169244507737093`*^9, {3.916995820026519*^9, 3.916995872136689*^9}, {
   3.916995930730976*^9, 3.9169959985089684`*^9}},
 CellLabel->"In[25]:=",ExpressionUUID->"2a4fb119-634d-42e6-ada1-22d7b7884096"],

Cell["\<\
The derivative of focal individual fitness, with respect to the focal \
individual\[CloseCurlyQuote]s investment in signalling,  evaluated at \
monomorphic equilibrium, is written below as -cmx. This is Equation K1 in the \
SI. The derivative of focal individual fitness, with respect to the focal \
individual\[CloseCurlyQuote]s level of signal-response,  evaluated at \
monomorphic equilibrium, is written below as -cmy. This is Equation K2  in \
the SI. The derivative of focal individual fitness, with respect to the focal \
individual\[CloseCurlyQuote]s level of dishonesty,  evaluated at monomorphic \
equilibrium, is written below as -cmz. This is Equation K3 in the SI. Note \
that the \[OpenCurlyQuote]cm\[CloseCurlyQuote] notation is used to represent \
the \[OpenCurlyQuote]marginal cost\[CloseCurlyQuote] of Hamilton\
\[CloseCurlyQuote]s Rule. \
\>", "Text",
 CellChangeTimes->{{3.915175733249536*^9, 3.915175737026534*^9}, {
  3.915175857656424*^9, 3.915175883915668*^9}, {3.915201785175893*^9, 
  3.915201785787332*^9}, {3.9169243383213587`*^9, 3.916924540689454*^9}, {
  3.917170050440551*^9, 
  3.917170100424304*^9}},ExpressionUUID->"6061d38e-9f3e-478f-afab-\
95501fdd65c9"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"cmx", "=", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{"D", "[", 
       RowBox[{"w", ",", "xfocal"}], "]"}]}], "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"xfocal", "->", 
        SuperscriptBox["x", "*"]}], ",", 
       RowBox[{"xothers", "->", 
        SuperscriptBox["x", "*"]}], ",", 
       RowBox[{"xpop", "->", 
        SuperscriptBox["x", "*"]}], ",", 
       RowBox[{"yfocal", "->", 
        SuperscriptBox["y", "*"]}], ",", 
       RowBox[{"yothers", "->", 
        SuperscriptBox["y", "*"]}], ",", 
       RowBox[{"ypop", "->", 
        SuperscriptBox["y", "*"]}], ",", 
       RowBox[{"zfocal", "->", 
        SuperscriptBox["z", "*"]}], ",", 
       RowBox[{"zothers", "->", 
        SuperscriptBox["z", "*"]}], ",", 
       RowBox[{"zpop", "->", 
        SuperscriptBox["z", "*"]}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"TraditionalForm", "[", 
  RowBox[{"-", "cmx"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cmy", "=", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{"D", "[", 
       RowBox[{"w", ",", "yfocal"}], "]"}]}], "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"xfocal", "->", 
        SuperscriptBox["x", "*"]}], ",", 
       RowBox[{"xothers", "->", 
        SuperscriptBox["x", "*"]}], ",", 
       RowBox[{"xpop", "->", 
        SuperscriptBox["x", "*"]}], ",", 
       RowBox[{"yfocal", "->", 
        SuperscriptBox["y", "*"]}], ",", 
       RowBox[{"yothers", "->", 
        SuperscriptBox["y", "*"]}], ",", 
       RowBox[{"ypop", "->", 
        SuperscriptBox["y", "*"]}], ",", 
       RowBox[{"zfocal", "->", 
        SuperscriptBox["z", "*"]}], ",", 
       RowBox[{"zothers", "->", 
        SuperscriptBox["z", "*"]}], ",", 
       RowBox[{"zpop", "->", 
        SuperscriptBox["z", "*"]}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"TraditionalForm", "[", 
  RowBox[{"-", "cmx"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cmz", "=", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{"D", "[", 
       RowBox[{"w", ",", "zfocal"}], "]"}]}], "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"xfocal", "->", 
        SuperscriptBox["x", "*"]}], ",", 
       RowBox[{"xothers", "->", 
        SuperscriptBox["x", "*"]}], ",", 
       RowBox[{"xpop", "->", 
        SuperscriptBox["x", "*"]}], ",", 
       RowBox[{"yfocal", "->", 
        SuperscriptBox["y", "*"]}], ",", 
       RowBox[{"yothers", "->", 
        SuperscriptBox["y", "*"]}], ",", 
       RowBox[{"ypop", "->", 
        SuperscriptBox["y", "*"]}], ",", 
       RowBox[{"zfocal", "->", 
        SuperscriptBox["z", "*"]}], ",", 
       RowBox[{"zothers", "->", 
        SuperscriptBox["z", "*"]}], ",", 
       RowBox[{"zpop", "->", 
        SuperscriptBox["z", "*"]}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"TraditionalForm", "[", 
  RowBox[{"-", "cmx"}], "]"}]}], "Input",
 CellChangeTimes->{{3.915177161684618*^9, 3.9151771773356667`*^9}, {
   3.916481483253688*^9, 3.916481552430945*^9}, {3.91648160244484*^9, 
   3.9164816118925*^9}, {3.916481759966824*^9, 3.916481788106379*^9}, 
   3.916481934096526*^9, {3.9164822989840403`*^9, 3.9164823223519583`*^9}, {
   3.916482356877144*^9, 3.916482367589439*^9}, {3.916897535989539*^9, 
   3.9168975825045357`*^9}, {3.916897664196308*^9, 3.916897685271616*^9}, {
   3.916924011307473*^9, 3.916924066960389*^9}},
 CellLabel->"In[32]:=",ExpressionUUID->"7644ce82-8180-466f-8a3c-0b55c7d17920"],

Cell[BoxData[
 FormBox[
  RowBox[{"-", 
   FractionBox[
    RowBox[{
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"m", "-", "1"}], ")"}], "2"], " ", 
      RowBox[{"(", 
       RowBox[{"N", "-", "1"}], ")"}], " ", 
      SuperscriptBox["y", "*"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"p", " ", 
         RowBox[{"(", 
          RowBox[{"d", "-", "s"}], ")"}]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"p", "-", "1"}], ")"}], " ", "s", " ", 
         SuperscriptBox["z", "*"]}]}], ")"}]}], "-", 
     RowBox[{"c", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"g", " ", 
         RowBox[{"(", 
          RowBox[{"N", "-", "1"}], ")"}]}], "-", "N"}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"m", "-", "1"}], ")"}], "2"], "-", "N"}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"p", "-", "1"}], ")"}], " ", 
         SuperscriptBox["z", "*"]}], "-", "p"}], ")"}]}]}], 
    RowBox[{"N", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        SuperscriptBox["x", "*"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"N", "-", "1"}], ")"}], " ", 
           SuperscriptBox["y", "*"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"p", " ", 
              RowBox[{"(", 
               RowBox[{"d", "-", "s"}], ")"}]}], "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"p", "-", "1"}], ")"}], " ", "s", " ", 
              SuperscriptBox["z", "*"]}]}], ")"}]}], "-", 
          RowBox[{"c", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"g", "-", "1"}], ")"}], " ", "N"}], "-", "g"}], ")"}], 
           " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"p", "-", "1"}], ")"}], " ", 
              SuperscriptBox["z", "*"]}], "-", "p"}], ")"}]}]}], ")"}]}], "-", 
       RowBox[{"d", " ", "N", " ", "p"}], "+", "N"}], ")"}]}]]}], 
  TraditionalForm]], "Output",
 CellChangeTimes->{{3.915175743038382*^9, 3.915175768128035*^9}, 
   3.915175936434854*^9, 3.915177190897686*^9, 3.915177506724401*^9, 
   3.91517759649308*^9, 3.915185308457467*^9, 3.9151854454804688`*^9, 
   3.9152057318463173`*^9, 3.916481442342709*^9, {3.9164815393717117`*^9, 
   3.916481552674883*^9}, {3.916481586104621*^9, 3.9164816546079397`*^9}, {
   3.9164817755564833`*^9, 3.916481808975319*^9}, {3.9164819310673447`*^9, 
   3.9164819343561277`*^9}, 3.9164821102923717`*^9, 3.916482441344426*^9, 
   3.91681723672745*^9, 3.916897391167815*^9, {3.91689755154731*^9, 
   3.916897582715363*^9}, {3.916897667376539*^9, 3.916897685486547*^9}, 
   3.916924190750946*^9, 3.916996116523508*^9, 3.917008740797999*^9, 
   3.9170087831838417`*^9, 3.9170852426604013`*^9, 3.9170876997934732`*^9, 
   3.9171701290389*^9},
 CellLabel->
  "Out[33]//TraditionalForm=",ExpressionUUID->"56f9cc37-4f7c-42a8-ae4b-\
0dbc7c99e14e"],

Cell[BoxData[
 FormBox[
  RowBox[{"-", 
   FractionBox[
    RowBox[{
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"m", "-", "1"}], ")"}], "2"], " ", 
      RowBox[{"(", 
       RowBox[{"N", "-", "1"}], ")"}], " ", 
      SuperscriptBox["y", "*"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"p", " ", 
         RowBox[{"(", 
          RowBox[{"d", "-", "s"}], ")"}]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"p", "-", "1"}], ")"}], " ", "s", " ", 
         SuperscriptBox["z", "*"]}]}], ")"}]}], "-", 
     RowBox[{"c", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"g", " ", 
         RowBox[{"(", 
          RowBox[{"N", "-", "1"}], ")"}]}], "-", "N"}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"m", "-", "1"}], ")"}], "2"], "-", "N"}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"p", "-", "1"}], ")"}], " ", 
         SuperscriptBox["z", "*"]}], "-", "p"}], ")"}]}]}], 
    RowBox[{"N", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        SuperscriptBox["x", "*"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"N", "-", "1"}], ")"}], " ", 
           SuperscriptBox["y", "*"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"p", " ", 
              RowBox[{"(", 
               RowBox[{"d", "-", "s"}], ")"}]}], "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"p", "-", "1"}], ")"}], " ", "s", " ", 
              SuperscriptBox["z", "*"]}]}], ")"}]}], "-", 
          RowBox[{"c", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"g", "-", "1"}], ")"}], " ", "N"}], "-", "g"}], ")"}], 
           " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"p", "-", "1"}], ")"}], " ", 
              SuperscriptBox["z", "*"]}], "-", "p"}], ")"}]}]}], ")"}]}], "-", 
       RowBox[{"d", " ", "N", " ", "p"}], "+", "N"}], ")"}]}]]}], 
  TraditionalForm]], "Output",
 CellChangeTimes->{{3.915175743038382*^9, 3.915175768128035*^9}, 
   3.915175936434854*^9, 3.915177190897686*^9, 3.915177506724401*^9, 
   3.91517759649308*^9, 3.915185308457467*^9, 3.9151854454804688`*^9, 
   3.9152057318463173`*^9, 3.916481442342709*^9, {3.9164815393717117`*^9, 
   3.916481552674883*^9}, {3.916481586104621*^9, 3.9164816546079397`*^9}, {
   3.9164817755564833`*^9, 3.916481808975319*^9}, {3.9164819310673447`*^9, 
   3.9164819343561277`*^9}, 3.9164821102923717`*^9, 3.916482441344426*^9, 
   3.91681723672745*^9, 3.916897391167815*^9, {3.91689755154731*^9, 
   3.916897582715363*^9}, {3.916897667376539*^9, 3.916897685486547*^9}, 
   3.916924190750946*^9, 3.916996116523508*^9, 3.917008740797999*^9, 
   3.9170087831838417`*^9, 3.9170852426604013`*^9, 3.9170876997934732`*^9, 
   3.917170129093905*^9},
 CellLabel->
  "Out[35]//TraditionalForm=",ExpressionUUID->"e8a47e08-4831-4e2d-baff-\
5d884c51d72f"],

Cell[BoxData[
 FormBox[
  RowBox[{"-", 
   FractionBox[
    RowBox[{
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"m", "-", "1"}], ")"}], "2"], " ", 
      RowBox[{"(", 
       RowBox[{"N", "-", "1"}], ")"}], " ", 
      SuperscriptBox["y", "*"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"p", " ", 
         RowBox[{"(", 
          RowBox[{"d", "-", "s"}], ")"}]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"p", "-", "1"}], ")"}], " ", "s", " ", 
         SuperscriptBox["z", "*"]}]}], ")"}]}], "-", 
     RowBox[{"c", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"g", " ", 
         RowBox[{"(", 
          RowBox[{"N", "-", "1"}], ")"}]}], "-", "N"}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"m", "-", "1"}], ")"}], "2"], "-", "N"}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"p", "-", "1"}], ")"}], " ", 
         SuperscriptBox["z", "*"]}], "-", "p"}], ")"}]}]}], 
    RowBox[{"N", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        SuperscriptBox["x", "*"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"N", "-", "1"}], ")"}], " ", 
           SuperscriptBox["y", "*"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"p", " ", 
              RowBox[{"(", 
               RowBox[{"d", "-", "s"}], ")"}]}], "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"p", "-", "1"}], ")"}], " ", "s", " ", 
              SuperscriptBox["z", "*"]}]}], ")"}]}], "-", 
          RowBox[{"c", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"g", "-", "1"}], ")"}], " ", "N"}], "-", "g"}], ")"}], 
           " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"p", "-", "1"}], ")"}], " ", 
              SuperscriptBox["z", "*"]}], "-", "p"}], ")"}]}]}], ")"}]}], "-", 
       RowBox[{"d", " ", "N", " ", "p"}], "+", "N"}], ")"}]}]]}], 
  TraditionalForm]], "Output",
 CellChangeTimes->{{3.915175743038382*^9, 3.915175768128035*^9}, 
   3.915175936434854*^9, 3.915177190897686*^9, 3.915177506724401*^9, 
   3.91517759649308*^9, 3.915185308457467*^9, 3.9151854454804688`*^9, 
   3.9152057318463173`*^9, 3.916481442342709*^9, {3.9164815393717117`*^9, 
   3.916481552674883*^9}, {3.916481586104621*^9, 3.9164816546079397`*^9}, {
   3.9164817755564833`*^9, 3.916481808975319*^9}, {3.9164819310673447`*^9, 
   3.9164819343561277`*^9}, 3.9164821102923717`*^9, 3.916482441344426*^9, 
   3.91681723672745*^9, 3.916897391167815*^9, {3.91689755154731*^9, 
   3.916897582715363*^9}, {3.916897667376539*^9, 3.916897685486547*^9}, 
   3.916924190750946*^9, 3.916996116523508*^9, 3.917008740797999*^9, 
   3.9170087831838417`*^9, 3.9170852426604013`*^9, 3.9170876997934732`*^9, 
   3.9171701292167664`*^9},
 CellLabel->
  "Out[37]//TraditionalForm=",ExpressionUUID->"4cd2d468-a713-4ebd-b122-\
12889452afb9"]
}, Open  ]],

Cell["\<\
The derivative of focal individual fitness, with respect to the average \
signal investment of other individuals on the deme, evaluated at monomorphic \
equilibrium, is written below as bmx. This is Equation K4 in the SI. The \
derivative of focal individual fitness, with respect to the average \
signal-response level of other individuals on the deme, evaluated at \
monomorphic equilibrium, is written below as bmy. This is Equation K5 in the \
SI. The derivative of focal individual fitness, with respect to the average \
signal dishonesty level of other individuals on the deme, evaluated at \
monomorphic equilibrium, is written below as bmz. This is Equation K6 in the \
SI. Note that the \[OpenCurlyQuote]bm\[CloseCurlyQuote] notation is used to \
represent the \[OpenCurlyQuote]marginal benefit\[CloseCurlyQuote] of Hamilton\
\[CloseCurlyQuote]s Rule. \
\>", "Text",
 CellChangeTimes->{{3.915175418488715*^9, 3.915175518937564*^9}, 
   3.915175722238924*^9, {3.915175920186359*^9, 3.915175930914809*^9}, {
   3.915201863902808*^9, 3.9152018640063953`*^9}, {3.916924737050666*^9, 
   3.916924834839422*^9}, {3.917170160152258*^9, 
   3.9171701855657063`*^9}},ExpressionUUID->"26feaadb-42c4-4ba1-a5b8-\
9055876ffc4c"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"TraditionalForm", "[", 
  RowBox[{"bmx", "=", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{"w", ",", "xothers"}], "]"}], "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"xfocal", "->", 
        SuperscriptBox["x", "*"]}], ",", 
       RowBox[{"xothers", "->", 
        SuperscriptBox["x", "*"]}], ",", 
       RowBox[{"xpop", "->", 
        SuperscriptBox["x", "*"]}], ",", 
       RowBox[{"yfocal", "->", 
        SuperscriptBox["y", "*"]}], ",", 
       RowBox[{"yothers", "->", 
        SuperscriptBox["y", "*"]}], ",", 
       RowBox[{"ypop", "->", 
        SuperscriptBox["y", "*"]}], ",", 
       RowBox[{"zfocal", "->", 
        SuperscriptBox["z", "*"]}], ",", 
       RowBox[{"zothers", "->", 
        SuperscriptBox["z", "*"]}], ",", 
       RowBox[{"zpop", "->", 
        SuperscriptBox["z", "*"]}]}], "}"}]}], "]"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"TraditionalForm", "[", 
  RowBox[{"bmy", "=", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{"w", ",", "yothers"}], "]"}], "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"xfocal", "->", 
        SuperscriptBox["x", "*"]}], ",", 
       RowBox[{"xothers", "->", 
        SuperscriptBox["x", "*"]}], ",", 
       RowBox[{"xpop", "->", 
        SuperscriptBox["x", "*"]}], ",", 
       RowBox[{"yfocal", "->", 
        SuperscriptBox["y", "*"]}], ",", 
       RowBox[{"yothers", "->", 
        SuperscriptBox["y", "*"]}], ",", 
       RowBox[{"ypop", "->", 
        SuperscriptBox["y", "*"]}], ",", 
       RowBox[{"zfocal", "->", 
        SuperscriptBox["z", "*"]}], ",", 
       RowBox[{"zothers", "->", 
        SuperscriptBox["z", "*"]}], ",", 
       RowBox[{"zpop", "->", 
        SuperscriptBox["z", "*"]}]}], "}"}]}], "]"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"TraditionalForm", "[", 
  RowBox[{"bmz", "=", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{"w", ",", "zothers"}], "]"}], "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"xfocal", "->", 
        SuperscriptBox["x", "*"]}], ",", 
       RowBox[{"xothers", "->", 
        SuperscriptBox["x", "*"]}], ",", 
       RowBox[{"xpop", "->", 
        SuperscriptBox["x", "*"]}], ",", 
       RowBox[{"yfocal", "->", 
        SuperscriptBox["y", "*"]}], ",", 
       RowBox[{"yothers", "->", 
        SuperscriptBox["y", "*"]}], ",", 
       RowBox[{"ypop", "->", 
        SuperscriptBox["y", "*"]}], ",", 
       RowBox[{"zfocal", "->", 
        SuperscriptBox["z", "*"]}], ",", 
       RowBox[{"zothers", "->", 
        SuperscriptBox["z", "*"]}], ",", 
       RowBox[{"zpop", "->", 
        SuperscriptBox["z", "*"]}]}], "}"}]}], "]"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.9081039414213743`*^9, 3.9081039435052147`*^9}, {
   3.90810406510456*^9, 3.908104073589612*^9}, {3.9081043026353397`*^9, 
   3.9081043339158287`*^9}, 3.908106925554028*^9, {3.911391003528234*^9, 
   3.9113910075287848`*^9}, {3.9115423725276537`*^9, 3.911542390599454*^9}, {
   3.915175399934017*^9, 3.915175400756152*^9}, 3.915175723845454*^9, {
   3.915177193413665*^9, 3.9151771935552893`*^9}, {3.9164819598739023`*^9, 
   3.916481970547638*^9}, 3.91648230585422*^9, {3.916482371868814*^9, 
   3.916482381088786*^9}, {3.916924211383026*^9, 3.916924219763884*^9}},
 CellLabel->"In[38]:=",ExpressionUUID->"701e2b4a-563e-4289-91c9-9f9b2e1e0961"],

Cell[BoxData[
 FormBox[
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{"N", "-", "1"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"c", " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"m", "-", "1"}], ")"}], "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"g", " ", 
          RowBox[{"(", 
           RowBox[{"N", "-", "1"}], ")"}]}], "-", "N"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"p", "-", "1"}], ")"}], " ", 
          SuperscriptBox["z", "*"]}], "-", "p"}], ")"}]}], "-", 
      RowBox[{
       SuperscriptBox["y", "*"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"m", "-", "2"}], ")"}], " ", "m", " ", 
          RowBox[{"(", 
           RowBox[{"N", "-", "1"}], ")"}]}], "-", "1"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"p", " ", 
          RowBox[{"(", 
           RowBox[{"d", "-", "s"}], ")"}]}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"p", "-", "1"}], ")"}], " ", "s", " ", 
          SuperscriptBox["z", "*"]}]}], ")"}]}]}], ")"}]}], 
   RowBox[{"N", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SuperscriptBox["x", "*"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"N", "-", "1"}], ")"}], " ", 
          SuperscriptBox["y", "*"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"p", " ", 
             RowBox[{"(", 
              RowBox[{"d", "-", "s"}], ")"}]}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"p", "-", "1"}], ")"}], " ", "s", " ", 
             SuperscriptBox["z", "*"]}]}], ")"}]}], "-", 
         RowBox[{"c", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"g", "-", "1"}], ")"}], " ", "N"}], "-", "g"}], ")"}], 
          " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"p", "-", "1"}], ")"}], " ", 
             SuperscriptBox["z", "*"]}], "-", "p"}], ")"}]}]}], ")"}]}], "-", 
      
      RowBox[{"d", " ", "N", " ", "p"}], "+", "N"}], ")"}]}]], 
  TraditionalForm]], "Output",
 CellChangeTimes->{{3.908104066438794*^9, 3.908104073995747*^9}, {
   3.908104334637701*^9, 3.908104339447672*^9}, 3.908104424387844*^9, 
   3.90810793331876*^9, 3.908268880209581*^9, 3.9083559231030807`*^9, 
   3.9108605734536858`*^9, 3.911376842118787*^9, 3.911377086620686*^9, 
   3.9113911571237173`*^9, 3.911471811646303*^9, 3.911542455073489*^9, 
   3.9115545156811333`*^9, 3.911555059549644*^9, 3.915175584540079*^9, 
   3.915175770181059*^9, {3.915175934655409*^9, 3.915175941825774*^9}, 
   3.915177194903661*^9, 3.915177508380785*^9, 3.915177613264398*^9, 
   3.9151854491434717`*^9, 3.915205736861938*^9, 3.91648197268186*^9, 
   3.916482112689074*^9, 3.916482454211854*^9, 3.916817238961383*^9, 
   3.916897399110004*^9, 3.916924221003422*^9, 3.916996126203195*^9, 
   3.917008741079323*^9, 3.91700878623107*^9, 3.9170852429402237`*^9, 
   3.917087700035041*^9, 3.917170129796028*^9},
 CellLabel->
  "Out[38]//TraditionalForm=",ExpressionUUID->"01f965a7-2db8-4038-8b35-\
de244633f366"],

Cell[BoxData[
 FormBox[
  RowBox[{"-", 
   FractionBox[
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"m", "-", "1"}], ")"}], "2"], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"N", "-", "1"}], ")"}], "2"], " ", 
     SuperscriptBox["x", "*"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"p", " ", 
        RowBox[{"(", 
         RowBox[{"d", "-", "s"}], ")"}]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"p", "-", "1"}], ")"}], " ", "s", " ", 
        SuperscriptBox["z", "*"]}]}], ")"}]}], 
    RowBox[{"N", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        SuperscriptBox["x", "*"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"N", "-", "1"}], ")"}], " ", 
           SuperscriptBox["y", "*"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"p", " ", 
              RowBox[{"(", 
               RowBox[{"d", "-", "s"}], ")"}]}], "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"p", "-", "1"}], ")"}], " ", "s", " ", 
              SuperscriptBox["z", "*"]}]}], ")"}]}], "-", 
          RowBox[{"c", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"g", "-", "1"}], ")"}], " ", "N"}], "-", "g"}], ")"}], 
           " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"p", "-", "1"}], ")"}], " ", 
              SuperscriptBox["z", "*"]}], "-", "p"}], ")"}]}]}], ")"}]}], "-", 
       RowBox[{"d", " ", "N", " ", "p"}], "+", "N"}], ")"}]}]]}], 
  TraditionalForm]], "Output",
 CellChangeTimes->{{3.908104066438794*^9, 3.908104073995747*^9}, {
   3.908104334637701*^9, 3.908104339447672*^9}, 3.908104424387844*^9, 
   3.90810793331876*^9, 3.908268880209581*^9, 3.9083559231030807`*^9, 
   3.9108605734536858`*^9, 3.911376842118787*^9, 3.911377086620686*^9, 
   3.9113911571237173`*^9, 3.911471811646303*^9, 3.911542455073489*^9, 
   3.9115545156811333`*^9, 3.911555059549644*^9, 3.915175584540079*^9, 
   3.915175770181059*^9, {3.915175934655409*^9, 3.915175941825774*^9}, 
   3.915177194903661*^9, 3.915177508380785*^9, 3.915177613264398*^9, 
   3.9151854491434717`*^9, 3.915205736861938*^9, 3.91648197268186*^9, 
   3.916482112689074*^9, 3.916482454211854*^9, 3.916817238961383*^9, 
   3.916897399110004*^9, 3.916924221003422*^9, 3.916996126203195*^9, 
   3.917008741079323*^9, 3.91700878623107*^9, 3.9170852429402237`*^9, 
   3.917087700035041*^9, 3.917170129883391*^9},
 CellLabel->
  "Out[39]//TraditionalForm=",ExpressionUUID->"f7e83af6-faa6-415d-a2b8-\
70fbb70abca2"],

Cell[BoxData[
 FormBox[
  RowBox[{"-", 
   FractionBox[
    RowBox[{
     RowBox[{"(", 
      RowBox[{"N", "-", "1"}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"p", "-", "1"}], ")"}], " ", 
     SuperscriptBox["x", "*"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"c", " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"m", "-", "1"}], ")"}], "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"g", " ", 
           RowBox[{"(", 
            RowBox[{"N", "-", "1"}], ")"}]}], "-", "N"}], ")"}]}], "+", 
       RowBox[{"s", " ", 
        SuperscriptBox["y", "*"], " ", 
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"m", "-", "2"}], ")"}], " ", "m", " ", 
           RowBox[{"(", 
            RowBox[{"N", "-", "1"}], ")"}]}]}], ")"}]}]}], ")"}]}], 
    RowBox[{"N", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        SuperscriptBox["x", "*"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"c", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"g", "-", "1"}], ")"}], " ", "N"}], "-", "g"}], ")"}], 
           " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"p", "-", "1"}], ")"}], " ", 
              SuperscriptBox["z", "*"]}], "-", "p"}], ")"}]}], "-", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"N", "-", "1"}], ")"}], " ", 
           SuperscriptBox["y", "*"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"p", " ", 
              RowBox[{"(", 
               RowBox[{"d", "-", "s"}], ")"}]}], "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"p", "-", "1"}], ")"}], " ", "s", " ", 
              SuperscriptBox["z", "*"]}]}], ")"}]}]}], ")"}]}], "+", 
       RowBox[{"N", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"d", " ", "p"}], "-", "1"}], ")"}]}]}], ")"}]}]]}], 
  TraditionalForm]], "Output",
 CellChangeTimes->{{3.908104066438794*^9, 3.908104073995747*^9}, {
   3.908104334637701*^9, 3.908104339447672*^9}, 3.908104424387844*^9, 
   3.90810793331876*^9, 3.908268880209581*^9, 3.9083559231030807`*^9, 
   3.9108605734536858`*^9, 3.911376842118787*^9, 3.911377086620686*^9, 
   3.9113911571237173`*^9, 3.911471811646303*^9, 3.911542455073489*^9, 
   3.9115545156811333`*^9, 3.911555059549644*^9, 3.915175584540079*^9, 
   3.915175770181059*^9, {3.915175934655409*^9, 3.915175941825774*^9}, 
   3.915177194903661*^9, 3.915177508380785*^9, 3.915177613264398*^9, 
   3.9151854491434717`*^9, 3.915205736861938*^9, 3.91648197268186*^9, 
   3.916482112689074*^9, 3.916482454211854*^9, 3.916817238961383*^9, 
   3.916897399110004*^9, 3.916924221003422*^9, 3.916996126203195*^9, 
   3.917008741079323*^9, 3.91700878623107*^9, 3.9170852429402237`*^9, 
   3.917087700035041*^9, 3.917170130011894*^9},
 CellLabel->
  "Out[40]//TraditionalForm=",ExpressionUUID->"071083a2-b4f1-4084-ad00-\
67c66a153e95"]
}, Open  ]],

Cell["\<\
The overall marginal change in neighbour-modulated fitness associated with a \
slight change in signalling investment is written below as margopenx. The \
overall marginal change in neighbour-modulated fitness associated with a \
slight change in signal-response is written below as margopeny. The overall \
marginal change in neighbour-modulated fitness associated with a slight \
change in signal dishonesty is written below as margopenz. The \
\[OpenCurlyQuote]margopen\[CloseCurlyQuote] notation is used to represent the \
marginal fitness change, and the open model setting. \
\>", "Text",
 CellChangeTimes->{{3.915175958153467*^9, 3.915176040877063*^9}, {
   3.915177227882449*^9, 3.9151773535121117`*^9}, {3.9152019626637087`*^9, 
   3.915201962719282*^9}, {3.916924848430903*^9, 3.9169249480354433`*^9}, 
   3.91717022293972*^9},ExpressionUUID->"9a454de3-d58e-408b-801a-\
4867065fda69"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"TraditionalForm", "[", 
  RowBox[{"margopenx", "=", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{
     RowBox[{
      SuperscriptBox["r", "*"], " ", "bmx"}], " ", "-", " ", "cmx"}], "]"}]}],
   "]"}], "\[IndentingNewLine]", 
 RowBox[{"TraditionalForm", "[", 
  RowBox[{"margopeny", "=", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{
     RowBox[{
      SuperscriptBox["r", "*"], " ", "bmy"}], " ", "-", " ", "cmy"}], "]"}]}],
   "]"}], "\[IndentingNewLine]", 
 RowBox[{"TraditionalForm", "[", 
  RowBox[{"margopenz", "=", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{
     RowBox[{
      SuperscriptBox["r", "*"], " ", "bmz"}], " ", "-", " ", "cmz"}], "]"}]}],
   "]"}]}], "Input",
 CellChangeTimes->{{3.9081044477104807`*^9, 3.908104459241107*^9}, {
   3.908104492639288*^9, 3.9081044941536303`*^9}, {3.9081051452016487`*^9, 
   3.90810514887316*^9}, {3.9151758222548037`*^9, 3.9151758368976316`*^9}, {
   3.915177197160902*^9, 3.9151772227977467`*^9}, 3.915177266100378*^9, {
   3.91648233432502*^9, 3.916482342389292*^9}, {3.916482411368557*^9, 
   3.916482421649559*^9}, {3.9170087339618473`*^9, 3.9170087418761663`*^9}},
 CellLabel->"In[41]:=",ExpressionUUID->"4d208711-404e-4bec-88cb-ace1bb82c375"],

Cell[BoxData[
 FormBox[
  FractionBox[
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"N", "-", "1"}], ")"}], " ", 
     SuperscriptBox["r", "*"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"c", " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"m", "-", "1"}], ")"}], "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"g", "-", "1"}], ")"}], " ", "N"}], "-", "g"}], ")"}], 
        " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"p", "-", "1"}], ")"}], " ", 
           SuperscriptBox["z", "*"]}], "-", "p"}], ")"}]}], "-", 
       RowBox[{
        SuperscriptBox["y", "*"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"m", "-", "2"}], ")"}], " ", "m", " ", 
           RowBox[{"(", 
            RowBox[{"N", "-", "1"}], ")"}]}], "-", "1"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"p", " ", 
           RowBox[{"(", 
            RowBox[{"d", "-", "s"}], ")"}]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"p", "-", "1"}], ")"}], " ", "s", " ", 
           SuperscriptBox["z", "*"]}]}], ")"}]}]}], ")"}]}], "+", 
    RowBox[{"c", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"g", "-", "1"}], ")"}], " ", "N"}], "-", "g"}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"m", "-", "1"}], ")"}], "2"], "-", "N"}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"p", "-", "1"}], ")"}], " ", 
        SuperscriptBox["z", "*"]}], "-", "p"}], ")"}]}], "-", 
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"m", "-", "1"}], ")"}], "2"], " ", 
      RowBox[{"(", 
       RowBox[{"N", "-", "1"}], ")"}], " ", 
      SuperscriptBox["y", "*"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"p", " ", 
         RowBox[{"(", 
          RowBox[{"d", "-", "s"}], ")"}]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"p", "-", "1"}], ")"}], " ", "s", " ", 
         SuperscriptBox["z", "*"]}]}], ")"}]}], ")"}]}], 
   RowBox[{"N", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SuperscriptBox["x", "*"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"N", "-", "1"}], ")"}], " ", 
          SuperscriptBox["y", "*"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"p", " ", 
             RowBox[{"(", 
              RowBox[{"d", "-", "s"}], ")"}]}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"p", "-", "1"}], ")"}], " ", "s", " ", 
             SuperscriptBox["z", "*"]}]}], ")"}]}], "-", 
         RowBox[{"c", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"g", "-", "1"}], ")"}], " ", "N"}], "-", "g"}], ")"}], 
          " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"p", "-", "1"}], ")"}], " ", 
             SuperscriptBox["z", "*"]}], "-", "p"}], ")"}]}]}], ")"}]}], "-", 
      
      RowBox[{"d", " ", "N", " ", "p"}], "+", "N"}], ")"}]}]], 
  TraditionalForm]], "Output",
 CellChangeTimes->{
  3.9081044594986353`*^9, 3.908104494901422*^9, 3.908105149718433*^9, 
   3.9081079426689453`*^9, 3.908268887184318*^9, 3.908355930776684*^9, 
   3.910860606912422*^9, 3.911376884182818*^9, 3.9113771335928373`*^9, 
   3.911471977218416*^9, 3.91154771336239*^9, 3.911554641393799*^9, 
   3.9115551823599377`*^9, {3.9151758295380363`*^9, 3.915175837301425*^9}, 
   3.915175945948777*^9, 3.91517605612919*^9, 3.915177202186002*^9, 
   3.915177356595026*^9, 3.9151775111263103`*^9, 3.915177625624977*^9, 
   3.91518566158922*^9, 3.915186018478601*^9, 3.915205738524659*^9, 
   3.9164819989330893`*^9, 3.9164821167929287`*^9, 3.916482535622197*^9, 
   3.916817241448886*^9, 3.916924226240726*^9, 3.916996132270293*^9, 
   3.917008745724008*^9, 3.9170087958062983`*^9, {3.917085243082612*^9, 
   3.9170852465569563`*^9}, 3.917087700201982*^9, 3.917170131887912*^9},
 CellLabel->
  "Out[41]//TraditionalForm=",ExpressionUUID->"95ef06dd-e99e-45de-9efb-\
4f48f5351a13"],

Cell[BoxData[
 FormBox[
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{"N", "-", "1"}], ")"}], " ", 
    SuperscriptBox["x", "*"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", 
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"m", "-", "1"}], ")"}], "2"], " ", 
         RowBox[{"(", 
          RowBox[{"N", "-", "1"}], ")"}], " ", 
         SuperscriptBox["r", "*"]}], ")"}]}], "-", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"m", "-", "1"}], ")"}], "2"], "+", "N"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"p", " ", 
       RowBox[{"(", 
        RowBox[{"d", "-", "s"}], ")"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"p", "-", "1"}], ")"}], " ", "s", " ", 
       SuperscriptBox["z", "*"]}]}], ")"}]}], 
   RowBox[{"N", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SuperscriptBox["x", "*"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"N", "-", "1"}], ")"}], " ", 
          SuperscriptBox["y", "*"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"p", " ", 
             RowBox[{"(", 
              RowBox[{"d", "-", "s"}], ")"}]}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"p", "-", "1"}], ")"}], " ", "s", " ", 
             SuperscriptBox["z", "*"]}]}], ")"}]}], "-", 
         RowBox[{"c", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"g", "-", "1"}], ")"}], " ", "N"}], "-", "g"}], ")"}], 
          " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"p", "-", "1"}], ")"}], " ", 
             SuperscriptBox["z", "*"]}], "-", "p"}], ")"}]}]}], ")"}]}], "-", 
      
      RowBox[{"d", " ", "N", " ", "p"}], "+", "N"}], ")"}]}]], 
  TraditionalForm]], "Output",
 CellChangeTimes->{
  3.9081044594986353`*^9, 3.908104494901422*^9, 3.908105149718433*^9, 
   3.9081079426689453`*^9, 3.908268887184318*^9, 3.908355930776684*^9, 
   3.910860606912422*^9, 3.911376884182818*^9, 3.9113771335928373`*^9, 
   3.911471977218416*^9, 3.91154771336239*^9, 3.911554641393799*^9, 
   3.9115551823599377`*^9, {3.9151758295380363`*^9, 3.915175837301425*^9}, 
   3.915175945948777*^9, 3.91517605612919*^9, 3.915177202186002*^9, 
   3.915177356595026*^9, 3.9151775111263103`*^9, 3.915177625624977*^9, 
   3.91518566158922*^9, 3.915186018478601*^9, 3.915205738524659*^9, 
   3.9164819989330893`*^9, 3.9164821167929287`*^9, 3.916482535622197*^9, 
   3.916817241448886*^9, 3.916924226240726*^9, 3.916996132270293*^9, 
   3.917008745724008*^9, 3.9170087958062983`*^9, {3.917085243082612*^9, 
   3.9170852465569563`*^9}, 3.917087700201982*^9, 3.917170132014488*^9},
 CellLabel->
  "Out[42]//TraditionalForm=",ExpressionUUID->"325a5e5d-2492-4740-9ba8-\
53db41f6030e"],

Cell[BoxData[
 FormBox[
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{"p", "-", "1"}], ")"}], " ", 
    SuperscriptBox["x", "*"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"N", "-", "1"}], ")"}], " ", 
       SuperscriptBox["r", "*"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"s", " ", 
          SuperscriptBox["y", "*"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"m", "-", "2"}], ")"}], " ", "m", " ", 
             RowBox[{"(", 
              RowBox[{"N", "-", "1"}], ")"}]}], "-", "1"}], ")"}]}], "-", 
         RowBox[{"c", " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"m", "-", "1"}], ")"}], "2"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"g", "-", "1"}], ")"}], " ", "N"}], "-", "g"}], 
           ")"}]}]}], ")"}]}], "-", 
      RowBox[{"c", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"g", "-", "1"}], ")"}], " ", "N"}], "-", "g"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"m", "-", "1"}], ")"}], "2"], "-", "N"}], ")"}]}], "+", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"m", "-", "1"}], ")"}], "2"], " ", 
       RowBox[{"(", 
        RowBox[{"N", "-", "1"}], ")"}], " ", "s", " ", 
       SuperscriptBox["y", "*"]}]}], ")"}]}], 
   RowBox[{"N", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SuperscriptBox["x", "*"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"c", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"g", "-", "1"}], ")"}], " ", "N"}], "-", "g"}], ")"}], 
          " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"p", "-", "1"}], ")"}], " ", 
             SuperscriptBox["z", "*"]}], "-", "p"}], ")"}]}], "-", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"N", "-", "1"}], ")"}], " ", 
          SuperscriptBox["y", "*"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"p", " ", 
             RowBox[{"(", 
              RowBox[{"d", "-", "s"}], ")"}]}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"p", "-", "1"}], ")"}], " ", "s", " ", 
             SuperscriptBox["z", "*"]}]}], ")"}]}]}], ")"}]}], "+", 
      RowBox[{"N", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"d", " ", "p"}], "-", "1"}], ")"}]}]}], ")"}]}]], 
  TraditionalForm]], "Output",
 CellChangeTimes->{
  3.9081044594986353`*^9, 3.908104494901422*^9, 3.908105149718433*^9, 
   3.9081079426689453`*^9, 3.908268887184318*^9, 3.908355930776684*^9, 
   3.910860606912422*^9, 3.911376884182818*^9, 3.9113771335928373`*^9, 
   3.911471977218416*^9, 3.91154771336239*^9, 3.911554641393799*^9, 
   3.9115551823599377`*^9, {3.9151758295380363`*^9, 3.915175837301425*^9}, 
   3.915175945948777*^9, 3.91517605612919*^9, 3.915177202186002*^9, 
   3.915177356595026*^9, 3.9151775111263103`*^9, 3.915177625624977*^9, 
   3.91518566158922*^9, 3.915186018478601*^9, 3.915205738524659*^9, 
   3.9164819989330893`*^9, 3.9164821167929287`*^9, 3.916482535622197*^9, 
   3.916817241448886*^9, 3.916924226240726*^9, 3.916996132270293*^9, 
   3.917008745724008*^9, 3.9170087958062983`*^9, {3.917085243082612*^9, 
   3.9170852465569563`*^9}, 3.917087700201982*^9, 3.917170132370525*^9},
 CellLabel->
  "Out[43]//TraditionalForm=",ExpressionUUID->"b7922126-c52d-4587-8313-\
5f747a7c8386"]
}, Open  ]],

Cell[TextData[{
 "We obtain a condition for signal-dishonesty being at an ESS by setting \
margopenz to equal zero, to obtain ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SuperscriptBox["y", "*"], "\[Rule]", 
    FractionBox[
     RowBox[{"c", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"g", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "N"}], ")"}]}], "-", "N"}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "m"}], ")"}], "2"], "-", "N", "+", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "m"}], ")"}], "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "N"}], ")"}], " ", 
         SuperscriptBox["r", "*"]}]}], ")"}]}], 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "N"}], ")"}], " ", "s", " ", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "m"}], ")"}], "2"], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "2"}], "+", "m"}], ")"}], " ", "m", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", "N"}], ")"}]}]}], ")"}], " ", 
         SuperscriptBox["r", "*"]}]}], ")"}]}]]}], TraditionalForm]],
  CellChangeTimes->{3.9168193414187*^9, 3.9168275118005867`*^9, 
   3.916924240351778*^9},ExpressionUUID->
  "9ba1f4b9-2232-4567-91d5-a73436fbc2b8"],
 ". Signal-dishonesty is at an ESS (z=z*) when this condition is satisfied. \
This is Equation K7 in the SI. "
}], "Text",
 CellChangeTimes->{{3.917170254432003*^9, 3.917170258567997*^9}, {
  3.9171702954565287`*^9, 
  3.917170318799673*^9}},ExpressionUUID->"ec472916-8991-4cfd-9480-\
c889a7587422"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"FullSimplify", "[", 
  RowBox[{"Solve", "[", 
   RowBox[{
    RowBox[{"margopenz", "==", "0"}], ",", 
    SuperscriptBox["y", "*"]}], "]"}], "]"}]], "Input",
 CellLabel->"In[52]:=",ExpressionUUID->"f807c18f-1aea-4185-90c3-6023ceb08b07"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    SuperscriptBox["y", "*"], "\[Rule]", 
    FractionBox[
     RowBox[{"c", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"g", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "N"}], ")"}]}], "-", "N"}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "m"}], ")"}], "2"], "-", "N", "+", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "m"}], ")"}], "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "N"}], ")"}], " ", 
         SuperscriptBox["r", "*"]}]}], ")"}]}], 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "N"}], ")"}], " ", "s", " ", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "m"}], ")"}], "2"], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "2"}], "+", "m"}], ")"}], " ", "m", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", "N"}], ")"}]}]}], ")"}], " ", 
         SuperscriptBox["r", "*"]}]}], ")"}]}]]}], "}"}], "}"}]], "Output",
 CellChangeTimes->{3.917170283666946*^9},
 CellLabel->"Out[52]=",ExpressionUUID->"e72bef48-35de-479a-8fd2-36db446cab53"]
}, Open  ]],

Cell[TextData[{
 "We obtain a condition for signal-response being at an ESS by setting \
margopeny to equal zero, to obtain ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SuperscriptBox["z", "*"], "\[Rule]", 
    FractionBox[
     RowBox[{"p", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "d"}], "+", "s"}], ")"}]}], 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "p"}], ")"}], " ", "s"}]]}], 
   TraditionalForm]],
  CellChangeTimes->{3.9168193414187*^9, 3.9168275118005867`*^9, 
   3.916924240351778*^9},ExpressionUUID->
  "c722d4c4-4a07-4e50-aa0d-b0e9f1c6066b"],
 ". Signal-response is at an ESS (y=y*) when this condition is satisfied. \
This is Equation J20 in the SI. "
}], "Text",
 CellChangeTimes->{{3.9171703311710997`*^9, 3.917170343249854*^9}, {
  3.91717040202172*^9, 3.917170413658534*^9}, {3.917170455672781*^9, 
  3.917170456688447*^9}},ExpressionUUID->"e8c2e3ce-9ce9-4884-b6ea-\
ac58a9283ee5"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"FullSimplify", "[", 
  RowBox[{"Solve", "[", 
   RowBox[{
    RowBox[{"margopeny", "==", "0"}], ",", 
    SuperscriptBox["z", "*"]}], "]"}], "]"}]], "Input",
 CellLabel->"In[53]:=",ExpressionUUID->"af0c4b2a-8a0a-4854-847d-9a3d80d443b8"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    SuperscriptBox["z", "*"], "\[Rule]", 
    FractionBox[
     RowBox[{"p", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "d"}], "+", "s"}], ")"}]}], 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "p"}], ")"}], " ", "s"}]]}], "}"}], 
  "}"}]], "Output",
 CellChangeTimes->{3.917170371240728*^9},
 CellLabel->"Out[53]=",ExpressionUUID->"7e4fd52a-eca0-4417-a24e-e4c4777cec7b"]
}, Open  ]],

Cell[TextData[{
 "We ask when a slight increase in signalling is favoured. To do so, we set \
the margopenx to be greater than zero. This is Equation K8 in the SI. We then \
substitute into margopenx=0 our ESS values for ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["y", "*"], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "a9cec201-fabb-45de-ac66-ed752fb08d85"],
 "and ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["z", "*"], TraditionalForm]],ExpressionUUID->
  "55cfc2d9-321d-41a7-bb94-3e74e43a5474"],
 " and obtain ",
 Cell[BoxData[
  RowBox[{
   SuperscriptBox["r", "*"], "\[Rule]", 
   FractionBox[
    RowBox[{
     RowBox[{"-", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "m"}], ")"}], "2"]}], "+", "N"}], 
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "m"}], ")"}], "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "N"}], ")"}]}]]}]],
  CellChangeTimes->{
   3.916995038374185*^9, 3.91699513183324*^9, {3.916995166521688*^9, 
    3.9169951901365023`*^9}, 3.916995241138644*^9, {3.916995275123004*^9, 
    3.9169952871546173`*^9}, 3.917008717942792*^9},ExpressionUUID->
  "ebca0b4a-6f62-46bf-838c-67d3a81dc540"],
 ". Signalling is favoured when the left-hand side is greater than the \
right-hand side. This is Equation K9 in the SI."
}], "Text",
 CellChangeTimes->{{3.915176101958577*^9, 3.915176179387744*^9}, {
  3.915176229291583*^9, 3.915176243005365*^9}, {3.915177406063599*^9, 
  3.915177410206997*^9}, {3.915177643831272*^9, 3.915177649866047*^9}, {
  3.916925020263899*^9, 3.91692502865641*^9}, {3.91692516531522*^9, 
  3.916925175033794*^9}, {3.9169252289730663`*^9, 3.916925243873952*^9}, {
  3.916925313939077*^9, 3.916925356059578*^9}, {3.9171704849487*^9, 
  3.917170560603078*^9}, {3.917170633368148*^9, 3.9171706348782043`*^9}, {
  3.917170678459549*^9, 
  3.9171707325913467`*^9}},ExpressionUUID->"395e4e00-c51e-43e5-ae18-\
b957467ab50a"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"TraditionalForm", "[", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{"margopenx", ">", "0"}], "]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"FullSimplify", "[", 
  RowBox[{"Solve", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"margopenx", "==", "0"}], "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        SuperscriptBox["y", "*"], "\[Rule]", 
        FractionBox[
         RowBox[{"c", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"g", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", "N"}], ")"}]}], "-", "N"}], ")"}], 
          " ", 
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", "m"}], ")"}], "2"], "-", "N", "+", 
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", "m"}], ")"}], "2"], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", "N"}], ")"}], " ", 
             SuperscriptBox["r", "*"]}]}], ")"}]}], 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "N"}], ")"}], " ", "s", " ", 
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", "m"}], ")"}], "2"], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "2"}], "+", "m"}], ")"}], " ", "m", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "1"}], "+", "N"}], ")"}]}]}], ")"}], " ", 
             SuperscriptBox["r", "*"]}]}], ")"}]}]]}], ",", 
       RowBox[{
        SuperscriptBox["z", "*"], "\[Rule]", 
        FractionBox[
         RowBox[{"p", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "d"}], "+", "s"}], ")"}]}], 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "p"}], ")"}], " ", "s"}]]}]}], "}"}]}], 
    ",", 
    SuperscriptBox["r", "*"]}], "]"}], "]"}]}], "Input",
 CellChangeTimes->{{3.9168192463935623`*^9, 3.916819258916613*^9}, {
   3.916819365377577*^9, 3.916819377273843*^9}, {3.916985544152729*^9, 
   3.916985562760304*^9}, {3.91699161642218*^9, 3.916991618562194*^9}, 
   3.916996149235955*^9, {3.916996240199279*^9, 3.916996242600165*^9}, {
   3.916996475756598*^9, 3.9169964767183228`*^9}, {3.9170876729214573`*^9, 
   3.9170876744957314`*^9}, {3.917087706992586*^9, 3.917087712197817*^9}, {
   3.917170740137535*^9, 3.917170740342331*^9}},
 CellLabel->"In[55]:=",ExpressionUUID->"9df08afd-28a0-401e-a22f-da7d2b3f85e2"],

Cell[BoxData[
 FormBox[
  RowBox[{
   RowBox[{"N", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SuperscriptBox["x", "*"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"c", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"g", "-", "1"}], ")"}], " ", "N"}], "-", "g"}], ")"}], 
          " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"p", "-", "1"}], ")"}], " ", 
             SuperscriptBox["z", "*"]}], "-", "p"}], ")"}]}], "-", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"N", "-", "1"}], ")"}], " ", 
          SuperscriptBox["y", "*"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"p", " ", 
             RowBox[{"(", 
              RowBox[{"d", "-", "s"}], ")"}]}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"p", "-", "1"}], ")"}], " ", "s", " ", 
             SuperscriptBox["z", "*"]}]}], ")"}]}]}], ")"}]}], "+", 
      RowBox[{"N", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"d", " ", "p"}], "-", "1"}], ")"}]}]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"N", "-", "1"}], ")"}], " ", 
       SuperscriptBox["r", "*"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"c", " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"m", "-", "1"}], ")"}], "2"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"g", "-", "1"}], ")"}], " ", "N"}], "-", "g"}], ")"}], 
          " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"p", "-", "1"}], ")"}], " ", 
             SuperscriptBox["z", "*"]}], "-", "p"}], ")"}]}], "-", 
         RowBox[{
          SuperscriptBox["y", "*"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"m", "-", "2"}], ")"}], " ", "m", " ", 
             RowBox[{"(", 
              RowBox[{"N", "-", "1"}], ")"}]}], "-", "1"}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"p", " ", 
             RowBox[{"(", 
              RowBox[{"d", "-", "s"}], ")"}]}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"p", "-", "1"}], ")"}], " ", "s", " ", 
             SuperscriptBox["z", "*"]}]}], ")"}]}]}], ")"}]}], "+", 
      RowBox[{"c", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"g", "-", "1"}], ")"}], " ", "N"}], "-", "g"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"m", "-", "1"}], ")"}], "2"], "-", "N"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"p", "-", "1"}], ")"}], " ", 
          SuperscriptBox["z", "*"]}], "-", "p"}], ")"}]}], "-", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"m", "-", "1"}], ")"}], "2"], " ", 
        RowBox[{"(", 
         RowBox[{"N", "-", "1"}], ")"}], " ", 
        SuperscriptBox["y", "*"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"p", " ", 
           RowBox[{"(", 
            RowBox[{"d", "-", "s"}], ")"}]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"p", "-", "1"}], ")"}], " ", "s", " ", 
           SuperscriptBox["z", "*"]}]}], ")"}]}], ")"}]}], ")"}]}], "<", 
   "0"}], TraditionalForm]], "Output",
 CellChangeTimes->{
  3.91681932997968*^9, {3.9168193708872013`*^9, 3.916819377676259*^9}, 
   3.9169242352947397`*^9, 3.9169855635265627`*^9, 3.916991618814695*^9, {
   3.916996237806885*^9, 3.916996264204488*^9}, 3.916996479619976*^9, 
   3.917008752247363*^9, 3.917008806073615*^9, 3.917085251826428*^9, {
   3.917087677034753*^9, 3.917087712496573*^9}, 3.917170133663301*^9, 
   3.9171704903139467`*^9, 3.917170752027505*^9},
 CellLabel->
  "Out[55]//TraditionalForm=",ExpressionUUID->"9af3ccf8-bac0-4b04-a1a7-\
8210241a1619"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    SuperscriptBox["r", "*"], "\[Rule]", 
    FractionBox[
     RowBox[{
      RowBox[{"-", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "m"}], ")"}], "2"]}], "+", "N"}], 
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "m"}], ")"}], "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "N"}], ")"}]}]]}], "}"}], "}"}]], "Output",
 CellChangeTimes->{
  3.91681932997968*^9, {3.9168193708872013`*^9, 3.916819377676259*^9}, 
   3.9169242352947397`*^9, 3.9169855635265627`*^9, 3.916991618814695*^9, {
   3.916996237806885*^9, 3.916996264204488*^9}, 3.916996479619976*^9, 
   3.917008752247363*^9, 3.917008806073615*^9, 3.917085251826428*^9, {
   3.917087677034753*^9, 3.917087712496573*^9}, 3.917170133663301*^9, 
   3.9171704903139467`*^9, 3.917170752040971*^9},
 CellLabel->"Out[56]=",ExpressionUUID->"0611d43e-4732-4737-863b-e81cca3ee3b1"]
}, Open  ]],

Cell[TextData[{
 "We \[OpenCurlyQuote]close\[CloseCurlyQuote] the model by substituting our \
explicit value for r* into our condition for signalling being favoured, ",
 Cell[BoxData[
  RowBox[{
   SuperscriptBox["r", "*"], ">", 
   FractionBox[
    RowBox[{
     RowBox[{"-", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "m"}], ")"}], "2"]}], "+", "N"}], 
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "m"}], ")"}], "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "N"}], ")"}]}]]}]],
  CellChangeTimes->{
   3.91681932997968*^9, {3.9168193708872013`*^9, 3.916819377676259*^9}, 
    3.9169242352947397`*^9, 3.9169855635265627`*^9, 3.916991618814695*^9, {
    3.916996237806885*^9, 3.916996264204488*^9}, 3.916996479619976*^9, 
    3.917008752247363*^9, 3.917008806073615*^9, 3.917085251826428*^9, {
    3.917087677034753*^9, 3.917087712496573*^9}, 3.917170133663301*^9, 
    3.9171704903139467`*^9, 3.917170752040971*^9},ExpressionUUID->
  "803be208-a28a-4e16-ac99-b7da2a55efd5"],
 ". We obtain ",
 Cell[BoxData[
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "2"}], "+", "m"}], ")"}], " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "m"}], ")"}], "2"], " ", "m", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "2"}], "+", "m"}], ")"}], " ", "m", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "N"}], ")"}]}]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "N"}], ")"}], " ", 
    SuperscriptBox["N", "2"]}], "<", "0"}]],
  CellChangeTimes->{{3.917170900635763*^9, 3.917170908543838*^9}},
  ExpressionUUID->"378102a6-fbaa-4909-8548-d0fecf0ca0e0"],
 ", which is never satisfied, meaning signalling is not favoured in the \
closed version of the model."
}], "Text",
 CellChangeTimes->{{3.915176441285725*^9, 3.915176587713168*^9}, {
  3.915177463317815*^9, 3.9151774714126167`*^9}, {3.915201893168091*^9, 
  3.915201894284738*^9}, {3.915202007544639*^9, 3.9152020082622538`*^9}, {
  3.916995439095326*^9, 3.91699545870647*^9}, {3.9169967026784773`*^9, 
  3.916996704556098*^9}, {3.916997001048623*^9, 3.9169970386335917`*^9}, {
  3.91715868016183*^9, 3.917158685351819*^9}, {3.917170783286191*^9, 
  3.917170856787763*^9}, {3.917170916695551*^9, 
  3.9171709297921753`*^9}},ExpressionUUID->"0de5a5ef-4c88-4ef5-9255-\
1a2c10ad59b9"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"FullSimplify", "[", 
  RowBox[{
   RowBox[{
    SuperscriptBox["r", "*"], ">", 
    FractionBox[
     RowBox[{
      RowBox[{"-", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "m"}], ")"}], "2"]}], "+", "N"}], 
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "m"}], ")"}], "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "N"}], ")"}]}]]}], "/.", 
   RowBox[{"{", 
    RowBox[{
     SuperscriptBox["r", "*"], "->", 
     RowBox[{"1", "/", 
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"m", "-", "2"}], ")"}], " ", "m", " ", "N"}], ")"}], "/", 
         
         RowBox[{
          RowBox[{"(", 
           RowBox[{"m", "-", "1"}], ")"}], "^", "2"}]}]}], ")"}]}]}], "}"}]}],
   "]"}]], "Input",
 CellChangeTimes->{{3.917170864224873*^9, 3.9171708669725523`*^9}, {
  3.9171708981356173`*^9, 3.917170908292357*^9}},
 CellLabel->"In[58]:=",ExpressionUUID->"6a9bee47-550a-4b1e-b773-b5da4b1b9377"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "2"}], "+", "m"}], ")"}], " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "m"}], ")"}], "2"], " ", "m", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "2"}], "+", "m"}], ")"}], " ", "m", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "N"}], ")"}]}]}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "+", "N"}], ")"}], " ", 
   SuperscriptBox["N", "2"]}], "<", "0"}]], "Output",
 CellChangeTimes->{{3.917170900635763*^9, 3.917170908543838*^9}},
 CellLabel->"Out[58]=",ExpressionUUID->"794ece65-22b5-45fe-b3af-1dc26f04aa83"]
}, Open  ]]
}, Closed]]
},
WindowSize->{Full, Full},
WindowMargins->{{12, Automatic}, {Automatic, 0}},
TaggingRules-><|"TryRealOnly" -> False|>,
FrontEndVersion->"13.1 for Mac OS X ARM (64-bit) (June 16, 2022)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"fe364b21-cd01-4d22-9d08-47abc9c99cc7"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 624, 11, 35, "Text",ExpressionUUID->"685cb5ce-8020-48ce-96b9-a75886698576"],
Cell[CellGroupData[{
Cell[1207, 35, 384, 7, 67, "Section",ExpressionUUID->"eef3e3db-99f7-470a-892d-dcbb5b19ef05"],
Cell[1594, 44, 356, 7, 35, "Text",ExpressionUUID->"45d5df5b-96cb-462e-9b49-9c92bba9c003"],
Cell[1953, 53, 3136, 86, 116, "Input",ExpressionUUID->"6ab4c242-b49a-4fa1-ae28-0ce77f725fde"],
Cell[5092, 141, 614, 10, 58, "Text",ExpressionUUID->"9bb87755-b4bb-4c9f-b40f-dfb9b9707cb4"],
Cell[CellGroupData[{
Cell[5731, 155, 840, 23, 52, "Input",ExpressionUUID->"24bf0ab3-3e66-438b-8020-e04921876f38"],
Cell[6574, 180, 1274, 40, 67, "Output",ExpressionUUID->"6383fd44-a9e5-4112-b386-6fa8931f4bf1"]
}, Open  ]],
Cell[7863, 223, 664, 12, 58, "Text",ExpressionUUID->"d05b3397-2c4e-443c-8583-32f09e2bcb9b"],
Cell[CellGroupData[{
Cell[8552, 239, 1125, 24, 30, "Input",ExpressionUUID->"a3605713-800e-4336-b1c7-0e4a604a5416"],
Cell[9680, 265, 1179, 38, 67, "Output",ExpressionUUID->"61cb4931-f527-4816-80a5-f4b81907a40e"]
}, Open  ]],
Cell[10874, 306, 615, 10, 58, "Text",ExpressionUUID->"f25a8219-dcda-4207-b4eb-94d684749939"],
Cell[CellGroupData[{
Cell[11514, 320, 710, 15, 30, "Input",ExpressionUUID->"05008782-7791-4357-a2a3-c1f9668e81c2"],
Cell[12227, 337, 1319, 42, 67, "Output",ExpressionUUID->"880ea228-91a1-43e5-b898-e636ecec134b"]
}, Open  ]],
Cell[13561, 382, 731, 12, 58, "Text",ExpressionUUID->"1c5fee6b-d001-4e42-9b27-a5410b7e9ee9"],
Cell[CellGroupData[{
Cell[14317, 398, 324, 7, 30, "Input",ExpressionUUID->"f73cbbdf-8f71-4505-a6c5-5fd2c217c1cd"],
Cell[14644, 407, 755, 24, 46, "Output",ExpressionUUID->"daf1c169-d624-4fc7-b42f-09c0d30380e4"]
}, Open  ]],
Cell[15414, 434, 1726, 34, 101, "Text",ExpressionUUID->"6a37b233-19a5-434c-a5a3-b4d6384a34e0"],
Cell[CellGroupData[{
Cell[17165, 472, 1042, 29, 30, "Input",ExpressionUUID->"501e4be6-f164-4fcd-81f3-e5b1586b63ad"],
Cell[18210, 503, 1492, 46, 67, "Output",ExpressionUUID->"c74482c2-af46-46cc-b40d-ebbf6bdb177a"]
}, Open  ]],
Cell[19717, 552, 610, 11, 58, "Text",ExpressionUUID->"3766a80a-e8dd-4ce5-86a6-6c26e8d93045"],
Cell[CellGroupData[{
Cell[20352, 567, 768, 13, 30, "Input",ExpressionUUID->"6d5f0305-1b66-4d15-a0f2-8af35835d611"],
Cell[21123, 582, 1154, 30, 44, "Output",ExpressionUUID->"1810a375-bb6c-4e5d-824e-242a79bb193f"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[22326, 618, 342, 7, 53, "Section",ExpressionUUID->"aa1c85bd-0246-49e0-a27e-a25648c6e879"],
Cell[22671, 627, 356, 7, 35, "Text",ExpressionUUID->"f5580ae9-2638-4cb4-a379-650590143669"],
Cell[23030, 636, 5991, 164, 222, "Input",ExpressionUUID->"a21b650b-5cbd-4bbc-a541-202c40a61cec"],
Cell[29024, 802, 614, 10, 58, "Text",ExpressionUUID->"a96f95d9-564e-4b5c-a70a-9626482de7a4"],
Cell[CellGroupData[{
Cell[29663, 816, 844, 23, 52, "Input",ExpressionUUID->"d67c21ef-3a92-4094-98b7-603032d7a27a"],
Cell[30510, 841, 1610, 52, 71, "Output",ExpressionUUID->"d8132f1b-f481-437c-8a76-ce87f505546f"]
}, Open  ]],
Cell[32135, 896, 662, 12, 58, "Text",ExpressionUUID->"7bb8876d-2031-40ad-a1c5-a0990cd0c3f0"],
Cell[CellGroupData[{
Cell[32822, 912, 1122, 24, 30, "Input",ExpressionUUID->"0f5499f3-9efa-4849-83aa-c55b74d53ebc"],
Cell[33947, 938, 1732, 54, 71, "Output",ExpressionUUID->"a68c5607-8ca1-4bf1-9d5c-658025ae041b"]
}, Open  ]],
Cell[35694, 995, 612, 10, 58, "Text",ExpressionUUID->"1d642f2c-5c9d-4bb4-8ac9-93d16e2e2944"],
Cell[CellGroupData[{
Cell[36331, 1009, 714, 15, 30, "Input",ExpressionUUID->"49378176-ba94-42c9-b7eb-d34187383634"],
Cell[37048, 1026, 2583, 82, 71, "Output",ExpressionUUID->"7079c320-d6c9-460d-a05e-cdddd8fc12ec"]
}, Open  ]],
Cell[39646, 1111, 765, 12, 58, "Text",ExpressionUUID->"814091cb-f6e2-4a7e-940b-e6b192478abe"],
Cell[CellGroupData[{
Cell[40436, 1127, 1318, 25, 52, "Input",ExpressionUUID->"29864960-ef33-4814-bb7b-347be41625c6"],
Cell[41757, 1154, 1968, 51, 67, "Output",ExpressionUUID->"51c91f0e-bba8-4de5-acdc-422a357863c6"],
Cell[43728, 1207, 1455, 34, 46, "Output",ExpressionUUID->"db3a11b4-27f7-446b-a939-d3b74c0219e9"]
}, Open  ]],
Cell[45198, 1244, 1319, 28, 63, "Text",ExpressionUUID->"53ef27b6-ade9-45ec-ab9d-3668546edfd1"],
Cell[CellGroupData[{
Cell[46542, 1276, 1042, 23, 52, "Input",ExpressionUUID->"de382b43-3f17-4a3a-9c8e-9108952c42cc"],
Cell[47587, 1301, 1178, 35, 67, "Output",ExpressionUUID->"955c8e22-1fa2-439b-9706-b6714032e025"],
Cell[48768, 1338, 821, 24, 66, "Output",ExpressionUUID->"96051983-0782-4a0d-894b-e85956f00ec8"]
}, Open  ]],
Cell[49604, 1365, 1676, 33, 101, "Text",ExpressionUUID->"5ebf40e9-1778-43c5-be7a-7405ac196882"],
Cell[CellGroupData[{
Cell[51305, 1402, 993, 28, 30, "Input",ExpressionUUID->"ea10e739-a763-45e3-b542-84d1f16d9f27"],
Cell[52301, 1432, 1247, 40, 67, "Output",ExpressionUUID->"deeea19e-5d61-474a-91ff-0d66c8237132"]
}, Open  ]],
Cell[53563, 1475, 1070, 22, 43, "Text",ExpressionUUID->"7819eeb0-1f08-466f-b046-51cb1b22efc3"],
Cell[CellGroupData[{
Cell[54658, 1501, 770, 13, 30, "Input",ExpressionUUID->"8ffffd61-8406-434f-87f4-617d3d00c477"],
Cell[55431, 1516, 1023, 26, 64, "Output",ExpressionUUID->"1f08f3c4-5629-4ff9-83cd-98a6b72eda1f"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[56503, 1548, 439, 8, 53, "Section",ExpressionUUID->"040398a3-4a45-46e3-9cd1-865e1abed546"],
Cell[56945, 1558, 323, 6, 35, "Text",ExpressionUUID->"50c16f6b-77bd-401d-81a4-4ae4d681c945"],
Cell[57271, 1566, 3165, 87, 92, "Input",ExpressionUUID->"4104c392-96b6-4c29-ab36-52d0aba19d49"],
Cell[60439, 1655, 614, 10, 58, "Text",ExpressionUUID->"a952d5f5-de64-4dce-92fd-00031a61f240"],
Cell[CellGroupData[{
Cell[61078, 1669, 842, 23, 52, "Input",ExpressionUUID->"fe76039b-3638-4c90-808f-c65e0a2cc2e9"],
Cell[61923, 1694, 1298, 40, 67, "Output",ExpressionUUID->"e234d016-ba81-4bbf-85b8-5e3d847f19c6"]
}, Open  ]],
Cell[63236, 1737, 662, 12, 58, "Text",ExpressionUUID->"4c2c2ffb-e217-490f-8eb3-5e5f469f813c"],
Cell[CellGroupData[{
Cell[63923, 1753, 1124, 24, 30, "Input",ExpressionUUID->"90659cd5-c69b-42dc-8612-66b47068ad11"],
Cell[65050, 1779, 1222, 39, 67, "Output",ExpressionUUID->"93026e50-c110-484e-9ef4-baa984c17757"]
}, Open  ]],
Cell[66287, 1821, 615, 10, 58, "Text",ExpressionUUID->"cddfbd31-7bed-42b9-bcc7-cd4999122f0a"],
Cell[CellGroupData[{
Cell[66927, 1835, 660, 14, 30, "Input",ExpressionUUID->"0af63682-ff07-472f-86b3-c74d732ea5ea"],
Cell[67590, 1851, 1287, 42, 67, "Output",ExpressionUUID->"67982d37-1cd5-4429-a9b9-c50ef1fd809d"]
}, Open  ]],
Cell[68892, 1896, 878, 14, 58, "Text",ExpressionUUID->"30346f09-b0fa-4497-a9f2-d5ce3da08d84"],
Cell[CellGroupData[{
Cell[69795, 1914, 322, 7, 30, "Input",ExpressionUUID->"92a151a7-dca6-4277-b18f-2a6a59b34fc0"],
Cell[70120, 1923, 674, 21, 46, "Output",ExpressionUUID->"71875b7a-85b2-4fce-8edc-6183f9e1f4cc"]
}, Open  ]],
Cell[70809, 1947, 1725, 34, 101, "Text",ExpressionUUID->"9841d958-651f-40e3-8193-0acb8b57e09b"],
Cell[CellGroupData[{
Cell[72559, 1985, 993, 28, 30, "Input",ExpressionUUID->"9f8da327-e8ab-4d0b-9265-46ebb86d51ca"],
Cell[73555, 2015, 1561, 50, 67, "Output",ExpressionUUID->"69cc473f-1c3b-4c55-a837-fc02b045383a"]
}, Open  ]],
Cell[75131, 2068, 940, 15, 58, "Text",ExpressionUUID->"00d7ef1d-e8ae-44e1-8141-fd0e3cf02d64"],
Cell[CellGroupData[{
Cell[76096, 2087, 324, 7, 30, "Input",ExpressionUUID->"4a7206e0-0de6-4437-a6b8-70035634ac0c"],
Cell[76423, 2096, 707, 22, 44, "Output",ExpressionUUID->"d02061ca-5fbc-4d0e-a470-014304158daa"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[77179, 2124, 365, 7, 53, "Section",ExpressionUUID->"5e6dbf40-4a8f-4fe4-93ed-1ed86cbee34d"],
Cell[77547, 2133, 304, 6, 35, "Text",ExpressionUUID->"179394d0-db8a-43a2-8181-6dfaa582789e"],
Cell[77854, 2141, 5886, 168, 200, "Input",ExpressionUUID->"c9b86c00-c65a-4e56-9b5f-c789e091a106"],
Cell[83743, 2311, 614, 10, 58, "Text",ExpressionUUID->"725accf9-794f-475c-b7b9-29ca28733c18"],
Cell[CellGroupData[{
Cell[84382, 2325, 841, 23, 52, "Input",ExpressionUUID->"c4be2823-9b43-489e-80e0-b90c9ed5ef61"],
Cell[85226, 2350, 1767, 56, 71, "Output",ExpressionUUID->"37802015-4885-4194-91c1-28c0653d234c"]
}, Open  ]],
Cell[87008, 2409, 662, 12, 58, "Text",ExpressionUUID->"d8f09699-d5da-46db-bba5-ad240c940a93"],
Cell[CellGroupData[{
Cell[87695, 2425, 1128, 24, 30, "Input",ExpressionUUID->"adc28761-8fbb-4d25-b2d6-06cc58d79bc4"],
Cell[88826, 2451, 1897, 59, 71, "Output",ExpressionUUID->"4c25de8b-843b-406e-9eca-d08eed543b94"]
}, Open  ]],
Cell[90738, 2513, 613, 10, 58, "Text",ExpressionUUID->"4b7fc4aa-a658-49b6-8cca-d93440e90155"],
Cell[CellGroupData[{
Cell[91376, 2527, 660, 14, 30, "Input",ExpressionUUID->"0225feb0-71ca-4190-b536-c9cbee7cacb3"],
Cell[92039, 2543, 2680, 86, 71, "Output",ExpressionUUID->"5a569d19-da13-4fda-9056-95e67b2cd310"]
}, Open  ]],
Cell[94734, 2632, 1866, 39, 66, "Text",ExpressionUUID->"f9e653d0-4271-46db-8c5f-f52d1960fd8e"],
Cell[CellGroupData[{
Cell[96625, 2675, 1265, 24, 52, "Input",ExpressionUUID->"64b5d706-b0a7-4a82-bf91-c0e42723d69e"],
Cell[97893, 2701, 1803, 47, 67, "Output",ExpressionUUID->"d8b03890-cb79-4e63-a00c-78ffd7f4d541"],
Cell[99699, 2750, 1858, 48, 66, "Output",ExpressionUUID->"3b6b8d4d-63f3-4f66-aedb-64411c336881"]
}, Closed]],
Cell[101572, 2801, 928, 15, 54, "Text",ExpressionUUID->"55c2aa31-f5bf-43bb-bb55-1c34a3a80b43"],
Cell[CellGroupData[{
Cell[102525, 2820, 647, 14, 30, "Input",ExpressionUUID->"677d8d81-1c11-4a10-8af1-2befe2e38179"],
Cell[103175, 2836, 672, 21, 46, "Output",ExpressionUUID->"9916b4d4-0fe1-479a-9f2e-e4acc7849823"]
}, Open  ]],
Cell[103862, 2860, 1674, 33, 101, "Text",ExpressionUUID->"896dd8e5-f168-4eb7-ab14-135cb5ea234b"],
Cell[CellGroupData[{
Cell[105561, 2897, 995, 28, 30, "Input",ExpressionUUID->"9cac7589-1abc-41d4-8acb-6f3b95750918"],
Cell[106559, 2927, 1453, 46, 67, "Output",ExpressionUUID->"f0aa47be-5fba-4d80-b4bb-b323efdc45b7"]
}, Open  ]],
Cell[108027, 2976, 1044, 21, 43, "Text",ExpressionUUID->"e1479d8b-1cd7-4569-aa43-c1acec44fa44"],
Cell[CellGroupData[{
Cell[109096, 3001, 697, 12, 30, "Input",ExpressionUUID->"298abba8-bee2-4107-bcf1-5eee032e0b0d"],
Cell[109796, 3015, 1049, 27, 64, "Output",ExpressionUUID->"07a369d1-d046-47d3-a957-ba8ecc5f0047"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[110894, 3048, 574, 10, 53, "Section",ExpressionUUID->"600d8c9a-9480-4c1c-94b8-ccb9d1a53acb"],
Cell[111471, 3060, 453, 8, 35, "Text",ExpressionUUID->"52096bc2-8450-4cc3-ab49-055ac6c35be8"],
Cell[111927, 3070, 4551, 133, 230, "Input",ExpressionUUID->"d743a551-f29e-461f-98d6-9dce6216e767"],
Cell[116481, 3205, 1203, 19, 81, "Text",ExpressionUUID->"fce3e85e-8fb1-496d-a817-8d857d339c45"],
Cell[CellGroupData[{
Cell[117709, 3228, 3594, 98, 136, "Input",ExpressionUUID->"eb4e5a5e-1e19-473b-85b6-9bb00a5dd6e2"],
Cell[121306, 3328, 2946, 80, 67, "Output",ExpressionUUID->"646e24bb-5936-4654-8fd2-4c50464e25b5"],
Cell[124255, 3410, 2945, 80, 67, "Output",ExpressionUUID->"5d527c82-56bd-448a-a37c-87269021a042"],
Cell[127203, 3492, 2947, 80, 67, "Output",ExpressionUUID->"1efdaae0-ec8f-4749-9b98-24edd7aa4d29"]
}, Open  ]],
Cell[130165, 3575, 1235, 19, 81, "Text",ExpressionUUID->"ae18ee5f-537b-42c2-986a-fcb68167ff09"],
Cell[CellGroupData[{
Cell[131425, 3598, 3434, 89, 73, "Input",ExpressionUUID->"39673324-5332-4b28-ad78-d5381040ef45"],
Cell[134862, 3689, 2950, 81, 67, "Output",ExpressionUUID->"a9d2faf8-51a9-474a-9470-6c79f88ff4ed"],
Cell[137815, 3772, 2569, 67, 70, "Output",ExpressionUUID->"3161d497-ae08-40ca-93bf-2032ba97a920"],
Cell[140387, 3841, 2654, 70, 67, "Output",ExpressionUUID->"403d3a08-6444-405c-a41f-98a3494e38a2"]
}, Open  ]],
Cell[143056, 3914, 880, 14, 81, "Text",ExpressionUUID->"b72be7b4-4cfd-417f-ab29-81581f670046"],
Cell[CellGroupData[{
Cell[143961, 3932, 1228, 28, 73, "Input",ExpressionUUID->"6f7794fb-7f9c-466e-be51-fe277bb00d5c"],
Cell[145192, 3962, 2971, 84, 67, "Output",ExpressionUUID->"79f86600-add3-4bf0-a438-de161778c5d0"],
Cell[148166, 4048, 2597, 70, 70, "Output",ExpressionUUID->"2198b3ca-b497-49f0-b3ca-3a8bca4d935f"],
Cell[150766, 4120, 2607, 72, 67, "Output",ExpressionUUID->"de7ec33f-680e-4c9c-bff8-29dcc7bed96e"]
}, Open  ]],
Cell[153388, 4195, 1130, 27, 41, "Text",ExpressionUUID->"1a512985-5fff-4041-a9e5-e702c66675a1"],
Cell[CellGroupData[{
Cell[154543, 4226, 452, 10, 30, "Input",ExpressionUUID->"d009c62b-bb35-4c68-8c74-a52f0bfa684f"],
Cell[154998, 4238, 559, 13, 50, "Output",ExpressionUUID->"89008f56-d965-46f4-965a-d9a5d7c5e00a"]
}, Open  ]],
Cell[155572, 4254, 961, 26, 45, "Text",ExpressionUUID->"5cbbf18a-a18d-4401-b02e-f9ebee2fa215"],
Cell[CellGroupData[{
Cell[156558, 4284, 472, 9, 30, "Input",ExpressionUUID->"ecb3cc8e-1fe9-4b11-b343-64bab0747cda"],
Cell[157033, 4295, 624, 18, 53, "Output",ExpressionUUID->"5cf877e0-4dd1-4ea3-a9f0-40c74da97446"]
}, Open  ]],
Cell[157672, 4316, 3576, 97, 82, "Text",ExpressionUUID->"53748a7d-4843-43f4-bcd1-a786586ca1bf"],
Cell[CellGroupData[{
Cell[161273, 4417, 1292, 34, 75, "Input",ExpressionUUID->"f5948c10-ce5e-4680-9bd2-81685c03947d"],
Cell[162568, 4453, 1235, 36, 53, "Output",ExpressionUUID->"50e20c20-2735-41cc-aae5-7e30b9d3853c"],
Cell[163806, 4491, 1173, 34, 53, "Output",ExpressionUUID->"da8cd3e6-23b0-44e2-9992-e36407a2862f"]
}, Open  ]],
Cell[164994, 4528, 611, 10, 35, "Text",ExpressionUUID->"92d4765b-5a60-47c4-bae9-bdd20646c8da"]
}, Closed]],
Cell[CellGroupData[{
Cell[165642, 4543, 625, 11, 53, "Section",ExpressionUUID->"b6ebd33b-1ca5-453f-bd09-41f0e66e202f"],
Cell[166270, 4556, 558, 10, 35, "Text",ExpressionUUID->"41eb204a-abc1-4ef2-8090-823f031e2b81"],
Cell[166831, 4568, 6291, 189, 292, "Input",ExpressionUUID->"2a4fb119-634d-42e6-ada1-22d7b7884096"],
Cell[173125, 4759, 1201, 19, 81, "Text",ExpressionUUID->"6061d38e-9f3e-478f-afab-95501fdd65c9"],
Cell[CellGroupData[{
Cell[174351, 4782, 3595, 98, 136, "Input",ExpressionUUID->"7644ce82-8180-466f-8a3c-0b55c7d17920"],
Cell[177949, 4882, 3181, 87, 71, "Output",ExpressionUUID->"56f9cc37-4f7c-42a8-ae4b-0dbc7c99e14e"],
Cell[181133, 4971, 3183, 87, 71, "Output",ExpressionUUID->"e8a47e08-4831-4e2d-baff-5d884c51d72f"],
Cell[184319, 5060, 3185, 87, 71, "Output",ExpressionUUID->"4cd2d468-a713-4ebd-b122-12889452afb9"]
}, Open  ]],
Cell[187519, 5150, 1234, 19, 81, "Text",ExpressionUUID->"26feaadb-42c4-4ba1-a5b8-9055876ffc4c"],
Cell[CellGroupData[{
Cell[188778, 5173, 3434, 89, 73, "Input",ExpressionUUID->"701e2b4a-563e-4289-91c9-9f9b2e1e0961"],
Cell[192215, 5264, 3350, 92, 71, "Output",ExpressionUUID->"01f965a7-2db8-4038-8b35-de244633f366"],
Cell[195568, 5358, 2732, 71, 70, "Output",ExpressionUUID->"f7e83af6-faa6-415d-a2b8-70fbb70abca2"],
Cell[198303, 5431, 3112, 83, 71, "Output",ExpressionUUID->"071083a2-b4f1-4084-ad00-67c66a153e95"]
}, Open  ]],
Cell[201430, 5517, 904, 14, 81, "Text",ExpressionUUID->"9a454de3-d58e-408b-801a-4867065fda69"],
Cell[CellGroupData[{
Cell[202359, 5535, 1232, 28, 73, "Input",ExpressionUUID->"4d208711-404e-4bec-88cb-ace1bb82c375"],
Cell[203594, 5565, 4462, 129, 71, "Output",ExpressionUUID->"95ef06dd-e99e-45de-9efb-4f48f5351a13"],
Cell[208059, 5696, 2966, 81, 71, "Output",ExpressionUUID->"325a5e5d-2492-4740-9ba8-53db41f6030e"],
Cell[211028, 5779, 3767, 105, 71, "Output",ExpressionUUID->"b7922126-c52d-4587-8313-5f747a7c8386"]
}, Open  ]],
Cell[214810, 5887, 2049, 61, 54, "Text",ExpressionUUID->"ec472916-8991-4cfd-9480-c889a7587422"],
Cell[CellGroupData[{
Cell[216884, 5952, 260, 6, 30, "Input",ExpressionUUID->"f807c18f-1aea-4185-90c3-6023ceb08b07"],
Cell[217147, 5960, 1616, 51, 61, "Output",ExpressionUUID->"e72bef48-35de-479a-8fd2-36db446cab53"]
}, Open  ]],
Cell[218778, 6014, 962, 26, 45, "Text",ExpressionUUID->"e8c2e3ce-9ce9-4884-b6ea-ac58a9283ee5"],
Cell[CellGroupData[{
Cell[219765, 6044, 260, 6, 30, "Input",ExpressionUUID->"af0c4b2a-8a0a-4854-847d-9a3d80d443b8"],
Cell[220028, 6052, 486, 16, 53, "Output",ExpressionUUID->"7e4fd52a-eca0-4417-a24e-e4c4777cec7b"]
}, Open  ]],
Cell[220529, 6071, 2025, 50, 70, "Text",ExpressionUUID->"395e4e00-c51e-43e5-ae18-b957467ab50a"],
Cell[CellGroupData[{
Cell[222579, 6125, 2928, 79, 84, "Input",ExpressionUUID->"9df08afd-28a0-401e-a22f-da7d2b3f85e2"],
Cell[225510, 6206, 4260, 126, 54, "Output",ExpressionUUID->"9af3ccf8-bac0-4b04-a1a7-8210241a1619"],
Cell[229773, 6334, 1038, 27, 57, "Output",ExpressionUUID->"0611d43e-4732-4737-863b-e81cca3ee3b1"]
}, Open  ]],
Cell[230826, 6364, 2597, 67, 70, "Text",ExpressionUUID->"0de5a5ef-4c88-4ef5-9255-1a2c10ad59b9"],
Cell[CellGroupData[{
Cell[233448, 6435, 1166, 38, 55, "Input",ExpressionUUID->"6a9bee47-550a-4b1e-b773-b5da4b1b9377"],
Cell[234617, 6475, 785, 25, 34, "Output",ExpressionUUID->"794ece65-22b5-45fe-b3af-1dc26f04aa83"]
}, Open  ]]
}, Closed]]
}
]
*)

