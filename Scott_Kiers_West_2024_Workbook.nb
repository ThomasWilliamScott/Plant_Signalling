(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    347895,       9140]
NotebookOptionsPosition[    325009,       8792]
NotebookOutlinePosition[    325445,       8809]
CellTagsIndexPosition[    325402,       8806]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell["\<\
This Mathematica document contains all calculations featured in the \
Supplementary Information for Scott, Kiers & West (PNAS, 2025).\
\>", "Text",
 CellChangeTimes->{{3.915174872147344*^9, 3.9151749078339043`*^9}, {
   3.915174958645629*^9, 3.915175096549225*^9}, {3.915175130288045*^9, 
   3.915175181350585*^9}, {3.915201691885071*^9, 3.9152016935524*^9}, {
   3.9152055858978157`*^9, 3.9152056717803307`*^9}, 3.916911375023654*^9, 
   3.9169114123168173`*^9, 3.9169114655729303`*^9, 3.916920964235355*^9, {
   3.916923840537129*^9, 3.916923841396008*^9}, {3.943002958642316*^9, 
   3.9430029610195312`*^9}, {3.9430029964620733`*^9, 
   3.943003003493787*^9}},ExpressionUUID->"685cb5ce-8020-48ce-96b9-\
a75886698576"],

Cell[CellGroupData[{

Cell["\<\
Models A & B) Signalling; migration after population regulation\
\>", "Section",
 CellChangeTimes->{{3.915174600364295*^9, 3.91517462569272*^9}, 
   3.91517466765668*^9, {3.915175186685773*^9, 3.915175197207159*^9}, {
   3.91517755046989*^9, 3.9151775509280024`*^9}, {3.915184515366377*^9, 
   3.915184552979945*^9}},ExpressionUUID->"eef3e3db-99f7-470a-892d-\
dcbb5b19ef05"],

Cell["\<\
Neighbour-modulated fitness for the focal individual (w) is written below. \
This is Equation A6 in the SI.\
\>", "Text",
 CellChangeTimes->{{3.9151752377757063`*^9, 3.915175259620417*^9}, {
  3.915175352890313*^9, 3.9151753593515577`*^9}, {3.915201719433642*^9, 
  3.915201720074353*^9}},ExpressionUUID->"45d5df5b-96cb-462e-9b49-\
9c92bba9c003"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"w", "=", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "-", 
       RowBox[{
        RowBox[{"(", 
         FractionBox["1", "N"], ")"}], 
        RowBox[{"(", 
         RowBox[{"d", "+", 
          RowBox[{"c", " ", "xfocal"}]}], ")"}]}], "-", 
       RowBox[{
        RowBox[{"(", 
         FractionBox[
          RowBox[{"N", "-", "1"}], "N"], ")"}], 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"d", 
           RowBox[{"(", 
            RowBox[{"1", "-", "xothers"}], ")"}]}], "+", 
          RowBox[{"c", " ", "xfocal", 
           RowBox[{"(", 
            RowBox[{"1", "-", "g"}], ")"}]}], "+", 
          RowBox[{"s", " ", "xothers"}]}], ")"}]}]}], ")"}], "/", 
     RowBox[{"(", 
      RowBox[{"1", "-", 
       RowBox[{
        RowBox[{"(", 
         FractionBox["1", "N"], ")"}], 
        RowBox[{"(", 
         RowBox[{"d", "+", 
          RowBox[{"c", " ", 
           RowBox[{"(", 
            RowBox[{
             FractionBox[
              RowBox[{"xothers", 
               RowBox[{"(", 
                RowBox[{"N", "-", "1"}], ")"}]}], "N"], "+", 
             FractionBox["xfocal", "N"]}], ")"}]}]}], ")"}]}], "-", 
       RowBox[{
        RowBox[{"(", 
         FractionBox[
          RowBox[{"N", "-", "1"}], "N"], ")"}], 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"d", 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"(", 
              RowBox[{
               FractionBox[
                RowBox[{"xothers", 
                 RowBox[{"(", 
                  RowBox[{"N", "-", "1"}], ")"}]}], "N"], "+", 
               FractionBox["xfocal", "N"]}], ")"}]}], ")"}]}], "+", 
          RowBox[{"c", " ", 
           RowBox[{"(", 
            RowBox[{
             FractionBox[
              RowBox[{"xothers", 
               RowBox[{"(", 
                RowBox[{"N", "-", "1"}], ")"}]}], "N"], "+", 
             FractionBox["xfocal", "N"]}], ")"}], 
           RowBox[{"(", 
            RowBox[{"1", "-", "g"}], ")"}]}], "+", 
          RowBox[{"s", " ", 
           RowBox[{"(", 
            RowBox[{
             FractionBox[
              RowBox[{"xothers", 
               RowBox[{"(", 
                RowBox[{"N", "-", "1"}], ")"}]}], "N"], "+", 
             FractionBox["xfocal", "N"]}], ")"}]}]}], ")"}]}]}], ")"}]}]}], 
   ";"}], "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.908103877779798*^9, 3.9081039368551617`*^9}, {
   3.9082687020329027`*^9, 3.908268859066394*^9}, {3.908269883914235*^9, 
   3.908269920730289*^9}, {3.908355862871335*^9, 3.908355902589114*^9}, {
   3.9108604899938927`*^9, 3.910860560580213*^9}, {3.9113770175862293`*^9, 
   3.911377066649146*^9}, {3.911391018117175*^9, 3.911391056891016*^9}, 
   3.915175265985262*^9, {3.915177560180121*^9, 3.9151775756131973`*^9}, {
   3.916902659559713*^9, 3.9169027418006277`*^9}, {3.916911375029875*^9, 
   3.916911375031365*^9}, {3.916911412321594*^9, 3.916911412327455*^9}, {
   3.916911465577889*^9, 3.9169114655840473`*^9}},
 CellLabel->
  "In[300]:=",ExpressionUUID->"6ab4c242-b49a-4fa1-ae28-0ce77f725fde"],

Cell["\<\
The derivative of focal individual fitness, with respect to the focal \
individual trait value, evaluated at monomorphic equilibrium, is written \
below (as -cm). Note that the \[OpenCurlyQuote]cm\[CloseCurlyQuote] notation \
is used to represent the \[OpenCurlyQuote]marginal cost\[CloseCurlyQuote] of \
Hamilton\[CloseCurlyQuote]s Rule. This is Equation A9 in the SI.\
\>", "Text",
 CellChangeTimes->{{3.915175733249536*^9, 3.915175737026534*^9}, {
  3.915175857656424*^9, 3.915175883915668*^9}, {3.915201785175893*^9, 
  3.915201785787332*^9}},ExpressionUUID->"9bb87755-b4bb-4c9f-b40f-\
dfb9b9707cb4"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"cm", "=", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{"D", "[", 
       RowBox[{"w", ",", "xfocal"}], "]"}]}], "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"xpop", "->", 
        SuperscriptBox["x", "*"]}], ",", 
       RowBox[{"xothers", "->", 
        SuperscriptBox["x", "*"]}], ",", 
       RowBox[{"xfocal", "->", 
        SuperscriptBox["x", "*"]}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"TraditionalForm", "[", 
  RowBox[{"-", "cm"}], "]"}]}], "Input",
 CellChangeTimes->{{3.915177161684618*^9, 3.9151771773356667`*^9}, {
   3.916911412328679*^9, 3.916911412330186*^9}, 3.916911465585104*^9, {
   3.916911608925912*^9, 3.916911695809928*^9}},
 CellLabel->
  "In[301]:=",ExpressionUUID->"24bf0ab3-3e66-438b-8020-e04921876f38"],

Cell[BoxData[
 FormBox[
  RowBox[{"-", 
   FractionBox[
    RowBox[{
     RowBox[{"(", 
      RowBox[{"N", "-", "1"}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"c", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"g", " ", 
           RowBox[{"(", 
            RowBox[{"-", "N"}], ")"}]}], "+", "g", "+", "N"}], ")"}]}], "+", 
       "d", "-", "s"}], ")"}]}], 
    RowBox[{"N", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        SuperscriptBox["x", "*"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"N", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"c", " ", "g"}], "-", "s"}], ")"}]}], "-", 
          RowBox[{"c", " ", 
           RowBox[{"(", 
            RowBox[{"g", "+", "N"}], ")"}]}], "+", 
          RowBox[{"d", " ", 
           RowBox[{"(", 
            RowBox[{"N", "-", "1"}], ")"}]}], "+", "s"}], ")"}]}], "-", 
       RowBox[{"d", " ", "N"}], "+", "N"}], ")"}]}]]}], 
  TraditionalForm]], "Output",
 CellChangeTimes->{
  3.916911580167145*^9, {3.916911678775997*^9, 3.916911696456108*^9}, 
   3.917003744512588*^9, 3.917006906962982*^9, 3.917167951855569*^9},
 CellLabel->
  "Out[302]//TraditionalForm=",ExpressionUUID->"6383fd44-a9e5-4112-b386-\
6fa8931f4bf1"]
}, Open  ]],

Cell["\<\
The derivative of focal individual fitness, with respect to the average trait \
value of other individuals on the deme, evaluated at monomorphic equilibrium, \
is written below. Note that the \[OpenCurlyQuote]bm\[CloseCurlyQuote] \
notation is used to represent the \[OpenCurlyQuote]marginal benefit\
\[CloseCurlyQuote] of Hamilton\[CloseCurlyQuote]s Rule. This is Equation A10 \
in the SI.\
\>", "Text",
 CellChangeTimes->{{3.915175418488715*^9, 3.915175518937564*^9}, 
   3.915175722238924*^9, {3.915175920186359*^9, 3.915175930914809*^9}, {
   3.915201863902808*^9, 3.9152018640063953`*^9}, 
   3.922169392447191*^9},ExpressionUUID->"d05b3397-2c4e-443c-8583-\
32f09e2bcb9b"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TraditionalForm", "[", 
  RowBox[{"bm", "=", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{"w", ",", "xothers"}], "]"}], "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"xpop", "->", 
        SuperscriptBox["x", "*"]}], ",", 
       RowBox[{"xothers", "->", 
        SuperscriptBox["x", "*"]}], ",", 
       RowBox[{"xfocal", "->", 
        SuperscriptBox["x", "*"]}]}], "}"}]}], "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.9081039414213743`*^9, 3.9081039435052147`*^9}, {
   3.90810406510456*^9, 3.908104073589612*^9}, {3.9081043026353397`*^9, 
   3.9081043339158287`*^9}, 3.908106925554028*^9, {3.911391003528234*^9, 
   3.9113910075287848`*^9}, {3.9115423725276537`*^9, 3.911542390599454*^9}, {
   3.915175399934017*^9, 3.915175400756152*^9}, 3.915175723845454*^9, {
   3.915177193413665*^9, 3.9151771935552893`*^9}, {3.9169114123325033`*^9, 
   3.91691141233325*^9}, {3.9169114655861692`*^9, 3.916911465586907*^9}, 
   3.916911634624299*^9, 3.916911726811151*^9},
 CellLabel->
  "In[303]:=",ExpressionUUID->"a3605713-800e-4336-b1c7-0e4a604a5416"],

Cell[BoxData[
 FormBox[
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{"N", "-", "1"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"c", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"g", " ", 
          RowBox[{"(", 
           RowBox[{"-", "N"}], ")"}]}], "+", "g", "+", "N"}], ")"}]}], "+", 
      "d", "-", "s"}], ")"}]}], 
   RowBox[{"N", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SuperscriptBox["x", "*"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"N", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"c", " ", "g"}], "-", "s"}], ")"}]}], "-", 
         RowBox[{"c", " ", 
          RowBox[{"(", 
           RowBox[{"g", "+", "N"}], ")"}]}], "+", 
         RowBox[{"d", " ", 
          RowBox[{"(", 
           RowBox[{"N", "-", "1"}], ")"}]}], "+", "s"}], ")"}]}], "-", 
      RowBox[{"d", " ", "N"}], "+", "N"}], ")"}]}]], 
  TraditionalForm]], "Output",
 CellChangeTimes->{3.916911729799966*^9, 3.9170037463383303`*^9, 
  3.9170069088756657`*^9, 3.917167953293294*^9},
 CellLabel->
  "Out[303]//TraditionalForm=",ExpressionUUID->"61cb4931-f527-4816-80a5-\
f4b81907a40e"]
}, Open  ]],

Cell["\<\
The overall marginal change in neighbour-modulated fitness associated with a \
slight change in behaviour is written below, on the (false) assumption that \
relatedness is a constant (open model). The \[OpenCurlyQuote]margopen\
\[CloseCurlyQuote] notation is used to represent the marginal fitness change, \
and the open model setting. This is Equation B1 in the SI.\
\>", "Text",
 CellChangeTimes->{{3.915175958153467*^9, 3.915176040877063*^9}, {
  3.915177227882449*^9, 3.9151773535121117`*^9}, {3.9152019626637087`*^9, 
  3.915201962719282*^9}},ExpressionUUID->"f25a8219-dcda-4207-b4eb-\
94d684749939"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TraditionalForm", "[", 
  RowBox[{"margopen", "=", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{
     RowBox[{
      SuperscriptBox["r", "*"], " ", "bm"}], " ", "-", " ", "cm"}], "]"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.9081044477104807`*^9, 3.908104459241107*^9}, {
   3.908104492639288*^9, 3.9081044941536303`*^9}, {3.9081051452016487`*^9, 
   3.90810514887316*^9}, {3.9151758222548037`*^9, 3.9151758368976316`*^9}, {
   3.915177197160902*^9, 3.9151772227977467`*^9}, 3.915177266100378*^9, {
   3.917003772170973*^9, 3.917003774002141*^9}, {3.917006895782506*^9, 
   3.917006902872171*^9}},
 CellLabel->
  "In[304]:=",ExpressionUUID->"05008782-7791-4357-a2a3-c1f9668e81c2"],

Cell[BoxData[
 FormBox[
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{"N", "-", "1"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["r", "*"], "-", "1"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"c", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"g", " ", 
          RowBox[{"(", 
           RowBox[{"-", "N"}], ")"}]}], "+", "g", "+", "N"}], ")"}]}], "+", 
      "d", "-", "s"}], ")"}]}], 
   RowBox[{"N", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SuperscriptBox["x", "*"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"N", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"c", " ", "g"}], "-", "s"}], ")"}]}], "-", 
         RowBox[{"c", " ", 
          RowBox[{"(", 
           RowBox[{"g", "+", "N"}], ")"}]}], "+", 
         RowBox[{"d", " ", 
          RowBox[{"(", 
           RowBox[{"N", "-", "1"}], ")"}]}], "+", "s"}], ")"}]}], "-", 
      RowBox[{"d", " ", "N"}], "+", "N"}], ")"}]}]], 
  TraditionalForm]], "Output",
 CellChangeTimes->{
  3.916911738010305*^9, {3.91700373625091*^9, 3.9170037483137836`*^9}, 
   3.9170037844905777`*^9, 3.9170069105025053`*^9, 3.917167955511587*^9},
 CellLabel->
  "Out[304]//TraditionalForm=",ExpressionUUID->"880ea228-91a1-43e5-b898-\
e636ecec134b"]
}, Open  ]],

Cell["\<\
We ask when a slight increase in the behaviour is favoured. To do so, we \
first set the selection differential to zero, to obtain s\[Rule]c (g \
(-N)+g+N)+d. We can see that the right hand side is always greater than the \
left hand side, meaning the selection differential is always negative, and so \
the behaviour is always disfavoured.\
\>", "Text",
 CellChangeTimes->{{3.915176101958577*^9, 3.915176179387744*^9}, {
  3.915176229291583*^9, 3.915176243005365*^9}, {3.915177406063599*^9, 
  3.915177410206997*^9}, {3.915177643831272*^9, 3.915177649866047*^9}, {
  3.9169118896083317`*^9, 3.916912048834888*^9}, {3.916921398024084*^9, 
  3.916921402210896*^9}},ExpressionUUID->"1c5fee6b-d001-4e42-9b27-\
a5410b7e9ee9"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TraditionalForm", "[", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{"Solve", "[", 
    RowBox[{"margopen", "==", "0"}], "]"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.916911791734164*^9, 3.9169118096452503`*^9}},
 CellLabel->
  "In[305]:=",ExpressionUUID->"f73cbbdf-8f71-4505-a6c5-5fd2c217c1cd"],

Cell[BoxData[
 FormBox[
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"N", "\[Rule]", "1"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"s", "\[Rule]", 
      RowBox[{
       RowBox[{"c", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"g", " ", 
           RowBox[{"(", 
            RowBox[{"-", "N"}], ")"}]}], "+", "g", "+", "N"}], ")"}]}], "+", 
       "d"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      SuperscriptBox["r", "*"], "\[Rule]", "1"}], "}"}]}], "}"}], 
  TraditionalForm]], "Output",
 CellChangeTimes->{3.9169118098629103`*^9, 3.9170037532184057`*^9, 
  3.917006915300378*^9, 3.917167957532297*^9},
 CellLabel->
  "Out[305]//TraditionalForm=",ExpressionUUID->"daf1c169-d624-4fc7-b42f-\
09c0d30380e4"]
}, Open  ]],

Cell[TextData[{
 "We now undertake the \[OpenCurlyQuote]closed model\[CloseCurlyQuote] \
analysis, where relatedness is not considered a constant, but is instead \
expressed in terms of model parameters. Relatedness is given by ",
 Cell[BoxData[
  FormBox[
   RowBox[{"r", "=", 
    FractionBox["1", 
     RowBox[{"1", "-", 
      FractionBox[
       RowBox[{
        RowBox[{"(", 
         RowBox[{"m", "-", "2"}], ")"}], " ", "m", " ", "N"}], 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"m", "-", "1"}], ")"}], "2"]]}]]}], TraditionalForm]],
  CellChangeTimes->{{3.910861979123197*^9, 3.9108619999508753`*^9}, {
    3.91086222963589*^9, 3.9108622426687517`*^9}, 3.910862460959608*^9, 
    3.9108626243521233`*^9, 3.9114609992207623`*^9, 3.911461049933278*^9, 
    3.911461104221305*^9, 3.9114637937132893`*^9, {3.9114638920883408`*^9, 
    3.9114638987610273`*^9}, {3.911464017519855*^9, 3.911464020308721*^9}, 
    3.911472250412627*^9, 3.911554645377158*^9},ExpressionUUID->
  "41f6f5ba-b23f-435a-a6be-0592fab3e2ba"],
 "(Equation A17). We therefore obtain the overall marginal change in \
neighbour-modulated fitness associated with a slight change in behaviour, on \
the (true) assumption that relatedness emerges from model parameters.  The \
\[OpenCurlyQuote]margclosed\[CloseCurlyQuote] notation is used to represent \
the marginal fitness change, and the closed model setting. This is Equation \
A18 in the SI. "
}], "Text",
 CellChangeTimes->{{3.915176441285725*^9, 3.915176587713168*^9}, {
  3.915177463317815*^9, 3.9151774714126167`*^9}, {3.915201893168091*^9, 
  3.915201894284738*^9}, {3.915202007544639*^9, 
  3.9152020082622538`*^9}},ExpressionUUID->"6a37b233-19a5-434c-a5a3-\
b4d6384a34e0"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TraditionalForm", "[", 
  RowBox[{"margclosed", "=", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       SuperscriptBox["r", "*"], " ", "bm"}], " ", "-", " ", "cm"}], "/.", 
     RowBox[{"{", 
      RowBox[{
       SuperscriptBox["r", "*"], "->", 
       RowBox[{"1", "/", 
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"m", "-", "2"}], ")"}], " ", "m", " ", "N"}], ")"}], 
           "/", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"m", "-", "1"}], ")"}], "^", "2"}]}]}], ")"}]}]}], 
      "}"}]}], "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.91517659618088*^9, 3.915176615645871*^9}, 
   3.915177444830543*^9, {3.915177479766621*^9, 3.915177481869033*^9}, {
   3.91700371130721*^9, 3.917003713024507*^9}, {3.917008545430057*^9, 
   3.917008555707427*^9}},
 CellLabel->
  "In[306]:=",ExpressionUUID->"501e4be6-f164-4fcd-81f3-e5b1586b63ad"],

Cell[BoxData[
 FormBox[
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{"m", "-", "2"}], ")"}], " ", "m", " ", 
    RowBox[{"(", 
     RowBox[{"N", "-", "1"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"c", " ", 
       RowBox[{"(", 
        RowBox[{"g", "-", "1"}], ")"}], " ", "N"}], "-", 
      RowBox[{"c", " ", "g"}], "-", "d", "+", "s"}], ")"}]}], 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"m", "-", "2"}], ")"}], " ", "m", " ", 
       RowBox[{"(", 
        RowBox[{"N", "-", "1"}], ")"}]}], "-", "1"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SuperscriptBox["x", "*"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"N", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"c", " ", "g"}], "-", "s"}], ")"}]}], "-", 
         RowBox[{"c", " ", 
          RowBox[{"(", 
           RowBox[{"g", "+", "N"}], ")"}]}], "+", 
         RowBox[{"d", " ", 
          RowBox[{"(", 
           RowBox[{"N", "-", "1"}], ")"}]}], "+", "s"}], ")"}]}], "-", 
      RowBox[{"d", " ", "N"}], "+", "N"}], ")"}]}]], 
  TraditionalForm]], "Output",
 CellChangeTimes->{
  3.9169121061689577`*^9, {3.9170037227399893`*^9, 3.917003724466658*^9}, 
   3.917003758054388*^9, 3.917004076921381*^9, 3.917004112438052*^9, 
   3.917006956026813*^9, 3.917167959540667*^9},
 CellLabel->
  "Out[306]//TraditionalForm=",ExpressionUUID->"c74482c2-af46-46cc-b40d-\
ebbf6bdb177a"]
}, Open  ]],

Cell["\<\
We ask when a slight increase in the behaviour is favoured. To do so, we \
first set the selection differential to zero, to obtain s\[Rule]c (g \
(-N)+g+N)+d, as we did for the open model setting, meaning the behaviour is \
disfavoured. The behaviour is favoured in neither the open nor closed model \
setting.\
\>", "Text",
 CellChangeTimes->{{3.9151769454838057`*^9, 3.9151769716502733`*^9}, {
  3.91517770399575*^9, 3.9151777276819963`*^9}, {3.9169121268830423`*^9, 
  3.916912182303183*^9}, {3.91692195367419*^9, 
  3.916921967125901*^9}},ExpressionUUID->"3766a80a-e8dd-4ce5-86a6-\
6c26e8d93045"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TraditionalForm", "[", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{"Solve", "[", 
    RowBox[{"margclosed", "==", "0"}], "]"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.91086262736821*^9, 3.910862678869877*^9}, 
   3.911472300688035*^9, {3.911472332014091*^9, 3.911472344399435*^9}, {
   3.911548186771056*^9, 3.911548189170001*^9}, 3.9115482347234707`*^9, {
   3.9115482852122593`*^9, 3.9115483160155067`*^9}, {3.915176872170781*^9, 
   3.9151769012207336`*^9}, {3.915177491578352*^9, 3.9151774916856956`*^9}, {
   3.91690359743087*^9, 3.916903621292493*^9}, 3.916911375063733*^9, 
   3.916911412338291*^9, {3.9169121376276073`*^9, 3.916912141157288*^9}},
 CellLabel->
  "In[307]:=",ExpressionUUID->"6d5f0305-1b66-4d15-a0f2-8af35835d611"],

Cell[BoxData[
 FormBox[
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"m", "\[Rule]", "0"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"m", "\[Rule]", "2"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"N", "\[Rule]", "1"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"s", "\[Rule]", 
      RowBox[{
       RowBox[{"c", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"g", " ", 
           RowBox[{"(", 
            RowBox[{"-", "N"}], ")"}]}], "+", "g", "+", "N"}], ")"}]}], "+", 
       "d"}]}], "}"}]}], "}"}], TraditionalForm]], "Output",
 CellChangeTimes->{
  3.910862634126298*^9, 3.910862679713876*^9, 3.911377178731172*^9, {
   3.911472315555702*^9, 3.911472345188623*^9}, 3.911548193938794*^9, 
   3.911548237122397*^9, {3.91154829494869*^9, 3.911548316947212*^9}, 
   3.9115546458318996`*^9, 3.9151769039327383`*^9, 3.915177492573509*^9, 
   3.915177527058111*^9, 3.9151777092089453`*^9, 3.915205744985972*^9, 
   3.9169036278410873`*^9, 3.916912141621896*^9, 3.917006958987402*^9, 
   3.9171679624357147`*^9},
 CellLabel->
  "Out[307]//TraditionalForm=",ExpressionUUID->"1810a375-bb6c-4e5d-824e-\
242a79bb193f"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
Models C & D) Signalling; migration before population regulation\
\>", "Section",
 CellChangeTimes->{{3.915174600364295*^9, 3.91517462569272*^9}, 
   3.91517466765668*^9, {3.915175186685773*^9, 3.915175197207159*^9}, {
   3.9151845315098667`*^9, 
   3.9151845554729557`*^9}},ExpressionUUID->"aa1c85bd-0246-49e0-a27e-\
a25648c6e879"],

Cell["\<\
Neighbour-modulated fitness for the focal individual (w) is written below. \
This is Equation C1 in the SI.\
\>", "Text",
 CellChangeTimes->{{3.9151752377757063`*^9, 3.915175259620417*^9}, {
  3.915175352890313*^9, 3.9151753593515577`*^9}, {3.915202060281857*^9, 
  3.915202060344359*^9}},ExpressionUUID->"f5580ae9-2638-4cb4-a379-\
650590143669"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"w", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", "m"}], ")"}], 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{
          RowBox[{"(", 
           FractionBox["1", "N"], ")"}], 
          RowBox[{"(", 
           RowBox[{"d", "+", 
            RowBox[{"c", " ", "xfocal"}]}], ")"}]}], "-", 
         RowBox[{
          RowBox[{"(", 
           FractionBox[
            RowBox[{"N", "-", "1"}], "N"], ")"}], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"d", 
             RowBox[{"(", 
              RowBox[{"1", "-", "xothers"}], ")"}]}], "+", 
            RowBox[{"c", " ", "xfocal", 
             RowBox[{"(", 
              RowBox[{"1", "-", "g"}], ")"}]}], "+", 
            RowBox[{"s", " ", "xothers"}]}], ")"}]}]}], ")"}], "/", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "-", "m"}], ")"}], 
          RowBox[{"(", 
           RowBox[{"1", "-", 
            RowBox[{
             RowBox[{"(", 
              FractionBox["1", "N"], ")"}], 
             RowBox[{"(", 
              RowBox[{"d", "+", 
               RowBox[{"c", " ", 
                RowBox[{"(", 
                 RowBox[{
                  FractionBox[
                   RowBox[{"xothers", 
                    RowBox[{"(", 
                    RowBox[{"N", "-", "1"}], ")"}]}], "N"], "+", 
                  FractionBox["xfocal", "N"]}], ")"}]}]}], ")"}]}], "-", 
            RowBox[{
             RowBox[{"(", 
              FractionBox[
               RowBox[{"N", "-", "1"}], "N"], ")"}], 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"d", 
                RowBox[{"(", 
                 RowBox[{"1", "-", 
                  RowBox[{"(", 
                   RowBox[{
                    FractionBox[
                    RowBox[{"xothers", 
                    RowBox[{"(", 
                    RowBox[{"N", "-", "1"}], ")"}]}], "N"], "+", 
                    FractionBox["xfocal", "N"]}], ")"}]}], ")"}]}], "+", 
               RowBox[{"c", " ", 
                RowBox[{"(", 
                 RowBox[{
                  FractionBox[
                   RowBox[{"xothers", 
                    RowBox[{"(", 
                    RowBox[{"N", "-", "1"}], ")"}]}], "N"], "+", 
                  FractionBox["xfocal", "N"]}], ")"}], 
                RowBox[{"(", 
                 RowBox[{"1", "-", "g"}], ")"}]}], "+", 
               RowBox[{"s", 
                RowBox[{"(", 
                 RowBox[{
                  FractionBox[
                   RowBox[{"xothers", 
                    RowBox[{"(", 
                    RowBox[{"N", "-", "1"}], ")"}]}], "N"], "+", 
                  FractionBox["xfocal", "N"]}], ")"}]}]}], ")"}]}]}], ")"}]}],
          "+", 
         RowBox[{"m", 
          RowBox[{"(", 
           RowBox[{"1", "-", 
            RowBox[{
             RowBox[{"(", 
              FractionBox["1", "N"], ")"}], 
             RowBox[{"(", 
              RowBox[{"d", "+", 
               RowBox[{"c", " ", "xpop"}]}], ")"}]}], "-", 
            RowBox[{
             RowBox[{"(", 
              FractionBox[
               RowBox[{"N", "-", "1"}], "N"], ")"}], 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"d", 
                RowBox[{"(", 
                 RowBox[{"1", "-", "xpop"}], ")"}]}], "+", 
               RowBox[{"c", " ", "xpop", 
                RowBox[{"(", 
                 RowBox[{"1", "-", "g"}], ")"}]}], "+", 
               RowBox[{"s", " ", "xpop"}]}], ")"}]}]}], ")"}]}]}], ")"}]}]}], 
     "+", 
     RowBox[{"m", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{
          RowBox[{"(", 
           FractionBox["1", "N"], ")"}], 
          RowBox[{"(", 
           RowBox[{"d", "+", 
            RowBox[{"c", " ", "xfocal"}]}], ")"}]}], "-", 
         RowBox[{
          RowBox[{"(", 
           FractionBox[
            RowBox[{"N", "-", "1"}], "N"], ")"}], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"d", 
             RowBox[{"(", 
              RowBox[{"1", "-", "xothers"}], ")"}]}], "+", 
            RowBox[{"c", " ", "xfocal", 
             RowBox[{"(", 
              RowBox[{"1", "-", "g"}], ")"}]}], "+", 
            RowBox[{"s", " ", "xothers"}]}], ")"}]}]}], ")"}], "/", 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{
          RowBox[{"(", 
           FractionBox["1", "N"], ")"}], 
          RowBox[{"(", 
           RowBox[{"d", "+", 
            RowBox[{"c", " ", "xpop"}]}], ")"}]}], "-", 
         RowBox[{
          RowBox[{"(", 
           FractionBox[
            RowBox[{"N", "-", "1"}], "N"], ")"}], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"d", 
             RowBox[{"(", 
              RowBox[{"1", "-", "xpop"}], ")"}]}], "+", 
            RowBox[{"c", " ", "xpop", 
             RowBox[{"(", 
              RowBox[{"1", "-", "g"}], ")"}]}], "+", " ", 
            RowBox[{"s", " ", "xpop"}]}], ")"}]}]}], ")"}]}]}]}]}], ";"}], 
  "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.908103877779798*^9, 3.9081039368551617`*^9}, {
   3.9082687020329027`*^9, 3.908268859066394*^9}, {3.908269883914235*^9, 
   3.908269920730289*^9}, {3.908355862871335*^9, 3.908355902589114*^9}, {
   3.9108604899938927`*^9, 3.910860560580213*^9}, {3.9113770175862293`*^9, 
   3.911377066649146*^9}, {3.911391018117175*^9, 3.911391056891016*^9}, 
   3.915175265985262*^9, {3.916903665255417*^9, 3.916903737332921*^9}, {
   3.916903780079558*^9, 3.916903784107769*^9}, {3.9169113750673647`*^9, 
   3.916911375075122*^9}, {3.916911412340334*^9, 3.916911412349597*^9}, {
   3.916911465589005*^9, 3.9169114655986567`*^9}, {3.9169115536660643`*^9, 
   3.916911553671792*^9}, {3.916920964243086*^9, 3.9169209642489967`*^9}},
 CellLabel->
  "In[209]:=",ExpressionUUID->"a21b650b-5cbd-4bbc-a541-202c40a61cec"],

Cell["\<\
The derivative of focal individual fitness, with respect to the focal \
individual trait value, evaluated at monomorphic equilibrium, is written \
below (as -cm). Note that the \[OpenCurlyQuote]cm\[CloseCurlyQuote] notation \
is used to represent the \[OpenCurlyQuote]marginal cost\[CloseCurlyQuote] of \
Hamilton\[CloseCurlyQuote]s Rule. This is Equation C2 in the SI.\
\>", "Text",
 CellChangeTimes->{{3.915175733249536*^9, 3.915175737026534*^9}, {
  3.915175857656424*^9, 3.915175883915668*^9}, {3.915202107785346*^9, 
  3.915202108337833*^9}},ExpressionUUID->"a96f95d9-564e-4b5c-a70a-\
9626482de7a4"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"cm", "=", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{"D", "[", 
       RowBox[{"w", ",", "xfocal"}], "]"}]}], "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"xpop", "->", 
        SuperscriptBox["x", "*"]}], ",", 
       RowBox[{"xothers", "->", 
        SuperscriptBox["x", "*"]}], ",", 
       RowBox[{"xfocal", "->", 
        SuperscriptBox["x", "*"]}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"TraditionalForm", "[", 
  RowBox[{"-", "cm"}], "]"}]}], "Input",
 CellChangeTimes->{{3.915177161684618*^9, 3.9151771773356667`*^9}, {
   3.9169114123507566`*^9, 3.916911412351968*^9}, 3.9169114655999727`*^9, 
   3.916911553673272*^9, 3.9169208882701902`*^9},
 CellLabel->
  "In[210]:=",ExpressionUUID->"d67c21ef-3a92-4094-98b7-603032d7a27a"],

Cell[BoxData[
 FormBox[
  RowBox[{"-", 
   FractionBox[
    RowBox[{
     RowBox[{"c", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"g", "-", "1"}], ")"}], " ", "N"}], "-", "g"}], ")"}], " ", 
      
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"m", "-", "1"}], ")"}], "2"], "-", "N"}], ")"}]}], "+", 
     RowBox[{"d", " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"m", "-", "1"}], ")"}], "2"], " ", 
      RowBox[{"(", 
       RowBox[{"N", "-", "1"}], ")"}]}], "-", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"m", "-", "1"}], ")"}], "2"], " ", 
      RowBox[{"(", 
       RowBox[{"N", "-", "1"}], ")"}], " ", "s"}]}], 
    RowBox[{"N", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        SuperscriptBox["x", "*"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"N", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"c", " ", "g"}], "-", "s"}], ")"}]}], "-", 
          RowBox[{"c", " ", 
           RowBox[{"(", 
            RowBox[{"g", "+", "N"}], ")"}]}], "+", 
          RowBox[{"d", " ", 
           RowBox[{"(", 
            RowBox[{"N", "-", "1"}], ")"}]}], "+", "s"}], ")"}]}], "-", 
       RowBox[{"d", " ", "N"}], "+", "N"}], ")"}]}]]}], 
  TraditionalForm]], "Output",
 CellChangeTimes->{3.916920972674039*^9, 3.917006431323813*^9, 
  3.917007073991768*^9, 3.9171681212103157`*^9, 3.921300577369028*^9},
 CellLabel->
  "Out[211]//TraditionalForm=",ExpressionUUID->"48103aa9-bbed-450b-862b-\
1e5ba978f7c3"]
}, Open  ]],

Cell["\<\
The derivative of focal individual fitness, with respect to the average trait \
value of other individuals on the deme, evaluated at monomorphic equilibrium, \
is written below. Note that the \[OpenCurlyQuote]bm\[CloseCurlyQuote] \
notation is used to represent the \[OpenCurlyQuote]marginal benefit\
\[CloseCurlyQuote] of Hamilton\[CloseCurlyQuote]s Rule. This is Equation C3 \
in the SI.\
\>", "Text",
 CellChangeTimes->{{3.915175418488715*^9, 3.915175518937564*^9}, 
   3.915175722238924*^9, {3.915175920186359*^9, 3.915175930914809*^9}, {
   3.915202112427059*^9, 
   3.915202112942956*^9}},ExpressionUUID->"7bb8876d-2031-40ad-a1c5-\
a0990cd0c3f0"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TraditionalForm", "[", 
  RowBox[{"bm", "=", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{"w", ",", "xothers"}], "]"}], "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"xpop", "->", 
        SuperscriptBox["x", "*"]}], ",", 
       RowBox[{"xothers", "->", 
        SuperscriptBox["x", "*"]}], ",", 
       RowBox[{"xfocal", "->", 
        SuperscriptBox["x", "*"]}]}], "}"}]}], "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.9081039414213743`*^9, 3.9081039435052147`*^9}, {
   3.90810406510456*^9, 3.908104073589612*^9}, {3.9081043026353397`*^9, 
   3.9081043339158287`*^9}, 3.908106925554028*^9, {3.911391003528234*^9, 
   3.9113910075287848`*^9}, {3.9115423725276537`*^9, 3.911542390599454*^9}, {
   3.915175399934017*^9, 3.915175400756152*^9}, 3.915175723845454*^9, {
   3.915177193413665*^9, 3.9151771935552893`*^9}, {3.916911412353875*^9, 
   3.916911412354452*^9}, {3.916911465600852*^9, 3.916911465601432*^9}, 
   3.916911553674254*^9, 3.916920996643852*^9},
 CellLabel->
  "In[212]:=",ExpressionUUID->"0f5499f3-9efa-4849-83aa-c55b74d53ebc"],

Cell[BoxData[
 FormBox[
  RowBox[{"-", 
   FractionBox[
    RowBox[{
     RowBox[{"(", 
      RowBox[{"N", "-", "1"}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"c", " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"m", "-", "1"}], ")"}], "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"g", "-", "1"}], ")"}], " ", "N"}], "-", "g"}], ")"}]}], 
       "+", 
       RowBox[{"d", " ", 
        RowBox[{"(", 
         RowBox[{"m", "-", "2"}], ")"}], " ", "m", " ", "N"}], "-", 
       RowBox[{"d", " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"m", "-", "1"}], ")"}], "2"]}], "-", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"m", "-", "2"}], ")"}], " ", "m", " ", 
        RowBox[{"(", 
         RowBox[{"N", "-", "1"}], ")"}], " ", "s"}], "+", "s"}], ")"}]}], 
    RowBox[{"N", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        SuperscriptBox["x", "*"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"N", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"c", " ", "g"}], "-", "s"}], ")"}]}], "-", 
          RowBox[{"c", " ", 
           RowBox[{"(", 
            RowBox[{"g", "+", "N"}], ")"}]}], "+", 
          RowBox[{"d", " ", 
           RowBox[{"(", 
            RowBox[{"N", "-", "1"}], ")"}]}], "+", "s"}], ")"}]}], "-", 
       RowBox[{"d", " ", "N"}], "+", "N"}], ")"}]}]]}], 
  TraditionalForm]], "Output",
 CellChangeTimes->{3.916920998726347*^9, 3.917006433333035*^9, 
  3.917007075679339*^9, 3.917168122794384*^9, 3.921300579207028*^9},
 CellLabel->
  "Out[212]//TraditionalForm=",ExpressionUUID->"d56349f8-a26f-446b-9473-\
5f4217a0a005"]
}, Open  ]],

Cell["\<\
The overall marginal change in neighbour-modulated fitness associated with a \
slight change in behaviour is written below, on the (false) assumption that \
relatedness is a constant (open model). The \[OpenCurlyQuote]margopen\
\[CloseCurlyQuote] notation is used to represent the marginal fitness change, \
and the open model setting. This is Equation D1 in the SI.\
\>", "Text",
 CellChangeTimes->{{3.915175958153467*^9, 3.915176040877063*^9}, {
  3.915177227882449*^9, 3.9151773535121117`*^9}, {3.915202480835009*^9, 
  3.91520248145765*^9}},ExpressionUUID->"1d642f2c-5c9d-4bb4-8ac9-\
93d16e2e2944"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TraditionalForm", "[", 
  RowBox[{"margopen", "=", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{
     RowBox[{
      SuperscriptBox["r", "*"], " ", "bm"}], " ", "-", " ", "cm"}], "]"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.9081044477104807`*^9, 3.908104459241107*^9}, {
   3.908104492639288*^9, 3.9081044941536303`*^9}, {3.9081051452016487`*^9, 
   3.90810514887316*^9}, {3.9151758222548037`*^9, 3.9151758368976316`*^9}, {
   3.915177197160902*^9, 3.9151772227977467`*^9}, 3.915177266100378*^9, {
   3.917006399083518*^9, 3.917006454533423*^9}, {3.9170064855052347`*^9, 
   3.9170064866297903`*^9}},
 CellLabel->
  "In[213]:=",ExpressionUUID->"49378176-ba94-42c9-b7eb-d34187383634"],

Cell[BoxData[
 FormBox[
  RowBox[{"-", 
   FractionBox[
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"N", "-", "1"}], ")"}], " ", 
      SuperscriptBox["r", "*"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"c", " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"m", "-", "1"}], ")"}], "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"g", "-", "1"}], ")"}], " ", "N"}], "-", "g"}], ")"}]}], 
        "+", 
        RowBox[{"d", " ", 
         RowBox[{"(", 
          RowBox[{"m", "-", "2"}], ")"}], " ", "m", " ", "N"}], "-", 
        RowBox[{"d", " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"m", "-", "1"}], ")"}], "2"]}], "-", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"m", "-", "2"}], ")"}], " ", "m", " ", 
         RowBox[{"(", 
          RowBox[{"N", "-", "1"}], ")"}], " ", "s"}], "+", "s"}], ")"}]}], 
     "+", 
     RowBox[{"c", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"g", "-", "1"}], ")"}], " ", "N"}], "-", "g"}], ")"}], " ", 
      
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"m", "-", "1"}], ")"}], "2"], "-", "N"}], ")"}]}], "+", 
     RowBox[{"d", " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"m", "-", "1"}], ")"}], "2"], " ", 
      RowBox[{"(", 
       RowBox[{"N", "-", "1"}], ")"}]}], "-", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"m", "-", "1"}], ")"}], "2"], " ", 
      RowBox[{"(", 
       RowBox[{"N", "-", "1"}], ")"}], " ", "s"}]}], 
    RowBox[{"N", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        SuperscriptBox["x", "*"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"N", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"c", " ", "g"}], "-", "s"}], ")"}]}], "-", 
          RowBox[{"c", " ", 
           RowBox[{"(", 
            RowBox[{"g", "+", "N"}], ")"}]}], "+", 
          RowBox[{"d", " ", 
           RowBox[{"(", 
            RowBox[{"N", "-", "1"}], ")"}]}], "+", "s"}], ")"}]}], "-", 
       RowBox[{"d", " ", "N"}], "+", "N"}], ")"}]}]]}], 
  TraditionalForm]], "Output",
 CellChangeTimes->{3.916921024606532*^9, 3.917006414970397*^9, 
  3.9170064565066137`*^9, 3.917006487254201*^9, 3.917007077552244*^9, 
  3.917168124236874*^9, 3.921300581076297*^9},
 CellLabel->
  "Out[213]//TraditionalForm=",ExpressionUUID->"8d3541ce-b8c2-4628-8cfc-\
a8284eff5a2c"]
}, Open  ]],

Cell["\<\
We ask when a slight increase in the behaviour is favoured, on the assumption \
of zero migration (m=0). To do so, we  set the selection differential to \
zero, to obtain s\[Rule]c (g (-N)+g+N)+d. We can see that the right hand side \
is always greater than the left hand side, meaning the selection differential \
is always negative, and so the behaviour is  disfavoured.\
\>", "Text",
 CellChangeTimes->{{3.915176101958577*^9, 3.915176179387744*^9}, {
  3.915176229291583*^9, 3.915176243005365*^9}, {3.915177406063599*^9, 
  3.915177410206997*^9}, {3.9169211674956417`*^9, 3.916921184717087*^9}, {
  3.916921339323142*^9, 3.916921382237941*^9}, {3.916921462434651*^9, 
  3.9169214680810337`*^9}},ExpressionUUID->"814091cb-f6e2-4a7e-940b-\
e6b192478abe"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"FullSimplify", "[", 
  RowBox[{"Solve", "[", 
   RowBox[{
    RowBox[{"margopen", "==", "0"}], ",", 
    SuperscriptBox["r", "*"]}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.921300544157765*^9, 3.921300597017961*^9}},
 CellLabel->
  "In[215]:=",ExpressionUUID->"719453b3-debd-4e1b-854d-89124d10b029"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    SuperscriptBox["r", "*"], "\[Rule]", 
    FractionBox[
     RowBox[{
      RowBox[{
       RowBox[{"-", "d"}], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "m"}], ")"}], "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "N"}], ")"}]}], "-", 
      RowBox[{"c", " ", 
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "m"}], ")"}], "2"], "-", "N"}], ")"}], 
       " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "g"}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "g"}], ")"}], " ", "N"}]}], ")"}]}], "+", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "m"}], ")"}], "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "N"}], ")"}], " ", "s"}]}], 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "N"}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "d"}], " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "m"}], ")"}], "2"]}], "+", 
        RowBox[{"d", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "2"}], "+", "m"}], ")"}], " ", "m", " ", "N"}], "+", 
        RowBox[{"c", " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "m"}], ")"}], "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "g"}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", "g"}], ")"}], " ", "N"}]}], ")"}]}], 
        "+", "s", "-", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "2"}], "+", "m"}], ")"}], " ", "m", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "N"}], ")"}], " ", "s"}]}], ")"}]}]]}], 
   "}"}], "}"}]], "Output",
 CellChangeTimes->{{3.921300563085063*^9, 3.921300597264737*^9}},
 CellLabel->
  "Out[215]=",ExpressionUUID->"e4f0778f-0861-4558-90ea-001bcbbbf9cf"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"TraditionalForm", "[", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{"margopen", "/.", 
    RowBox[{"{", 
     RowBox[{"m", "->", "0"}], "}"}]}], "]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"TraditionalForm", "[", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{"Solve", "[", 
    RowBox[{
     RowBox[{"margopen", "==", "0"}], "/.", 
     RowBox[{"{", 
      RowBox[{"m", "->", "0"}], "}"}]}], "]"}], "]"}], "]"}]}], "Input",
 CellChangeTimes->{{3.908108081357972*^9, 3.90810815886198*^9}, 
   3.9082689167181387`*^9, {3.908275020896943*^9, 3.9082750299584627`*^9}, {
   3.908275081536397*^9, 3.9082751262301083`*^9}, {3.9082751906324368`*^9, 
   3.908275193265663*^9}, {3.9082752320393248`*^9, 3.908275277398169*^9}, {
   3.908275311973724*^9, 3.9082753702498417`*^9}, {3.908275404855864*^9, 
   3.908275411310329*^9}, {3.911472199070818*^9, 3.911472202133206*^9}, {
   3.915177205821993*^9, 3.9151772059558477`*^9}, {3.915177361413143*^9, 
   3.915177361646332*^9}, {3.91690420982997*^9, 3.9169042308246803`*^9}, 
   3.916911375095974*^9, 3.916911412357128*^9, {3.9169210658871527`*^9, 
   3.916921073116468*^9}, {3.916921271319553*^9, 3.91692128963286*^9}, {
   3.9170066555903482`*^9, 3.917006688008757*^9}},
 CellLabel->
  "In[313]:=",ExpressionUUID->"29864960-ef33-4814-bb7b-347be41625c6"],

Cell[BoxData[
 FormBox[
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{"N", "-", "1"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["r", "*"], "-", "1"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"c", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"g", " ", 
          RowBox[{"(", 
           RowBox[{"-", "N"}], ")"}]}], "+", "g", "+", "N"}], ")"}]}], "+", 
      "d", "-", "s"}], ")"}]}], 
   RowBox[{"N", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SuperscriptBox["x", "*"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"N", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"c", " ", "g"}], "-", "s"}], ")"}]}], "-", 
         RowBox[{"c", " ", 
          RowBox[{"(", 
           RowBox[{"g", "+", "N"}], ")"}]}], "+", 
         RowBox[{"d", " ", 
          RowBox[{"(", 
           RowBox[{"N", "-", "1"}], ")"}]}], "+", "s"}], ")"}]}], "-", 
      RowBox[{"d", " ", "N"}], "+", "N"}], ")"}]}]], 
  TraditionalForm]], "Output",
 CellChangeTimes->{
  3.9082689189247103`*^9, {3.9082750095828257`*^9, 3.908275031642332*^9}, {
   3.908275084386447*^9, 3.908275127976161*^9}, 3.908275193877214*^9, {
   3.908275233458981*^9, 3.908275248590908*^9}, 3.908275279347251*^9, 
   3.908275380694973*^9, 3.908275413192636*^9, 3.9083559387106123`*^9, 
   3.910860622126617*^9, 3.911376898573859*^9, 3.911377143928994*^9, 
   3.9114720838680353`*^9, 3.911472229947011*^9, 3.911548109194347*^9, 
   3.911554643668841*^9, 3.915177207879016*^9, 3.9151773650375423`*^9, 
   3.9151775188673983`*^9, 3.915205762706293*^9, 3.916904268839561*^9, 
   3.916921079337216*^9, {3.916921276745158*^9, 3.9169212899054413`*^9}, 
   3.917006468813139*^9, 3.917006570992041*^9, {3.917006666988304*^9, 
   3.9170066889448833`*^9}, 3.917007079514983*^9, 3.917168126232297*^9},
 CellLabel->
  "Out[313]//TraditionalForm=",ExpressionUUID->"51c91f0e-bba8-4de5-acdc-\
422a357863c6"],

Cell[BoxData[
 FormBox[
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"N", "\[Rule]", "1"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"s", "\[Rule]", 
      RowBox[{
       RowBox[{"c", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"g", " ", 
           RowBox[{"(", 
            RowBox[{"-", "N"}], ")"}]}], "+", "g", "+", "N"}], ")"}]}], "+", 
       "d"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      SuperscriptBox["r", "*"], "\[Rule]", "1"}], "}"}]}], "}"}], 
  TraditionalForm]], "Output",
 CellChangeTimes->{
  3.9082689189247103`*^9, {3.9082750095828257`*^9, 3.908275031642332*^9}, {
   3.908275084386447*^9, 3.908275127976161*^9}, 3.908275193877214*^9, {
   3.908275233458981*^9, 3.908275248590908*^9}, 3.908275279347251*^9, 
   3.908275380694973*^9, 3.908275413192636*^9, 3.9083559387106123`*^9, 
   3.910860622126617*^9, 3.911376898573859*^9, 3.911377143928994*^9, 
   3.9114720838680353`*^9, 3.911472229947011*^9, 3.911548109194347*^9, 
   3.911554643668841*^9, 3.915177207879016*^9, 3.9151773650375423`*^9, 
   3.9151775188673983`*^9, 3.915205762706293*^9, 3.916904268839561*^9, 
   3.916921079337216*^9, {3.916921276745158*^9, 3.9169212899054413`*^9}, 
   3.917006468813139*^9, 3.917006570992041*^9, {3.917006666988304*^9, 
   3.9170066889448833`*^9}, 3.917007079514983*^9, 3.917168126237528*^9},
 CellLabel->
  "Out[314]//TraditionalForm=",ExpressionUUID->"db3a11b4-27f7-446b-a939-\
d3b74c0219e9"]
}, Open  ]],

Cell[TextData[{
 "We ask when a slight increase in the behaviour is favoured, on the \
assumption of full migration (m=1). To do so, we first set the selection \
differential to zero, to obtain ",
 Cell[BoxData[
  RowBox[{"s", "\[Rule]", 
   FractionBox[
    RowBox[{"c", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"g", " ", 
        RowBox[{"(", 
         RowBox[{"-", "N"}], ")"}]}], "+", "g", "+", "N"}], ")"}]}], 
    RowBox[{"r", "-", 
     RowBox[{"N", " ", "r"}]}]]}]],
  CellChangeTimes->{{3.916921517193231*^9, 3.916921520764381*^9}},
  ExpressionUUID->"694bfba1-37ac-4f8a-9120-5c5344f7200f"],
 ". The behaviour is favoured when the left-hand side is greater than the \
right-hand side. This is Equation D4 (slightly rearranged) in the SI."
}], "Text",
 CellChangeTimes->{{3.915176273466278*^9, 3.915176279609105*^9}, {
   3.915176337851461*^9, 3.915176359760262*^9}, {3.915177400639497*^9, 
   3.915177402013357*^9}, {3.915202520975082*^9, 3.915202521661769*^9}, {
   3.916904476370679*^9, 3.9169044782464933`*^9}, {3.916911375097795*^9, 
   3.916911375098484*^9}, {3.916921475845743*^9, 3.9169214853349543`*^9}, 
   3.9169215432682133`*^9, {3.916921596894339*^9, 3.916921622380485*^9}, {
   3.91692177560401*^9, 
   3.916921788848304*^9}},ExpressionUUID->"53ef27b6-ade9-45ec-ab9d-\
3668546edfd1"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"TraditionalForm", "[", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{"margopen", "/.", 
    RowBox[{"{", 
     RowBox[{"m", "->", "1"}], "}"}]}], "]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"TraditionalForm", "[", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{"Solve", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"margopen", "==", "0"}], "/.", 
      RowBox[{"{", 
       RowBox[{"m", "->", "1"}], "}"}]}], ",", 
     SuperscriptBox["r", "*"]}], "]"}], "]"}], "]"}]}], "Input",
 CellChangeTimes->{{3.90827547900133*^9, 3.908275526641282*^9}, {
   3.908275670152458*^9, 3.908275700588422*^9}, {3.9114722372479143`*^9, 
   3.9114722413253193`*^9}, {3.915177386188711*^9, 3.915177386585072*^9}, 
   3.916904284833131*^9, 3.916904565383276*^9, 3.916911375100438*^9, 
   3.91691141235809*^9, {3.916921494316596*^9, 3.91692152019011*^9}, {
   3.917007038277079*^9, 3.917007041534177*^9}, {3.917007331470581*^9, 
   3.917007342955291*^9}},
 CellLabel->
  "In[315]:=",ExpressionUUID->"de382b43-3f17-4a3a-9c8e-9108952c42cc"],

Cell[BoxData[
 FormBox[
  FractionBox[
   RowBox[{
    RowBox[{"c", " ", 
     RowBox[{"(", 
      RowBox[{"g", "-", "1"}], ")"}], " ", "N"}], "-", 
    RowBox[{"c", " ", "g"}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"N", "-", "1"}], ")"}], " ", 
     SuperscriptBox["r", "*"], " ", 
     RowBox[{"(", 
      RowBox[{"d", "-", "s"}], ")"}]}]}], 
   RowBox[{
    RowBox[{
     SuperscriptBox["x", "*"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"N", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"c", " ", "g"}], "-", "s"}], ")"}]}], "-", 
       RowBox[{"c", " ", 
        RowBox[{"(", 
         RowBox[{"g", "+", "N"}], ")"}]}], "+", 
       RowBox[{"d", " ", 
        RowBox[{"(", 
         RowBox[{"N", "-", "1"}], ")"}]}], "+", "s"}], ")"}]}], "-", 
    RowBox[{"d", " ", "N"}], "+", "N"}]], TraditionalForm]], "Output",
 CellChangeTimes->{{3.916921517193231*^9, 3.916921520764381*^9}, 
   3.917006475779202*^9, 3.917007043922151*^9, 3.917007082082943*^9, {
   3.917007321809005*^9, 3.917007346255299*^9}, 3.917168128553379*^9},
 CellLabel->
  "Out[315]//TraditionalForm=",ExpressionUUID->"955c8e22-1fa2-439b-9706-\
b6714032e025"],

Cell[BoxData[
 FormBox[
  RowBox[{"{", 
   RowBox[{"{", 
    RowBox[{
     SuperscriptBox["r", "*"], "\[Rule]", 
     FractionBox[
      RowBox[{"c", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"g", " ", 
          RowBox[{"(", 
           RowBox[{"-", "N"}], ")"}]}], "+", "g", "+", "N"}], ")"}]}], 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"N", "-", "1"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"d", "-", "s"}], ")"}]}]]}], "}"}], "}"}], 
  TraditionalForm]], "Output",
 CellChangeTimes->{{3.916921517193231*^9, 3.916921520764381*^9}, 
   3.917006475779202*^9, 3.917007043922151*^9, 3.917007082082943*^9, {
   3.917007321809005*^9, 3.917007346255299*^9}, 3.917168128558538*^9},
 CellLabel->
  "Out[316]//TraditionalForm=",ExpressionUUID->"96051983-0782-4a0d-894b-\
e85956f00ec8"]
}, Open  ]],

Cell[TextData[{
 "We now undertake the \[OpenCurlyQuote]closed model\[CloseCurlyQuote] \
analysis, where relatedness is not considered a constant, but is instead \
expressed in terms of model parameters. Relatedness is given by ",
 Cell[BoxData[
  FormBox[
   RowBox[{"r", "=", 
    FractionBox["1", 
     RowBox[{"1", "-", 
      FractionBox[
       RowBox[{
        RowBox[{"(", 
         RowBox[{"m", "-", "2"}], ")"}], " ", "m", " ", "N"}], 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"m", "-", "1"}], ")"}], "2"]]}]]}], TraditionalForm]],
  CellChangeTimes->{{3.910861979123197*^9, 3.9108619999508753`*^9}, {
    3.91086222963589*^9, 3.9108622426687517`*^9}, 3.910862460959608*^9, 
    3.9108626243521233`*^9, 3.9114609992207623`*^9, 3.911461049933278*^9, 
    3.911461104221305*^9, 3.9114637937132893`*^9, {3.9114638920883408`*^9, 
    3.9114638987610273`*^9}, {3.911464017519855*^9, 3.911464020308721*^9}, 
    3.911472250412627*^9, 3.911554645377158*^9},ExpressionUUID->
  "88e9a451-7b65-4ef5-ad2b-ae678ec82321"],
 "(Equation A17). We therefore obtain the overall marginal change in \
neighbour-modulated fitness associated with a slight change in behaviour, on \
the (true) assumption that relatedness emerges from model parameters.  The \
\[OpenCurlyQuote]margclosed\[CloseCurlyQuote] notation is used to represent \
the marginal fitness change, and the closed model setting. This is Equation \
C4 in the SI. "
}], "Text",
 CellChangeTimes->{{3.915176441285725*^9, 3.915176587713168*^9}, {
  3.915177463317815*^9, 3.9151774714126167`*^9}, {3.915202162057556*^9, 
  3.9152021995216208`*^9}},ExpressionUUID->"5ebf40e9-1778-43c5-be7a-\
7405ac196882"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TraditionalForm", "[", 
  RowBox[{"margclosed", "=", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       SuperscriptBox["r", "*"], " ", "bm"}], " ", "-", " ", "cm"}], "/.", 
     RowBox[{"{", 
      RowBox[{
       SuperscriptBox["r", "*"], "->", 
       RowBox[{"1", "/", 
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"m", "-", "2"}], ")"}], " ", "m", " ", "N"}], ")"}], 
           "/", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"m", "-", "1"}], ")"}], "^", "2"}]}]}], ")"}]}]}], 
      "}"}]}], "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.91517659618088*^9, 3.915176615645871*^9}, 
   3.915177444830543*^9, {3.915177479766621*^9, 3.915177481869033*^9}, {
   3.917008585431531*^9, 3.917008591437913*^9}},
 CellLabel->
  "In[317]:=",ExpressionUUID->"ea10e739-a763-45e3-b542-84d1f16d9f27"],

Cell[BoxData[
 FormBox[
  FractionBox[
   RowBox[{"c", " ", 
    RowBox[{"(", 
     RowBox[{"m", "-", "2"}], ")"}], " ", "m", " ", "N", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"g", " ", 
       RowBox[{"(", 
        RowBox[{"N", "-", "1"}], ")"}]}], "-", "N"}], ")"}]}], 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"m", "-", "2"}], ")"}], " ", "m", " ", 
       RowBox[{"(", 
        RowBox[{"N", "-", "1"}], ")"}]}], "-", "1"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SuperscriptBox["x", "*"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"N", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"c", " ", "g"}], "-", "s"}], ")"}]}], "-", 
         RowBox[{"c", " ", 
          RowBox[{"(", 
           RowBox[{"g", "+", "N"}], ")"}]}], "+", 
         RowBox[{"d", " ", 
          RowBox[{"(", 
           RowBox[{"N", "-", "1"}], ")"}]}], "+", "s"}], ")"}]}], "-", 
      RowBox[{"d", " ", "N"}], "+", "N"}], ")"}]}]], 
  TraditionalForm]], "Output",
 CellChangeTimes->{3.9169217998445807`*^9, 3.917168131575746*^9},
 CellLabel->
  "Out[317]//TraditionalForm=",ExpressionUUID->"deeea19e-5d61-474a-91ff-\
0d66c8237132"]
}, Open  ]],

Cell[TextData[{
 "We ask when a slight increase in the behaviour is favoured. To do so, we \
first set the selection differential to zero, to obtain ",
 Cell[BoxData[
  FormBox[
   RowBox[{"N", "\[Rule]", 
    FractionBox["g", 
     RowBox[{"g", "-", "1"}]]}], TraditionalForm]],
  CellChangeTimes->{
   3.910862634126298*^9, 3.910862679713876*^9, 3.911377178731172*^9, {
    3.911472315555702*^9, 3.911472345188623*^9}, 3.911548193938794*^9, 
    3.911548237122397*^9, {3.91154829494869*^9, 3.911548316947212*^9}, 
    3.9115546458318996`*^9, 3.9151769039327383`*^9, 3.915177492573509*^9, 
    3.915177527058111*^9, 3.91520576940941*^9, 3.9169046757511387`*^9, {
    3.91692181322268*^9, 3.916921825090461*^9}},ExpressionUUID->
  "4078cfa2-9e3d-4616-aedc-c874c59b8652"],
 ". The left-hand side is always greater than the right-hand side, meaning \
the behaviour is disfavoured."
}], "Text",
 CellChangeTimes->{{3.9151769454838057`*^9, 3.9151769716502733`*^9}, {
  3.916921879569149*^9, 
  3.916921918568274*^9}},ExpressionUUID->"7819eeb0-1f08-466f-b046-\
51cb1b22efc3"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TraditionalForm", "[", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{"Solve", "[", 
    RowBox[{"margclosed", "==", "0"}], "]"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.91086262736821*^9, 3.910862678869877*^9}, 
   3.911472300688035*^9, {3.911472332014091*^9, 3.911472344399435*^9}, {
   3.911548186771056*^9, 3.911548189170001*^9}, 3.9115482347234707`*^9, {
   3.9115482852122593`*^9, 3.9115483160155067`*^9}, {3.915176872170781*^9, 
   3.9151769012207336`*^9}, {3.915177491578352*^9, 3.9151774916856956`*^9}, {
   3.916904602331162*^9, 3.9169046174555693`*^9}, 3.916911375107368*^9, 
   3.916911412359993*^9, {3.9169218120408077`*^9, 3.91692182363475*^9}},
 CellLabel->
  "In[318]:=",ExpressionUUID->"8ffffd61-8406-434f-87f4-617d3d00c477"],

Cell[BoxData[
 FormBox[
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"c", "\[Rule]", "0"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"m", "\[Rule]", "0"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"m", "\[Rule]", "2"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"N", "\[Rule]", "0"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"N", "\[Rule]", 
      FractionBox["g", 
       RowBox[{"g", "-", "1"}]]}], "}"}]}], "}"}], TraditionalForm]], "Output",\

 CellChangeTimes->{
  3.910862634126298*^9, 3.910862679713876*^9, 3.911377178731172*^9, {
   3.911472315555702*^9, 3.911472345188623*^9}, 3.911548193938794*^9, 
   3.911548237122397*^9, {3.91154829494869*^9, 3.911548316947212*^9}, 
   3.9115546458318996`*^9, 3.9151769039327383`*^9, 3.915177492573509*^9, 
   3.915177527058111*^9, 3.91520576940941*^9, 3.9169046757511387`*^9, {
   3.91692181322268*^9, 3.916921825090461*^9}, 3.917168135464245*^9},
 CellLabel->
  "Out[318]//TraditionalForm=",ExpressionUUID->"1f08f3c4-5629-4ff9-83cd-\
98a6b72eda1f"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
Model E) Signalling; kin discrimination; migration before population \
regulation\
\>", "Section",
 CellChangeTimes->{{3.915174600364295*^9, 3.91517462569272*^9}, 
   3.91517466765668*^9, {3.915175186685773*^9, 3.915175197207159*^9}, {
   3.9151845315098667`*^9, 3.9151845554729557`*^9}, {3.9355872340551147`*^9, 
   3.935587252128766*^9}},ExpressionUUID->"3b985d79-fc23-4b0a-b79e-\
6233e3b177f0"],

Cell["\<\
Neighbour-modulated fitness for the focal individual (w) is written below. \
This is obtained by substituting Equations E2 - E4 into Equation C1 in the SI.\
\>", "Text",
 CellChangeTimes->{{3.9151752377757063`*^9, 3.915175259620417*^9}, {
  3.915175352890313*^9, 3.9151753593515577`*^9}, {3.915202060281857*^9, 
  3.915202060344359*^9}, {3.943000432995995*^9, 3.9430004846331797`*^9}, {
  3.943000906158533*^9, 
  3.943000906193693*^9}},ExpressionUUID->"c1f5f780-ebe2-4046-8288-\
a21fb6ad467a"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"w", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", "m"}], ")"}], 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"F", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              FractionBox["1", "N"], ")"}], 
             RowBox[{"(", 
              RowBox[{"d", "+", 
               RowBox[{"c", " ", "xfocal"}]}], ")"}]}], "+", 
            RowBox[{
             RowBox[{"(", 
              FractionBox[
               RowBox[{"N", "-", "1"}], "N"], ")"}], 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"d", 
                RowBox[{"(", 
                 RowBox[{"1", "-", "xothers"}], ")"}]}], "+", 
               RowBox[{"c", " ", "xfocal", 
                RowBox[{"(", 
                 RowBox[{"1", "-", "g"}], ")"}]}], "+", 
               RowBox[{"s", " ", "xothers"}]}], ")"}]}]}], ")"}]}], "-", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "-", "F"}], ")"}], "d"}]}], ")"}], "/", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "-", "m"}], ")"}], 
          RowBox[{"(", 
           RowBox[{"1", "-", 
            RowBox[{"F", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 FractionBox["1", "N"], ")"}], 
                RowBox[{"(", 
                 RowBox[{"d", "+", 
                  RowBox[{"c", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    FractionBox[
                    RowBox[{"xothers", 
                    RowBox[{"(", 
                    RowBox[{"N", "-", "1"}], ")"}]}], "N"], "+", 
                    FractionBox["xfocal", "N"]}], ")"}]}]}], ")"}]}], "+", 
               RowBox[{
                RowBox[{"(", 
                 FractionBox[
                  RowBox[{"N", "-", "1"}], "N"], ")"}], 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"d", 
                   RowBox[{"(", 
                    RowBox[{"1", "-", 
                    RowBox[{"(", 
                    RowBox[{
                    FractionBox[
                    RowBox[{"xothers", 
                    RowBox[{"(", 
                    RowBox[{"N", "-", "1"}], ")"}]}], "N"], "+", 
                    FractionBox["xfocal", "N"]}], ")"}]}], ")"}]}], "+", 
                  RowBox[{"c", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    FractionBox[
                    RowBox[{"xothers", 
                    RowBox[{"(", 
                    RowBox[{"N", "-", "1"}], ")"}]}], "N"], "+", 
                    FractionBox["xfocal", "N"]}], ")"}], 
                   RowBox[{"(", 
                    RowBox[{"1", "-", "g"}], ")"}]}], "+", 
                  RowBox[{"s", 
                   RowBox[{"(", 
                    RowBox[{
                    FractionBox[
                    RowBox[{"xothers", 
                    RowBox[{"(", 
                    RowBox[{"N", "-", "1"}], ")"}]}], "N"], "+", 
                    FractionBox["xfocal", "N"]}], ")"}]}]}], ")"}]}]}], 
              ")"}]}], "-", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "-", "F"}], ")"}], "d"}]}], ")"}]}], "+", 
         RowBox[{"m", 
          RowBox[{"(", 
           RowBox[{"1", "-", 
            RowBox[{"F", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 FractionBox["1", "N"], ")"}], 
                RowBox[{"(", 
                 RowBox[{"d", "+", 
                  RowBox[{"c", " ", "xpop"}]}], ")"}]}], "+", 
               RowBox[{
                RowBox[{"(", 
                 FractionBox[
                  RowBox[{"N", "-", "1"}], "N"], ")"}], 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"d", 
                   RowBox[{"(", 
                    RowBox[{"1", "-", "xpop"}], ")"}]}], "+", 
                  RowBox[{"c", " ", "xpop", 
                   RowBox[{"(", 
                    RowBox[{"1", "-", "g"}], ")"}]}], "+", 
                  RowBox[{"s", " ", "xpop"}]}], ")"}]}]}], ")"}]}], "-", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "-", "F"}], ")"}], "d"}]}], ")"}]}]}], ")"}]}]}], 
     "+", 
     RowBox[{"m", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"F", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              FractionBox["1", "N"], ")"}], 
             RowBox[{"(", 
              RowBox[{"d", "+", 
               RowBox[{"c", " ", "xfocal"}]}], ")"}]}], "+", 
            RowBox[{
             RowBox[{"(", 
              FractionBox[
               RowBox[{"N", "-", "1"}], "N"], ")"}], 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"d", 
                RowBox[{"(", 
                 RowBox[{"1", "-", "xothers"}], ")"}]}], "+", 
               RowBox[{"c", " ", "xfocal", 
                RowBox[{"(", 
                 RowBox[{"1", "-", "g"}], ")"}]}], "+", 
               RowBox[{"s", " ", "xothers"}]}], ")"}]}]}], ")"}]}], "-", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "-", "F"}], ")"}], "d"}]}], ")"}], "/", 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"F", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              FractionBox["1", "N"], ")"}], 
             RowBox[{"(", 
              RowBox[{"d", "+", 
               RowBox[{"c", " ", "xpop"}]}], ")"}]}], "+", 
            RowBox[{
             RowBox[{"(", 
              FractionBox[
               RowBox[{"N", "-", "1"}], "N"], ")"}], 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"d", 
                RowBox[{"(", 
                 RowBox[{"1", "-", "xpop"}], ")"}]}], "+", 
               RowBox[{"c", " ", "xpop", 
                RowBox[{"(", 
                 RowBox[{"1", "-", "g"}], ")"}]}], "+", " ", 
               RowBox[{"s", " ", "xpop"}]}], ")"}]}]}], ")"}]}], "-", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "-", "F"}], ")"}], "d"}]}], ")"}]}]}]}]}], ";"}], 
  "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.908103877779798*^9, 3.9081039368551617`*^9}, {
   3.9082687020329027`*^9, 3.908268859066394*^9}, {3.908269883914235*^9, 
   3.908269920730289*^9}, {3.908355862871335*^9, 3.908355902589114*^9}, {
   3.9108604899938927`*^9, 3.910860560580213*^9}, {3.9113770175862293`*^9, 
   3.911377066649146*^9}, {3.911391018117175*^9, 3.911391056891016*^9}, 
   3.915175265985262*^9, {3.916903665255417*^9, 3.916903737332921*^9}, {
   3.916903780079558*^9, 3.916903784107769*^9}, {3.9169113750673647`*^9, 
   3.916911375075122*^9}, {3.916911412340334*^9, 3.916911412349597*^9}, {
   3.916911465589005*^9, 3.9169114655986567`*^9}, {3.9169115536660643`*^9, 
   3.916911553671792*^9}, {3.916920964243086*^9, 3.9169209642489967`*^9}, {
   3.9355960316229*^9, 3.9355960696723843`*^9}, {3.935596332859233*^9, 
   3.935596371523262*^9}, {3.935596470888687*^9, 3.9355966386134357`*^9}, {
   3.935735988116892*^9, 3.935736019586771*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"b3b30ec9-5b45-421d-abb6-2072348667a9"],

Cell["\<\
We undertake a closed analysis, which means we use an explicit expression for \
F in the following calculations (Equation E1 in the SI). The derivative of \
focal individual fitness, with respect to the focal individual trait value, \
evaluated at monomorphic equilibrium, is written below (as -cm). Note that \
the \[OpenCurlyQuote]cm\[CloseCurlyQuote] notation is used to represent the \
\[OpenCurlyQuote]marginal cost\[CloseCurlyQuote] of \
Hamilton\[CloseCurlyQuote]s Rule. This is Equation E5 in the SI.\
\>", "Text",
 CellChangeTimes->{{3.915175733249536*^9, 3.915175737026534*^9}, {
  3.915175857656424*^9, 3.915175883915668*^9}, {3.915202107785346*^9, 
  3.915202108337833*^9}, {3.943000531793955*^9, 3.9430005323623247`*^9}, {
  3.9430008446204453`*^9, 
  3.943000884610037*^9}},ExpressionUUID->"d8f4e8d4-caf4-45f9-85b6-\
2ae0c5289146"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"cm", "=", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{"D", "[", 
       RowBox[{"w", ",", "xfocal"}], "]"}]}], "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"xpop", "->", 
        SuperscriptBox["x", "*"]}], ",", 
       RowBox[{"xothers", "->", 
        SuperscriptBox["x", "*"]}], ",", 
       RowBox[{"xfocal", "->", 
        SuperscriptBox["x", "*"]}], ",", 
       RowBox[{"F", "->", 
        RowBox[{"1", "/", 
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"m", "-", "2"}], ")"}], " ", "m", " ", "N"}], ")"}], 
            "/", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"m", "-", "1"}], ")"}], "^", "2"}]}]}], ")"}]}]}]}], 
      "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"TraditionalForm", "[", 
  RowBox[{"-", "cm"}], "]"}]}], "Input",
 CellChangeTimes->{{3.915177161684618*^9, 3.9151771773356667`*^9}, {
   3.9169114123507566`*^9, 3.916911412351968*^9}, 3.9169114655999727`*^9, 
   3.916911553673272*^9, 3.9169208882701902`*^9, {3.9357360698282843`*^9, 
   3.935736091700194*^9}, {3.935736143665668*^9, 3.935736148540762*^9}, {
   3.935736432501375*^9, 3.935736438118072*^9}},
 CellLabel->"In[2]:=",ExpressionUUID->"1918650e-1b62-4b36-8aea-e6e638806ec5"],

Cell[BoxData[
 FormBox[
  RowBox[{"-", 
   FractionBox[
    RowBox[{
     RowBox[{"c", " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"m", "-", "1"}], ")"}], "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"g", "-", "1"}], ")"}], " ", "N"}], "-", "g"}], ")"}], " ", 
      
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"m", "-", "1"}], ")"}], "2"], "-", "N"}], ")"}]}], "+", 
     RowBox[{"d", " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"m", "-", "1"}], ")"}], "4"], " ", 
      RowBox[{"(", 
       RowBox[{"N", "-", "1"}], ")"}]}], "-", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"m", "-", "1"}], ")"}], "4"], " ", 
      RowBox[{"(", 
       RowBox[{"N", "-", "1"}], ")"}], " ", "s"}]}], 
    RowBox[{"N", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"m", "-", "1"}], ")"}], "2"], " ", 
        SuperscriptBox["x", "*"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"N", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"c", " ", "g"}], "-", "s"}], ")"}]}], "-", 
          RowBox[{"c", " ", 
           RowBox[{"(", 
            RowBox[{"g", "+", "N"}], ")"}]}], "+", 
          RowBox[{"d", " ", 
           RowBox[{"(", 
            RowBox[{"N", "-", "1"}], ")"}]}], "+", "s"}], ")"}]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"d", "-", "1"}], ")"}], " ", "N", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"m", "-", "2"}], ")"}], " ", "m", " ", 
           RowBox[{"(", 
            RowBox[{"N", "-", "1"}], ")"}]}], "-", "1"}], ")"}]}]}], 
      ")"}]}]]}], TraditionalForm]], "Output",
 CellChangeTimes->{
  3.9357361487428293`*^9, {3.935736438866599*^9, 3.9357364425294313`*^9}, 
   3.935737436921743*^9},
 CellLabel->
  "Out[3]//TraditionalForm=",ExpressionUUID->"ced27d83-53b7-4362-9dba-\
a164be397e5b"]
}, Open  ]],

Cell["\<\
The derivative of focal individual fitness, with respect to the average trait \
value of other individuals on the deme, evaluated at monomorphic equilibrium, \
is written below. Note that the \[OpenCurlyQuote]bm\[CloseCurlyQuote] \
notation is used to represent the \[OpenCurlyQuote]marginal benefit\
\[CloseCurlyQuote] of Hamilton\[CloseCurlyQuote]s Rule. This is Equation E6 \
in the SI.\
\>", "Text",
 CellChangeTimes->{{3.915175418488715*^9, 3.915175518937564*^9}, 
   3.915175722238924*^9, {3.915175920186359*^9, 3.915175930914809*^9}, {
   3.915202112427059*^9, 3.915202112942956*^9}, {3.9430005611745033`*^9, 
   3.943000561705338*^9}},ExpressionUUID->"febdf4cf-fa24-4bae-848c-\
fd86aa77dd8c"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TraditionalForm", "[", 
  RowBox[{"bm", "=", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{"w", ",", "xothers"}], "]"}], "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"xpop", "->", 
        SuperscriptBox["x", "*"]}], ",", 
       RowBox[{"xothers", "->", 
        SuperscriptBox["x", "*"]}], ",", 
       RowBox[{"xfocal", "->", 
        SuperscriptBox["x", "*"]}], ",", 
       RowBox[{"F", "->", 
        RowBox[{"1", "/", 
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"m", "-", "2"}], ")"}], " ", "m", " ", "N"}], ")"}], 
            "/", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"m", "-", "1"}], ")"}], "^", "2"}]}]}], ")"}]}]}]}], 
      "}"}]}], "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.9081039414213743`*^9, 3.9081039435052147`*^9}, {
   3.90810406510456*^9, 3.908104073589612*^9}, {3.9081043026353397`*^9, 
   3.9081043339158287`*^9}, 3.908106925554028*^9, {3.911391003528234*^9, 
   3.9113910075287848`*^9}, {3.9115423725276537`*^9, 3.911542390599454*^9}, {
   3.915175399934017*^9, 3.915175400756152*^9}, 3.915175723845454*^9, {
   3.915177193413665*^9, 3.9151771935552893`*^9}, {3.916911412353875*^9, 
   3.916911412354452*^9}, {3.916911465600852*^9, 3.916911465601432*^9}, 
   3.916911553674254*^9, 3.916920996643852*^9, {3.935736554473469*^9, 
   3.9357365546330967`*^9}},
 CellLabel->"In[4]:=",ExpressionUUID->"ba16fd83-18fc-46c3-909a-b698ab2cb643"],

Cell[BoxData[
 FormBox[
  RowBox[{"-", 
   FractionBox[
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"m", "-", "1"}], ")"}], "2"], " ", 
     RowBox[{"(", 
      RowBox[{"N", "-", "1"}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"c", " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"m", "-", "1"}], ")"}], "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"g", " ", 
           RowBox[{"(", 
            RowBox[{"N", "-", "1"}], ")"}]}], "-", "N"}], ")"}]}], "+", 
       RowBox[{"d", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"m", "-", "2"}], ")"}], " ", "m", " ", 
           RowBox[{"(", 
            RowBox[{"N", "-", "1"}], ")"}]}], "-", "1"}], ")"}]}], "-", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"m", "-", "2"}], ")"}], " ", "m", " ", 
        RowBox[{"(", 
         RowBox[{"N", "-", "1"}], ")"}], " ", "s"}], "+", "s"}], ")"}]}], 
    RowBox[{"N", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"m", "-", "1"}], ")"}], "2"], " ", 
        SuperscriptBox["x", "*"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"N", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"c", " ", "g"}], "-", "s"}], ")"}]}], "-", 
          RowBox[{"c", " ", 
           RowBox[{"(", 
            RowBox[{"g", "+", "N"}], ")"}]}], "+", 
          RowBox[{"d", " ", 
           RowBox[{"(", 
            RowBox[{"N", "-", "1"}], ")"}]}], "+", "s"}], ")"}]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"d", "-", "1"}], ")"}], " ", "N", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"m", "-", "2"}], ")"}], " ", "m", " ", 
           RowBox[{"(", 
            RowBox[{"N", "-", "1"}], ")"}]}], "-", "1"}], ")"}]}]}], 
      ")"}]}]]}], TraditionalForm]], "Output",
 CellChangeTimes->{3.916920998726347*^9, 3.917006433333035*^9, 
  3.917007075679339*^9, 3.917168122794384*^9, 3.921300579207028*^9, 
  3.935596677132285*^9, 3.935736556623156*^9, 3.9357374371103487`*^9},
 CellLabel->
  "Out[4]//TraditionalForm=",ExpressionUUID->"d20b65ae-cc75-4161-a85a-\
a9b3ca22b208"]
}, Open  ]],

Cell["\<\
The overall marginal change in neighbour-modulated fitness associated with a \
slight change in behaviour is written below, on the (true) assumption that \
relatedness emerges from model parameters (open model). Relatedness is given \
by 1 (Equation E7).The \[OpenCurlyQuote]margclosed\[CloseCurlyQuote] notation \
is used to represent the marginal fitness change, and the closed model \
setting. This is Equation E8 in the SI.\
\>", "Text",
 CellChangeTimes->{{3.915175958153467*^9, 3.915176040877063*^9}, {
  3.915177227882449*^9, 3.9151773535121117`*^9}, {3.915202480835009*^9, 
  3.91520248145765*^9}, {3.943000702533309*^9, 
  3.943000763300826*^9}},ExpressionUUID->"8d71afb1-1db5-45ed-a925-\
7d02376f98e5"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TraditionalForm", "[", 
  RowBox[{"margclosed", "=", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       SuperscriptBox["r", "*"], " ", "bm"}], " ", "-", " ", "cm"}], "/.", 
     RowBox[{"{", 
      RowBox[{
       SuperscriptBox["r", "*"], "->", "1"}], "}"}]}], "]"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.9081044477104807`*^9, 3.908104459241107*^9}, {
   3.908104492639288*^9, 3.9081044941536303`*^9}, {3.9081051452016487`*^9, 
   3.90810514887316*^9}, {3.9151758222548037`*^9, 3.9151758368976316`*^9}, {
   3.915177197160902*^9, 3.9151772227977467`*^9}, 3.915177266100378*^9, {
   3.917006399083518*^9, 3.917006454533423*^9}, {3.9170064855052347`*^9, 
   3.9170064866297903`*^9}, {3.935737455000799*^9, 3.935737467203623*^9}, {
   3.943000768347785*^9, 
   3.94300076907143*^9}},ExpressionUUID->"82adc939-3108-4edd-9db0-\
c53f402953ff"],

Cell[BoxData[
 FormBox[
  RowBox[{"-", 
   FractionBox[
    RowBox[{
     RowBox[{"(", 
      RowBox[{"m", "-", "2"}], ")"}], " ", "m"}], 
    RowBox[{
     FractionBox[
      RowBox[{
       RowBox[{"(", 
        RowBox[{"d", "-", "1"}], ")"}], " ", "N", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"m", "-", "2"}], ")"}], " ", "m", " ", 
          RowBox[{"(", 
           RowBox[{"N", "-", "1"}], ")"}]}], "-", "1"}], ")"}]}], 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"m", "-", "1"}], ")"}], "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"N", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"c", " ", "g"}], "-", "s"}], ")"}]}], "-", 
         RowBox[{"c", " ", 
          RowBox[{"(", 
           RowBox[{"g", "+", "N"}], ")"}]}], "+", 
         RowBox[{"d", " ", 
          RowBox[{"(", 
           RowBox[{"N", "-", "1"}], ")"}]}], "+", "s"}], ")"}]}]], "+", 
     SuperscriptBox["x", "*"]}]]}], TraditionalForm]], "Output",
 CellChangeTimes->{
  3.916921024606532*^9, 3.917006414970397*^9, 3.9170064565066137`*^9, 
   3.917006487254201*^9, 3.917007077552244*^9, 3.917168124236874*^9, 
   3.921300581076297*^9, {3.935596681574321*^9, 3.935596698011595*^9}, 
   3.935737408396372*^9, {3.935737444003677*^9, 3.935737468591404*^9}},
 CellLabel->
  "Out[6]//TraditionalForm=",ExpressionUUID->"1c86a7c1-d009-43f8-9c22-\
c56c8e757708"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Model F) Inclusive fitness versions of Models C & E", "Section",
 CellChangeTimes->{{3.935827170493651*^9, 3.935827175184251*^9}, {
  3.943002898620946*^9, 
  3.9430029027338037`*^9}},ExpressionUUID->"c1f9b66c-6baa-4e2b-a38e-\
2016de8d788d"],

Cell["\<\
We undertake inclusive fitness versions of Models C & E. We first write down \
the marginal inclusive fitness of signalling (IF). \
\>", "Text",
 CellChangeTimes->{{3.943001493820606*^9, 3.943001524363961*^9}, {
  3.9430016437828817`*^9, 3.943001645709836*^9}, {3.943002831667665*^9, 
  3.9430028578847027`*^9}},ExpressionUUID->"74088476-246c-41b5-8ecd-\
d3a219b8bef7"],

Cell[BoxData[
 RowBox[{
  RowBox[{"IF", "=", 
   RowBox[{
    RowBox[{"B", " ", "r"}], " ", "-", " ", "C", " ", "-", " ", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"1", "-", "m"}], ")"}], "2"], 
     RowBox[{"(", 
      RowBox[{"B", "-", "C"}], ")"}], "rwhole"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.943001720099524*^9, 3.943001725713936*^9}, {
  3.943001989429563*^9, 3.94300198978951*^9}},
 CellLabel->"In[6]:=",ExpressionUUID->"c7d7ad69-fc56-45fa-824b-045a916038f9"],

Cell["\<\
When individuals signal indiscriminately, r is given by Equation A16 in the \
SI and rwhole is given by Equation A14. Substituting these into IF and \
evaluating when the inclusive fitness effect is positive (IF>0), we obtain \
the following, which we can see by inspection never holds. This means that \
indiscriminate signalling is not favoured, recovering the result of Model C.\
\>", "Text",
 CellChangeTimes->{{3.943001647759591*^9, 3.94300168770234*^9}, {
  3.9430017181934443`*^9, 3.9430017580801477`*^9}, {3.9430019673482313`*^9, 
  3.9430020137537394`*^9}, {3.943002302309284*^9, 
  3.943002346527205*^9}},ExpressionUUID->"862fa872-8146-4779-b640-\
4ef5655d7989"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TraditionalForm", "[", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{
    RowBox[{"IF", ">", "0"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"r", "->", 
       RowBox[{"1", "/", 
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"m", "-", "2"}], ")"}], " ", "m", " ", "N"}], ")"}], 
           "/", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"m", "-", "1"}], ")"}], "^", "2"}]}]}], ")"}]}]}], ",", 
      RowBox[{"rwhole", "->", 
       FractionBox["1", 
        RowBox[{"N", "-", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"N", "-", "1"}], ")"}], 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"1", "-", "m"}], ")"}], "2"]}]}]]}]}], "}"}]}], "]"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.9358278720052958`*^9, 3.935827876912027*^9}, {
   3.9358332099936323`*^9, 3.935833239632106*^9}, 3.943001527459179*^9, {
   3.9430020179443417`*^9, 3.943002119523548*^9}, {3.9430022020842533`*^9, 
   3.94300220937649*^9}, {3.9430022816670437`*^9, 3.943002284901801*^9}},
 CellLabel->"In[20]:=",ExpressionUUID->"8fecfcac-0065-4809-aaf8-6e3263b13428"],

Cell[BoxData[
 FormBox[
  RowBox[{
   RowBox[{"C", " ", 
    RowBox[{"(", 
     RowBox[{"m", "-", "2"}], ")"}], " ", "m", " ", "N", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"m", "-", "2"}], ")"}], " ", "m", " ", 
       RowBox[{"(", 
        RowBox[{"N", "-", "1"}], ")"}]}], "-", "1"}], ")"}]}], "<", "0"}], 
  TraditionalForm]], "Output",
 CellChangeTimes->{
  3.935827901380669*^9, 3.935827992395897*^9, 3.935828076532113*^9, {
   3.935833240397831*^9, 3.93583325014641*^9}, 3.935835336884445*^9, {
   3.943002055622072*^9, 3.9430021207611523`*^9}, 3.94300224503934*^9, 
   3.94300228510832*^9},
 CellLabel->
  "Out[20]//TraditionalForm=",ExpressionUUID->"3a5c65fc-de52-4679-9ad5-\
943999441572"]
}, Open  ]],

Cell["\<\
When individuals signal discriminatorily towards kin, r is given by Equation \
E7 in the SI (i.e. is equal to 1) and rwhole is given by Equation A14 as \
before. Substituting these into IF and evaluating when the inclusive fitness \
effect is positive (IF>0), we obtain the following, which we can see by \
inspection simplifies to B>C.\
\>", "Text",
 CellChangeTimes->{{3.943002368576229*^9, 3.943002444589724*^9}, {
  3.943002497792737*^9, 
  3.943002518893573*^9}},ExpressionUUID->"e4cb48ec-69a8-4bfa-a95b-\
adc310e69964"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TraditionalForm", "[", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{
    RowBox[{"IF", ">", "0"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"r", "->", "1"}], ",", 
      RowBox[{"rwhole", "->", 
       FractionBox["1", 
        RowBox[{"N", "-", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"N", "-", "1"}], ")"}], 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"1", "-", "m"}], ")"}], "2"]}]}]]}]}], "}"}]}], "]"}], 
  "]"}]], "Input",
 CellChangeTimes->{3.9430024591985283`*^9},
 CellLabel->"In[21]:=",ExpressionUUID->"88669d3d-444c-426c-a449-36faeba32723"],

Cell[BoxData[
 FormBox[
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{"m", "-", "2"}], ")"}], " ", "m", " ", "N", " ", 
    RowBox[{"(", 
     RowBox[{"B", "-", "C"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"m", "-", "2"}], ")"}], " ", "m", " ", 
       RowBox[{"(", 
        RowBox[{"N", "-", "1"}], ")"}]}], "-", "1"}], ")"}]}], ">", "0"}], 
  TraditionalForm]], "Output",
 CellChangeTimes->{3.943002459969755*^9},
 CellLabel->
  "Out[21]//TraditionalForm=",ExpressionUUID->"e3cf372a-9eb8-4557-8851-\
5ebbdee35436"]
}, Open  ]],

Cell["\<\
We then evaluate B-C using the explicit values for B & C provided in \
Equations F3 & F4 respectively. We obtain the following, which simplifies to \
Equation E9 in the SI, recovering the result of Model E.\
\>", "Text",
 CellChangeTimes->{{3.943002540568193*^9, 3.943002599086594*^9}, {
  3.943002671079011*^9, 3.9430026893660927`*^9}, {3.943002726054226*^9, 
  3.943002755346366*^9}, {3.943002882653726*^9, 
  3.943002888701314*^9}},ExpressionUUID->"41a47b91-24eb-43e9-9b7a-\
2e51f87e06d1"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"FullSimplify", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{"B", "-", "C"}], ")"}], ">", "0"}], "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"B", "->", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"d", "-", "s"}], ")"}], 
         FractionBox[
          RowBox[{"N", "-", "1"}], "N"]}], ")"}], "F"}]}], ",", 
     RowBox[{"C", "->", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"c", 
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{
            FractionBox[
             RowBox[{"N", "-", "1"}], "N"], "g"}]}], ")"}]}], ")"}], 
       "F"}]}]}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.9358280047677393`*^9, 3.935828044985079*^9}, {
  3.935828469477447*^9, 3.9358284952635393`*^9}, {3.943002613919849*^9, 
  3.9430026432365437`*^9}},
 CellLabel->"In[23]:=",ExpressionUUID->"2a45b3a3-ca94-4c66-a0ac-e2211c3da7d9"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "m"}], ")"}], "2"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "2"}], "+", "m"}], ")"}], " ", "m", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "N"}], ")"}]}]}], ")"}], " ", "N", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "c"}], " ", "g"}], "+", 
     RowBox[{"d", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "N"}], ")"}]}], "+", 
     RowBox[{"c", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "g"}], ")"}], " ", "N"}], "+", "s", "-", 
     RowBox[{"N", " ", "s"}]}], ")"}]}], "<", "0"}]], "Output",
 CellChangeTimes->{{3.9430026364127817`*^9, 3.943002643524973*^9}},
 CellLabel->"Out[23]=",ExpressionUUID->"1312add7-ee87-4bf0-bf65-32a3ec97d317"]
}, Open  ]],

Cell["", "Text",
 CellChangeTimes->{{3.935828513814288*^9, 3.9358285189367857`*^9}, 
   3.943002691917699*^9},ExpressionUUID->"7a67705b-2bcc-41eb-9f9b-\
09c67338a597"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.9358278492717943`*^9, 
  3.9358278498558893`*^9}},ExpressionUUID->"91d0f52a-39b8-4766-bf26-\
854410abbf0b"]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
Models G & H) Cue-suppression; migration after population regulation\
\>", "Section",
 CellChangeTimes->{{3.915174600364295*^9, 3.91517462569272*^9}, 
   3.91517466765668*^9, {3.915175186685773*^9, 3.915175197207159*^9}, {
   3.91517755046989*^9, 3.9151775509280024`*^9}, {3.915178174251244*^9, 
   3.915178176160171*^9}, {3.915184562918439*^9, 3.915184568372199*^9}, {
   3.943003321868208*^9, 
   3.943003323782522*^9}},ExpressionUUID->"040398a3-4a45-46e3-9cd1-\
865e1abed546"],

Cell["\<\
Neighbour-modulated fitness for the focal individual (w) is written below.\
\>", "Text",
 CellChangeTimes->{{3.9151752377757063`*^9, 3.915175259620417*^9}, {
  3.915175352890313*^9, 3.9151753593515577`*^9}, {3.915202580661879*^9, 
  3.915202581910602*^9}},ExpressionUUID->"50c16f6b-77bd-401d-81a4-\
4ae4d681c945"],

Cell[BoxData[
 RowBox[{
  RowBox[{"w", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"1", "-", 
      RowBox[{
       RowBox[{"(", 
        FractionBox["1", "N"], ")"}], 
       RowBox[{"(", 
        RowBox[{"d", "+", 
         RowBox[{"c", " ", "xfocal"}]}], ")"}]}], "-", 
      RowBox[{
       RowBox[{"(", 
        FractionBox[
         RowBox[{"N", "-", "1"}], "N"], ")"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"d", 
          RowBox[{"(", "xothers", ")"}]}], "+", 
         RowBox[{"c", " ", "xfocal", 
          RowBox[{"(", 
           RowBox[{"1", "-", "g"}], ")"}]}], "+", 
         RowBox[{"s", 
          RowBox[{"(", 
           RowBox[{"1", "-", "xothers"}], ")"}]}]}], ")"}]}]}], ")"}], "/", 
    RowBox[{"(", 
     RowBox[{"1", "-", 
      RowBox[{
       RowBox[{"(", 
        FractionBox["1", "N"], ")"}], 
       RowBox[{"(", 
        RowBox[{"d", "+", 
         RowBox[{"c", " ", 
          RowBox[{"(", 
           RowBox[{
            FractionBox[
             RowBox[{"xothers", 
              RowBox[{"(", 
               RowBox[{"N", "-", "1"}], ")"}]}], "N"], "+", 
            FractionBox["xfocal", "N"]}], ")"}]}]}], ")"}]}], "-", 
      RowBox[{
       RowBox[{"(", 
        FractionBox[
         RowBox[{"N", "-", "1"}], "N"], ")"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"d", 
          RowBox[{"(", 
           RowBox[{"(", 
            RowBox[{
             FractionBox[
              RowBox[{"xothers", 
               RowBox[{"(", 
                RowBox[{"N", "-", "1"}], ")"}]}], "N"], "+", 
             FractionBox["xfocal", "N"]}], ")"}], ")"}]}], "+", 
         RowBox[{"c", " ", 
          RowBox[{"(", 
           RowBox[{
            FractionBox[
             RowBox[{"xothers", 
              RowBox[{"(", 
               RowBox[{"N", "-", "1"}], ")"}]}], "N"], "+", 
            FractionBox["xfocal", "N"]}], ")"}], 
          RowBox[{"(", 
           RowBox[{"1", "-", "g"}], ")"}]}], "+", 
         RowBox[{"s", 
          RowBox[{"(", 
           RowBox[{"1", "-", 
            FractionBox[
             RowBox[{"xothers", 
              RowBox[{"(", 
               RowBox[{"N", "-", "1"}], ")"}]}], "N"], "-", 
            FractionBox["xfocal", "N"]}], ")"}]}]}], ")"}]}]}], ")"}]}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.908103877779798*^9, 3.9081039368551617`*^9}, {
   3.9082687020329027`*^9, 3.908268859066394*^9}, {3.908269883914235*^9, 
   3.908269920730289*^9}, {3.908355862871335*^9, 3.908355902589114*^9}, {
   3.9108604899938927`*^9, 3.910860560580213*^9}, {3.9113770175862293`*^9, 
   3.911377066649146*^9}, {3.911391018117175*^9, 3.911391056891016*^9}, 
   3.915175265985262*^9, {3.915177560180121*^9, 3.9151775756131973`*^9}, {
   3.915178200264545*^9, 3.915178239018537*^9}, {3.9169047130418262`*^9, 
   3.9169047172647753`*^9}, {3.916904798095763*^9, 3.916904806290079*^9}, {
   3.91690484880543*^9, 3.91690485477936*^9}, {3.916911375110134*^9, 
   3.916911375111356*^9}, {3.916911412361319*^9, 3.9169114123655043`*^9}, {
   3.916911465602859*^9, 3.916911465607473*^9}},
 CellLabel->
  "In[191]:=",ExpressionUUID->"4104c392-96b6-4c29-ab36-52d0aba19d49"],

Cell["\<\
The derivative of focal individual fitness, with respect to the focal \
individual trait value, evaluated at monomorphic equilibrium, is written \
below (as -cm). Note that the \[OpenCurlyQuote]cm\[CloseCurlyQuote] notation \
is used to represent the \[OpenCurlyQuote]marginal cost\[CloseCurlyQuote] of \
Hamilton\[CloseCurlyQuote]s Rule. This is Equation G4 in the SI.\
\>", "Text",
 CellChangeTimes->{{3.915175733249536*^9, 3.915175737026534*^9}, {
   3.915175857656424*^9, 3.915175883915668*^9}, {3.915202602421441*^9, 
   3.915202602808991*^9}, 
   3.943003271755788*^9},ExpressionUUID->"a952d5f5-de64-4dce-92fd-\
00031a61f240"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"cm", "=", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{"D", "[", 
       RowBox[{"w", ",", "xfocal"}], "]"}]}], "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"xpop", "->", 
        SuperscriptBox["x", "*"]}], ",", 
       RowBox[{"xothers", "->", 
        SuperscriptBox["x", "*"]}], ",", 
       RowBox[{"xfocal", "->", 
        SuperscriptBox["x", "*"]}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"TraditionalForm", "[", 
  RowBox[{"-", "cm"}], "]"}]}], "Input",
 CellChangeTimes->{{3.915177161684618*^9, 3.9151771773356667`*^9}, {
   3.916911412366617*^9, 3.9169114123678703`*^9}, 3.916911465608355*^9, 
   3.916911553675412*^9, 3.9169227267665663`*^9},
 CellLabel->
  "In[192]:=",ExpressionUUID->"fe76039b-3638-4c90-808f-c65e0a2cc2e9"],

Cell[BoxData[
 FormBox[
  RowBox[{"-", 
   FractionBox[
    RowBox[{
     RowBox[{"(", 
      RowBox[{"N", "-", "1"}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"c", " ", 
        RowBox[{"(", 
         RowBox[{"g", "-", "1"}], ")"}], " ", "N"}], "-", 
       RowBox[{"c", " ", "g"}], "+", "d", "-", "s"}], ")"}]}], 
    RowBox[{"N", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        SuperscriptBox["x", "*"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", 
           RowBox[{"N", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"c", " ", "g"}], "+", "s"}], ")"}]}]}], "+", 
          RowBox[{"c", " ", 
           RowBox[{"(", 
            RowBox[{"g", "+", "N"}], ")"}]}], "+", 
          RowBox[{"d", " ", 
           RowBox[{"(", 
            RowBox[{"N", "-", "1"}], ")"}]}], "+", "s"}], ")"}]}], "+", "d", 
       "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"N", "-", "1"}], ")"}], " ", "s"}], "-", "N"}], ")"}]}]]}], 
  TraditionalForm]], "Output",
 CellChangeTimes->{{3.9169227113069973`*^9, 3.916922728460099*^9}, 
   3.917008471358342*^9, 3.9170086040876837`*^9, 3.91701000823407*^9},
 CellLabel->
  "Out[193]//TraditionalForm=",ExpressionUUID->"e234d016-ba81-4bbf-85b8-\
5e3d847f19c6"]
}, Open  ]],

Cell["\<\
The derivative of focal individual fitness, with respect to the average trait \
value of other individuals on the deme, evaluated at monomorphic equilibrium, \
is written below. Note that the \[OpenCurlyQuote]bm\[CloseCurlyQuote] \
notation is used to represent the \[OpenCurlyQuote]marginal benefit\
\[CloseCurlyQuote] of Hamilton\[CloseCurlyQuote]s Rule. This is Equation G5 \
in the SI.\
\>", "Text",
 CellChangeTimes->{{3.915175418488715*^9, 3.915175518937564*^9}, 
   3.915175722238924*^9, {3.915175920186359*^9, 3.915175930914809*^9}, {
   3.915202609953712*^9, 3.915202610239882*^9}, 
   3.943003277145791*^9},ExpressionUUID->"4c2c2ffb-e217-490f-8eb3-\
5e5f469f813c"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TraditionalForm", "[", 
  RowBox[{"bm", "=", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{"w", ",", "xothers"}], "]"}], "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"xpop", "->", 
        SuperscriptBox["x", "*"]}], ",", 
       RowBox[{"xothers", "->", 
        SuperscriptBox["x", "*"]}], ",", 
       RowBox[{"xfocal", "->", 
        SuperscriptBox["x", "*"]}]}], "}"}]}], "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.9081039414213743`*^9, 3.9081039435052147`*^9}, {
   3.90810406510456*^9, 3.908104073589612*^9}, {3.9081043026353397`*^9, 
   3.9081043339158287`*^9}, 3.908106925554028*^9, {3.911391003528234*^9, 
   3.9113910075287848`*^9}, {3.9115423725276537`*^9, 3.911542390599454*^9}, {
   3.915175399934017*^9, 3.915175400756152*^9}, 3.915175723845454*^9, {
   3.915177193413665*^9, 3.9151771935552893`*^9}, {3.916911412369804*^9, 
   3.916911412370419*^9}, {3.916911465609292*^9, 3.916911465609918*^9}, 
   3.916911553676111*^9, 3.9169227397657337`*^9},
 CellLabel->
  "In[194]:=",ExpressionUUID->"90659cd5-c69b-42dc-8612-66b47068ad11"],

Cell[BoxData[
 FormBox[
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{"N", "-", "1"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"c", " ", 
       RowBox[{"(", 
        RowBox[{"g", "-", "1"}], ")"}], " ", "N"}], "-", 
      RowBox[{"c", " ", "g"}], "+", "d", "-", "s"}], ")"}]}], 
   RowBox[{"N", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SuperscriptBox["x", "*"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", 
          RowBox[{"N", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"c", " ", "g"}], "+", "s"}], ")"}]}]}], "+", 
         RowBox[{"c", " ", 
          RowBox[{"(", 
           RowBox[{"g", "+", "N"}], ")"}]}], "+", 
         RowBox[{"d", " ", 
          RowBox[{"(", 
           RowBox[{"N", "-", "1"}], ")"}]}], "+", "s"}], ")"}]}], "+", "d", 
      "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"N", "-", "1"}], ")"}], " ", "s"}], "-", "N"}], ")"}]}]], 
  TraditionalForm]], "Output",
 CellChangeTimes->{3.9169227409244127`*^9, 3.917008473207049*^9, 
  3.917008608447404*^9, 3.917010009620878*^9},
 CellLabel->
  "Out[194]//TraditionalForm=",ExpressionUUID->"93026e50-c110-484e-9ef4-\
baa984c17757"]
}, Open  ]],

Cell["\<\
The overall marginal change in neighbour-modulated fitness associated with a \
slight change in behaviour is written below, on the (false) assumption that \
relatedness is a constant (open model). The \[OpenCurlyQuote]margopen\
\[CloseCurlyQuote] notation is used to represent the marginal fitness change, \
and the open model setting. This is Equation H1 in the SI.\
\>", "Text",
 CellChangeTimes->{{3.915175958153467*^9, 3.915176040877063*^9}, {
   3.915177227882449*^9, 3.9151773535121117`*^9}, {3.915202648822825*^9, 
   3.9152026494999847`*^9}, 
   3.943003284262244*^9},ExpressionUUID->"cddfbd31-7bed-42b9-bcc7-\
cd4999122f0a"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TraditionalForm", "[", 
  RowBox[{"margopen", "=", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{
     RowBox[{
      SuperscriptBox["r", "*"], " ", "bm"}], " ", "-", " ", "cm"}], "]"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.9081044477104807`*^9, 3.908104459241107*^9}, {
   3.908104492639288*^9, 3.9081044941536303`*^9}, {3.9081051452016487`*^9, 
   3.90810514887316*^9}, {3.9151758222548037`*^9, 3.9151758368976316`*^9}, {
   3.915177197160902*^9, 3.9151772227977467`*^9}, 3.915177266100378*^9, {
   3.917008480333598*^9, 3.917008481382784*^9}},
 CellLabel->
  "In[110]:=",ExpressionUUID->"0af63682-ff07-472f-86b3-c74d732ea5ea"],

Cell[BoxData[
 FormBox[
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{"N", "-", "1"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["r", "*"], "-", "1"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"c", " ", 
       RowBox[{"(", 
        RowBox[{"g", "-", "1"}], ")"}], " ", "N"}], "-", 
      RowBox[{"c", " ", "g"}], "+", "d", "-", "s"}], ")"}]}], 
   RowBox[{"N", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SuperscriptBox["x", "*"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", 
          RowBox[{"N", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"c", " ", "g"}], "+", "s"}], ")"}]}]}], "+", 
         RowBox[{"c", " ", 
          RowBox[{"(", 
           RowBox[{"g", "+", "N"}], ")"}]}], "+", 
         RowBox[{"d", " ", 
          RowBox[{"(", 
           RowBox[{"N", "-", "1"}], ")"}]}], "+", "s"}], ")"}]}], "+", "d", 
      "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"N", "-", "1"}], ")"}], " ", "s"}], "-", "N"}], ")"}]}]], 
  TraditionalForm]], "Output",
 CellChangeTimes->{3.916922749128614*^9, 3.917008482645234*^9, 
  3.917008610279105*^9},
 CellLabel->
  "Out[110]//TraditionalForm=",ExpressionUUID->"67982d37-1cd5-4429-a9b9-\
c50ef1fd809d"]
}, Open  ]],

Cell["\<\
We ask when a slight increase in the behaviour is favoured. To do so, we \
first set the selection differential to zero, to obtain s\[Rule]c (g-1) N-c \
g+d. The behaviour is favoured when the right-hand side is greater than the \
left-hand side. This is Equation G7 (rearranged) in the SI. \
\>", "Text",
 CellChangeTimes->{{3.915176101958577*^9, 3.915176179387744*^9}, {
   3.915176229291583*^9, 3.915176243005365*^9}, {3.915177406063599*^9, 
   3.915177410206997*^9}, {3.915177643831272*^9, 3.915177649866047*^9}, {
   3.915178282165604*^9, 3.915178310651388*^9}, {3.915202988218347*^9, 
   3.915202988304565*^9}, {3.916911375130149*^9, 3.916911375130191*^9}, {
   3.916922842138954*^9, 3.916922861496777*^9}, {3.91692292975881*^9, 
   3.9169229525467663`*^9}, {3.9171688558487463`*^9, 3.9171688592811947`*^9}, 
   3.943003290030143*^9},ExpressionUUID->"30346f09-b0fa-4497-a9f2-\
d5ce3da08d84"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TraditionalForm", "[", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{"Solve", "[", 
    RowBox[{"margopen", "==", "0"}], "]"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.916905090812405*^9, 3.916905124722721*^9}},
 CellLabel->
  "In[111]:=",ExpressionUUID->"92a151a7-dca6-4277-b18f-2a6a59b34fc0"],

Cell[BoxData[
 FormBox[
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"N", "\[Rule]", "1"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"s", "\[Rule]", 
      RowBox[{
       RowBox[{"c", " ", 
        RowBox[{"(", 
         RowBox[{"g", "-", "1"}], ")"}], " ", "N"}], "-", 
       RowBox[{"c", " ", "g"}], "+", "d"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      SuperscriptBox["r", "*"], "\[Rule]", "1"}], "}"}]}], "}"}], 
  TraditionalForm]], "Output",
 CellChangeTimes->{3.9169227602462397`*^9, 3.9170084860796957`*^9, 
  3.9170086132040043`*^9},
 CellLabel->
  "Out[111]//TraditionalForm=",ExpressionUUID->"71875b7a-85b2-4fce-8edc-\
6183f9e1f4cc"]
}, Open  ]],

Cell[TextData[{
 "We now undertake the \[OpenCurlyQuote]closed model\[CloseCurlyQuote] \
analysis, where relatedness is not considered a constant, but is instead \
expressed in terms of model parameters. Relatedness is given by ",
 Cell[BoxData[
  FormBox[
   RowBox[{"r", "=", 
    FractionBox["1", 
     RowBox[{"1", "-", 
      FractionBox[
       RowBox[{
        RowBox[{"(", 
         RowBox[{"m", "-", "2"}], ")"}], " ", "m", " ", "N"}], 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"m", "-", "1"}], ")"}], "2"]]}]]}], TraditionalForm]],
  CellChangeTimes->{{3.910861979123197*^9, 3.9108619999508753`*^9}, {
    3.91086222963589*^9, 3.9108622426687517`*^9}, 3.910862460959608*^9, 
    3.9108626243521233`*^9, 3.9114609992207623`*^9, 3.911461049933278*^9, 
    3.911461104221305*^9, 3.9114637937132893`*^9, {3.9114638920883408`*^9, 
    3.9114638987610273`*^9}, {3.911464017519855*^9, 3.911464020308721*^9}, 
    3.911472250412627*^9, 3.911554645377158*^9},ExpressionUUID->
  "99c359a9-713a-43e5-a3be-2dc49a0057ec"],
 "(Equation A17). We therefore obtain the overall marginal change in \
neighbour-modulated fitness associated with a slight change in behaviour, on \
the (true) assumption that relatedness emerges from model parameters.  The \
\[OpenCurlyQuote]margclosed\[CloseCurlyQuote] notation is used to represent \
the marginal fitness change, and the closed model setting. This is Equation \
G6 in the SI. "
}], "Text",
 CellChangeTimes->{{3.915176441285725*^9, 3.915176587713168*^9}, {
   3.915177463317815*^9, 3.9151774714126167`*^9}, {3.915202670777313*^9, 
   3.915202671273993*^9}, {3.9152029790009317`*^9, 3.915202979718953*^9}, 
   3.9430032981458273`*^9},ExpressionUUID->"9841d958-651f-40e3-8193-\
0acb8b57e09b"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TraditionalForm", "[", 
  RowBox[{"margclosed", "=", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       SuperscriptBox["r", "*"], " ", "bm"}], " ", "-", " ", "cm"}], "/.", 
     RowBox[{"{", 
      RowBox[{
       SuperscriptBox["r", "*"], "->", 
       RowBox[{"1", "/", 
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"m", "-", "2"}], ")"}], " ", "m", " ", "N"}], ")"}], 
           "/", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"m", "-", "1"}], ")"}], "^", "2"}]}]}], ")"}]}]}], 
      "}"}]}], "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.91517659618088*^9, 3.915176615645871*^9}, 
   3.915177444830543*^9, {3.915177479766621*^9, 3.915177481869033*^9}, {
   3.917008491079932*^9, 3.917008503492703*^9}},
 CellLabel->
  "In[112]:=",ExpressionUUID->"9f8da327-e8ab-4d0b-9265-46ebb86d51ca"],

Cell[BoxData[
 FormBox[
  RowBox[{"-", 
   FractionBox[
    RowBox[{
     RowBox[{"(", 
      RowBox[{"m", "-", "2"}], ")"}], " ", "m", " ", 
     RowBox[{"(", 
      RowBox[{"N", "-", "1"}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"c", " ", 
        RowBox[{"(", 
         RowBox[{"g", "-", "1"}], ")"}], " ", "N"}], "-", 
       RowBox[{"c", " ", "g"}], "+", "d", "-", "s"}], ")"}]}], 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"m", "-", "2"}], ")"}], " ", "m", " ", 
        RowBox[{"(", 
         RowBox[{"N", "-", "1"}], ")"}]}], "-", "1"}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        SuperscriptBox["x", "*"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", 
           RowBox[{"N", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"c", " ", "g"}], "+", "s"}], ")"}]}]}], "+", 
          RowBox[{"c", " ", 
           RowBox[{"(", 
            RowBox[{"g", "+", "N"}], ")"}]}], "+", 
          RowBox[{"d", " ", 
           RowBox[{"(", 
            RowBox[{"N", "-", "1"}], ")"}]}], "+", "s"}], ")"}]}], "+", "d", 
       "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"N", "-", "1"}], ")"}], " ", "s"}], "-", "N"}], ")"}]}]]}], 
  TraditionalForm]], "Output",
 CellChangeTimes->{
  3.91692278763568*^9, {3.917008494628525*^9, 3.9170085042236443`*^9}, 
   3.9170086151559973`*^9},
 CellLabel->
  "Out[112]//TraditionalForm=",ExpressionUUID->"69cc473f-1c3b-4c55-a837-\
fc02b045383a"]
}, Open  ]],

Cell["\<\
We ask when a slight increase in the behaviour is favoured. To do so, we \
first set the selection differential to zero, to obtain s\[Rule]c (g-1) N-c \
g+d. The behaviour is favoured when the right-hand side is greater than the \
left-hand side. This is Equation G7 (rearranged) in the SI. We see that the \
behaviour is favoured under the same condition in both the open and closed \
versions of the model, and this is essentially because relatedness is \
unimportant for evolutionary outcomes in this lifecycle.\
\>", "Text",
 CellChangeTimes->{{3.9151769454838057`*^9, 3.9151769716502733`*^9}, {
   3.91517770399575*^9, 3.9151777276819963`*^9}, {3.915178376688755*^9, 
   3.915178465945472*^9}, {3.9152029998081284`*^9, 3.915203000349091*^9}, {
   3.916911375143531*^9, 3.916911375143549*^9}, 3.916923075427209*^9, {
   3.917168866824984*^9, 3.917168870314743*^9}, 
   3.943003302244314*^9},ExpressionUUID->"00d7ef1d-e8ae-44e1-8141-\
fd0e3cf02d64"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TraditionalForm", "[", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{"Solve", "[", 
    RowBox[{"margclosed", "==", "0"}], "]"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.916905162374346*^9, 3.916905162993431*^9}},
 CellLabel->
  "In[113]:=",ExpressionUUID->"4a7206e0-0de6-4437-a6b8-70035634ac0c"],

Cell[BoxData[
 FormBox[
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"m", "\[Rule]", "0"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"m", "\[Rule]", "2"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"N", "\[Rule]", "1"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"s", "\[Rule]", 
      RowBox[{
       RowBox[{"c", " ", 
        RowBox[{"(", 
         RowBox[{"g", "-", "1"}], ")"}], " ", "N"}], "-", 
       RowBox[{"c", " ", "g"}], "+", "d"}]}], "}"}]}], "}"}], 
  TraditionalForm]], "Output",
 CellChangeTimes->{3.916922811293124*^9, 3.917008510213292*^9, 
  3.917008617652815*^9},
 CellLabel->
  "Out[113]//TraditionalForm=",ExpressionUUID->"d02061ca-5fbc-4d0e-a470-\
014304158daa"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
Models I & J) Cue-suppression; migration before population regulation\
\>", "Section",
 CellChangeTimes->{{3.915174600364295*^9, 3.91517462569272*^9}, 
   3.91517466765668*^9, {3.915175186685773*^9, 3.915175197207159*^9}, 
   3.915177935400619*^9, {3.915184565003374*^9, 3.915184571753236*^9}, {
   3.943003487352656*^9, 
   3.943003488976514*^9}},ExpressionUUID->"5e6dbf40-4a8f-4fe4-93ed-\
1ed86cbee34d"],

Cell["\<\
Neighbour-modulated fitness for the focal individual (w) is written below. \
\>", "Text",
 CellChangeTimes->{{3.9151752377757063`*^9, 3.915175259620417*^9}, {
   3.915175352890313*^9, 3.9151753593515577`*^9}, 
   3.9152034697990303`*^9},ExpressionUUID->"179394d0-db8a-43a2-8181-\
6dfaa582789e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"w", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "-", "m"}], ")"}], 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{
         RowBox[{"(", 
          FractionBox["1", "N"], ")"}], 
         RowBox[{"(", 
          RowBox[{"d", "+", 
           RowBox[{"c", " ", "xfocal"}]}], ")"}]}], "-", 
        RowBox[{
         RowBox[{"(", 
          FractionBox[
           RowBox[{"N", "-", "1"}], "N"], ")"}], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"d", 
            RowBox[{"(", "xothers", ")"}]}], "+", 
           RowBox[{"c", " ", "xfocal", 
            RowBox[{"(", 
             RowBox[{"1", "-", "g"}], ")"}]}], "+", 
           RowBox[{"s", 
            RowBox[{"(", 
             RowBox[{"1", "-", "xothers"}], ")"}]}]}], ")"}]}]}], ")"}], "/", 
      
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", "m"}], ")"}], 
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{
            RowBox[{"(", 
             FractionBox["1", "N"], ")"}], 
            RowBox[{"(", 
             RowBox[{"d", "+", 
              RowBox[{"c", " ", 
               RowBox[{"(", 
                RowBox[{
                 FractionBox[
                  RowBox[{"xothers", 
                   RowBox[{"(", 
                    RowBox[{"N", "-", "1"}], ")"}]}], "N"], "+", 
                 FractionBox["xfocal", "N"]}], ")"}]}]}], ")"}]}], "-", 
           RowBox[{
            RowBox[{"(", 
             FractionBox[
              RowBox[{"N", "-", "1"}], "N"], ")"}], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"d", 
               RowBox[{"(", 
                RowBox[{"(", 
                 RowBox[{
                  FractionBox[
                   RowBox[{"xothers", 
                    RowBox[{"(", 
                    RowBox[{"N", "-", "1"}], ")"}]}], "N"], "+", 
                  FractionBox["xfocal", "N"]}], ")"}], ")"}]}], "+", 
              RowBox[{"c", " ", 
               RowBox[{"(", 
                RowBox[{
                 FractionBox[
                  RowBox[{"xothers", 
                   RowBox[{"(", 
                    RowBox[{"N", "-", "1"}], ")"}]}], "N"], "+", 
                 FractionBox["xfocal", "N"]}], ")"}], 
               RowBox[{"(", 
                RowBox[{"1", "-", "g"}], ")"}]}], "+", 
              RowBox[{"s", 
               RowBox[{"(", 
                RowBox[{"1", "-", 
                 FractionBox[
                  RowBox[{"xothers", 
                   RowBox[{"(", 
                    RowBox[{"N", "-", "1"}], ")"}]}], "N"], "-", 
                 FractionBox["xfocal", "N"]}], ")"}]}]}], ")"}]}]}], ")"}]}], 
        "+", 
        RowBox[{"m", 
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{
            RowBox[{"(", 
             FractionBox["1", "N"], ")"}], 
            RowBox[{"(", 
             RowBox[{"d", "+", 
              RowBox[{"c", " ", "xpop"}]}], ")"}]}], "-", 
           RowBox[{
            RowBox[{"(", 
             FractionBox[
              RowBox[{"N", "-", "1"}], "N"], ")"}], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"d", 
               RowBox[{"(", "xpop", ")"}]}], "+", 
              RowBox[{"c", " ", "xpop", 
               RowBox[{"(", 
                RowBox[{"1", "-", "g"}], ")"}]}], "+", 
              RowBox[{"s", 
               RowBox[{"(", 
                RowBox[{"1", "-", "xpop"}], ")"}]}]}], ")"}]}]}], ")"}]}]}], 
       ")"}]}]}], "+", 
    RowBox[{"m", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{
         RowBox[{"(", 
          FractionBox["1", "N"], ")"}], 
         RowBox[{"(", 
          RowBox[{"d", "+", 
           RowBox[{"c", " ", "xfocal"}]}], ")"}]}], "-", 
        RowBox[{
         RowBox[{"(", 
          FractionBox[
           RowBox[{"N", "-", "1"}], "N"], ")"}], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"d", 
            RowBox[{"(", "xothers", ")"}]}], "+", 
           RowBox[{"c", " ", "xfocal", 
            RowBox[{"(", 
             RowBox[{"1", "-", "g"}], ")"}]}], "+", 
           RowBox[{"s", 
            RowBox[{"(", 
             RowBox[{"1", "-", "xothers"}], ")"}]}]}], ")"}]}]}], ")"}], "/", 
      
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{
         RowBox[{"(", 
          FractionBox["1", "N"], ")"}], 
         RowBox[{"(", 
          RowBox[{"d", "+", 
           RowBox[{"c", " ", "xpop"}]}], ")"}]}], "-", 
        RowBox[{
         RowBox[{"(", 
          FractionBox[
           RowBox[{"N", "-", "1"}], "N"], ")"}], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"d", 
            RowBox[{"(", "xpop", ")"}]}], "+", 
           RowBox[{"c", " ", "xpop", 
            RowBox[{"(", 
             RowBox[{"1", "-", "g"}], ")"}]}], "+", 
           RowBox[{"s", 
            RowBox[{"(", 
             RowBox[{"1", "-", "xpop"}], ")"}]}]}], ")"}]}]}], ")"}]}]}]}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.908103877779798*^9, 3.9081039368551617`*^9}, {
   3.9082687020329027`*^9, 3.908268859066394*^9}, {3.908269883914235*^9, 
   3.908269920730289*^9}, {3.908355862871335*^9, 3.908355902589114*^9}, {
   3.9108604899938927`*^9, 3.910860560580213*^9}, {3.9113770175862293`*^9, 
   3.911377066649146*^9}, {3.911391018117175*^9, 3.911391056891016*^9}, 
   3.915175265985262*^9, {3.91517795501114*^9, 3.915177969866983*^9}, {
   3.9169113751561823`*^9, 3.9169113751619864`*^9}, {3.9169114123777323`*^9, 
   3.916911412384989*^9}, {3.916911465611814*^9, 3.9169114656166077`*^9}, {
   3.916911553677781*^9, 3.9169115536843767`*^9}, 3.9170112771632643`*^9, {
   3.917011312366989*^9, 3.917011378897896*^9}},
 CellLabel->
  "In[320]:=",ExpressionUUID->"c9b86c00-c65a-4e56-9b5f-c789e091a106"],

Cell["\<\
The derivative of focal individual fitness, with respect to the focal \
individual trait value, evaluated at monomorphic equilibrium, is written \
below (as -cm). Note that the \[OpenCurlyQuote]cm\[CloseCurlyQuote] notation \
is used to represent the \[OpenCurlyQuote]marginal cost\[CloseCurlyQuote] of \
Hamilton\[CloseCurlyQuote]s Rule. This is Equation I1 in the SI.\
\>", "Text",
 CellChangeTimes->{{3.915175733249536*^9, 3.915175737026534*^9}, {
   3.915175857656424*^9, 3.915175883915668*^9}, {3.915203490603609*^9, 
   3.915203495714188*^9}, 
   3.943003341416874*^9},ExpressionUUID->"725accf9-794f-475c-b7b9-\
29ca28733c18"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"cm", "=", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{"D", "[", 
       RowBox[{"w", ",", "xfocal"}], "]"}]}], "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"xpop", "->", 
        SuperscriptBox["x", "*"]}], ",", 
       RowBox[{"xothers", "->", 
        SuperscriptBox["x", "*"]}], ",", 
       RowBox[{"xfocal", "->", 
        SuperscriptBox["x", "*"]}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"TraditionalForm", "[", 
  RowBox[{"-", "cm"}], "]"}]}], "Input",
 CellChangeTimes->{{3.915177161684618*^9, 3.9151771773356667`*^9}, {
   3.9169114123860893`*^9, 3.916911412387311*^9}, 3.916911465617879*^9, 
   3.91691155368524*^9, 3.9169231337290573`*^9},
 CellLabel->
  "In[321]:=",ExpressionUUID->"c4be2823-9b43-489e-80e0-b90c9ed5ef61"],

Cell[BoxData[
 FormBox[
  RowBox[{"-", 
   FractionBox[
    RowBox[{
     RowBox[{"-", 
      RowBox[{"c", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"g", "-", "1"}], ")"}], " ", "N"}], "-", "g"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"m", "-", "1"}], ")"}], "2"], "-", "N"}], ")"}]}]}], "+", 
     RowBox[{"d", " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"m", "-", "1"}], ")"}], "2"], " ", 
      RowBox[{"(", 
       RowBox[{"N", "-", "1"}], ")"}]}], "-", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"m", "-", "1"}], ")"}], "2"], " ", 
      RowBox[{"(", 
       RowBox[{"N", "-", "1"}], ")"}], " ", "s"}]}], 
    RowBox[{"N", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        SuperscriptBox["x", "*"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", 
           RowBox[{"N", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"c", " ", "g"}], "+", "s"}], ")"}]}]}], "+", 
          RowBox[{"c", " ", 
           RowBox[{"(", 
            RowBox[{"g", "+", "N"}], ")"}]}], "+", 
          RowBox[{"d", " ", 
           RowBox[{"(", 
            RowBox[{"N", "-", "1"}], ")"}]}], "+", "s"}], ")"}]}], "+", "d", 
       "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"N", "-", "1"}], ")"}], " ", "s"}], "-", "N"}], ")"}]}]]}], 
  TraditionalForm]], "Output",
 CellChangeTimes->{3.9169231372985353`*^9, 3.9170086349037943`*^9, 
  3.917011230529459*^9, 3.9170113867412663`*^9, 3.91716843263445*^9},
 CellLabel->
  "Out[322]//TraditionalForm=",ExpressionUUID->"37802015-4885-4194-91c1-\
28c0653d234c"]
}, Open  ]],

Cell["\<\
The derivative of focal individual fitness, with respect to the average trait \
value of other individuals on the deme, evaluated at monomorphic equilibrium, \
is written below. Note that the \[OpenCurlyQuote]bm\[CloseCurlyQuote] \
notation is used to represent the \[OpenCurlyQuote]marginal benefit\
\[CloseCurlyQuote] of Hamilton\[CloseCurlyQuote]s Rule. This is Equation I2 \
in the SI.\
\>", "Text",
 CellChangeTimes->{{3.915175418488715*^9, 3.915175518937564*^9}, 
   3.915175722238924*^9, {3.915175920186359*^9, 3.915175930914809*^9}, {
   3.915203501107039*^9, 3.915203501387886*^9}, 
   3.9430033476911583`*^9},ExpressionUUID->"d8f09699-d5da-46db-bba5-\
ad240c940a93"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TraditionalForm", "[", 
  RowBox[{"bm", "=", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{"w", ",", "xothers"}], "]"}], "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"xpop", "->", 
        SuperscriptBox["x", "*"]}], ",", 
       RowBox[{"xothers", "->", 
        SuperscriptBox["x", "*"]}], ",", 
       RowBox[{"xfocal", "->", 
        SuperscriptBox["x", "*"]}]}], "}"}]}], "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.9081039414213743`*^9, 3.9081039435052147`*^9}, {
   3.90810406510456*^9, 3.908104073589612*^9}, {3.9081043026353397`*^9, 
   3.9081043339158287`*^9}, 3.908106925554028*^9, {3.911391003528234*^9, 
   3.9113910075287848`*^9}, {3.9115423725276537`*^9, 3.911542390599454*^9}, {
   3.915175399934017*^9, 3.915175400756152*^9}, 3.915175723845454*^9, {
   3.915177193413665*^9, 3.9151771935552893`*^9}, {3.916911412389732*^9, 
   3.9169114123903093`*^9}, {3.9169114656188583`*^9, 3.916911465619519*^9}, 
   3.916911553685988*^9, 3.9169231466562233`*^9},
 CellLabel->
  "In[323]:=",ExpressionUUID->"adc28761-8fbb-4d25-b2d6-06cc58d79bc4"],

Cell[BoxData[
 FormBox[
  RowBox[{"-", 
   FractionBox[
    RowBox[{
     RowBox[{"(", 
      RowBox[{"N", "-", "1"}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"c", " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"m", "-", "1"}], ")"}], "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"g", "-", "1"}], ")"}], " ", "N"}], "-", "g"}], 
          ")"}]}]}], "+", 
       RowBox[{"d", " ", 
        RowBox[{"(", 
         RowBox[{"m", "-", "2"}], ")"}], " ", "m", " ", "N"}], "-", 
       RowBox[{"d", " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"m", "-", "1"}], ")"}], "2"]}], "-", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"m", "-", "2"}], ")"}], " ", "m", " ", 
        RowBox[{"(", 
         RowBox[{"N", "-", "1"}], ")"}], " ", "s"}], "+", "s"}], ")"}]}], 
    RowBox[{"N", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        SuperscriptBox["x", "*"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", 
           RowBox[{"N", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"c", " ", "g"}], "+", "s"}], ")"}]}]}], "+", 
          RowBox[{"c", " ", 
           RowBox[{"(", 
            RowBox[{"g", "+", "N"}], ")"}]}], "+", 
          RowBox[{"d", " ", 
           RowBox[{"(", 
            RowBox[{"N", "-", "1"}], ")"}]}], "+", "s"}], ")"}]}], "+", "d", 
       "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"N", "-", "1"}], ")"}], " ", "s"}], "-", "N"}], ")"}]}]]}], 
  TraditionalForm]], "Output",
 CellChangeTimes->{3.91692314888769*^9, 3.917008636657955*^9, 
  3.9170114212244043`*^9, 3.917011510453504*^9, 3.917168434523019*^9},
 CellLabel->
  "Out[323]//TraditionalForm=",ExpressionUUID->"4c25de8b-843b-406e-9eca-\
d08eed543b94"]
}, Open  ]],

Cell["\<\
The overall marginal change in neighbour-modulated fitness associated with a \
slight change in behaviour is written below, on the (false) assumption that \
relatedness is a constant (open model). The \[OpenCurlyQuote]margopen\
\[CloseCurlyQuote] notation is used to represent the marginal fitness change, \
and the open model setting. This is Equation J1 in the SI.\
\>", "Text",
 CellChangeTimes->{{3.915175958153467*^9, 3.915176040877063*^9}, {
   3.915177227882449*^9, 3.9151773535121117`*^9}, {3.915203566489521*^9, 
   3.915203566567294*^9}, 
   3.943003352113937*^9},ExpressionUUID->"4b7fc4aa-a658-49b6-8cca-\
d93440e90155"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TraditionalForm", "[", 
  RowBox[{"margopen", "=", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{
     RowBox[{
      SuperscriptBox["r", "*"], " ", "bm"}], " ", "-", " ", "cm"}], "]"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.9081044477104807`*^9, 3.908104459241107*^9}, {
   3.908104492639288*^9, 3.9081044941536303`*^9}, {3.9081051452016487`*^9, 
   3.90810514887316*^9}, {3.9151758222548037`*^9, 3.9151758368976316`*^9}, {
   3.915177197160902*^9, 3.9151772227977467`*^9}, 3.915177266100378*^9, {
   3.917008629469569*^9, 3.917008629842537*^9}},
 CellLabel->
  "In[325]:=",ExpressionUUID->"0225feb0-71ca-4190-b536-c9cbee7cacb3"],

Cell[BoxData[
 FormBox[
  FractionBox[
   RowBox[{
    RowBox[{"-", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"N", "-", "1"}], ")"}], " ", 
      SuperscriptBox["r", "*"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{"c", " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"m", "-", "1"}], ")"}], "2"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"g", "-", "1"}], ")"}], " ", "N"}], "-", "g"}], 
           ")"}]}]}], "+", 
        RowBox[{"d", " ", 
         RowBox[{"(", 
          RowBox[{"m", "-", "2"}], ")"}], " ", "m", " ", "N"}], "-", 
        RowBox[{"d", " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"m", "-", "1"}], ")"}], "2"]}], "-", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"m", "-", "2"}], ")"}], " ", "m", " ", 
         RowBox[{"(", 
          RowBox[{"N", "-", "1"}], ")"}], " ", "s"}], "+", "s"}], ")"}]}]}], 
    "+", 
    RowBox[{"c", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"g", "-", "1"}], ")"}], " ", "N"}], "-", "g"}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"m", "-", "1"}], ")"}], "2"], "-", "N"}], ")"}]}], "-", 
    RowBox[{"d", " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"m", "-", "1"}], ")"}], "2"], " ", 
     RowBox[{"(", 
      RowBox[{"N", "-", "1"}], ")"}]}], "+", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"m", "-", "1"}], ")"}], "2"], " ", 
     RowBox[{"(", 
      RowBox[{"N", "-", "1"}], ")"}], " ", "s"}]}], 
   RowBox[{"N", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SuperscriptBox["x", "*"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", 
          RowBox[{"N", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"c", " ", "g"}], "+", "s"}], ")"}]}]}], "+", 
         RowBox[{"c", " ", 
          RowBox[{"(", 
           RowBox[{"g", "+", "N"}], ")"}]}], "+", 
         RowBox[{"d", " ", 
          RowBox[{"(", 
           RowBox[{"N", "-", "1"}], ")"}]}], "+", "s"}], ")"}]}], "+", "d", 
      "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"N", "-", "1"}], ")"}], " ", "s"}], "-", "N"}], ")"}]}]], 
  TraditionalForm]], "Output",
 CellChangeTimes->{
  3.9169231562805777`*^9, 3.917008638525384*^9, 3.9170115156825438`*^9, 
   3.917012023186346*^9, {3.917168436441044*^9, 3.9171684429026747`*^9}},
 CellLabel->
  "Out[325]//TraditionalForm=",ExpressionUUID->"5a569d19-da13-4fda-9056-\
95e67b2cd310"]
}, Open  ]],

Cell[TextData[{
 "We ask when a slight increase in the behaviour is favoured, on the \
assumption of full migration (m=1). To do so, we  set the selection \
differential to zero, to obtain ",
 Cell[BoxData[
  FormBox[
   RowBox[{"s", "\[Rule]", 
    RowBox[{
     FractionBox[
      RowBox[{"c", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"g", " ", 
          RowBox[{"(", 
           RowBox[{"-", "N"}], ")"}]}], "+", "g", "+", "N"}], ")"}]}], 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"N", "-", "1"}], ")"}], " ", 
       SuperscriptBox["r", "*"]}]], "+", "d"}]}], TraditionalForm]],
  CellChangeTimes->{
   3.9082689189247103`*^9, {3.9082750095828257`*^9, 3.908275031642332*^9}, {
    3.908275084386447*^9, 3.908275127976161*^9}, 3.908275193877214*^9, {
    3.908275233458981*^9, 3.908275248590908*^9}, 3.908275279347251*^9, 
    3.908275380694973*^9, 3.908275413192636*^9, 3.9083559387106123`*^9, 
    3.910860622126617*^9, 3.911376898573859*^9, 3.911377143928994*^9, 
    3.9114720838680353`*^9, 3.911472229947011*^9, 3.911548109194347*^9, 
    3.911554643668841*^9, 3.915177207879016*^9, 3.9151773650375423`*^9, 
    3.9151775188673983`*^9, 3.915178011045245*^9, 3.915205810872473*^9, 
    3.916923231741188*^9},ExpressionUUID->
  "134605b6-7a94-40e6-aa78-3f7266224f13"],
 ". We can see that the right hand side is always greater than the left hand \
side, meaning the selection differential is always negative, and so the \
behaviour is  disfavoured."
}], "Text",
 CellChangeTimes->{{3.915176101958577*^9, 3.915176179387744*^9}, {
  3.915176229291583*^9, 3.915176243005365*^9}, {3.915177406063599*^9, 
  3.915177410206997*^9}, {3.915178003532593*^9, 3.915178009277268*^9}, {
  3.916923292588077*^9, 3.9169233218889637`*^9}, {3.917168515868033*^9, 
  3.917168541521164*^9}},ExpressionUUID->"f9e653d0-4271-46db-8c5f-\
f52d1960fd8e"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"TraditionalForm", "[", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{"margopen", "/.", 
    RowBox[{"{", 
     RowBox[{"m", "->", "1"}], "}"}]}], "]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"TraditionalForm", "[", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{"Solve", "[", 
    RowBox[{
     RowBox[{"margopen", "==", "0"}], "/.", 
     RowBox[{"{", 
      RowBox[{"m", "->", "1"}], "}"}]}], "]"}], "]"}], "]"}]}], "Input",
 CellChangeTimes->{{3.908108081357972*^9, 3.90810815886198*^9}, 
   3.9082689167181387`*^9, {3.908275020896943*^9, 3.9082750299584627`*^9}, {
   3.908275081536397*^9, 3.9082751262301083`*^9}, {3.9082751906324368`*^9, 
   3.908275193265663*^9}, {3.9082752320393248`*^9, 3.908275277398169*^9}, {
   3.908275311973724*^9, 3.9082753702498417`*^9}, {3.908275404855864*^9, 
   3.908275411310329*^9}, {3.911472199070818*^9, 3.911472202133206*^9}, {
   3.915177205821993*^9, 3.9151772059558477`*^9}, {3.915177361413143*^9, 
   3.915177361646332*^9}, {3.915178001412785*^9, 3.915178001471287*^9}, 
   3.916911375177553*^9, 3.916911412394047*^9, {3.91692322283072*^9, 
   3.916923230027397*^9}, {3.9170121748254347`*^9, 3.917012186634247*^9}},
 CellLabel->
  "In[326]:=",ExpressionUUID->"64b5d706-b0a7-4a82-bf91-c0e42723d69e"],

Cell[BoxData[
 FormBox[
  FractionBox[
   RowBox[{
    RowBox[{"c", " ", 
     RowBox[{"(", 
      RowBox[{"g", "-", "1"}], ")"}], " ", "N"}], "-", 
    RowBox[{"c", " ", "g"}], "-", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"N", "-", "1"}], ")"}], " ", 
     SuperscriptBox["r", "*"], " ", 
     RowBox[{"(", 
      RowBox[{"d", "-", "s"}], ")"}]}]}], 
   RowBox[{
    RowBox[{"-", 
     RowBox[{
      SuperscriptBox["x", "*"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{"N", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"c", " ", "g"}], "+", "s"}], ")"}]}]}], "+", 
        RowBox[{"c", " ", 
         RowBox[{"(", 
          RowBox[{"g", "+", "N"}], ")"}]}], "+", 
        RowBox[{"d", " ", 
         RowBox[{"(", 
          RowBox[{"N", "-", "1"}], ")"}]}], "+", "s"}], ")"}]}]}], "-", "d", 
    "-", 
    RowBox[{"N", " ", "s"}], "+", "N", "+", "s"}]], 
  TraditionalForm]], "Output",
 CellChangeTimes->{
  3.9082689189247103`*^9, {3.9082750095828257`*^9, 3.908275031642332*^9}, {
   3.908275084386447*^9, 3.908275127976161*^9}, 3.908275193877214*^9, {
   3.908275233458981*^9, 3.908275248590908*^9}, 3.908275279347251*^9, 
   3.908275380694973*^9, 3.908275413192636*^9, 3.9083559387106123`*^9, 
   3.910860622126617*^9, 3.911376898573859*^9, 3.911377143928994*^9, 
   3.9114720838680353`*^9, 3.911472229947011*^9, 3.911548109194347*^9, 
   3.911554643668841*^9, 3.915177207879016*^9, 3.9151773650375423`*^9, 
   3.9151775188673983`*^9, 3.915178011045245*^9, 3.915205810872473*^9, 
   3.916923231741188*^9, 3.917008645537665*^9, 3.9170115208188353`*^9, {
   3.917012164226644*^9, 3.917012188930409*^9}, 3.9171684466449738`*^9},
 CellLabel->
  "Out[326]//TraditionalForm=",ExpressionUUID->"d8b03890-cb79-4e63-a00c-\
78ffd7f4d541"],

Cell[BoxData[
 FormBox[
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"s", "\[Rule]", 
      RowBox[{
       FractionBox[
        RowBox[{"c", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"g", " ", 
            RowBox[{"(", 
             RowBox[{"-", "N"}], ")"}]}], "+", "g", "+", "N"}], ")"}]}], 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"N", "-", "1"}], ")"}], " ", 
         SuperscriptBox["r", "*"]}]], "+", "d"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"c", "\[Rule]", "0"}], ",", 
      RowBox[{"N", "\[Rule]", "1"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"c", "\[Rule]", "0"}], ",", 
      RowBox[{
       SuperscriptBox["r", "*"], "\[Rule]", "0"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"g", "\[Rule]", 
       FractionBox["N", 
        RowBox[{"N", "-", "1"}]]}], ",", 
      RowBox[{
       SuperscriptBox["r", "*"], "\[Rule]", "0"}]}], "}"}]}], "}"}], 
  TraditionalForm]], "Output",
 CellChangeTimes->{
  3.9082689189247103`*^9, {3.9082750095828257`*^9, 3.908275031642332*^9}, {
   3.908275084386447*^9, 3.908275127976161*^9}, 3.908275193877214*^9, {
   3.908275233458981*^9, 3.908275248590908*^9}, 3.908275279347251*^9, 
   3.908275380694973*^9, 3.908275413192636*^9, 3.9083559387106123`*^9, 
   3.910860622126617*^9, 3.911376898573859*^9, 3.911377143928994*^9, 
   3.9114720838680353`*^9, 3.911472229947011*^9, 3.911548109194347*^9, 
   3.911554643668841*^9, 3.915177207879016*^9, 3.9151773650375423`*^9, 
   3.9151775188673983`*^9, 3.915178011045245*^9, 3.915205810872473*^9, 
   3.916923231741188*^9, 3.917008645537665*^9, 3.9170115208188353`*^9, {
   3.917012164226644*^9, 3.917012188930409*^9}, 3.917168446687549*^9},
 CellLabel->
  "Out[327]//TraditionalForm=",ExpressionUUID->"3b6b8d4d-63f3-4f66-aedb-\
64411c336881"]
}, Closed]],

Cell["\<\
We ask when a slight increase in the behaviour is favoured, on the assumption \
of zero migration (m=0). To do so, we first set the selection differential to \
zero, to obtain s\[Rule]c (g-1) N-c g+d. The behaviour is favoured when the \
right-hand side is greater than the left-hand side. This is Equation G7 \
(rearranged) in the SI.\
\>", "Text",
 CellChangeTimes->{{3.915176273466278*^9, 3.915176279609105*^9}, {
   3.915176337851461*^9, 3.915176359760262*^9}, {3.915177400639497*^9, 
   3.915177402013357*^9}, {3.915178013962927*^9, 3.915178016675682*^9}, 
   3.9151780655440397`*^9, {3.915178105500216*^9, 3.915178107023058*^9}, {
   3.915203656179706*^9, 3.915203659734796*^9}, {3.9169113751788893`*^9, 
   3.916911375178904*^9}, {3.916923396008024*^9, 3.9169234227394876`*^9}, {
   3.916923519835164*^9, 3.916923539315836*^9}, 3.917168564144491*^9, {
   3.943003362757751*^9, 
   3.943003391218821*^9}},ExpressionUUID->"55c2aa31-f5bf-43bb-bb55-\
1c34a3a80b43"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TraditionalForm", "[", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{"Solve", "[", 
    RowBox[{
     RowBox[{"margopen", "==", "0"}], "/.", 
     RowBox[{"{", 
      RowBox[{"m", "->", "0"}], "}"}]}], "]"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.90827547900133*^9, 3.908275526641282*^9}, {
   3.908275670152458*^9, 3.908275700588422*^9}, {3.9114722372479143`*^9, 
   3.9114722413253193`*^9}, {3.915177386188711*^9, 3.915177386585072*^9}, 
   3.915178039525638*^9, 3.91691137517977*^9, 3.916911412394967*^9, 
   3.916923370284152*^9},
 CellLabel->
  "In[205]:=",ExpressionUUID->"677d8d81-1c11-4a10-8af1-2befe2e38179"],

Cell[BoxData[
 FormBox[
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"N", "\[Rule]", "1"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"s", "\[Rule]", 
      RowBox[{
       RowBox[{"c", " ", 
        RowBox[{"(", 
         RowBox[{"g", "-", "1"}], ")"}], " ", "N"}], "-", 
       RowBox[{"c", " ", "g"}], "+", "d"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      SuperscriptBox["r", "*"], "\[Rule]", "1"}], "}"}]}], "}"}], 
  TraditionalForm]], "Output",
 CellChangeTimes->{3.916923378242713*^9, 3.9170086497896347`*^9, 
  3.9170115231966352`*^9},
 CellLabel->
  "Out[205]//TraditionalForm=",ExpressionUUID->"9916b4d4-0fe1-479a-9f2e-\
e4acc7849823"]
}, Open  ]],

Cell[TextData[{
 "We now undertake the \[OpenCurlyQuote]closed model\[CloseCurlyQuote] \
analysis, where relatedness is not considered a constant, but is instead \
expressed in terms of model parameters. Relatedness is given by ",
 Cell[BoxData[
  FormBox[
   RowBox[{"r", "=", 
    FractionBox["1", 
     RowBox[{"1", "-", 
      FractionBox[
       RowBox[{
        RowBox[{"(", 
         RowBox[{"m", "-", "2"}], ")"}], " ", "m", " ", "N"}], 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"m", "-", "1"}], ")"}], "2"]]}]]}], TraditionalForm]],
  CellChangeTimes->{{3.910861979123197*^9, 3.9108619999508753`*^9}, {
    3.91086222963589*^9, 3.9108622426687517`*^9}, 3.910862460959608*^9, 
    3.9108626243521233`*^9, 3.9114609992207623`*^9, 3.911461049933278*^9, 
    3.911461104221305*^9, 3.9114637937132893`*^9, {3.9114638920883408`*^9, 
    3.9114638987610273`*^9}, {3.911464017519855*^9, 3.911464020308721*^9}, 
    3.911472250412627*^9, 3.911554645377158*^9},ExpressionUUID->
  "8632e220-702c-4b01-b211-af5afc459f78"],
 "(Equation A17). We therefore obtain the overall marginal change in \
neighbour-modulated fitness associated with a slight change in behaviour, on \
the (true) assumption that relatedness emerges from model parameters.  The \
\[OpenCurlyQuote]margclosed\[CloseCurlyQuote] notation is used to represent \
the marginal fitness change, and the closed model setting. This is Equation \
I3 in the SI. "
}], "Text",
 CellChangeTimes->{{3.915176441285725*^9, 3.915176587713168*^9}, {
   3.915177463317815*^9, 3.9151774714126167`*^9}, {3.915203527275138*^9, 
   3.915203542206978*^9}, 
   3.94300336964045*^9},ExpressionUUID->"896dd8e5-f168-4eb7-ab14-\
135cb5ea234b"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TraditionalForm", "[", 
  RowBox[{"margclosed", "=", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       SuperscriptBox["r", "*"], " ", "bm"}], " ", "-", " ", "cm"}], "/.", 
     RowBox[{"{", 
      RowBox[{
       SuperscriptBox["r", "*"], "->", 
       RowBox[{"1", "/", 
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"m", "-", "2"}], ")"}], " ", "m", " ", "N"}], ")"}], 
           "/", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"m", "-", "1"}], ")"}], "^", "2"}]}]}], ")"}]}]}], 
      "}"}]}], "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.91517659618088*^9, 3.915176615645871*^9}, 
   3.915177444830543*^9, {3.915177479766621*^9, 3.915177481869033*^9}, {
   3.917008654545506*^9, 3.9170086609259872`*^9}},
 CellLabel->
  "In[208]:=",ExpressionUUID->"9cac7589-1abc-41d4-8acb-6f3b95750918"],

Cell[BoxData[
 FormBox[
  RowBox[{"-", 
   FractionBox[
    RowBox[{"c", " ", 
     RowBox[{"(", 
      RowBox[{"m", "-", "2"}], ")"}], " ", "m", " ", "N", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"g", " ", 
        RowBox[{"(", 
         RowBox[{"N", "-", "1"}], ")"}]}], "-", "N"}], ")"}]}], 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"m", "-", "2"}], ")"}], " ", "m", " ", 
        RowBox[{"(", 
         RowBox[{"N", "-", "1"}], ")"}]}], "-", "1"}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        SuperscriptBox["x", "*"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", 
           RowBox[{"N", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"c", " ", "g"}], "+", "s"}], ")"}]}]}], "+", 
          RowBox[{"c", " ", 
           RowBox[{"(", 
            RowBox[{"g", "+", "N"}], ")"}]}], "+", 
          RowBox[{"d", " ", 
           RowBox[{"(", 
            RowBox[{"N", "-", "1"}], ")"}]}], "+", "s"}], ")"}]}], "+", "d", 
       "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"N", "-", "1"}], ")"}], " ", "s"}], "-", "N"}], ")"}]}]]}], 
  TraditionalForm]], "Output",
 CellChangeTimes->{3.916923550619752*^9, 3.9170086617474413`*^9, 
  3.917011525504067*^9, 3.917011968859572*^9},
 CellLabel->
  "Out[208]//TraditionalForm=",ExpressionUUID->"f0aa47be-5fba-4d80-b4bb-\
b323efdc45b7"]
}, Open  ]],

Cell[TextData[{
 "We ask when a slight increase in the behaviour is favoured. To do so, we \
first set the selection differential to zero, to obtain ",
 Cell[BoxData[
  FormBox[
   RowBox[{"N", "\[Rule]", 
    FractionBox["g", 
     RowBox[{"g", "-", "1"}]]}], TraditionalForm]],
  CellChangeTimes->{
   3.910862634126298*^9, 3.910862679713876*^9, 3.911377178731172*^9, {
    3.911472315555702*^9, 3.911472345188623*^9}, 3.911548193938794*^9, 
    3.911548237122397*^9, {3.91154829494869*^9, 3.911548316947212*^9}, 
    3.9115546458318996`*^9, 3.9151769039327383`*^9, 3.915177492573509*^9, 
    3.915177527058111*^9, 3.91520576940941*^9, 3.9169046757511387`*^9, {
    3.91692181322268*^9, 3.916921825090461*^9}},ExpressionUUID->
  "6959b2b1-66be-42a4-8816-cd6bcd5cf5b3"],
 ". The left-hand side is always greater than the right-hand side, meaning \
the behaviour is disfavoured."
}], "Text",
 CellChangeTimes->{{3.9151769454838057`*^9, 3.9151769716502733`*^9}, 
   3.916923578449094*^9},ExpressionUUID->"e1479d8b-1cd7-4569-aa43-\
c1acec44fa44"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TraditionalForm", "[", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{"Solve", "[", 
    RowBox[{"margclosed", "==", "0"}], "]"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.91086262736821*^9, 3.910862678869877*^9}, 
   3.911472300688035*^9, {3.911472332014091*^9, 3.911472344399435*^9}, {
   3.911548186771056*^9, 3.911548189170001*^9}, 3.9115482347234707`*^9, {
   3.9115482852122593`*^9, 3.9115483160155067`*^9}, {3.915176872170781*^9, 
   3.9151769012207336`*^9}, {3.915177491578352*^9, 3.9151774916856956`*^9}, {
   3.9169113751903687`*^9, 3.916911394930376*^9}, 3.916923588551108*^9},
 CellLabel->
  "In[209]:=",ExpressionUUID->"298abba8-bee2-4107-bcf1-5eee032e0b0d"],

Cell[BoxData[
 FormBox[
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"c", "\[Rule]", "0"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"m", "\[Rule]", "0"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"m", "\[Rule]", "2"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"N", "\[Rule]", "0"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"N", "\[Rule]", 
      FractionBox["g", 
       RowBox[{"g", "-", "1"}]]}], "}"}]}], "}"}], TraditionalForm]], "Output",\

 CellChangeTimes->{
  3.910862634126298*^9, 3.910862679713876*^9, 3.911377178731172*^9, {
   3.911472315555702*^9, 3.911472345188623*^9}, 3.911548193938794*^9, 
   3.911548237122397*^9, {3.91154829494869*^9, 3.911548316947212*^9}, 
   3.9115546458318996`*^9, 3.9151769039327383`*^9, 3.915177492573509*^9, 
   3.915177527058111*^9, 3.915178142722644*^9, 3.915205817122501*^9, 
   3.916923589773978*^9, 3.917008663930058*^9, 3.9170115289015303`*^9, 
   3.917011972113017*^9},
 CellLabel->
  "Out[209]//TraditionalForm=",ExpressionUUID->"07a369d1-d046-47d3-a957-\
ba8ecc5f0047"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
Model L) Signalling; migration after population regulation; signal response \
and dishonesty can evolve\
\>", "Section",
 CellChangeTimes->{{3.915174600364295*^9, 3.91517462569272*^9}, 
   3.91517466765668*^9, {3.915175186685773*^9, 3.915175197207159*^9}, {
   3.91517755046989*^9, 3.9151775509280024`*^9}, {3.915184515366377*^9, 
   3.915184552979945*^9}, {3.916923876040818*^9, 3.9169239091422167`*^9}, {
   3.916926135487589*^9, 3.916926139267849*^9}, {3.9171679997466803`*^9, 
   3.917168002383638*^9}, 
   3.943003505763298*^9},ExpressionUUID->"600d8c9a-9480-4c1c-94b8-\
ccb9d1a53acb"],

Cell["\<\
Neighbour-modulated fitness for the focal individual (w) is written below. \
This is given by Equations L3, L5 & A6 in the SI.\
\>", "Text",
 CellChangeTimes->{{3.9151752377757063`*^9, 3.915175259620417*^9}, {
   3.915175352890313*^9, 3.9151753593515577`*^9}, {3.915201719433642*^9, 
   3.915201720074353*^9}, 3.9169239389872704`*^9, {3.917168940574061*^9, 
   3.9171690118167477`*^9}, {3.943003526293153*^9, 
   3.943003528731151*^9}},ExpressionUUID->"52096bc2-8450-4cc3-ab49-\
055ac6c35be8"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ffocal", " ", "=", " ", 
   RowBox[{"1", "-", 
    RowBox[{"p", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        FractionBox["1", "N"], 
        RowBox[{"(", 
         RowBox[{"d", "+", 
          RowBox[{"c", " ", "xfocal"}]}], ")"}]}], "+", 
       RowBox[{
        FractionBox[
         RowBox[{"N", "-", "1"}], "N"], 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"d", 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"xothers", " ", "yfocal"}]}], ")"}]}], "+", 
          RowBox[{"c", " ", "xfocal", 
           RowBox[{"(", 
            RowBox[{"1", "-", "g"}], ")"}]}], "+", 
          RowBox[{"s", " ", "xothers", " ", "yfocal"}]}], ")"}]}]}], ")"}]}], 
    "-", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "-", "p"}], ")"}], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        FractionBox["1", "N"], 
        RowBox[{"(", 
         RowBox[{"c", " ", "xfocal", " ", "zfocal"}], ")"}]}], "+", 
       RowBox[{
        FractionBox[
         RowBox[{"N", "-", "1"}], "N"], 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"c", " ", "xfocal", " ", "zfocal", 
           RowBox[{"(", 
            RowBox[{"1", "-", "g"}], ")"}]}], "+", 
          RowBox[{"s", " ", "xothers", " ", "yfocal", " ", "zothers"}]}], 
         ")"}]}]}], ")"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"xdeme", "=", 
   RowBox[{
    RowBox[{
     FractionBox["1", "N"], "xfocal"}], "+", 
    RowBox[{
     FractionBox[
      RowBox[{"N", "-", "1"}], "N"], "xothers"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ydeme", "=", 
   RowBox[{
    RowBox[{
     FractionBox["1", "N"], "yfocal"}], "+", 
    RowBox[{
     FractionBox[
      RowBox[{"N", "-", "1"}], "N"], "yothers"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"zdeme", "=", 
   RowBox[{
    RowBox[{
     FractionBox["1", "N"], "zfocal"}], "+", 
    RowBox[{
     FractionBox[
      RowBox[{"N", "-", "1"}], "N"], "zothers"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fdeme", " ", "=", " ", 
   RowBox[{"1", "-", 
    RowBox[{"p", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        FractionBox["1", "N"], 
        RowBox[{"(", 
         RowBox[{"d", "+", 
          RowBox[{"c", " ", "xdeme"}]}], ")"}]}], "+", 
       RowBox[{
        FractionBox[
         RowBox[{"N", "-", "1"}], "N"], 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"d", 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"xdeme", " ", "ydeme"}]}], ")"}]}], "+", 
          RowBox[{"c", " ", "xdeme", 
           RowBox[{"(", 
            RowBox[{"1", "-", "g"}], ")"}]}], "+", 
          RowBox[{"s", " ", "xdeme", " ", "ydeme"}]}], ")"}]}]}], ")"}]}], 
    "-", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "-", "p"}], ")"}], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        FractionBox["1", "N"], 
        RowBox[{"(", 
         RowBox[{"c", " ", "xdeme", " ", "zdeme"}], ")"}]}], "+", 
       RowBox[{
        FractionBox[
         RowBox[{"N", "-", "1"}], "N"], 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"c", " ", "xdeme", " ", "zdeme", 
           RowBox[{"(", 
            RowBox[{"1", "-", "g"}], ")"}]}], "+", 
          RowBox[{"s", " ", "xdeme", " ", "ydeme", " ", "zdeme"}]}], 
         ")"}]}]}], ")"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"w", "=", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{"ffocal", " ", "/", " ", "fdeme"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.908103877779798*^9, 3.9081039368551617`*^9}, {
   3.9082687020329027`*^9, 3.908268859066394*^9}, {3.908269883914235*^9, 
   3.908269920730289*^9}, {3.908355862871335*^9, 3.908355902589114*^9}, {
   3.9108604899938927`*^9, 3.910860560580213*^9}, {3.9113770175862293`*^9, 
   3.911377066649146*^9}, {3.911391018117175*^9, 3.911391056891016*^9}, 
   3.915175265985262*^9, {3.915177560180121*^9, 3.9151775756131973`*^9}, {
   3.916477684098556*^9, 3.9164779154054203`*^9}, {3.916477958436911*^9, 
   3.916477985459425*^9}, {3.916478030965603*^9, 3.916478110056409*^9}, {
   3.916481286064456*^9, 3.9164813699923067`*^9}, {3.91648140307764*^9, 
   3.916481407874761*^9}, {3.916481619186276*^9, 3.916481623322246*^9}, {
   3.916481680406053*^9, 3.916481737519289*^9}, {3.916481914634831*^9, 
   3.916481918918346*^9}, {3.916923969477807*^9, 3.9169239903443813`*^9}, 
   3.9169244507737093`*^9},
 CellLabel->
  "In[133]:=",ExpressionUUID->"d743a551-f29e-461f-98d6-9dce6216e767"],

Cell["\<\
The derivative of focal individual fitness, with respect to the focal \
individual\[CloseCurlyQuote]s investment in signalling,  evaluated at \
monomorphic equilibrium, is written below as -cmx. This is Equation L22 in \
the SI. The derivative of focal individual fitness, with respect to the focal \
individual\[CloseCurlyQuote]s level of signal-response,  evaluated at \
monomorphic equilibrium, is written below as -cmy. This is Equation L16  in \
the SI. The derivative of focal individual fitness, with respect to the focal \
individual\[CloseCurlyQuote]s level of dishonesty,  evaluated at monomorphic \
equilibrium, is written below as -cmz. This is Equation L9 in the SI. Note \
that the \[OpenCurlyQuote]cm\[CloseCurlyQuote] notation is used to represent \
the \[OpenCurlyQuote]marginal cost\[CloseCurlyQuote] of Hamilton\
\[CloseCurlyQuote]s Rule. \
\>", "Text",
 CellChangeTimes->{{3.915175733249536*^9, 3.915175737026534*^9}, {
  3.915175857656424*^9, 3.915175883915668*^9}, {3.915201785175893*^9, 
  3.915201785787332*^9}, {3.9169243383213587`*^9, 3.916924540689454*^9}, {
  3.917169045808907*^9, 3.917169122094307*^9}, {3.943003540349025*^9, 
  3.9430035501899233`*^9}},ExpressionUUID->"fce3e85e-8fb1-496d-a817-\
8d857d339c45"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"cmx", "=", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{"D", "[", 
       RowBox[{"w", ",", "xfocal"}], "]"}]}], "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"xfocal", "->", 
        SuperscriptBox["x", "*"]}], ",", 
       RowBox[{"xothers", "->", 
        SuperscriptBox["x", "*"]}], ",", 
       RowBox[{"xpop", "->", 
        SuperscriptBox["x", "*"]}], ",", 
       RowBox[{"yfocal", "->", 
        SuperscriptBox["y", "*"]}], ",", 
       RowBox[{"yothers", "->", 
        SuperscriptBox["y", "*"]}], ",", 
       RowBox[{"ypop", "->", 
        SuperscriptBox["y", "*"]}], ",", 
       RowBox[{"zfocal", "->", 
        SuperscriptBox["z", "*"]}], ",", 
       RowBox[{"zothers", "->", 
        SuperscriptBox["z", "*"]}], ",", 
       RowBox[{"zpop", "->", 
        SuperscriptBox["z", "*"]}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"TraditionalForm", "[", 
  RowBox[{"-", "cmx"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cmy", "=", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{"D", "[", 
       RowBox[{"w", ",", "yfocal"}], "]"}]}], "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"xfocal", "->", 
        SuperscriptBox["x", "*"]}], ",", 
       RowBox[{"xothers", "->", 
        SuperscriptBox["x", "*"]}], ",", 
       RowBox[{"xpop", "->", 
        SuperscriptBox["x", "*"]}], ",", 
       RowBox[{"yfocal", "->", 
        SuperscriptBox["y", "*"]}], ",", 
       RowBox[{"yothers", "->", 
        SuperscriptBox["y", "*"]}], ",", 
       RowBox[{"ypop", "->", 
        SuperscriptBox["y", "*"]}], ",", 
       RowBox[{"zfocal", "->", 
        SuperscriptBox["z", "*"]}], ",", 
       RowBox[{"zothers", "->", 
        SuperscriptBox["z", "*"]}], ",", 
       RowBox[{"zpop", "->", 
        SuperscriptBox["z", "*"]}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"TraditionalForm", "[", 
  RowBox[{"-", "cmy"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cmz", "=", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{"D", "[", 
       RowBox[{"w", ",", "zfocal"}], "]"}]}], "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"xfocal", "->", 
        SuperscriptBox["x", "*"]}], ",", 
       RowBox[{"xothers", "->", 
        SuperscriptBox["x", "*"]}], ",", 
       RowBox[{"xpop", "->", 
        SuperscriptBox["x", "*"]}], ",", 
       RowBox[{"yfocal", "->", 
        SuperscriptBox["y", "*"]}], ",", 
       RowBox[{"yothers", "->", 
        SuperscriptBox["y", "*"]}], ",", 
       RowBox[{"ypop", "->", 
        SuperscriptBox["y", "*"]}], ",", 
       RowBox[{"zfocal", "->", 
        SuperscriptBox["z", "*"]}], ",", 
       RowBox[{"zothers", "->", 
        SuperscriptBox["z", "*"]}], ",", 
       RowBox[{"zpop", "->", 
        SuperscriptBox["z", "*"]}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"TraditionalForm", "[", 
  RowBox[{"-", "cmz"}], "]"}]}], "Input",
 CellChangeTimes->{{3.915177161684618*^9, 3.9151771773356667`*^9}, {
   3.916481483253688*^9, 3.916481552430945*^9}, {3.91648160244484*^9, 
   3.9164816118925*^9}, {3.916481759966824*^9, 3.916481788106379*^9}, 
   3.916481934096526*^9, {3.9164822989840403`*^9, 3.9164823223519583`*^9}, {
   3.916482356877144*^9, 3.916482367589439*^9}, {3.916897535989539*^9, 
   3.9168975825045357`*^9}, {3.916897664196308*^9, 3.916897685271616*^9}, {
   3.916924011307473*^9, 3.916924066960389*^9}, {3.918198102771426*^9, 
   3.918198106165697*^9}},
 CellLabel->
  "In[139]:=",ExpressionUUID->"eb4e5a5e-1e19-473b-85b6-9bb00a5dd6e2"],

Cell[BoxData[
 FormBox[
  RowBox[{"-", 
   FractionBox[
    RowBox[{
     RowBox[{"(", 
      RowBox[{"N", "-", "1"}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"c", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"g", " ", 
           RowBox[{"(", 
            RowBox[{"N", "-", "1"}], ")"}]}], "-", "N"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"p", "-", "1"}], ")"}], " ", 
           SuperscriptBox["z", "*"]}], "-", "p"}], ")"}]}], "+", 
       RowBox[{
        SuperscriptBox["y", "*"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"p", " ", 
           RowBox[{"(", 
            RowBox[{"d", "-", "s"}], ")"}]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"p", "-", "1"}], ")"}], " ", "s", " ", 
           SuperscriptBox["z", "*"]}]}], ")"}]}]}], ")"}]}], 
    RowBox[{"N", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        SuperscriptBox["x", "*"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"N", "-", "1"}], ")"}], " ", 
           SuperscriptBox["y", "*"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"p", " ", 
              RowBox[{"(", 
               RowBox[{"d", "-", "s"}], ")"}]}], "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"p", "-", "1"}], ")"}], " ", "s", " ", 
              SuperscriptBox["z", "*"]}]}], ")"}]}], "-", 
          RowBox[{"c", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"g", "-", "1"}], ")"}], " ", "N"}], "-", "g"}], ")"}], 
           " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"p", "-", "1"}], ")"}], " ", 
              SuperscriptBox["z", "*"]}], "-", "p"}], ")"}]}]}], ")"}]}], "-", 
       RowBox[{"d", " ", "N", " ", "p"}], "+", "N"}], ")"}]}]]}], 
  TraditionalForm]], "Output",
 CellChangeTimes->{{3.915175743038382*^9, 3.915175768128035*^9}, 
   3.915175936434854*^9, 3.915177190897686*^9, 3.915177506724401*^9, 
   3.91517759649308*^9, 3.915185308457467*^9, 3.9151854454804688`*^9, 
   3.9152057318463173`*^9, 3.916481442342709*^9, {3.9164815393717117`*^9, 
   3.916481552674883*^9}, {3.916481586104621*^9, 3.9164816546079397`*^9}, {
   3.9164817755564833`*^9, 3.916481808975319*^9}, {3.9164819310673447`*^9, 
   3.9164819343561277`*^9}, 3.9164821102923717`*^9, 3.916482441344426*^9, 
   3.91681723672745*^9, 3.916897391167815*^9, {3.91689755154731*^9, 
   3.916897582715363*^9}, {3.916897667376539*^9, 3.916897685486547*^9}, 
   3.916924190750946*^9, 3.917008688450069*^9, 3.9170727057502193`*^9, 
   3.9171696231830893`*^9, 3.9181981169750977`*^9},
 CellLabel->
  "Out[140]//TraditionalForm=",ExpressionUUID->"73f3151c-a334-48f1-89f8-\
eaaf57830500"],

Cell[BoxData[
 FormBox[
  FractionBox[
   RowBox[{
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"N", "-", "1"}], ")"}], "2"], " ", 
    SuperscriptBox["x", "*"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"p", " ", 
       RowBox[{"(", 
        RowBox[{"d", "-", "s"}], ")"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"p", "-", "1"}], ")"}], " ", "s", " ", 
       SuperscriptBox["z", "*"]}]}], ")"}]}], 
   RowBox[{"N", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SuperscriptBox["x", "*"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"N", "-", "1"}], ")"}], " ", 
          SuperscriptBox["y", "*"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"p", " ", 
             RowBox[{"(", 
              RowBox[{"d", "-", "s"}], ")"}]}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"p", "-", "1"}], ")"}], " ", "s", " ", 
             SuperscriptBox["z", "*"]}]}], ")"}]}], "-", 
         RowBox[{"c", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"g", "-", "1"}], ")"}], " ", "N"}], "-", "g"}], ")"}], 
          " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"p", "-", "1"}], ")"}], " ", 
             SuperscriptBox["z", "*"]}], "-", "p"}], ")"}]}]}], ")"}]}], "-", 
      
      RowBox[{"d", " ", "N", " ", "p"}], "+", "N"}], ")"}]}]], 
  TraditionalForm]], "Output",
 CellChangeTimes->{{3.915175743038382*^9, 3.915175768128035*^9}, 
   3.915175936434854*^9, 3.915177190897686*^9, 3.915177506724401*^9, 
   3.91517759649308*^9, 3.915185308457467*^9, 3.9151854454804688`*^9, 
   3.9152057318463173`*^9, 3.916481442342709*^9, {3.9164815393717117`*^9, 
   3.916481552674883*^9}, {3.916481586104621*^9, 3.9164816546079397`*^9}, {
   3.9164817755564833`*^9, 3.916481808975319*^9}, {3.9164819310673447`*^9, 
   3.9164819343561277`*^9}, 3.9164821102923717`*^9, 3.916482441344426*^9, 
   3.91681723672745*^9, 3.916897391167815*^9, {3.91689755154731*^9, 
   3.916897582715363*^9}, {3.916897667376539*^9, 3.916897685486547*^9}, 
   3.916924190750946*^9, 3.917008688450069*^9, 3.9170727057502193`*^9, 
   3.9171696231830893`*^9, 3.918198117001759*^9},
 CellLabel->
  "Out[142]//TraditionalForm=",ExpressionUUID->"81cd7004-feec-4113-b18d-\
353d00c6c2ba"],

Cell[BoxData[
 FormBox[
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{"N", "-", "1"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{"p", "-", "1"}], ")"}], " ", 
    SuperscriptBox["x", "*"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"c", " ", 
       RowBox[{"(", 
        RowBox[{"g", "-", "1"}], ")"}], " ", "N"}], "-", 
      RowBox[{"c", " ", "g"}], "+", 
      RowBox[{"s", " ", 
       SuperscriptBox["y", "*"]}]}], ")"}]}], 
   RowBox[{"N", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SuperscriptBox["x", "*"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"c", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"g", "-", "1"}], ")"}], " ", "N"}], "-", "g"}], ")"}], 
          " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"p", "-", "1"}], ")"}], " ", 
             SuperscriptBox["z", "*"]}], "-", "p"}], ")"}]}], "-", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"N", "-", "1"}], ")"}], " ", 
          SuperscriptBox["y", "*"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"p", " ", 
             RowBox[{"(", 
              RowBox[{"d", "-", "s"}], ")"}]}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"p", "-", "1"}], ")"}], " ", "s", " ", 
             SuperscriptBox["z", "*"]}]}], ")"}]}]}], ")"}]}], "+", 
      RowBox[{"N", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"d", " ", "p"}], "-", "1"}], ")"}]}]}], ")"}]}]], 
  TraditionalForm]], "Output",
 CellChangeTimes->{{3.915175743038382*^9, 3.915175768128035*^9}, 
   3.915175936434854*^9, 3.915177190897686*^9, 3.915177506724401*^9, 
   3.91517759649308*^9, 3.915185308457467*^9, 3.9151854454804688`*^9, 
   3.9152057318463173`*^9, 3.916481442342709*^9, {3.9164815393717117`*^9, 
   3.916481552674883*^9}, {3.916481586104621*^9, 3.9164816546079397`*^9}, {
   3.9164817755564833`*^9, 3.916481808975319*^9}, {3.9164819310673447`*^9, 
   3.9164819343561277`*^9}, 3.9164821102923717`*^9, 3.916482441344426*^9, 
   3.91681723672745*^9, 3.916897391167815*^9, {3.91689755154731*^9, 
   3.916897582715363*^9}, {3.916897667376539*^9, 3.916897685486547*^9}, 
   3.916924190750946*^9, 3.917008688450069*^9, 3.9170727057502193`*^9, 
   3.9171696231830893`*^9, 3.918198117021162*^9},
 CellLabel->
  "Out[144]//TraditionalForm=",ExpressionUUID->"f9206fe0-ff18-41d2-aef7-\
24dc84d2857d"]
}, Open  ]],

Cell["\<\
The derivative of focal individual fitness, with respect to the average \
signal investment of other individuals on the deme, evaluated at monomorphic \
equilibrium, is written below as bmx. This is Equation L23 in the SI. The \
derivative of focal individual fitness, with respect to the average \
signal-response level of other individuals on the deme, evaluated at \
monomorphic equilibrium, is written below as bmy. This is Equation L17 in the \
SI. The derivative of focal individual fitness, with respect to the average \
signal dishonesty level of other individuals on the deme, evaluated at \
monomorphic equilibrium, is written below as bmz. This is Equation L10 in the \
SI. Note that the \[OpenCurlyQuote]bm\[CloseCurlyQuote] notation is used to \
represent the \[OpenCurlyQuote]marginal benefit\[CloseCurlyQuote] of Hamilton\
\[CloseCurlyQuote]s Rule. \
\>", "Text",
 CellChangeTimes->{{3.915175418488715*^9, 3.915175518937564*^9}, 
   3.915175722238924*^9, {3.915175920186359*^9, 3.915175930914809*^9}, {
   3.915201863902808*^9, 3.9152018640063953`*^9}, {3.916924737050666*^9, 
   3.916924834839422*^9}, {3.917169140804325*^9, 3.917169197401903*^9}, {
   3.943003555681685*^9, 
   3.9430035639338293`*^9}},ExpressionUUID->"ae18ee5f-537b-42c2-986a-\
fcb68167ff09"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"TraditionalForm", "[", 
  RowBox[{"bmx", "=", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{"w", ",", "xothers"}], "]"}], "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"xfocal", "->", 
        SuperscriptBox["x", "*"]}], ",", 
       RowBox[{"xothers", "->", 
        SuperscriptBox["x", "*"]}], ",", 
       RowBox[{"xpop", "->", 
        SuperscriptBox["x", "*"]}], ",", 
       RowBox[{"yfocal", "->", 
        SuperscriptBox["y", "*"]}], ",", 
       RowBox[{"yothers", "->", 
        SuperscriptBox["y", "*"]}], ",", 
       RowBox[{"ypop", "->", 
        SuperscriptBox["y", "*"]}], ",", 
       RowBox[{"zfocal", "->", 
        SuperscriptBox["z", "*"]}], ",", 
       RowBox[{"zothers", "->", 
        SuperscriptBox["z", "*"]}], ",", 
       RowBox[{"zpop", "->", 
        SuperscriptBox["z", "*"]}]}], "}"}]}], "]"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"TraditionalForm", "[", 
  RowBox[{"bmy", "=", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{"w", ",", "yothers"}], "]"}], "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"xfocal", "->", 
        SuperscriptBox["x", "*"]}], ",", 
       RowBox[{"xothers", "->", 
        SuperscriptBox["x", "*"]}], ",", 
       RowBox[{"xpop", "->", 
        SuperscriptBox["x", "*"]}], ",", 
       RowBox[{"yfocal", "->", 
        SuperscriptBox["y", "*"]}], ",", 
       RowBox[{"yothers", "->", 
        SuperscriptBox["y", "*"]}], ",", 
       RowBox[{"ypop", "->", 
        SuperscriptBox["y", "*"]}], ",", 
       RowBox[{"zfocal", "->", 
        SuperscriptBox["z", "*"]}], ",", 
       RowBox[{"zothers", "->", 
        SuperscriptBox["z", "*"]}], ",", 
       RowBox[{"zpop", "->", 
        SuperscriptBox["z", "*"]}]}], "}"}]}], "]"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"TraditionalForm", "[", 
  RowBox[{"bmz", "=", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{"w", ",", "zothers"}], "]"}], "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"xfocal", "->", 
        SuperscriptBox["x", "*"]}], ",", 
       RowBox[{"xothers", "->", 
        SuperscriptBox["x", "*"]}], ",", 
       RowBox[{"xpop", "->", 
        SuperscriptBox["x", "*"]}], ",", 
       RowBox[{"yfocal", "->", 
        SuperscriptBox["y", "*"]}], ",", 
       RowBox[{"yothers", "->", 
        SuperscriptBox["y", "*"]}], ",", 
       RowBox[{"ypop", "->", 
        SuperscriptBox["y", "*"]}], ",", 
       RowBox[{"zfocal", "->", 
        SuperscriptBox["z", "*"]}], ",", 
       RowBox[{"zothers", "->", 
        SuperscriptBox["z", "*"]}], ",", 
       RowBox[{"zpop", "->", 
        SuperscriptBox["z", "*"]}]}], "}"}]}], "]"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.9081039414213743`*^9, 3.9081039435052147`*^9}, {
   3.90810406510456*^9, 3.908104073589612*^9}, {3.9081043026353397`*^9, 
   3.9081043339158287`*^9}, 3.908106925554028*^9, {3.911391003528234*^9, 
   3.9113910075287848`*^9}, {3.9115423725276537`*^9, 3.911542390599454*^9}, {
   3.915175399934017*^9, 3.915175400756152*^9}, 3.915175723845454*^9, {
   3.915177193413665*^9, 3.9151771935552893`*^9}, {3.9164819598739023`*^9, 
   3.916481970547638*^9}, 3.91648230585422*^9, {3.916482371868814*^9, 
   3.916482381088786*^9}, {3.916924211383026*^9, 3.916924219763884*^9}},
 CellLabel->"In[13]:=",ExpressionUUID->"39673324-5332-4b28-ad78-d5381040ef45"],

Cell[BoxData[
 FormBox[
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{"N", "-", "1"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"c", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"g", " ", 
          RowBox[{"(", 
           RowBox[{"N", "-", "1"}], ")"}]}], "-", "N"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"p", "-", "1"}], ")"}], " ", 
          SuperscriptBox["z", "*"]}], "-", "p"}], ")"}]}], "+", 
      RowBox[{
       SuperscriptBox["y", "*"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"p", " ", 
          RowBox[{"(", 
           RowBox[{"d", "-", "s"}], ")"}]}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"p", "-", "1"}], ")"}], " ", "s", " ", 
          SuperscriptBox["z", "*"]}]}], ")"}]}]}], ")"}]}], 
   RowBox[{"N", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SuperscriptBox["x", "*"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"N", "-", "1"}], ")"}], " ", 
          SuperscriptBox["y", "*"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"p", " ", 
             RowBox[{"(", 
              RowBox[{"d", "-", "s"}], ")"}]}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"p", "-", "1"}], ")"}], " ", "s", " ", 
             SuperscriptBox["z", "*"]}]}], ")"}]}], "-", 
         RowBox[{"c", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"g", "-", "1"}], ")"}], " ", "N"}], "-", "g"}], ")"}], 
          " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"p", "-", "1"}], ")"}], " ", 
             SuperscriptBox["z", "*"]}], "-", "p"}], ")"}]}]}], ")"}]}], "-", 
      
      RowBox[{"d", " ", "N", " ", "p"}], "+", "N"}], ")"}]}]], 
  TraditionalForm]], "Output",
 CellChangeTimes->{{3.908104066438794*^9, 3.908104073995747*^9}, {
   3.908104334637701*^9, 3.908104339447672*^9}, 3.908104424387844*^9, 
   3.90810793331876*^9, 3.908268880209581*^9, 3.9083559231030807`*^9, 
   3.9108605734536858`*^9, 3.911376842118787*^9, 3.911377086620686*^9, 
   3.9113911571237173`*^9, 3.911471811646303*^9, 3.911542455073489*^9, 
   3.9115545156811333`*^9, 3.911555059549644*^9, 3.915175584540079*^9, 
   3.915175770181059*^9, {3.915175934655409*^9, 3.915175941825774*^9}, 
   3.915177194903661*^9, 3.915177508380785*^9, 3.915177613264398*^9, 
   3.9151854491434717`*^9, 3.915205736861938*^9, 3.91648197268186*^9, 
   3.916482112689074*^9, 3.916482454211854*^9, 3.916817238961383*^9, 
   3.916897399110004*^9, 3.916924221003422*^9, 3.917008690775882*^9, 
   3.917072844153636*^9, 3.9171696236729403`*^9},
 CellLabel->
  "Out[13]//TraditionalForm=",ExpressionUUID->"a9d2faf8-51a9-474a-9470-\
6c79f88ff4ed"],

Cell[BoxData[
 FormBox[
  RowBox[{"-", 
   FractionBox[
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"N", "-", "1"}], ")"}], "2"], " ", 
     SuperscriptBox["x", "*"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"p", " ", 
        RowBox[{"(", 
         RowBox[{"d", "-", "s"}], ")"}]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"p", "-", "1"}], ")"}], " ", "s", " ", 
        SuperscriptBox["z", "*"]}]}], ")"}]}], 
    RowBox[{"N", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        SuperscriptBox["x", "*"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"N", "-", "1"}], ")"}], " ", 
           SuperscriptBox["y", "*"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"p", " ", 
              RowBox[{"(", 
               RowBox[{"d", "-", "s"}], ")"}]}], "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"p", "-", "1"}], ")"}], " ", "s", " ", 
              SuperscriptBox["z", "*"]}]}], ")"}]}], "-", 
          RowBox[{"c", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"g", "-", "1"}], ")"}], " ", "N"}], "-", "g"}], ")"}], 
           " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"p", "-", "1"}], ")"}], " ", 
              SuperscriptBox["z", "*"]}], "-", "p"}], ")"}]}]}], ")"}]}], "-", 
       RowBox[{"d", " ", "N", " ", "p"}], "+", "N"}], ")"}]}]]}], 
  TraditionalForm]], "Output",
 CellChangeTimes->{{3.908104066438794*^9, 3.908104073995747*^9}, {
   3.908104334637701*^9, 3.908104339447672*^9}, 3.908104424387844*^9, 
   3.90810793331876*^9, 3.908268880209581*^9, 3.9083559231030807`*^9, 
   3.9108605734536858`*^9, 3.911376842118787*^9, 3.911377086620686*^9, 
   3.9113911571237173`*^9, 3.911471811646303*^9, 3.911542455073489*^9, 
   3.9115545156811333`*^9, 3.911555059549644*^9, 3.915175584540079*^9, 
   3.915175770181059*^9, {3.915175934655409*^9, 3.915175941825774*^9}, 
   3.915177194903661*^9, 3.915177508380785*^9, 3.915177613264398*^9, 
   3.9151854491434717`*^9, 3.915205736861938*^9, 3.91648197268186*^9, 
   3.916482112689074*^9, 3.916482454211854*^9, 3.916817238961383*^9, 
   3.916897399110004*^9, 3.916924221003422*^9, 3.917008690775882*^9, 
   3.917072844153636*^9, 3.917169623688849*^9},
 CellLabel->
  "Out[14]//TraditionalForm=",ExpressionUUID->"3161d497-ae08-40ca-93bf-\
2032ba97a920"],

Cell[BoxData[
 FormBox[
  RowBox[{"-", 
   FractionBox[
    RowBox[{
     RowBox[{"(", 
      RowBox[{"N", "-", "1"}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"p", "-", "1"}], ")"}], " ", 
     SuperscriptBox["x", "*"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"c", " ", 
        RowBox[{"(", 
         RowBox[{"g", "-", "1"}], ")"}], " ", "N"}], "-", 
       RowBox[{"c", " ", "g"}], "+", 
       RowBox[{"s", " ", 
        SuperscriptBox["y", "*"]}]}], ")"}]}], 
    RowBox[{"N", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        SuperscriptBox["x", "*"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"c", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"g", "-", "1"}], ")"}], " ", "N"}], "-", "g"}], ")"}], 
           " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"p", "-", "1"}], ")"}], " ", 
              SuperscriptBox["z", "*"]}], "-", "p"}], ")"}]}], "-", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"N", "-", "1"}], ")"}], " ", 
           SuperscriptBox["y", "*"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"p", " ", 
              RowBox[{"(", 
               RowBox[{"d", "-", "s"}], ")"}]}], "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"p", "-", "1"}], ")"}], " ", "s", " ", 
              SuperscriptBox["z", "*"]}]}], ")"}]}]}], ")"}]}], "+", 
       RowBox[{"N", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"d", " ", "p"}], "-", "1"}], ")"}]}]}], ")"}]}]]}], 
  TraditionalForm]], "Output",
 CellChangeTimes->{{3.908104066438794*^9, 3.908104073995747*^9}, {
   3.908104334637701*^9, 3.908104339447672*^9}, 3.908104424387844*^9, 
   3.90810793331876*^9, 3.908268880209581*^9, 3.9083559231030807`*^9, 
   3.9108605734536858`*^9, 3.911376842118787*^9, 3.911377086620686*^9, 
   3.9113911571237173`*^9, 3.911471811646303*^9, 3.911542455073489*^9, 
   3.9115545156811333`*^9, 3.911555059549644*^9, 3.915175584540079*^9, 
   3.915175770181059*^9, {3.915175934655409*^9, 3.915175941825774*^9}, 
   3.915177194903661*^9, 3.915177508380785*^9, 3.915177613264398*^9, 
   3.9151854491434717`*^9, 3.915205736861938*^9, 3.91648197268186*^9, 
   3.916482112689074*^9, 3.916482454211854*^9, 3.916817238961383*^9, 
   3.916897399110004*^9, 3.916924221003422*^9, 3.917008690775882*^9, 
   3.917072844153636*^9, 3.9171696237044573`*^9},
 CellLabel->
  "Out[15]//TraditionalForm=",ExpressionUUID->"403d3a08-6444-405c-a41f-\
98a3494e38a2"]
}, Open  ]],

Cell["\<\
The overall marginal change in neighbour-modulated fitness associated with a \
slight change in signalling investment is written below as margopenx. The \
overall marginal change in neighbour-modulated fitness associated with a \
slight change in signal-response is written below as margopeny. The overall \
marginal change in neighbour-modulated fitness associated with a slight \
change in signal dishonesty is written below as margopenz. The \
\[OpenCurlyQuote]margopen\[CloseCurlyQuote] notation is used to represent the \
marginal fitness change, and the open model setting. \
\>", "Text",
 CellChangeTimes->{{3.915175958153467*^9, 3.915176040877063*^9}, {
  3.915177227882449*^9, 3.9151773535121117`*^9}, {3.9152019626637087`*^9, 
  3.915201962719282*^9}, {3.916924848430903*^9, 
  3.9169249480354433`*^9}},ExpressionUUID->"b72be7b4-4cfd-417f-ab29-\
81581f670046"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"TraditionalForm", "[", 
  RowBox[{"margopenx", "=", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{
     RowBox[{
      SuperscriptBox["r", "*"], " ", "bmx"}], " ", "-", " ", "cmx"}], "]"}]}],
   "]"}], "\[IndentingNewLine]", 
 RowBox[{"TraditionalForm", "[", 
  RowBox[{"margopeny", "=", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{
     RowBox[{
      SuperscriptBox["r", "*"], " ", "bmy"}], " ", "-", " ", "cmy"}], "]"}]}],
   "]"}], "\[IndentingNewLine]", 
 RowBox[{"TraditionalForm", "[", 
  RowBox[{"margopenz", "=", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{
     RowBox[{
      SuperscriptBox["r", "*"], " ", "bmz"}], " ", "-", " ", "cmz"}], "]"}]}],
   "]"}]}], "Input",
 CellChangeTimes->{{3.9081044477104807`*^9, 3.908104459241107*^9}, {
   3.908104492639288*^9, 3.9081044941536303`*^9}, {3.9081051452016487`*^9, 
   3.90810514887316*^9}, {3.9151758222548037`*^9, 3.9151758368976316`*^9}, {
   3.915177197160902*^9, 3.9151772227977467`*^9}, 3.915177266100378*^9, {
   3.91648233432502*^9, 3.916482342389292*^9}, {3.916482411368557*^9, 
   3.916482421649559*^9}, {3.917008695470492*^9, 3.917008702573369*^9}},
 CellLabel->"In[16]:=",ExpressionUUID->"6f7794fb-7f9c-466e-be51-fe277bb00d5c"],

Cell[BoxData[
 FormBox[
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{"N", "-", "1"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["r", "*"], "-", "1"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"c", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"g", " ", 
          RowBox[{"(", 
           RowBox[{"N", "-", "1"}], ")"}]}], "-", "N"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"p", "-", "1"}], ")"}], " ", 
          SuperscriptBox["z", "*"]}], "-", "p"}], ")"}]}], "+", 
      RowBox[{
       SuperscriptBox["y", "*"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"p", " ", 
          RowBox[{"(", 
           RowBox[{"d", "-", "s"}], ")"}]}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"p", "-", "1"}], ")"}], " ", "s", " ", 
          SuperscriptBox["z", "*"]}]}], ")"}]}]}], ")"}]}], 
   RowBox[{"N", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SuperscriptBox["x", "*"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"N", "-", "1"}], ")"}], " ", 
          SuperscriptBox["y", "*"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"p", " ", 
             RowBox[{"(", 
              RowBox[{"d", "-", "s"}], ")"}]}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"p", "-", "1"}], ")"}], " ", "s", " ", 
             SuperscriptBox["z", "*"]}]}], ")"}]}], "-", 
         RowBox[{"c", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"g", "-", "1"}], ")"}], " ", "N"}], "-", "g"}], ")"}], 
          " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"p", "-", "1"}], ")"}], " ", 
             SuperscriptBox["z", "*"]}], "-", "p"}], ")"}]}]}], ")"}]}], "-", 
      
      RowBox[{"d", " ", "N", " ", "p"}], "+", "N"}], ")"}]}]], 
  TraditionalForm]], "Output",
 CellChangeTimes->{
  3.9081044594986353`*^9, 3.908104494901422*^9, 3.908105149718433*^9, 
   3.9081079426689453`*^9, 3.908268887184318*^9, 3.908355930776684*^9, 
   3.910860606912422*^9, 3.911376884182818*^9, 3.9113771335928373`*^9, 
   3.911471977218416*^9, 3.91154771336239*^9, 3.911554641393799*^9, 
   3.9115551823599377`*^9, {3.9151758295380363`*^9, 3.915175837301425*^9}, 
   3.915175945948777*^9, 3.91517605612919*^9, 3.915177202186002*^9, 
   3.915177356595026*^9, 3.9151775111263103`*^9, 3.915177625624977*^9, 
   3.91518566158922*^9, 3.915186018478601*^9, 3.915205738524659*^9, 
   3.9164819989330893`*^9, 3.9164821167929287`*^9, 3.916482535622197*^9, 
   3.916817241448886*^9, 3.916924226240726*^9, 3.917008704527029*^9, 
   3.917169623881089*^9},
 CellLabel->
  "Out[16]//TraditionalForm=",ExpressionUUID->"79f86600-add3-4bf0-a438-\
de161778c5d0"],

Cell[BoxData[
 FormBox[
  RowBox[{"-", 
   FractionBox[
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"N", "-", "1"}], ")"}], "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["r", "*"], "-", "1"}], ")"}], " ", 
     SuperscriptBox["x", "*"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"p", " ", 
        RowBox[{"(", 
         RowBox[{"d", "-", "s"}], ")"}]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"p", "-", "1"}], ")"}], " ", "s", " ", 
        SuperscriptBox["z", "*"]}]}], ")"}]}], 
    RowBox[{"N", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        SuperscriptBox["x", "*"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"N", "-", "1"}], ")"}], " ", 
           SuperscriptBox["y", "*"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"p", " ", 
              RowBox[{"(", 
               RowBox[{"d", "-", "s"}], ")"}]}], "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"p", "-", "1"}], ")"}], " ", "s", " ", 
              SuperscriptBox["z", "*"]}]}], ")"}]}], "-", 
          RowBox[{"c", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"g", "-", "1"}], ")"}], " ", "N"}], "-", "g"}], ")"}], 
           " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"p", "-", "1"}], ")"}], " ", 
              SuperscriptBox["z", "*"]}], "-", "p"}], ")"}]}]}], ")"}]}], "-", 
       RowBox[{"d", " ", "N", " ", "p"}], "+", "N"}], ")"}]}]]}], 
  TraditionalForm]], "Output",
 CellChangeTimes->{
  3.9081044594986353`*^9, 3.908104494901422*^9, 3.908105149718433*^9, 
   3.9081079426689453`*^9, 3.908268887184318*^9, 3.908355930776684*^9, 
   3.910860606912422*^9, 3.911376884182818*^9, 3.9113771335928373`*^9, 
   3.911471977218416*^9, 3.91154771336239*^9, 3.911554641393799*^9, 
   3.9115551823599377`*^9, {3.9151758295380363`*^9, 3.915175837301425*^9}, 
   3.915175945948777*^9, 3.91517605612919*^9, 3.915177202186002*^9, 
   3.915177356595026*^9, 3.9151775111263103`*^9, 3.915177625624977*^9, 
   3.91518566158922*^9, 3.915186018478601*^9, 3.915205738524659*^9, 
   3.9164819989330893`*^9, 3.9164821167929287`*^9, 3.916482535622197*^9, 
   3.916817241448886*^9, 3.916924226240726*^9, 3.917008704527029*^9, 
   3.9171696239578238`*^9},
 CellLabel->
  "Out[17]//TraditionalForm=",ExpressionUUID->"2198b3ca-b497-49f0-b3ca-\
3a8bca4d935f"],

Cell[BoxData[
 FormBox[
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{"N", "-", "1"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{"p", "-", "1"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{"1", "-", 
      SuperscriptBox["r", "*"]}], ")"}], " ", 
    SuperscriptBox["x", "*"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"c", " ", 
       RowBox[{"(", 
        RowBox[{"g", "-", "1"}], ")"}], " ", "N"}], "-", 
      RowBox[{"c", " ", "g"}], "+", 
      RowBox[{"s", " ", 
       SuperscriptBox["y", "*"]}]}], ")"}]}], 
   RowBox[{"N", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SuperscriptBox["x", "*"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"c", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"g", "-", "1"}], ")"}], " ", "N"}], "-", "g"}], ")"}], 
          " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"p", "-", "1"}], ")"}], " ", 
             SuperscriptBox["z", "*"]}], "-", "p"}], ")"}]}], "-", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"N", "-", "1"}], ")"}], " ", 
          SuperscriptBox["y", "*"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"p", " ", 
             RowBox[{"(", 
              RowBox[{"d", "-", "s"}], ")"}]}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"p", "-", "1"}], ")"}], " ", "s", " ", 
             SuperscriptBox["z", "*"]}]}], ")"}]}]}], ")"}]}], "+", 
      RowBox[{"N", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"d", " ", "p"}], "-", "1"}], ")"}]}]}], ")"}]}]], 
  TraditionalForm]], "Output",
 CellChangeTimes->{
  3.9081044594986353`*^9, 3.908104494901422*^9, 3.908105149718433*^9, 
   3.9081079426689453`*^9, 3.908268887184318*^9, 3.908355930776684*^9, 
   3.910860606912422*^9, 3.911376884182818*^9, 3.9113771335928373`*^9, 
   3.911471977218416*^9, 3.91154771336239*^9, 3.911554641393799*^9, 
   3.9115551823599377`*^9, {3.9151758295380363`*^9, 3.915175837301425*^9}, 
   3.915175945948777*^9, 3.91517605612919*^9, 3.915177202186002*^9, 
   3.915177356595026*^9, 3.9151775111263103`*^9, 3.915177625624977*^9, 
   3.91518566158922*^9, 3.915186018478601*^9, 3.915205738524659*^9, 
   3.9164819989330893`*^9, 3.9164821167929287`*^9, 3.916482535622197*^9, 
   3.916817241448886*^9, 3.916924226240726*^9, 3.917008704527029*^9, 
   3.9171696240437183`*^9},
 CellLabel->
  "Out[18]//TraditionalForm=",ExpressionUUID->"de7ec33f-680e-4c9c-bff8-\
29dcc7bed96e"]
}, Open  ]],

Cell[TextData[{
 "We obtain a condition for signal-dishonesty being at an ESS by setting \
margopenz to equal zero, to obtain ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SuperscriptBox["y", "*"], "\[Rule]", 
    FractionBox[
     RowBox[{"c", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"g", " ", 
         RowBox[{"(", 
          RowBox[{"-", "N"}], ")"}]}], "+", "g", "+", "N"}], ")"}]}], "s"]}], 
   TraditionalForm]],
  CellChangeTimes->{3.9168193414187*^9, 3.9168275118005867`*^9, 
   3.916924240351778*^9},ExpressionUUID->
  "50916b3a-4fa0-4444-b26e-b245609ed4c3"],
 ". Signal-dishonesty is at an ESS (z=z*) when this condition is satisfied. \
This is Equation L13 in the SI. "
}], "Text",
 CellChangeTimes->{{3.916925405730946*^9, 3.9169254139292717`*^9}, {
   3.9169254444444304`*^9, 3.916925444444467*^9}, {3.916925616595517*^9, 
   3.916925670890792*^9}, {3.916926403105534*^9, 3.916926421929783*^9}, {
   3.916926508876215*^9, 3.916926515776126*^9}, 3.916985469976035*^9, {
   3.917169375647493*^9, 3.91716946483741*^9}, 3.917169502590571*^9, {
   3.9430036110407543`*^9, 
   3.943003611127036*^9}},ExpressionUUID->"1a512985-5fff-4041-a9e5-\
e702c66675a1"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"FullSimplify", "[", 
  RowBox[{"Solve", "[", 
   RowBox[{
    RowBox[{"margopenz", "==", "0"}], ",", 
    SuperscriptBox["y", "*"]}], "]"}], "]"}]], "Input",
 CellChangeTimes->{
  3.916819346510264*^9, {3.916827517292119*^9, 3.9168275197514668`*^9}, {
   3.91698549685701*^9, 3.91698550525738*^9}, {3.9169916289956493`*^9, 
   3.91699163084838*^9}},
 CellLabel->"In[19]:=",ExpressionUUID->"d009c62b-bb35-4c68-8c74-a52f0bfa684f"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    SuperscriptBox["y", "*"], "\[Rule]", 
    FractionBox[
     RowBox[{"c", " ", 
      RowBox[{"(", 
       RowBox[{"g", "+", "N", "-", 
        RowBox[{"g", " ", "N"}]}], ")"}]}], "s"]}], "}"}], "}"}]], "Output",
 CellChangeTimes->{3.9168193469289417`*^9, 3.916827520046818*^9, 
  3.9169242437882566`*^9, 3.9169254315367804`*^9, 3.916985506206353*^9, 
  3.916991631098401*^9, 3.917008711976697*^9, 3.917169624132285*^9},
 CellLabel->"Out[19]=",ExpressionUUID->"89008f56-d965-46f4-965a-d9a5d7c5e00a"]
}, Open  ]],

Cell[TextData[{
 "We obtain a condition for signal-response being at an ESS by setting \
margopeny to equal zero, to obtain ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SuperscriptBox["z", "*"], "\[Rule]", 
    FractionBox[
     RowBox[{"p", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "d"}], "+", "s"}], ")"}]}], 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "p"}], ")"}], " ", "s"}]]}], 
   TraditionalForm]],
  CellChangeTimes->{3.9168193414187*^9, 3.9168275118005867`*^9, 
   3.916924240351778*^9},ExpressionUUID->
  "c400b85a-02fa-4830-a6ae-8d9060bee644"],
 ". Signal-response is at an ESS (y=y*) when this condition is satisfied. \
This is Equation L20 in the SI. "
}], "Text",
 CellChangeTimes->{{3.916925368926862*^9, 3.916925390412713*^9}, {
  3.917169489795814*^9, 3.917169539996696*^9}, {3.917170424492074*^9, 
  3.917170428290436*^9}, {3.9430036149144287`*^9, 
  3.943003614956766*^9}},ExpressionUUID->"5cbbf18a-a18d-4401-b02e-\
f9ebee2fa215"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"FullSimplify", "[", 
  RowBox[{"Solve", "[", 
   RowBox[{
    RowBox[{"margopeny", "==", "0"}], ",", 
    SuperscriptBox["z", "*"]}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.916819340783867*^9, 3.916819340845152*^9}, {
  3.916827508768277*^9, 3.916827511389678*^9}, {3.9169854843460693`*^9, 
  3.916985488809363*^9}, {3.916991623237121*^9, 3.916991625352806*^9}},
 CellLabel->"In[20]:=",ExpressionUUID->"ecb3cc8e-1fe9-4b11-b343-64bab0747cda"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    SuperscriptBox["z", "*"], "\[Rule]", 
    FractionBox[
     RowBox[{"p", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "d"}], "+", "s"}], ")"}]}], 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "p"}], ")"}], " ", "s"}]]}], "}"}], 
  "}"}]], "Output",
 CellChangeTimes->{3.9168193414187*^9, 3.9168275118005867`*^9, 
  3.916924240351778*^9, 3.916985489760758*^9, 3.916991625582993*^9, 
  3.917008710583263*^9, 3.917169624202911*^9},
 CellLabel->"Out[20]=",ExpressionUUID->"5cf877e0-4dd1-4ea3-a9f0-40c74da97446"]
}, Open  ]],

Cell[TextData[{
 "We ask when a slight increase in signalling is favoured. To do so, we first \
set the margopenx to zero, to obtain ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SuperscriptBox["y", "*"], "\[Rule]", 
    RowBox[{"-", 
     FractionBox[
      RowBox[{"c", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"g", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "N"}], ")"}]}], "-", "N"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "p"}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "p"}], ")"}], " ", 
          SuperscriptBox["z", "*"]}]}], ")"}]}], 
      RowBox[{
       RowBox[{"p", " ", 
        RowBox[{"(", 
         RowBox[{"d", "-", "s"}], ")"}]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "p"}], ")"}], " ", "s", " ", 
        SuperscriptBox["z", "*"]}]}]]}]}], TraditionalForm]],
  CellChangeTimes->{
   3.91681932997968*^9, {3.9168193708872013`*^9, 3.916819377676259*^9}, 
    3.9169242352947397`*^9},ExpressionUUID->
  "b1c7465c-e3e0-4050-8779-188508be244f"],
 ". Signalling is favoured when the left-hand side is greater than the \
right-hand side. This is Equation L26 (rearranged) in the SI. We then \
substitute into margopenx our ESS values for ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["y", "*"], TraditionalForm]],ExpressionUUID->
  "26a2d164-a01e-4273-9c7d-718e54f9f60d"],
 "and ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["z", "*"], TraditionalForm]],ExpressionUUID->
  "7fc204e5-78a6-45c4-8f9e-72046df947fd"],
 " and obtain ",
 Cell[BoxData[
  FractionBox[
   RowBox[{"c", " ", "d", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"g", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "N"}], ")"}]}], "-", "N"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "N"}], ")"}], " ", "p", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", 
      SuperscriptBox["r", "*"]}], ")"}]}], 
   RowBox[{"N", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"N", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", 
         RowBox[{"d", " ", "p"}]}], ")"}], " ", "s"}], "+", 
      RowBox[{"c", " ", "d", " ", 
       RowBox[{"(", 
        RowBox[{"g", "+", "N", "-", 
         RowBox[{"g", " ", "N"}]}], ")"}], " ", "p", " ", 
       SuperscriptBox["x", "*"]}]}], ")"}]}]]],
  CellChangeTimes->{
   3.916995038374185*^9, 3.91699513183324*^9, {3.916995166521688*^9, 
    3.9169951901365023`*^9}, 3.916995241138644*^9, {3.916995275123004*^9, 
    3.9169952871546173`*^9}, 3.917008717942792*^9},ExpressionUUID->
  "525d86e3-2eda-43e6-b188-322bdca269be"],
 ", which we can see by inspection is always negative. This means that \
signalling is disfavoured at equilibrium, leading to x*=0."
}], "Text",
 CellChangeTimes->{{3.915176101958577*^9, 3.915176179387744*^9}, {
  3.915176229291583*^9, 3.915176243005365*^9}, {3.915177406063599*^9, 
  3.915177410206997*^9}, {3.915177643831272*^9, 3.915177649866047*^9}, {
  3.916925020263899*^9, 3.91692502865641*^9}, {3.91692516531522*^9, 
  3.916925175033794*^9}, {3.9169252289730663`*^9, 3.916925243873952*^9}, {
  3.916925313939077*^9, 3.916925356059578*^9}, {3.917169315385355*^9, 
  3.917169324958881*^9}, {3.9171695715163097`*^9, 3.917169574485723*^9}, {
  3.917169650175866*^9, 3.917169837557352*^9}, {3.943003619647622*^9, 
  3.94300361969858*^9}},ExpressionUUID->"53748a7d-4843-43f4-bcd1-\
a786586ca1bf"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"FullSimplify", "[", 
  RowBox[{"Solve", "[", 
   RowBox[{
    RowBox[{"margopenx", "==", "0"}], ",", 
    SuperscriptBox["y", "*"]}], "]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"FullSimplify", "[", 
  RowBox[{"margopenx", "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      SuperscriptBox["y", "*"], "\[Rule]", 
      FractionBox[
       RowBox[{"c", " ", 
        RowBox[{"(", 
         RowBox[{"g", "+", "N", "-", 
          RowBox[{"g", " ", "N"}]}], ")"}]}], "s"]}], ",", 
     RowBox[{
      SuperscriptBox["z", "*"], "\[Rule]", 
      FractionBox[
       RowBox[{"p", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "d"}], "+", "s"}], ")"}]}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "p"}], ")"}], " ", "s"}]]}]}], "}"}]}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.9168192463935623`*^9, 3.916819258916613*^9}, {
  3.916819365377577*^9, 3.916819377273843*^9}, {3.916985544152729*^9, 
  3.916985562760304*^9}, {3.91699161642218*^9, 3.916991618562194*^9}, {
  3.917169599741001*^9, 3.9171696014622173`*^9}, {3.917169634646111*^9, 
  3.9171696384704*^9}, {3.91716984423207*^9, 3.9171698444705477`*^9}},
 CellLabel->"In[23]:=",ExpressionUUID->"f5948c10-ce5e-4680-9bd2-81685c03947d"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    SuperscriptBox["y", "*"], "\[Rule]", 
    RowBox[{"-", 
     FractionBox[
      RowBox[{"c", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"g", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "N"}], ")"}]}], "-", "N"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "p"}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "p"}], ")"}], " ", 
          SuperscriptBox["z", "*"]}]}], ")"}]}], 
      RowBox[{
       RowBox[{"p", " ", 
        RowBox[{"(", 
         RowBox[{"d", "-", "s"}], ")"}]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "p"}], ")"}], " ", "s", " ", 
        SuperscriptBox["z", "*"]}]}]]}]}], "}"}], "}"}]], "Output",
 CellChangeTimes->{
  3.91681932997968*^9, {3.9168193708872013`*^9, 3.916819377676259*^9}, 
   3.9169242352947397`*^9, 3.9169855635265627`*^9, 3.916991618814695*^9, 
   3.917008708959016*^9, {3.9171696291265182`*^9, 3.917169639164115*^9}, 
   3.917169845158881*^9},
 CellLabel->"Out[23]=",ExpressionUUID->"50e20c20-2735-41cc-aae5-7e30b9d3853c"],

Cell[BoxData[
 FractionBox[
  RowBox[{"c", " ", "d", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"g", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "N"}], ")"}]}], "-", "N"}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "+", "N"}], ")"}], " ", "p", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "+", 
     SuperscriptBox["r", "*"]}], ")"}]}], 
  RowBox[{"N", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"N", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        RowBox[{"d", " ", "p"}]}], ")"}], " ", "s"}], "+", 
     RowBox[{"c", " ", "d", " ", 
      RowBox[{"(", 
       RowBox[{"g", "+", "N", "-", 
        RowBox[{"g", " ", "N"}]}], ")"}], " ", "p", " ", 
      SuperscriptBox["x", "*"]}]}], ")"}]}]]], "Output",
 CellChangeTimes->{
  3.91681932997968*^9, {3.9168193708872013`*^9, 3.916819377676259*^9}, 
   3.9169242352947397`*^9, 3.9169855635265627`*^9, 3.916991618814695*^9, 
   3.917008708959016*^9, {3.9171696291265182`*^9, 3.917169639164115*^9}, 
   3.9171698452031603`*^9},
 CellLabel->"Out[24]=",ExpressionUUID->"da8cd3e6-23b0-44e2-9992-e36407a2862f"]
}, Open  ]],

Cell["\<\
Note that the closed model analysis is the same as this open one, since \
relatedness (r*) drops out of all of the equations obtained by setting the \
selection differentials (margopenx, margopeny, margopenz) to zero.\
\>", "Text",
 CellChangeTimes->{{3.915176441285725*^9, 3.915176587713168*^9}, {
  3.915177463317815*^9, 3.9151774714126167`*^9}, {3.915201893168091*^9, 
  3.915201894284738*^9}, {3.915202007544639*^9, 3.9152020082622538`*^9}, {
  3.916995439095326*^9, 3.91699545870647*^9}, {3.9171698773127813`*^9, 
  3.917169945385906*^9}},ExpressionUUID->"92d4765b-5a60-47c4-bae9-\
bdd20646c8da"]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
Model M) Signalling; migration before population regulation; signal response \
and dishonesty can evolve\
\>", "Section",
 CellChangeTimes->{{3.915174600364295*^9, 3.91517462569272*^9}, 
   3.91517466765668*^9, {3.915175186685773*^9, 3.915175197207159*^9}, {
   3.91517755046989*^9, 3.9151775509280024`*^9}, {3.915184515366377*^9, 
   3.915184552979945*^9}, {3.916923876040818*^9, 3.9169239091422167`*^9}, {
   3.916926135487589*^9, 3.916926139267849*^9}, {3.916995714185733*^9, 
   3.9169957194255953`*^9}, {3.917168006341456*^9, 3.917168009935837*^9}, 
   3.943003509587964*^9},ExpressionUUID->"b6ebd33b-1ca5-453f-bd09-\
41f0e66e202f"],

Cell["\<\
Neighbour-modulated fitness for the focal individual (w) is written below. \
This is given by Equations L3, L5, L6 & C1 in the SI.\
\>", "Text",
 CellChangeTimes->{{3.9151752377757063`*^9, 3.915175259620417*^9}, {
   3.915175352890313*^9, 3.9151753593515577`*^9}, {3.915201719433642*^9, 
   3.915201720074353*^9}, 3.9169239389872704`*^9, {3.916995799978519*^9, 
   3.916995804315872*^9}, {3.9171689176628027`*^9, 3.91716893310305*^9}, {
   3.9171700012256327`*^9, 3.917170030696865*^9}, {3.9430036640743837`*^9, 
   3.94300366628773*^9}},ExpressionUUID->"41eb204a-abc1-4ef2-8090-\
823f031e2b81"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ffocal", " ", "=", " ", 
   RowBox[{"1", "-", 
    RowBox[{"p", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        FractionBox["1", "N"], 
        RowBox[{"(", 
         RowBox[{"d", "+", 
          RowBox[{"c", " ", "xfocal"}]}], ")"}]}], "+", 
       RowBox[{
        FractionBox[
         RowBox[{"N", "-", "1"}], "N"], 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"d", 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"xothers", " ", "yfocal"}]}], ")"}]}], "+", 
          RowBox[{"c", " ", "xfocal", 
           RowBox[{"(", 
            RowBox[{"1", "-", "g"}], ")"}]}], "+", 
          RowBox[{"s", " ", "xothers", " ", "yfocal"}]}], ")"}]}]}], ")"}]}], 
    "-", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "-", "p"}], ")"}], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        FractionBox["1", "N"], 
        RowBox[{"(", 
         RowBox[{"c", " ", "xfocal", " ", "zfocal"}], ")"}]}], "+", 
       RowBox[{
        FractionBox[
         RowBox[{"N", "-", "1"}], "N"], 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"c", " ", "xfocal", " ", "zfocal", 
           RowBox[{"(", 
            RowBox[{"1", "-", "g"}], ")"}]}], "+", 
          RowBox[{"s", " ", "xothers", " ", "yfocal", " ", "zothers"}]}], 
         ")"}]}]}], ")"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"xdeme", "=", 
   RowBox[{
    RowBox[{
     FractionBox["1", "N"], "xfocal"}], "+", 
    RowBox[{
     FractionBox[
      RowBox[{"N", "-", "1"}], "N"], "xothers"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ydeme", "=", 
   RowBox[{
    RowBox[{
     FractionBox["1", "N"], "yfocal"}], "+", 
    RowBox[{
     FractionBox[
      RowBox[{"N", "-", "1"}], "N"], "yothers"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"zdeme", "=", 
   RowBox[{
    RowBox[{
     FractionBox["1", "N"], "zfocal"}], "+", 
    RowBox[{
     FractionBox[
      RowBox[{"N", "-", "1"}], "N"], "zothers"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fdeme", " ", "=", " ", 
   RowBox[{"1", "-", 
    RowBox[{"p", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        FractionBox["1", "N"], 
        RowBox[{"(", 
         RowBox[{"d", "+", 
          RowBox[{"c", " ", "xdeme"}]}], ")"}]}], "+", 
       RowBox[{
        FractionBox[
         RowBox[{"N", "-", "1"}], "N"], 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"d", 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"xdeme", " ", "ydeme"}]}], ")"}]}], "+", 
          RowBox[{"c", " ", "xdeme", 
           RowBox[{"(", 
            RowBox[{"1", "-", "g"}], ")"}]}], "+", 
          RowBox[{"s", " ", "xdeme", " ", "ydeme"}]}], ")"}]}]}], ")"}]}], 
    "-", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "-", "p"}], ")"}], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        FractionBox["1", "N"], 
        RowBox[{"(", 
         RowBox[{"c", " ", "xdeme", " ", "zdeme"}], ")"}]}], "+", 
       RowBox[{
        FractionBox[
         RowBox[{"N", "-", "1"}], "N"], 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"c", " ", "xdeme", " ", "zdeme", 
           RowBox[{"(", 
            RowBox[{"1", "-", "g"}], ")"}]}], "+", 
          RowBox[{"s", " ", "xdeme", " ", "ydeme", " ", "zdeme"}]}], 
         ")"}]}]}], ")"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fpop", " ", "=", " ", 
   RowBox[{"1", "-", 
    RowBox[{"p", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        FractionBox["1", "N"], 
        RowBox[{"(", 
         RowBox[{"d", "+", 
          RowBox[{"c", " ", "xpop"}]}], ")"}]}], "+", 
       RowBox[{
        FractionBox[
         RowBox[{"N", "-", "1"}], "N"], 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"d", 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"xpop", " ", "ypop"}]}], ")"}]}], "+", 
          RowBox[{"c", " ", "xpop", 
           RowBox[{"(", 
            RowBox[{"1", "-", "g"}], ")"}]}], "+", 
          RowBox[{"s", " ", "xpop", " ", "ypop"}]}], ")"}]}]}], ")"}]}], "-", 
    
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "-", "p"}], ")"}], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        FractionBox["1", "N"], 
        RowBox[{"(", 
         RowBox[{"c", " ", "xpop", " ", "zpop"}], ")"}]}], "+", 
       RowBox[{
        FractionBox[
         RowBox[{"N", "-", "1"}], "N"], 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"c", " ", "xpop", " ", "zpop", 
           RowBox[{"(", 
            RowBox[{"1", "-", "g"}], ")"}]}], "+", 
          RowBox[{"s", " ", "xpop", " ", "ypop", " ", "zpop"}]}], ")"}]}]}], 
      ")"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"w", "=", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", "m"}], ")"}], 
      FractionBox["ffocal", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", "m"}], ")"}], "fdeme"}], "+", 
        RowBox[{"m", " ", "fpop"}]}]]}], "+", 
     RowBox[{"m", " ", 
      FractionBox["ffocal", "fpop"]}]}], " ", "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.908103877779798*^9, 3.9081039368551617`*^9}, {
   3.9082687020329027`*^9, 3.908268859066394*^9}, {3.908269883914235*^9, 
   3.908269920730289*^9}, {3.908355862871335*^9, 3.908355902589114*^9}, {
   3.9108604899938927`*^9, 3.910860560580213*^9}, {3.9113770175862293`*^9, 
   3.911377066649146*^9}, {3.911391018117175*^9, 3.911391056891016*^9}, 
   3.915175265985262*^9, {3.915177560180121*^9, 3.9151775756131973`*^9}, {
   3.916477684098556*^9, 3.9164779154054203`*^9}, {3.916477958436911*^9, 
   3.916477985459425*^9}, {3.916478030965603*^9, 3.916478110056409*^9}, {
   3.916481286064456*^9, 3.9164813699923067`*^9}, {3.91648140307764*^9, 
   3.916481407874761*^9}, {3.916481619186276*^9, 3.916481623322246*^9}, {
   3.916481680406053*^9, 3.916481737519289*^9}, {3.916481914634831*^9, 
   3.916481918918346*^9}, {3.916923969477807*^9, 3.9169239903443813`*^9}, 
   3.9169244507737093`*^9, {3.916995820026519*^9, 3.916995872136689*^9}, {
   3.916995930730976*^9, 3.9169959985089684`*^9}, 3.921217018559334*^9},
 CellLabel->"In[37]:=",ExpressionUUID->"2a4fb119-634d-42e6-ada1-22d7b7884096"],

Cell["\<\
The derivative of focal individual fitness, with respect to the focal \
individual\[CloseCurlyQuote]s investment in signalling,  evaluated at \
monomorphic equilibrium, is written below as -cmx. This is Equation M1 in the \
SI. The derivative of focal individual fitness, with respect to the focal \
individual\[CloseCurlyQuote]s level of signal-response,  evaluated at \
monomorphic equilibrium, is written below as -cmy. This is Equation M2  in \
the SI. The derivative of focal individual fitness, with respect to the focal \
individual\[CloseCurlyQuote]s level of dishonesty,  evaluated at monomorphic \
equilibrium, is written below as -cmz. This is Equation M3 in the SI. Note \
that the \[OpenCurlyQuote]cm\[CloseCurlyQuote] notation is used to represent \
the \[OpenCurlyQuote]marginal cost\[CloseCurlyQuote] of Hamilton\
\[CloseCurlyQuote]s Rule. \
\>", "Text",
 CellChangeTimes->{{3.915175733249536*^9, 3.915175737026534*^9}, {
  3.915175857656424*^9, 3.915175883915668*^9}, {3.915201785175893*^9, 
  3.915201785787332*^9}, {3.9169243383213587`*^9, 3.916924540689454*^9}, {
  3.917170050440551*^9, 3.917170100424304*^9}, {3.943003688718741*^9, 
  3.943003696199078*^9}},ExpressionUUID->"6061d38e-9f3e-478f-afab-\
95501fdd65c9"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"cmx", "=", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{"D", "[", 
       RowBox[{"w", ",", "xfocal"}], "]"}]}], "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"xfocal", "->", 
        SuperscriptBox["x", "*"]}], ",", 
       RowBox[{"xothers", "->", 
        SuperscriptBox["x", "*"]}], ",", 
       RowBox[{"xpop", "->", 
        SuperscriptBox["x", "*"]}], ",", 
       RowBox[{"yfocal", "->", 
        SuperscriptBox["y", "*"]}], ",", 
       RowBox[{"yothers", "->", 
        SuperscriptBox["y", "*"]}], ",", 
       RowBox[{"ypop", "->", 
        SuperscriptBox["y", "*"]}], ",", 
       RowBox[{"zfocal", "->", 
        SuperscriptBox["z", "*"]}], ",", 
       RowBox[{"zothers", "->", 
        SuperscriptBox["z", "*"]}], ",", 
       RowBox[{"zpop", "->", 
        SuperscriptBox["z", "*"]}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"TraditionalForm", "[", 
  RowBox[{"-", "cmx"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cmy", "=", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{"D", "[", 
       RowBox[{"w", ",", "yfocal"}], "]"}]}], "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"xfocal", "->", 
        SuperscriptBox["x", "*"]}], ",", 
       RowBox[{"xothers", "->", 
        SuperscriptBox["x", "*"]}], ",", 
       RowBox[{"xpop", "->", 
        SuperscriptBox["x", "*"]}], ",", 
       RowBox[{"yfocal", "->", 
        SuperscriptBox["y", "*"]}], ",", 
       RowBox[{"yothers", "->", 
        SuperscriptBox["y", "*"]}], ",", 
       RowBox[{"ypop", "->", 
        SuperscriptBox["y", "*"]}], ",", 
       RowBox[{"zfocal", "->", 
        SuperscriptBox["z", "*"]}], ",", 
       RowBox[{"zothers", "->", 
        SuperscriptBox["z", "*"]}], ",", 
       RowBox[{"zpop", "->", 
        SuperscriptBox["z", "*"]}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"TraditionalForm", "[", 
  RowBox[{"-", "cmy"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cmz", "=", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{"D", "[", 
       RowBox[{"w", ",", "zfocal"}], "]"}]}], "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"xfocal", "->", 
        SuperscriptBox["x", "*"]}], ",", 
       RowBox[{"xothers", "->", 
        SuperscriptBox["x", "*"]}], ",", 
       RowBox[{"xpop", "->", 
        SuperscriptBox["x", "*"]}], ",", 
       RowBox[{"yfocal", "->", 
        SuperscriptBox["y", "*"]}], ",", 
       RowBox[{"yothers", "->", 
        SuperscriptBox["y", "*"]}], ",", 
       RowBox[{"ypop", "->", 
        SuperscriptBox["y", "*"]}], ",", 
       RowBox[{"zfocal", "->", 
        SuperscriptBox["z", "*"]}], ",", 
       RowBox[{"zothers", "->", 
        SuperscriptBox["z", "*"]}], ",", 
       RowBox[{"zpop", "->", 
        SuperscriptBox["z", "*"]}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"TraditionalForm", "[", 
  RowBox[{"-", "cmz"}], "]"}]}], "Input",
 CellChangeTimes->{{3.915177161684618*^9, 3.9151771773356667`*^9}, {
   3.916481483253688*^9, 3.916481552430945*^9}, {3.91648160244484*^9, 
   3.9164816118925*^9}, {3.916481759966824*^9, 3.916481788106379*^9}, 
   3.916481934096526*^9, {3.9164822989840403`*^9, 3.9164823223519583`*^9}, {
   3.916482356877144*^9, 3.916482367589439*^9}, {3.916897535989539*^9, 
   3.9168975825045357`*^9}, {3.916897664196308*^9, 3.916897685271616*^9}, {
   3.916924011307473*^9, 3.916924066960389*^9}, {3.918198273756646*^9, 
   3.918198276209237*^9}},
 CellLabel->"In[44]:=",ExpressionUUID->"7644ce82-8180-466f-8a3c-0b55c7d17920"],

Cell[BoxData[
 FormBox[
  RowBox[{"-", 
   FractionBox[
    RowBox[{
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"m", "-", "1"}], ")"}], "2"], " ", 
      RowBox[{"(", 
       RowBox[{"N", "-", "1"}], ")"}], " ", 
      SuperscriptBox["y", "*"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"p", " ", 
         RowBox[{"(", 
          RowBox[{"d", "-", "s"}], ")"}]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"p", "-", "1"}], ")"}], " ", "s", " ", 
         SuperscriptBox["z", "*"]}]}], ")"}]}], "-", 
     RowBox[{"c", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"g", " ", 
         RowBox[{"(", 
          RowBox[{"N", "-", "1"}], ")"}]}], "-", "N"}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"m", "-", "1"}], ")"}], "2"], "-", "N"}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"p", "-", "1"}], ")"}], " ", 
         SuperscriptBox["z", "*"]}], "-", "p"}], ")"}]}]}], 
    RowBox[{"N", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        SuperscriptBox["x", "*"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"N", "-", "1"}], ")"}], " ", 
           SuperscriptBox["y", "*"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"p", " ", 
              RowBox[{"(", 
               RowBox[{"d", "-", "s"}], ")"}]}], "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"p", "-", "1"}], ")"}], " ", "s", " ", 
              SuperscriptBox["z", "*"]}]}], ")"}]}], "-", 
          RowBox[{"c", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"g", "-", "1"}], ")"}], " ", "N"}], "-", "g"}], ")"}], 
           " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"p", "-", "1"}], ")"}], " ", 
              SuperscriptBox["z", "*"]}], "-", "p"}], ")"}]}]}], ")"}]}], "-", 
       RowBox[{"d", " ", "N", " ", "p"}], "+", "N"}], ")"}]}]]}], 
  TraditionalForm]], "Output",
 CellChangeTimes->{{3.915175743038382*^9, 3.915175768128035*^9}, 
   3.915175936434854*^9, 3.915177190897686*^9, 3.915177506724401*^9, 
   3.91517759649308*^9, 3.915185308457467*^9, 3.9151854454804688`*^9, 
   3.9152057318463173`*^9, 3.916481442342709*^9, {3.9164815393717117`*^9, 
   3.916481552674883*^9}, {3.916481586104621*^9, 3.9164816546079397`*^9}, {
   3.9164817755564833`*^9, 3.916481808975319*^9}, {3.9164819310673447`*^9, 
   3.9164819343561277`*^9}, 3.9164821102923717`*^9, 3.916482441344426*^9, 
   3.91681723672745*^9, 3.916897391167815*^9, {3.91689755154731*^9, 
   3.916897582715363*^9}, {3.916897667376539*^9, 3.916897685486547*^9}, 
   3.916924190750946*^9, 3.916996116523508*^9, 3.917008740797999*^9, 
   3.9170087831838417`*^9, 3.9170852426604013`*^9, 3.9170876997934732`*^9, 
   3.9171701290389*^9, 3.918198288480152*^9, 3.9212170579757338`*^9, 
   3.921231357994995*^9, 3.9213018917720613`*^9, 3.9215789932277813`*^9, 
   3.922170432908877*^9, 3.922177957821632*^9},
 CellLabel->
  "Out[45]//TraditionalForm=",ExpressionUUID->"ed249a36-db34-4eba-8c2f-\
f8d652f661e5"],

Cell[BoxData[
 FormBox[
  RowBox[{"-", 
   FractionBox[
    RowBox[{
     RowBox[{"(", 
      RowBox[{"N", "-", "1"}], ")"}], " ", 
     SuperscriptBox["x", "*"], " ", 
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"m", "-", "1"}], ")"}], "2"], "-", "N"}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"p", " ", 
        RowBox[{"(", 
         RowBox[{"d", "-", "s"}], ")"}]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"p", "-", "1"}], ")"}], " ", "s", " ", 
        SuperscriptBox["z", "*"]}]}], ")"}]}], 
    RowBox[{"N", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        SuperscriptBox["x", "*"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"N", "-", "1"}], ")"}], " ", 
           SuperscriptBox["y", "*"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"p", " ", 
              RowBox[{"(", 
               RowBox[{"d", "-", "s"}], ")"}]}], "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"p", "-", "1"}], ")"}], " ", "s", " ", 
              SuperscriptBox["z", "*"]}]}], ")"}]}], "-", 
          RowBox[{"c", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"g", "-", "1"}], ")"}], " ", "N"}], "-", "g"}], ")"}], 
           " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"p", "-", "1"}], ")"}], " ", 
              SuperscriptBox["z", "*"]}], "-", "p"}], ")"}]}]}], ")"}]}], "-", 
       RowBox[{"d", " ", "N", " ", "p"}], "+", "N"}], ")"}]}]]}], 
  TraditionalForm]], "Output",
 CellChangeTimes->{{3.915175743038382*^9, 3.915175768128035*^9}, 
   3.915175936434854*^9, 3.915177190897686*^9, 3.915177506724401*^9, 
   3.91517759649308*^9, 3.915185308457467*^9, 3.9151854454804688`*^9, 
   3.9152057318463173`*^9, 3.916481442342709*^9, {3.9164815393717117`*^9, 
   3.916481552674883*^9}, {3.916481586104621*^9, 3.9164816546079397`*^9}, {
   3.9164817755564833`*^9, 3.916481808975319*^9}, {3.9164819310673447`*^9, 
   3.9164819343561277`*^9}, 3.9164821102923717`*^9, 3.916482441344426*^9, 
   3.91681723672745*^9, 3.916897391167815*^9, {3.91689755154731*^9, 
   3.916897582715363*^9}, {3.916897667376539*^9, 3.916897685486547*^9}, 
   3.916924190750946*^9, 3.916996116523508*^9, 3.917008740797999*^9, 
   3.9170087831838417`*^9, 3.9170852426604013`*^9, 3.9170876997934732`*^9, 
   3.9171701290389*^9, 3.918198288480152*^9, 3.9212170579757338`*^9, 
   3.921231357994995*^9, 3.9213018917720613`*^9, 3.9215789932277813`*^9, 
   3.922170432908877*^9, 3.92217795790809*^9},
 CellLabel->
  "Out[47]//TraditionalForm=",ExpressionUUID->"4380cb98-ec9c-4083-b353-\
0d1aceeb5b12"],

Cell[BoxData[
 FormBox[
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{"p", "-", "1"}], ")"}], " ", 
    SuperscriptBox["x", "*"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"m", "-", "1"}], ")"}], "2"], " ", 
       RowBox[{"(", 
        RowBox[{"N", "-", "1"}], ")"}], " ", "s", " ", 
       SuperscriptBox["y", "*"]}], "-", 
      RowBox[{"c", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"g", " ", 
          RowBox[{"(", 
           RowBox[{"N", "-", "1"}], ")"}]}], "-", "N"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"m", "-", "1"}], ")"}], "2"], "-", "N"}], ")"}]}]}], 
     ")"}]}], 
   RowBox[{"N", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SuperscriptBox["x", "*"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"c", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"g", "-", "1"}], ")"}], " ", "N"}], "-", "g"}], ")"}], 
          " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"p", "-", "1"}], ")"}], " ", 
             SuperscriptBox["z", "*"]}], "-", "p"}], ")"}]}], "-", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"N", "-", "1"}], ")"}], " ", 
          SuperscriptBox["y", "*"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"p", " ", 
             RowBox[{"(", 
              RowBox[{"d", "-", "s"}], ")"}]}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"p", "-", "1"}], ")"}], " ", "s", " ", 
             SuperscriptBox["z", "*"]}]}], ")"}]}]}], ")"}]}], "+", 
      RowBox[{"N", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"d", " ", "p"}], "-", "1"}], ")"}]}]}], ")"}]}]], 
  TraditionalForm]], "Output",
 CellChangeTimes->{{3.915175743038382*^9, 3.915175768128035*^9}, 
   3.915175936434854*^9, 3.915177190897686*^9, 3.915177506724401*^9, 
   3.91517759649308*^9, 3.915185308457467*^9, 3.9151854454804688`*^9, 
   3.9152057318463173`*^9, 3.916481442342709*^9, {3.9164815393717117`*^9, 
   3.916481552674883*^9}, {3.916481586104621*^9, 3.9164816546079397`*^9}, {
   3.9164817755564833`*^9, 3.916481808975319*^9}, {3.9164819310673447`*^9, 
   3.9164819343561277`*^9}, 3.9164821102923717`*^9, 3.916482441344426*^9, 
   3.91681723672745*^9, 3.916897391167815*^9, {3.91689755154731*^9, 
   3.916897582715363*^9}, {3.916897667376539*^9, 3.916897685486547*^9}, 
   3.916924190750946*^9, 3.916996116523508*^9, 3.917008740797999*^9, 
   3.9170087831838417`*^9, 3.9170852426604013`*^9, 3.9170876997934732`*^9, 
   3.9171701290389*^9, 3.918198288480152*^9, 3.9212170579757338`*^9, 
   3.921231357994995*^9, 3.9213018917720613`*^9, 3.9215789932277813`*^9, 
   3.922170432908877*^9, 3.922177958240465*^9},
 CellLabel->
  "Out[49]//TraditionalForm=",ExpressionUUID->"d0a9d745-0a5a-45ea-8bc0-\
8b5f6f355ec5"]
}, Open  ]],

Cell["\<\
The derivative of focal individual fitness, with respect to the average \
signal investment of other individuals on the deme, evaluated at monomorphic \
equilibrium, is written below as bmx. This is Equation M4 in the SI. The \
derivative of focal individual fitness, with respect to the average \
signal-response level of other individuals on the deme, evaluated at \
monomorphic equilibrium, is written below as bmy. This is Equation M5 in the \
SI. The derivative of focal individual fitness, with respect to the average \
signal dishonesty level of other individuals on the deme, evaluated at \
monomorphic equilibrium, is written below as bmz. This is Equation M6 in the \
SI. Note that the \[OpenCurlyQuote]bm\[CloseCurlyQuote] notation is used to \
represent the \[OpenCurlyQuote]marginal benefit\[CloseCurlyQuote] of Hamilton\
\[CloseCurlyQuote]s Rule. \
\>", "Text",
 CellChangeTimes->{{3.915175418488715*^9, 3.915175518937564*^9}, 
   3.915175722238924*^9, {3.915175920186359*^9, 3.915175930914809*^9}, {
   3.915201863902808*^9, 3.9152018640063953`*^9}, {3.916924737050666*^9, 
   3.916924834839422*^9}, {3.917170160152258*^9, 3.9171701855657063`*^9}, {
   3.94300370055121*^9, 
   3.943003707506816*^9}},ExpressionUUID->"26feaadb-42c4-4ba1-a5b8-\
9055876ffc4c"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"TraditionalForm", "[", 
  RowBox[{"bmx", "=", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{"w", ",", "xothers"}], "]"}], "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"xfocal", "->", 
        SuperscriptBox["x", "*"]}], ",", 
       RowBox[{"xothers", "->", 
        SuperscriptBox["x", "*"]}], ",", 
       RowBox[{"xpop", "->", 
        SuperscriptBox["x", "*"]}], ",", 
       RowBox[{"yfocal", "->", 
        SuperscriptBox["y", "*"]}], ",", 
       RowBox[{"yothers", "->", 
        SuperscriptBox["y", "*"]}], ",", 
       RowBox[{"ypop", "->", 
        SuperscriptBox["y", "*"]}], ",", 
       RowBox[{"zfocal", "->", 
        SuperscriptBox["z", "*"]}], ",", 
       RowBox[{"zothers", "->", 
        SuperscriptBox["z", "*"]}], ",", 
       RowBox[{"zpop", "->", 
        SuperscriptBox["z", "*"]}]}], "}"}]}], "]"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"TraditionalForm", "[", 
  RowBox[{"bmy", "=", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{"w", ",", "yothers"}], "]"}], "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"xfocal", "->", 
        SuperscriptBox["x", "*"]}], ",", 
       RowBox[{"xothers", "->", 
        SuperscriptBox["x", "*"]}], ",", 
       RowBox[{"xpop", "->", 
        SuperscriptBox["x", "*"]}], ",", 
       RowBox[{"yfocal", "->", 
        SuperscriptBox["y", "*"]}], ",", 
       RowBox[{"yothers", "->", 
        SuperscriptBox["y", "*"]}], ",", 
       RowBox[{"ypop", "->", 
        SuperscriptBox["y", "*"]}], ",", 
       RowBox[{"zfocal", "->", 
        SuperscriptBox["z", "*"]}], ",", 
       RowBox[{"zothers", "->", 
        SuperscriptBox["z", "*"]}], ",", 
       RowBox[{"zpop", "->", 
        SuperscriptBox["z", "*"]}]}], "}"}]}], "]"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"TraditionalForm", "[", 
  RowBox[{"bmz", "=", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{"w", ",", "zothers"}], "]"}], "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"xfocal", "->", 
        SuperscriptBox["x", "*"]}], ",", 
       RowBox[{"xothers", "->", 
        SuperscriptBox["x", "*"]}], ",", 
       RowBox[{"xpop", "->", 
        SuperscriptBox["x", "*"]}], ",", 
       RowBox[{"yfocal", "->", 
        SuperscriptBox["y", "*"]}], ",", 
       RowBox[{"yothers", "->", 
        SuperscriptBox["y", "*"]}], ",", 
       RowBox[{"ypop", "->", 
        SuperscriptBox["y", "*"]}], ",", 
       RowBox[{"zfocal", "->", 
        SuperscriptBox["z", "*"]}], ",", 
       RowBox[{"zothers", "->", 
        SuperscriptBox["z", "*"]}], ",", 
       RowBox[{"zpop", "->", 
        SuperscriptBox["z", "*"]}]}], "}"}]}], "]"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.9081039414213743`*^9, 3.9081039435052147`*^9}, {
   3.90810406510456*^9, 3.908104073589612*^9}, {3.9081043026353397`*^9, 
   3.9081043339158287`*^9}, 3.908106925554028*^9, {3.911391003528234*^9, 
   3.9113910075287848`*^9}, {3.9115423725276537`*^9, 3.911542390599454*^9}, {
   3.915175399934017*^9, 3.915175400756152*^9}, 3.915175723845454*^9, {
   3.915177193413665*^9, 3.9151771935552893`*^9}, {3.9164819598739023`*^9, 
   3.916481970547638*^9}, 3.91648230585422*^9, {3.916482371868814*^9, 
   3.916482381088786*^9}, {3.916924211383026*^9, 3.916924219763884*^9}},
 CellLabel->"In[50]:=",ExpressionUUID->"701e2b4a-563e-4289-91c9-9f9b2e1e0961"],

Cell[BoxData[
 FormBox[
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{"N", "-", "1"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"c", " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"m", "-", "1"}], ")"}], "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"g", " ", 
          RowBox[{"(", 
           RowBox[{"N", "-", "1"}], ")"}]}], "-", "N"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"p", "-", "1"}], ")"}], " ", 
          SuperscriptBox["z", "*"]}], "-", "p"}], ")"}]}], "-", 
      RowBox[{
       SuperscriptBox["y", "*"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"m", "-", "2"}], ")"}], " ", "m", " ", 
          RowBox[{"(", 
           RowBox[{"N", "-", "1"}], ")"}]}], "-", "1"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"p", " ", 
          RowBox[{"(", 
           RowBox[{"d", "-", "s"}], ")"}]}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"p", "-", "1"}], ")"}], " ", "s", " ", 
          SuperscriptBox["z", "*"]}]}], ")"}]}]}], ")"}]}], 
   RowBox[{"N", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SuperscriptBox["x", "*"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"N", "-", "1"}], ")"}], " ", 
          SuperscriptBox["y", "*"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"p", " ", 
             RowBox[{"(", 
              RowBox[{"d", "-", "s"}], ")"}]}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"p", "-", "1"}], ")"}], " ", "s", " ", 
             SuperscriptBox["z", "*"]}]}], ")"}]}], "-", 
         RowBox[{"c", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"g", "-", "1"}], ")"}], " ", "N"}], "-", "g"}], ")"}], 
          " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"p", "-", "1"}], ")"}], " ", 
             SuperscriptBox["z", "*"]}], "-", "p"}], ")"}]}]}], ")"}]}], "-", 
      
      RowBox[{"d", " ", "N", " ", "p"}], "+", "N"}], ")"}]}]], 
  TraditionalForm]], "Output",
 CellChangeTimes->{{3.908104066438794*^9, 3.908104073995747*^9}, {
   3.908104334637701*^9, 3.908104339447672*^9}, 3.908104424387844*^9, 
   3.90810793331876*^9, 3.908268880209581*^9, 3.9083559231030807`*^9, 
   3.9108605734536858`*^9, 3.911376842118787*^9, 3.911377086620686*^9, 
   3.9113911571237173`*^9, 3.911471811646303*^9, 3.911542455073489*^9, 
   3.9115545156811333`*^9, 3.911555059549644*^9, 3.915175584540079*^9, 
   3.915175770181059*^9, {3.915175934655409*^9, 3.915175941825774*^9}, 
   3.915177194903661*^9, 3.915177508380785*^9, 3.915177613264398*^9, 
   3.9151854491434717`*^9, 3.915205736861938*^9, 3.91648197268186*^9, 
   3.916482112689074*^9, 3.916482454211854*^9, 3.916817238961383*^9, 
   3.916897399110004*^9, 3.916924221003422*^9, 3.916996126203195*^9, 
   3.917008741079323*^9, 3.91700878623107*^9, 3.9170852429402237`*^9, 
   3.917087700035041*^9, 3.917170129796028*^9, 3.921217058985626*^9, 
   3.921231358251195*^9, 3.921301891984103*^9, 3.921578993341538*^9, 
   3.92217043311016*^9, 3.92217795879657*^9},
 CellLabel->
  "Out[50]//TraditionalForm=",ExpressionUUID->"f5400d9f-2c88-44dd-99b2-\
937efa2fd472"],

Cell[BoxData[
 FormBox[
  RowBox[{"-", 
   FractionBox[
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"m", "-", "1"}], ")"}], "2"], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"N", "-", "1"}], ")"}], "2"], " ", 
     SuperscriptBox["x", "*"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"p", " ", 
        RowBox[{"(", 
         RowBox[{"d", "-", "s"}], ")"}]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"p", "-", "1"}], ")"}], " ", "s", " ", 
        SuperscriptBox["z", "*"]}]}], ")"}]}], 
    RowBox[{"N", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        SuperscriptBox["x", "*"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"N", "-", "1"}], ")"}], " ", 
           SuperscriptBox["y", "*"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"p", " ", 
              RowBox[{"(", 
               RowBox[{"d", "-", "s"}], ")"}]}], "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"p", "-", "1"}], ")"}], " ", "s", " ", 
              SuperscriptBox["z", "*"]}]}], ")"}]}], "-", 
          RowBox[{"c", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"g", "-", "1"}], ")"}], " ", "N"}], "-", "g"}], ")"}], 
           " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"p", "-", "1"}], ")"}], " ", 
              SuperscriptBox["z", "*"]}], "-", "p"}], ")"}]}]}], ")"}]}], "-", 
       RowBox[{"d", " ", "N", " ", "p"}], "+", "N"}], ")"}]}]]}], 
  TraditionalForm]], "Output",
 CellChangeTimes->{{3.908104066438794*^9, 3.908104073995747*^9}, {
   3.908104334637701*^9, 3.908104339447672*^9}, 3.908104424387844*^9, 
   3.90810793331876*^9, 3.908268880209581*^9, 3.9083559231030807`*^9, 
   3.9108605734536858`*^9, 3.911376842118787*^9, 3.911377086620686*^9, 
   3.9113911571237173`*^9, 3.911471811646303*^9, 3.911542455073489*^9, 
   3.9115545156811333`*^9, 3.911555059549644*^9, 3.915175584540079*^9, 
   3.915175770181059*^9, {3.915175934655409*^9, 3.915175941825774*^9}, 
   3.915177194903661*^9, 3.915177508380785*^9, 3.915177613264398*^9, 
   3.9151854491434717`*^9, 3.915205736861938*^9, 3.91648197268186*^9, 
   3.916482112689074*^9, 3.916482454211854*^9, 3.916817238961383*^9, 
   3.916897399110004*^9, 3.916924221003422*^9, 3.916996126203195*^9, 
   3.917008741079323*^9, 3.91700878623107*^9, 3.9170852429402237`*^9, 
   3.917087700035041*^9, 3.917170129796028*^9, 3.921217058985626*^9, 
   3.921231358251195*^9, 3.921301891984103*^9, 3.921578993341538*^9, 
   3.92217043311016*^9, 3.9221779588833017`*^9},
 CellLabel->
  "Out[51]//TraditionalForm=",ExpressionUUID->"7fe0caba-0e10-4ded-86a0-\
0c1c9dac51c0"],

Cell[BoxData[
 FormBox[
  RowBox[{"-", 
   FractionBox[
    RowBox[{
     RowBox[{"(", 
      RowBox[{"N", "-", "1"}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"p", "-", "1"}], ")"}], " ", 
     SuperscriptBox["x", "*"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"c", " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"m", "-", "1"}], ")"}], "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"g", " ", 
           RowBox[{"(", 
            RowBox[{"N", "-", "1"}], ")"}]}], "-", "N"}], ")"}]}], "+", 
       RowBox[{"s", " ", 
        SuperscriptBox["y", "*"], " ", 
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"m", "-", "2"}], ")"}], " ", "m", " ", 
           RowBox[{"(", 
            RowBox[{"N", "-", "1"}], ")"}]}]}], ")"}]}]}], ")"}]}], 
    RowBox[{"N", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        SuperscriptBox["x", "*"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"c", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"g", "-", "1"}], ")"}], " ", "N"}], "-", "g"}], ")"}], 
           " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"p", "-", "1"}], ")"}], " ", 
              SuperscriptBox["z", "*"]}], "-", "p"}], ")"}]}], "-", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"N", "-", "1"}], ")"}], " ", 
           SuperscriptBox["y", "*"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"p", " ", 
              RowBox[{"(", 
               RowBox[{"d", "-", "s"}], ")"}]}], "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"p", "-", "1"}], ")"}], " ", "s", " ", 
              SuperscriptBox["z", "*"]}]}], ")"}]}]}], ")"}]}], "+", 
       RowBox[{"N", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"d", " ", "p"}], "-", "1"}], ")"}]}]}], ")"}]}]]}], 
  TraditionalForm]], "Output",
 CellChangeTimes->{{3.908104066438794*^9, 3.908104073995747*^9}, {
   3.908104334637701*^9, 3.908104339447672*^9}, 3.908104424387844*^9, 
   3.90810793331876*^9, 3.908268880209581*^9, 3.9083559231030807`*^9, 
   3.9108605734536858`*^9, 3.911376842118787*^9, 3.911377086620686*^9, 
   3.9113911571237173`*^9, 3.911471811646303*^9, 3.911542455073489*^9, 
   3.9115545156811333`*^9, 3.911555059549644*^9, 3.915175584540079*^9, 
   3.915175770181059*^9, {3.915175934655409*^9, 3.915175941825774*^9}, 
   3.915177194903661*^9, 3.915177508380785*^9, 3.915177613264398*^9, 
   3.9151854491434717`*^9, 3.915205736861938*^9, 3.91648197268186*^9, 
   3.916482112689074*^9, 3.916482454211854*^9, 3.916817238961383*^9, 
   3.916897399110004*^9, 3.916924221003422*^9, 3.916996126203195*^9, 
   3.917008741079323*^9, 3.91700878623107*^9, 3.9170852429402237`*^9, 
   3.917087700035041*^9, 3.917170129796028*^9, 3.921217058985626*^9, 
   3.921231358251195*^9, 3.921301891984103*^9, 3.921578993341538*^9, 
   3.92217043311016*^9, 3.922177959008904*^9},
 CellLabel->
  "Out[52]//TraditionalForm=",ExpressionUUID->"4b569dae-63c9-474d-b135-\
e4ad821c90c9"]
}, Open  ]],

Cell["\<\
The overall marginal change in neighbour-modulated fitness associated with a \
slight change in signalling investment is written below as margopenx. The \
overall marginal change in neighbour-modulated fitness associated with a \
slight change in signal-response is written below as margopeny. The overall \
marginal change in neighbour-modulated fitness associated with a slight \
change in signal dishonesty is written below as margopenz. The \
\[OpenCurlyQuote]margopen\[CloseCurlyQuote] notation is used to represent the \
marginal fitness change, and the open model setting. \
\>", "Text",
 CellChangeTimes->{{3.915175958153467*^9, 3.915176040877063*^9}, {
   3.915177227882449*^9, 3.9151773535121117`*^9}, {3.9152019626637087`*^9, 
   3.915201962719282*^9}, {3.916924848430903*^9, 3.9169249480354433`*^9}, 
   3.91717022293972*^9},ExpressionUUID->"9a454de3-d58e-408b-801a-\
4867065fda69"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"TraditionalForm", "[", 
  RowBox[{"margopenx", "=", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{
     RowBox[{
      SuperscriptBox["r", "*"], " ", "bmx"}], " ", "-", " ", "cmx"}], "]"}]}],
   "]"}], "\[IndentingNewLine]", 
 RowBox[{"TraditionalForm", "[", 
  RowBox[{"margopeny", "=", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{
     RowBox[{
      SuperscriptBox["r", "*"], " ", "bmy"}], " ", "-", " ", "cmy"}], "]"}]}],
   "]"}], "\[IndentingNewLine]", 
 RowBox[{"TraditionalForm", "[", 
  RowBox[{"margopenz", "=", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{
     RowBox[{
      SuperscriptBox["r", "*"], " ", "bmz"}], " ", "-", " ", "cmz"}], "]"}]}],
   "]"}]}], "Input",
 CellChangeTimes->{{3.9081044477104807`*^9, 3.908104459241107*^9}, {
   3.908104492639288*^9, 3.9081044941536303`*^9}, {3.9081051452016487`*^9, 
   3.90810514887316*^9}, {3.9151758222548037`*^9, 3.9151758368976316`*^9}, {
   3.915177197160902*^9, 3.9151772227977467`*^9}, 3.915177266100378*^9, {
   3.91648233432502*^9, 3.916482342389292*^9}, {3.916482411368557*^9, 
   3.916482421649559*^9}, {3.9170087339618473`*^9, 3.9170087418761663`*^9}},
 CellLabel->"In[53]:=",ExpressionUUID->"4d208711-404e-4bec-88cb-ace1bb82c375"],

Cell[BoxData[
 FormBox[
  FractionBox[
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"N", "-", "1"}], ")"}], " ", 
     SuperscriptBox["r", "*"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"c", " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"m", "-", "1"}], ")"}], "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"g", "-", "1"}], ")"}], " ", "N"}], "-", "g"}], ")"}], 
        " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"p", "-", "1"}], ")"}], " ", 
           SuperscriptBox["z", "*"]}], "-", "p"}], ")"}]}], "-", 
       RowBox[{
        SuperscriptBox["y", "*"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"m", "-", "2"}], ")"}], " ", "m", " ", 
           RowBox[{"(", 
            RowBox[{"N", "-", "1"}], ")"}]}], "-", "1"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"p", " ", 
           RowBox[{"(", 
            RowBox[{"d", "-", "s"}], ")"}]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"p", "-", "1"}], ")"}], " ", "s", " ", 
           SuperscriptBox["z", "*"]}]}], ")"}]}]}], ")"}]}], "+", 
    RowBox[{"c", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"g", "-", "1"}], ")"}], " ", "N"}], "-", "g"}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"m", "-", "1"}], ")"}], "2"], "-", "N"}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"p", "-", "1"}], ")"}], " ", 
        SuperscriptBox["z", "*"]}], "-", "p"}], ")"}]}], "-", 
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"m", "-", "1"}], ")"}], "2"], " ", 
      RowBox[{"(", 
       RowBox[{"N", "-", "1"}], ")"}], " ", 
      SuperscriptBox["y", "*"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"p", " ", 
         RowBox[{"(", 
          RowBox[{"d", "-", "s"}], ")"}]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"p", "-", "1"}], ")"}], " ", "s", " ", 
         SuperscriptBox["z", "*"]}]}], ")"}]}], ")"}]}], 
   RowBox[{"N", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SuperscriptBox["x", "*"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"N", "-", "1"}], ")"}], " ", 
          SuperscriptBox["y", "*"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"p", " ", 
             RowBox[{"(", 
              RowBox[{"d", "-", "s"}], ")"}]}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"p", "-", "1"}], ")"}], " ", "s", " ", 
             SuperscriptBox["z", "*"]}]}], ")"}]}], "-", 
         RowBox[{"c", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"g", "-", "1"}], ")"}], " ", "N"}], "-", "g"}], ")"}], 
          " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"p", "-", "1"}], ")"}], " ", 
             SuperscriptBox["z", "*"]}], "-", "p"}], ")"}]}]}], ")"}]}], "-", 
      
      RowBox[{"d", " ", "N", " ", "p"}], "+", "N"}], ")"}]}]], 
  TraditionalForm]], "Output",
 CellChangeTimes->{
  3.9081044594986353`*^9, 3.908104494901422*^9, 3.908105149718433*^9, 
   3.9081079426689453`*^9, 3.908268887184318*^9, 3.908355930776684*^9, 
   3.910860606912422*^9, 3.911376884182818*^9, 3.9113771335928373`*^9, 
   3.911471977218416*^9, 3.91154771336239*^9, 3.911554641393799*^9, 
   3.9115551823599377`*^9, {3.9151758295380363`*^9, 3.915175837301425*^9}, 
   3.915175945948777*^9, 3.91517605612919*^9, 3.915177202186002*^9, 
   3.915177356595026*^9, 3.9151775111263103`*^9, 3.915177625624977*^9, 
   3.91518566158922*^9, 3.915186018478601*^9, 3.915205738524659*^9, 
   3.9164819989330893`*^9, 3.9164821167929287`*^9, 3.916482535622197*^9, 
   3.916817241448886*^9, 3.916924226240726*^9, 3.916996132270293*^9, 
   3.917008745724008*^9, 3.9170087958062983`*^9, {3.917085243082612*^9, 
   3.9170852465569563`*^9}, 3.917087700201982*^9, 3.917170131887912*^9, 
   3.9212170653958406`*^9, 3.921231358343424*^9, 3.921301892072267*^9, 
   3.921578993436203*^9, 3.922170433193204*^9, 3.9221779608118343`*^9},
 CellLabel->
  "Out[53]//TraditionalForm=",ExpressionUUID->"68f68416-fc64-43a8-b679-\
4a5669b82cf3"],

Cell[BoxData[
 FormBox[
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{"N", "-", "1"}], ")"}], " ", 
    SuperscriptBox["x", "*"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", 
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"m", "-", "1"}], ")"}], "2"], " ", 
         RowBox[{"(", 
          RowBox[{"N", "-", "1"}], ")"}], " ", 
         SuperscriptBox["r", "*"]}], ")"}]}], "-", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"m", "-", "1"}], ")"}], "2"], "+", "N"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"p", " ", 
       RowBox[{"(", 
        RowBox[{"d", "-", "s"}], ")"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"p", "-", "1"}], ")"}], " ", "s", " ", 
       SuperscriptBox["z", "*"]}]}], ")"}]}], 
   RowBox[{"N", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SuperscriptBox["x", "*"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"N", "-", "1"}], ")"}], " ", 
          SuperscriptBox["y", "*"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"p", " ", 
             RowBox[{"(", 
              RowBox[{"d", "-", "s"}], ")"}]}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"p", "-", "1"}], ")"}], " ", "s", " ", 
             SuperscriptBox["z", "*"]}]}], ")"}]}], "-", 
         RowBox[{"c", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"g", "-", "1"}], ")"}], " ", "N"}], "-", "g"}], ")"}], 
          " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"p", "-", "1"}], ")"}], " ", 
             SuperscriptBox["z", "*"]}], "-", "p"}], ")"}]}]}], ")"}]}], "-", 
      
      RowBox[{"d", " ", "N", " ", "p"}], "+", "N"}], ")"}]}]], 
  TraditionalForm]], "Output",
 CellChangeTimes->{
  3.9081044594986353`*^9, 3.908104494901422*^9, 3.908105149718433*^9, 
   3.9081079426689453`*^9, 3.908268887184318*^9, 3.908355930776684*^9, 
   3.910860606912422*^9, 3.911376884182818*^9, 3.9113771335928373`*^9, 
   3.911471977218416*^9, 3.91154771336239*^9, 3.911554641393799*^9, 
   3.9115551823599377`*^9, {3.9151758295380363`*^9, 3.915175837301425*^9}, 
   3.915175945948777*^9, 3.91517605612919*^9, 3.915177202186002*^9, 
   3.915177356595026*^9, 3.9151775111263103`*^9, 3.915177625624977*^9, 
   3.91518566158922*^9, 3.915186018478601*^9, 3.915205738524659*^9, 
   3.9164819989330893`*^9, 3.9164821167929287`*^9, 3.916482535622197*^9, 
   3.916817241448886*^9, 3.916924226240726*^9, 3.916996132270293*^9, 
   3.917008745724008*^9, 3.9170087958062983`*^9, {3.917085243082612*^9, 
   3.9170852465569563`*^9}, 3.917087700201982*^9, 3.917170131887912*^9, 
   3.9212170653958406`*^9, 3.921231358343424*^9, 3.921301892072267*^9, 
   3.921578993436203*^9, 3.922170433193204*^9, 3.9221779609402514`*^9},
 CellLabel->
  "Out[54]//TraditionalForm=",ExpressionUUID->"c5caaae1-6457-4213-95b1-\
b0c56b0cf1b0"],

Cell[BoxData[
 FormBox[
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{"p", "-", "1"}], ")"}], " ", 
    SuperscriptBox["x", "*"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"N", "-", "1"}], ")"}], " ", 
       SuperscriptBox["r", "*"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"s", " ", 
          SuperscriptBox["y", "*"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"m", "-", "2"}], ")"}], " ", "m", " ", 
             RowBox[{"(", 
              RowBox[{"N", "-", "1"}], ")"}]}], "-", "1"}], ")"}]}], "-", 
         RowBox[{"c", " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"m", "-", "1"}], ")"}], "2"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"g", "-", "1"}], ")"}], " ", "N"}], "-", "g"}], 
           ")"}]}]}], ")"}]}], "-", 
      RowBox[{"c", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"g", "-", "1"}], ")"}], " ", "N"}], "-", "g"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"m", "-", "1"}], ")"}], "2"], "-", "N"}], ")"}]}], "+", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"m", "-", "1"}], ")"}], "2"], " ", 
       RowBox[{"(", 
        RowBox[{"N", "-", "1"}], ")"}], " ", "s", " ", 
       SuperscriptBox["y", "*"]}]}], ")"}]}], 
   RowBox[{"N", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SuperscriptBox["x", "*"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"c", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"g", "-", "1"}], ")"}], " ", "N"}], "-", "g"}], ")"}], 
          " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"p", "-", "1"}], ")"}], " ", 
             SuperscriptBox["z", "*"]}], "-", "p"}], ")"}]}], "-", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"N", "-", "1"}], ")"}], " ", 
          SuperscriptBox["y", "*"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"p", " ", 
             RowBox[{"(", 
              RowBox[{"d", "-", "s"}], ")"}]}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"p", "-", "1"}], ")"}], " ", "s", " ", 
             SuperscriptBox["z", "*"]}]}], ")"}]}]}], ")"}]}], "+", 
      RowBox[{"N", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"d", " ", "p"}], "-", "1"}], ")"}]}]}], ")"}]}]], 
  TraditionalForm]], "Output",
 CellChangeTimes->{
  3.9081044594986353`*^9, 3.908104494901422*^9, 3.908105149718433*^9, 
   3.9081079426689453`*^9, 3.908268887184318*^9, 3.908355930776684*^9, 
   3.910860606912422*^9, 3.911376884182818*^9, 3.9113771335928373`*^9, 
   3.911471977218416*^9, 3.91154771336239*^9, 3.911554641393799*^9, 
   3.9115551823599377`*^9, {3.9151758295380363`*^9, 3.915175837301425*^9}, 
   3.915175945948777*^9, 3.91517605612919*^9, 3.915177202186002*^9, 
   3.915177356595026*^9, 3.9151775111263103`*^9, 3.915177625624977*^9, 
   3.91518566158922*^9, 3.915186018478601*^9, 3.915205738524659*^9, 
   3.9164819989330893`*^9, 3.9164821167929287`*^9, 3.916482535622197*^9, 
   3.916817241448886*^9, 3.916924226240726*^9, 3.916996132270293*^9, 
   3.917008745724008*^9, 3.9170087958062983`*^9, {3.917085243082612*^9, 
   3.9170852465569563`*^9}, 3.917087700201982*^9, 3.917170131887912*^9, 
   3.9212170653958406`*^9, 3.921231358343424*^9, 3.921301892072267*^9, 
   3.921578993436203*^9, 3.922170433193204*^9, 3.922177961273389*^9},
 CellLabel->
  "Out[55]//TraditionalForm=",ExpressionUUID->"d651c83c-2aa4-433f-8c8e-\
b6007d909f32"]
}, Open  ]],

Cell[TextData[{
 "We obtain a condition for signal-response being at an ESS by setting \
margopeny to equal zero, to obtain ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SuperscriptBox["z", "*"], "\[Rule]", 
    FractionBox[
     RowBox[{"p", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "d"}], "+", "s"}], ")"}]}], 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "p"}], ")"}], " ", "s"}]]}], 
   TraditionalForm]],
  CellChangeTimes->{3.9168193414187*^9, 3.9168275118005867`*^9, 
   3.916924240351778*^9},ExpressionUUID->
  "c722d4c4-4a07-4e50-aa0d-b0e9f1c6066b"],
 ". Signal-response is at an ESS (y=y*) when this condition is satisfied. \
This is Equation L20 in the SI. Signal-response is favoured when the RHS is \
greater than the LHS."
}], "Text",
 CellChangeTimes->{{3.9171703311710997`*^9, 3.917170343249854*^9}, {
  3.91717040202172*^9, 3.917170413658534*^9}, {3.917170455672781*^9, 
  3.917170456688447*^9}, {3.9221699788107*^9, 3.9221699961607857`*^9}, {
  3.9430037778042183`*^9, 
  3.943003789666223*^9}},ExpressionUUID->"e8c2e3ce-9ce9-4884-b6ea-\
ac58a9283ee5"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TraditionalForm", "[", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{"Solve", "[", 
    RowBox[{
     RowBox[{"margopeny", "==", "0"}], ",", 
     SuperscriptBox["z", "*"]}], "]"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.9221704570894127`*^9, 3.922170478996804*^9}, {
  3.922177944801536*^9, 3.922177948976657*^9}},
 CellLabel->"In[56]:=",ExpressionUUID->"af0c4b2a-8a0a-4854-847d-9a3d80d443b8"],

Cell[BoxData[
 FormBox[
  RowBox[{"{", 
   RowBox[{"{", 
    RowBox[{
     SuperscriptBox["z", "*"], "\[Rule]", 
     FractionBox[
      RowBox[{"p", " ", 
       RowBox[{"(", 
        RowBox[{"s", "-", "d"}], ")"}]}], 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"p", "-", "1"}], ")"}], " ", "s"}]]}], "}"}], "}"}], 
  TraditionalForm]], "Output",
 CellChangeTimes->{
  3.917170371240728*^9, 3.92121708409494*^9, 3.921231441421982*^9, 
   3.921579005776773*^9, 3.922170433328801*^9, {3.922170474879553*^9, 
   3.9221704793344107`*^9}, 3.9221779613422813`*^9},
 CellLabel->
  "Out[56]//TraditionalForm=",ExpressionUUID->"1221e068-114b-4b55-814c-\
e2aead13657d"]
}, Open  ]],

Cell[TextData[{
 "We obtain a condition for signal-response being at an ESS by setting \
margopenz to equal zero, to obtain ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    FractionBox[
     RowBox[{
      RowBox[{"(", 
       RowBox[{"p", "-", "1"}], ")"}], " ", 
      SuperscriptBox["x", "*"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"N", "-", "1"}], ")"}], " ", 
         SuperscriptBox["r", "*"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"c", " ", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"m", "-", "1"}], ")"}], "2"], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"g", "-", "1"}], ")"}], " ", "N"}], "-", "g"}], 
             ")"}]}], "+", 
           RowBox[{"s", " ", 
            SuperscriptBox["y", "*"], " ", 
            RowBox[{"(", 
             RowBox[{"1", "-", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"m", "-", "2"}], ")"}], " ", "m", " ", 
               RowBox[{"(", 
                RowBox[{"N", "-", "1"}], ")"}]}]}], ")"}]}]}], ")"}]}], "+", 
        RowBox[{"c", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"g", "-", "1"}], ")"}], " ", "N"}], "-", "g"}], ")"}], 
         " ", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"m", "-", "1"}], ")"}], "2"], "-", "N"}], ")"}]}], "-", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"m", "-", "1"}], ")"}], "2"], " ", 
          RowBox[{"(", 
           RowBox[{"N", "-", "1"}], ")"}], " ", "s", " ", 
          SuperscriptBox["y", "*"]}], ")"}]}], ")"}]}], 
     RowBox[{"N", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SuperscriptBox["x", "*"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"c", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"g", "-", "1"}], ")"}], " ", "N"}], "-", "g"}], ")"}],
             " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"p", "-", "1"}], ")"}], " ", 
               SuperscriptBox["z", "*"]}], "-", "p"}], ")"}]}], "-", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"N", "-", "1"}], ")"}], " ", 
            SuperscriptBox["y", "*"], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"p", " ", 
               RowBox[{"(", 
                RowBox[{"d", "-", "s"}], ")"}]}], "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"p", "-", "1"}], ")"}], " ", "s", " ", 
               SuperscriptBox["z", "*"]}]}], ")"}]}]}], ")"}]}], "+", 
        RowBox[{"N", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"d", " ", "p"}], "-", "1"}], ")"}]}]}], ")"}]}]], 
    "\[LongEqual]", "0"}], TraditionalForm]],
  CellChangeTimes->{
   3.917170283666946*^9, 3.921217081507296*^9, {3.921221837247192*^9, 
    3.921221871681367*^9}, 3.921229760860495*^9, 3.921231372773685*^9, 
    3.921301892232854*^9, 3.9215736309474773`*^9, 3.921578993604475*^9, 
    3.922170244434433*^9, {3.922170391294161*^9, 3.922170395049076*^9}, {
    3.922170433861299*^9, 3.92217044958895*^9}, 3.92217055802742*^9, 
    3.922170814951397*^9, 3.922177964305434*^9, 3.92217813351295*^9},
  ExpressionUUID->"57bb91fd-8243-4715-9691-d302b3be8bb5"],
 ". Signal-response is favoured when the LHS is greater than the RHS - this \
is Equation M8 in the SI."
}], "Text",
 CellChangeTimes->{{3.917170254432003*^9, 3.917170258567997*^9}, {
  3.9171702954565287`*^9, 3.917170318799673*^9}, {3.92217026824098*^9, 
  3.922170268241102*^9}, {3.922170302904285*^9, 3.922170334518807*^9}, {
  3.922170524359524*^9, 3.9221705557106524`*^9}, {3.922178145240349*^9, 
  3.9221781758792458`*^9}, {3.922178215513129*^9, 3.922178240908701*^9}, {
  3.9430038074346657`*^9, 
  3.9430038074908733`*^9}},ExpressionUUID->"ec472916-8991-4cfd-9480-\
c889a7587422"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TraditionalForm", "[", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{"margopenz", "==", "0"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.921221833716742*^9, 3.921221871453833*^9}, {
  3.9215736272538137`*^9, 3.9215736306842823`*^9}, {3.922170233915104*^9, 
  3.922170241824339*^9}, {3.922170377690117*^9, 3.9221703933199797`*^9}, {
  3.922170438329049*^9, 3.922170449011032*^9}, {3.922170806275071*^9, 
  3.9221708080193357`*^9}, {3.922178132558239*^9, 3.9221781326873407`*^9}},
 CellLabel->"In[63]:=",ExpressionUUID->"f807c18f-1aea-4185-90c3-6023ceb08b07"],

Cell[BoxData[
 FormBox[
  RowBox[{
   FractionBox[
    RowBox[{
     RowBox[{"(", 
      RowBox[{"p", "-", "1"}], ")"}], " ", 
     SuperscriptBox["x", "*"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"N", "-", "1"}], ")"}], " ", 
        SuperscriptBox["r", "*"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"c", " ", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"m", "-", "1"}], ")"}], "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"g", "-", "1"}], ")"}], " ", "N"}], "-", "g"}], 
            ")"}]}], "+", 
          RowBox[{"s", " ", 
           SuperscriptBox["y", "*"], " ", 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"m", "-", "2"}], ")"}], " ", "m", " ", 
              RowBox[{"(", 
               RowBox[{"N", "-", "1"}], ")"}]}]}], ")"}]}]}], ")"}]}], "+", 
       RowBox[{"c", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"g", "-", "1"}], ")"}], " ", "N"}], "-", "g"}], ")"}], 
        " ", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"m", "-", "1"}], ")"}], "2"], "-", "N"}], ")"}]}], "-", 
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"m", "-", "1"}], ")"}], "2"], " ", 
         RowBox[{"(", 
          RowBox[{"N", "-", "1"}], ")"}], " ", "s", " ", 
         SuperscriptBox["y", "*"]}], ")"}]}], ")"}]}], 
    RowBox[{"N", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        SuperscriptBox["x", "*"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"c", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"g", "-", "1"}], ")"}], " ", "N"}], "-", "g"}], ")"}], 
           " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"p", "-", "1"}], ")"}], " ", 
              SuperscriptBox["z", "*"]}], "-", "p"}], ")"}]}], "-", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"N", "-", "1"}], ")"}], " ", 
           SuperscriptBox["y", "*"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"p", " ", 
              RowBox[{"(", 
               RowBox[{"d", "-", "s"}], ")"}]}], "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"p", "-", "1"}], ")"}], " ", "s", " ", 
              SuperscriptBox["z", "*"]}]}], ")"}]}]}], ")"}]}], "+", 
       RowBox[{"N", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"d", " ", "p"}], "-", "1"}], ")"}]}]}], ")"}]}]], 
   "\[LongEqual]", "0"}], TraditionalForm]], "Output",
 CellChangeTimes->{
  3.917170283666946*^9, 3.921217081507296*^9, {3.921221837247192*^9, 
   3.921221871681367*^9}, 3.921229760860495*^9, 3.921231372773685*^9, 
   3.921301892232854*^9, 3.9215736309474773`*^9, 3.921578993604475*^9, 
   3.922170244434433*^9, {3.922170391294161*^9, 3.922170395049076*^9}, {
   3.922170433861299*^9, 3.92217044958895*^9}, 3.92217055802742*^9, 
   3.922170814951397*^9, 3.922177964305434*^9, 3.92217813351295*^9, 
   3.922178325001747*^9},
 CellLabel->
  "Out[63]//TraditionalForm=",ExpressionUUID->"9d8ce422-2a20-40b7-ac03-\
6676e208d000"]
}, Open  ]],

Cell[TextData[{
 "We obtain a condition for signalling being at an ESS by setting margopenx \
to equal zero, to obtain ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SuperscriptBox["r", "*"], "\[Rule]", 
    FractionBox[
     RowBox[{
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"m", "-", "1"}], ")"}], "2"], " ", 
       RowBox[{"(", 
        RowBox[{"N", "-", "1"}], ")"}], " ", 
       SuperscriptBox["y", "*"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"p", " ", 
          RowBox[{"(", 
           RowBox[{"d", "-", "s"}], ")"}]}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"p", "-", "1"}], ")"}], " ", "s", " ", 
          SuperscriptBox["z", "*"]}]}], ")"}]}], "-", 
      RowBox[{"c", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"g", " ", 
          RowBox[{"(", 
           RowBox[{"N", "-", "1"}], ")"}]}], "-", "N"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"m", "-", "1"}], ")"}], "2"], "-", "N"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"p", "-", "1"}], ")"}], " ", 
          SuperscriptBox["z", "*"]}], "-", "p"}], ")"}]}]}], 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"N", "-", "1"}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"c", " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"m", "-", "1"}], ")"}], "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"g", " ", 
            RowBox[{"(", 
             RowBox[{"N", "-", "1"}], ")"}]}], "-", "N"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"p", "-", "1"}], ")"}], " ", 
            SuperscriptBox["z", "*"]}], "-", "p"}], ")"}]}], "-", 
        RowBox[{
         SuperscriptBox["y", "*"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"m", "-", "2"}], ")"}], " ", "m", " ", 
            RowBox[{"(", 
             RowBox[{"N", "-", "1"}], ")"}]}], "-", "1"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"p", " ", 
            RowBox[{"(", 
             RowBox[{"d", "-", "s"}], ")"}]}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"p", "-", "1"}], ")"}], " ", "s", " ", 
            SuperscriptBox["z", "*"]}]}], ")"}]}]}], ")"}]}]]}], 
   TraditionalForm]],
  CellChangeTimes->{3.9168193414187*^9, 3.9168275118005867`*^9, 
   3.916924240351778*^9},ExpressionUUID->
  "d3e5ec75-f596-4faf-97f0-d63c152f10ad"],
 ". Signalling is favoured when the LHS is greater than the RHS - this is \
Equation M9 in the SI."
}], "Text",
 CellChangeTimes->{{3.915176101958577*^9, 3.915176179387744*^9}, {
  3.915176229291583*^9, 3.915176243005365*^9}, {3.915177406063599*^9, 
  3.915177410206997*^9}, {3.915177643831272*^9, 3.915177649866047*^9}, {
  3.916925020263899*^9, 3.91692502865641*^9}, {3.91692516531522*^9, 
  3.916925175033794*^9}, {3.9169252289730663`*^9, 3.916925243873952*^9}, {
  3.916925313939077*^9, 3.916925356059578*^9}, {3.9171704849487*^9, 
  3.917170560603078*^9}, {3.917170633368148*^9, 3.9171706348782043`*^9}, {
  3.917170678459549*^9, 3.9171707325913467`*^9}, {3.9221703679801903`*^9, 
  3.922170372432494*^9}, {3.922170565547186*^9, 3.922170578259124*^9}, {
  3.922174747332838*^9, 3.9221748008361073`*^9}, {3.922174879123838*^9, 
  3.922174879472123*^9}, {3.922178308666689*^9, 3.922178310040882*^9}, {
  3.943003817469949*^9, 
  3.943003817510393*^9}},ExpressionUUID->"395e4e00-c51e-43e5-ae18-\
b957467ab50a"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TraditionalForm", "[", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{"Solve", "[", 
    RowBox[{
     RowBox[{"margopenx", "==", "0"}], ",", 
     SuperscriptBox["r", "*"]}], "]"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{
  3.9221705916188726`*^9, {3.922174384633173*^9, 3.9221744153419533`*^9}, {
   3.922174489895979*^9, 3.922174494115037*^9}, {3.922174981105447*^9, 
   3.922174982631407*^9}, {3.922177899794511*^9, 3.922177904504187*^9}, {
   3.922177982023039*^9, 3.922177986357251*^9}},
 CellLabel->"In[59]:=",ExpressionUUID->"f90543e0-45f2-4671-850d-5790f43da9db"],

Cell[BoxData[
 FormBox[
  RowBox[{"{", 
   RowBox[{"{", 
    RowBox[{
     SuperscriptBox["r", "*"], "\[Rule]", 
     FractionBox[
      RowBox[{
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"m", "-", "1"}], ")"}], "2"], " ", 
        RowBox[{"(", 
         RowBox[{"N", "-", "1"}], ")"}], " ", 
        SuperscriptBox["y", "*"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"p", " ", 
           RowBox[{"(", 
            RowBox[{"d", "-", "s"}], ")"}]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"p", "-", "1"}], ")"}], " ", "s", " ", 
           SuperscriptBox["z", "*"]}]}], ")"}]}], "-", 
       RowBox[{"c", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"g", " ", 
           RowBox[{"(", 
            RowBox[{"N", "-", "1"}], ")"}]}], "-", "N"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"m", "-", "1"}], ")"}], "2"], "-", "N"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"p", "-", "1"}], ")"}], " ", 
           SuperscriptBox["z", "*"]}], "-", "p"}], ")"}]}]}], 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"N", "-", "1"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"c", " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"m", "-", "1"}], ")"}], "2"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"g", " ", 
             RowBox[{"(", 
              RowBox[{"N", "-", "1"}], ")"}]}], "-", "N"}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"p", "-", "1"}], ")"}], " ", 
             SuperscriptBox["z", "*"]}], "-", "p"}], ")"}]}], "-", 
         RowBox[{
          SuperscriptBox["y", "*"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"m", "-", "2"}], ")"}], " ", "m", " ", 
             RowBox[{"(", 
              RowBox[{"N", "-", "1"}], ")"}]}], "-", "1"}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"p", " ", 
             RowBox[{"(", 
              RowBox[{"d", "-", "s"}], ")"}]}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"p", "-", "1"}], ")"}], " ", "s", " ", 
             SuperscriptBox["z", "*"]}]}], ")"}]}]}], ")"}]}]]}], "}"}], 
   "}"}], TraditionalForm]], "Output",
 CellChangeTimes->{
  3.922170601873764*^9, {3.922174394811987*^9, 3.922174415669127*^9}, 
   3.922174494359798*^9, 3.922174982868003*^9, {3.9221779803140993`*^9, 
   3.922177986625618*^9}},
 CellLabel->
  "Out[59]//TraditionalForm=",ExpressionUUID->"f3d19847-4628-476c-a67f-\
5e9b9e58c515"]
}, Open  ]],

Cell["\<\
We can obtain \[OpenCurlyQuote]closed\[CloseCurlyQuote] versions of the above \
conditions by substituting in our explicit value for r* .\
\>", "Text",
 CellChangeTimes->{{3.915176441285725*^9, 3.915176587713168*^9}, {
  3.915177463317815*^9, 3.9151774714126167`*^9}, {3.915201893168091*^9, 
  3.915201894284738*^9}, {3.915202007544639*^9, 3.9152020082622538`*^9}, {
  3.916995439095326*^9, 3.91699545870647*^9}, {3.9169967026784773`*^9, 
  3.916996704556098*^9}, {3.916997001048623*^9, 3.9169970386335917`*^9}, {
  3.91715868016183*^9, 3.917158685351819*^9}, {3.917170783286191*^9, 
  3.917170856787763*^9}, {3.917170916695551*^9, 3.9171709297921753`*^9}, {
  3.922170674636406*^9, 
  3.9221707048136806`*^9}},ExpressionUUID->"0de5a5ef-4c88-4ef5-9255-\
1a2c10ad59b9"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"TraditionalForm", "[", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{
    RowBox[{"margopenz", ">", "0"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      SuperscriptBox["r", "*"], "->", 
      RowBox[{"1", "/", 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"m", "-", "2"}], ")"}], " ", "m", " ", "N"}], ")"}], "/", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"m", "-", "1"}], ")"}], "^", "2"}]}]}], ")"}]}]}], 
     "}"}]}], "]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"TraditionalForm", "[", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{
    RowBox[{"1", "/", 
     RowBox[{"(", 
      RowBox[{"1", "-", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"m", "-", "2"}], ")"}], " ", "m", " ", "N"}], ")"}], "/", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"m", "-", "1"}], ")"}], "^", "2"}]}]}], ")"}]}], "==", 
    FractionBox[
     RowBox[{
      RowBox[{
       RowBox[{"-", "c"}], " ", 
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "m"}], ")"}], "2"], "-", "N"}], ")"}], 
       " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"g", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "N"}], ")"}]}], "-", "N"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "p"}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "p"}], ")"}], " ", 
          SuperscriptBox["z", "*"]}]}], ")"}]}], "+", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "m"}], ")"}], "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "N"}], ")"}], " ", 
       SuperscriptBox["y", "*"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"p", " ", 
          RowBox[{"(", 
           RowBox[{"d", "-", "s"}], ")"}]}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "p"}], ")"}], " ", "s", " ", 
          SuperscriptBox["z", "*"]}]}], ")"}]}]}], 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "N"}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"c", " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "m"}], ")"}], "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"g", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", "N"}], ")"}]}], "-", "N"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "p"}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", "p"}], ")"}], " ", 
            SuperscriptBox["z", "*"]}]}], ")"}]}], "-", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "2"}], "+", "m"}], ")"}], " ", "m", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", "N"}], ")"}]}]}], ")"}], " ", 
         SuperscriptBox["y", "*"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"p", " ", 
            RowBox[{"(", 
             RowBox[{"d", "-", "s"}], ")"}]}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", "p"}], ")"}], " ", "s", " ", 
            SuperscriptBox["z", "*"]}]}], ")"}]}]}], ")"}]}]]}], "]"}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.9221707117900333`*^9, 3.9221707319106073`*^9}, {
  3.922174932346594*^9, 3.922175000464697*^9}},
 CellLabel->"In[60]:=",ExpressionUUID->"5f6fb6e2-4039-482b-9dce-2a7c660a2821"],

Cell[BoxData[
 FormBox[
  RowBox[{
   RowBox[{"c", " ", 
    RowBox[{"(", 
     RowBox[{"m", "-", "2"}], ")"}], " ", "m", " ", "N", " ", 
    RowBox[{"(", 
     RowBox[{"p", "-", "1"}], ")"}], " ", 
    SuperscriptBox["x", "*"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"g", " ", 
       RowBox[{"(", 
        RowBox[{"N", "-", "1"}], ")"}]}], "-", "N"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"m", "-", "2"}], ")"}], " ", "m", " ", 
       RowBox[{"(", 
        RowBox[{"N", "-", "1"}], ")"}]}], "-", "1"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SuperscriptBox["x", "*"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"c", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"g", "-", "1"}], ")"}], " ", "N"}], "-", "g"}], ")"}], 
          " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"p", "-", "1"}], ")"}], " ", 
             SuperscriptBox["z", "*"]}], "-", "p"}], ")"}]}], "-", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"N", "-", "1"}], ")"}], " ", 
          SuperscriptBox["y", "*"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"p", " ", 
             RowBox[{"(", 
              RowBox[{"d", "-", "s"}], ")"}]}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"p", "-", "1"}], ")"}], " ", "s", " ", 
             SuperscriptBox["z", "*"]}]}], ")"}]}]}], ")"}]}], "+", 
      RowBox[{"N", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"d", " ", "p"}], "-", "1"}], ")"}]}]}], ")"}]}], ">", "0"}], 
  TraditionalForm]], "Output",
 CellChangeTimes->{{3.922170727645697*^9, 3.922170732842222*^9}, 
   3.922175001753077*^9, 3.922177989644799*^9},
 CellLabel->
  "Out[60]//TraditionalForm=",ExpressionUUID->"7c7ca250-9f97-44c9-9519-\
c5fd6a7e2384"],

Cell[BoxData[
 FormBox[
  RowBox[{
   FractionBox[
    RowBox[{"c", " ", 
     RowBox[{"(", 
      RowBox[{"m", "-", "2"}], ")"}], " ", "m", " ", "N", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"g", " ", 
        RowBox[{"(", 
         RowBox[{"N", "-", "1"}], ")"}]}], "-", "N"}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"p", "-", "1"}], ")"}], " ", 
        SuperscriptBox["z", "*"]}], "-", "p"}], ")"}]}], 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"N", "-", "1"}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"m", "-", "2"}], ")"}], " ", "m", " ", 
        RowBox[{"(", 
         RowBox[{"N", "-", "1"}], ")"}]}], "-", "1"}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"c", " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"m", "-", "1"}], ")"}], "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"g", " ", 
           RowBox[{"(", 
            RowBox[{"N", "-", "1"}], ")"}]}], "-", "N"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"p", "-", "1"}], ")"}], " ", 
           SuperscriptBox["z", "*"]}], "-", "p"}], ")"}]}], "-", 
       RowBox[{
        SuperscriptBox["y", "*"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"m", "-", "2"}], ")"}], " ", "m", " ", 
           RowBox[{"(", 
            RowBox[{"N", "-", "1"}], ")"}]}], "-", "1"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"p", " ", 
           RowBox[{"(", 
            RowBox[{"d", "-", "s"}], ")"}]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"p", "-", "1"}], ")"}], " ", "s", " ", 
           SuperscriptBox["z", "*"]}]}], ")"}]}]}], ")"}]}]], "\[LongEqual]", 
   "0"}], TraditionalForm]], "Output",
 CellChangeTimes->{{3.922170727645697*^9, 3.922170732842222*^9}, 
   3.922175001753077*^9, 3.922177990249135*^9},
 CellLabel->
  "Out[61]//TraditionalForm=",ExpressionUUID->"bc839327-a4ca-450a-a6fa-\
caad9a465d77"]
}, Open  ]],

Cell["\<\
We solve this model using numerical techniques (see SI for details). The \
numerical procedure is implemented in a supplementary Matlab file, which can \
be found at https://github.com/ThomasWilliamScott/Plant_Signalling. \
\>", "Text",
 CellChangeTimes->{{3.9221709798220463`*^9, 3.9221709895517807`*^9}, {
  3.9221710788232193`*^9, 3.922171137229089*^9}, {3.922175033179352*^9, 
  3.922175108731187*^9}},ExpressionUUID->"dfc3b888-f650-44a6-8cd6-\
684eb89229e7"]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
Model N) Fungal monitoring; migration after population regulation; signal \
response can evolve\
\>", "Section",
 CellChangeTimes->{{3.915174600364295*^9, 3.91517462569272*^9}, 
   3.91517466765668*^9, {3.915175186685773*^9, 3.915175197207159*^9}, {
   3.91517755046989*^9, 3.9151775509280024`*^9}, {3.915184515366377*^9, 
   3.915184552979945*^9}, {3.916923876040818*^9, 3.9169239091422167`*^9}, {
   3.916926135487589*^9, 3.916926139267849*^9}, {3.9171679997466803`*^9, 
   3.917168002383638*^9}, {3.918195966529559*^9, 3.918196005762494*^9}, 
   3.94300351143441*^9, {3.9430050625057383`*^9, 3.9430050640489883`*^9}, {
   3.94300511893602*^9, 
   3.943005120650779*^9}},ExpressionUUID->"13812067-9e28-4c3d-a005-\
9e82cde75ae9"],

Cell[TextData[{
 "Neighbour-modulated fitness for the focal plant (w) and fungus (",
 Cell[BoxData[
  OverscriptBox["w", "~"]],
  CellChangeTimes->{{3.908103877779798*^9, 3.9081039368551617`*^9}, {
    3.9082687020329027`*^9, 3.908268859066394*^9}, {3.908269883914235*^9, 
    3.908269920730289*^9}, {3.908355862871335*^9, 3.908355902589114*^9}, {
    3.9108604899938927`*^9, 3.910860560580213*^9}, {3.9113770175862293`*^9, 
    3.911377066649146*^9}, {3.911391018117175*^9, 3.911391056891016*^9}, 
    3.915175265985262*^9, {3.915177560180121*^9, 3.9151775756131973`*^9}, {
    3.916477684098556*^9, 3.9164779154054203`*^9}, {3.916477958436911*^9, 
    3.916477985459425*^9}, {3.916478030965603*^9, 3.916478110056409*^9}, {
    3.916481286064456*^9, 3.9164813699923067`*^9}, {3.91648140307764*^9, 
    3.916481407874761*^9}, {3.916481619186276*^9, 3.916481623322246*^9}, {
    3.916481680406053*^9, 3.916481737519289*^9}, {3.916481914634831*^9, 
    3.916481918918346*^9}, {3.916923969477807*^9, 3.9169239903443813`*^9}, 
    3.9169244507737093`*^9, {3.918196030415245*^9, 3.918196033001748*^9}, {
    3.9181960639555397`*^9, 3.9181960641150703`*^9}, 3.918196144636689*^9, {
    3.918196200295842*^9, 3.918196208648095*^9}, {3.918196404875342*^9, 
    3.918196450348023*^9}, {3.918196597656413*^9, 3.918196603103346*^9}, {
    3.9181966637301617`*^9, 3.918196779781506*^9}, {3.918196901254066*^9, 
    3.918196959975978*^9}, {3.9181970020108*^9, 3.9181970684658337`*^9}, {
    3.918197138774539*^9, 3.9181972086836147`*^9}},ExpressionUUID->
  "e6407baf-a5c2-4a28-896a-de953e9ba463"],
 ") is written below."
}], "Text",
 CellChangeTimes->{{3.9151752377757063`*^9, 3.915175259620417*^9}, {
   3.915175352890313*^9, 3.9151753593515577`*^9}, {3.915201719433642*^9, 
   3.915201720074353*^9}, 3.9169239389872704`*^9, {3.917168940574061*^9, 
   3.9171690118167477`*^9}, {3.918196215439826*^9, 3.918196321947365*^9}, {
   3.918196360205652*^9, 3.9181963721181793`*^9}, 3.918196610325472*^9, {
   3.922175236721517*^9, 
   3.9221752773572273`*^9}},ExpressionUUID->"44b9399c-44bf-4968-ab2e-\
bed546233f65"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ffocal", " ", "=", " ", 
   RowBox[{"1", "-", 
    RowBox[{"p", 
     RowBox[{"(", 
      RowBox[{
       FractionBox["d", "N"], "+", 
       RowBox[{
        FractionBox[
         RowBox[{"N", "-", "1"}], "N"], 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"d", 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"xpop", " ", "yfocal"}]}], ")"}]}], "+", 
          RowBox[{"s", " ", "xpop", " ", "yfocal"}]}], ")"}]}]}], ")"}]}], 
    "-", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "-", "p"}], ")"}], "s", " ", "xpop", " ", "yfocal", " ", 
     "zpop"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fpartner", " ", "=", " ", 
   RowBox[{"1", "-", 
    RowBox[{"p", 
     RowBox[{"(", 
      RowBox[{
       FractionBox["d", "N"], "+", 
       RowBox[{
        FractionBox[
         RowBox[{"N", "-", "1"}], "N"], 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"d", 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"xfocal", " ", "ypop"}]}], ")"}]}], "+", 
          RowBox[{"s", " ", "xfocal", " ", "ypop"}]}], ")"}]}]}], ")"}]}], 
    "-", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "-", "p"}], ")"}], "s", " ", "xfocal", " ", "ypop", " ", 
     "zfocal"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fdeme", " ", "=", " ", 
   RowBox[{"1", "-", 
    RowBox[{"p", 
     RowBox[{"(", 
      RowBox[{
       FractionBox["d", "N"], "+", 
       RowBox[{
        FractionBox[
         RowBox[{"N", "-", "1"}], "N"], 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"d", 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"xpop", " ", "ydeme"}]}], ")"}]}], "+", 
          RowBox[{"s", " ", "xpop", " ", "ydeme"}]}], ")"}]}]}], ")"}]}], "-", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "-", "p"}], ")"}], "s", " ", "xpop", " ", "ydeme", " ", 
     "zpop"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fpop", " ", "=", " ", 
   RowBox[{"1", "-", 
    RowBox[{"p", 
     RowBox[{"(", 
      RowBox[{
       FractionBox["d", "N"], "+", 
       RowBox[{
        FractionBox[
         RowBox[{"N", "-", "1"}], "N"], 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"d", 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"xpop", " ", "ypop"}]}], ")"}]}], "+", 
          RowBox[{"s", " ", "xpop", " ", "ypop"}]}], ")"}]}]}], ")"}]}], "-", 
    
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "-", "p"}], ")"}], "s", " ", "xpop", " ", "ypop", " ", 
     "zpop"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   SubscriptBox[
    OverscriptBox["f", "~"], "focal"], "=", 
   RowBox[{"1", "-", 
    RowBox[{"p", " ", "c", " ", "xfocal"}], "-", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "-", "p"}], ")"}], "c", " ", "xfocal", " ", "zfocal"}], 
    "+", 
    RowBox[{"b", " ", "fpartner"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   SubscriptBox[
    OverscriptBox["f", "~"], "pop"], "=", 
   RowBox[{"1", "-", 
    RowBox[{"p", " ", "c", " ", "xpop"}], "-", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "-", "p"}], ")"}], "c", " ", "xpop", " ", "zpop"}], "+", 
    RowBox[{"b", " ", "fpop"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ydeme", "=", 
   RowBox[{
    RowBox[{
     FractionBox["1", "N"], "yfocal"}], "+", 
    RowBox[{
     FractionBox[
      RowBox[{"N", "-", "1"}], "N"], "yothers"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"w", "=", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{"ffocal", " ", "/", " ", "fdeme"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   OverscriptBox["w", "~"], "=", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{
     SubscriptBox[
      OverscriptBox["f", "~"], "focal"], " ", "/", " ", 
     SubscriptBox[
      OverscriptBox["f", "~"], "pop"]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.908103877779798*^9, 3.9081039368551617`*^9}, {
   3.9082687020329027`*^9, 3.908268859066394*^9}, {3.908269883914235*^9, 
   3.908269920730289*^9}, {3.908355862871335*^9, 3.908355902589114*^9}, {
   3.9108604899938927`*^9, 3.910860560580213*^9}, {3.9113770175862293`*^9, 
   3.911377066649146*^9}, {3.911391018117175*^9, 3.911391056891016*^9}, 
   3.915175265985262*^9, {3.915177560180121*^9, 3.9151775756131973`*^9}, {
   3.916477684098556*^9, 3.9164779154054203`*^9}, {3.916477958436911*^9, 
   3.916477985459425*^9}, {3.916478030965603*^9, 3.916478110056409*^9}, {
   3.916481286064456*^9, 3.9164813699923067`*^9}, {3.91648140307764*^9, 
   3.916481407874761*^9}, {3.916481619186276*^9, 3.916481623322246*^9}, {
   3.916481680406053*^9, 3.916481737519289*^9}, {3.916481914634831*^9, 
   3.916481918918346*^9}, {3.916923969477807*^9, 3.9169239903443813`*^9}, 
   3.9169244507737093`*^9, {3.918196030415245*^9, 3.918196033001748*^9}, {
   3.9181960639555397`*^9, 3.9181960641150703`*^9}, 3.918196144636689*^9, {
   3.918196200295842*^9, 3.918196208648095*^9}, {3.918196404875342*^9, 
   3.918196450348023*^9}, {3.918196597656413*^9, 3.918196603103346*^9}, {
   3.9181966637301617`*^9, 3.918196779781506*^9}, {3.918196901254066*^9, 
   3.918196959975978*^9}, {3.9181970020108*^9, 3.9181970684658337`*^9}, {
   3.918197138774539*^9, 3.9181972086836147`*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"27d86ab9-67c4-46ce-ba21-801f30b4192f"],

Cell["\<\
The derivative of focal fungus fitness, with respect to the focal fungus\
\[CloseCurlyQuote] investment in signalling,  evaluated at monomorphic \
equilibrium, is written below as -cmx. This is Equation N24 in the SI. The \
derivative of focal plant fitness, with respect to the focal plant\
\[CloseCurlyQuote]s level of signal-response,  evaluated at monomorphic \
equilibrium, is written below as -cmy. This is Equation N16  in the SI. The \
derivative of focal fungus fitness, with respect to the focal fungus\
\[CloseCurlyQuote] level of dishonesty,  evaluated at monomorphic \
equilibrium, is written below as -cmz. This is Equation N11 in the SI. Note \
that the \[OpenCurlyQuote]cm\[CloseCurlyQuote] notation is used to represent \
the \[OpenCurlyQuote]marginal cost\[CloseCurlyQuote] of Hamilton\
\[CloseCurlyQuote]s Rule. \
\>", "Text",
 CellChangeTimes->{{3.915175733249536*^9, 3.915175737026534*^9}, {
  3.915175857656424*^9, 3.915175883915668*^9}, {3.915201785175893*^9, 
  3.915201785787332*^9}, {3.9169243383213587`*^9, 3.916924540689454*^9}, {
  3.917169045808907*^9, 3.917169122094307*^9}, {3.922175503733666*^9, 
  3.922175513693166*^9}, {3.9221755941576443`*^9, 3.922175611728806*^9}, {
  3.9221756708420343`*^9, 3.922175744003662*^9}, {3.943003851803389*^9, 
  3.943003860383481*^9}},ExpressionUUID->"d8296425-ca3e-4b63-a992-\
40a464f88a9d"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"cmx", "=", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{"D", "[", 
       RowBox[{
        OverscriptBox["w", "~"], ",", "xfocal"}], "]"}]}], "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"xfocal", "->", 
        SuperscriptBox["x", "*"]}], ",", 
       RowBox[{"xothers", "->", 
        SuperscriptBox["x", "*"]}], ",", 
       RowBox[{"xpop", "->", 
        SuperscriptBox["x", "*"]}], ",", 
       RowBox[{"yfocal", "->", 
        SuperscriptBox["y", "*"]}], ",", 
       RowBox[{"yothers", "->", 
        SuperscriptBox["y", "*"]}], ",", 
       RowBox[{"ypop", "->", 
        SuperscriptBox["y", "*"]}], ",", 
       RowBox[{"zfocal", "->", 
        SuperscriptBox["z", "*"]}], ",", 
       RowBox[{"zothers", "->", 
        SuperscriptBox["z", "*"]}], ",", 
       RowBox[{"zpop", "->", 
        SuperscriptBox["z", "*"]}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"TraditionalForm", "[", 
  RowBox[{"-", "cmx"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cmy", "=", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{"D", "[", 
       RowBox[{"w", ",", "yfocal"}], "]"}]}], "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"xfocal", "->", 
        SuperscriptBox["x", "*"]}], ",", 
       RowBox[{"xothers", "->", 
        SuperscriptBox["x", "*"]}], ",", 
       RowBox[{"xpop", "->", 
        SuperscriptBox["x", "*"]}], ",", 
       RowBox[{"yfocal", "->", 
        SuperscriptBox["y", "*"]}], ",", 
       RowBox[{"yothers", "->", 
        SuperscriptBox["y", "*"]}], ",", 
       RowBox[{"ypop", "->", 
        SuperscriptBox["y", "*"]}], ",", 
       RowBox[{"zfocal", "->", 
        SuperscriptBox["z", "*"]}], ",", 
       RowBox[{"zothers", "->", 
        SuperscriptBox["z", "*"]}], ",", 
       RowBox[{"zpop", "->", 
        SuperscriptBox["z", "*"]}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"TraditionalForm", "[", 
  RowBox[{"-", "cmy"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cmz", "=", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{"D", "[", 
       RowBox[{
        OverscriptBox["w", "~"], ",", "zfocal"}], "]"}]}], "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"xfocal", "->", 
        SuperscriptBox["x", "*"]}], ",", 
       RowBox[{"xothers", "->", 
        SuperscriptBox["x", "*"]}], ",", 
       RowBox[{"xpop", "->", 
        SuperscriptBox["x", "*"]}], ",", 
       RowBox[{"yfocal", "->", 
        SuperscriptBox["y", "*"]}], ",", 
       RowBox[{"yothers", "->", 
        SuperscriptBox["y", "*"]}], ",", 
       RowBox[{"ypop", "->", 
        SuperscriptBox["y", "*"]}], ",", 
       RowBox[{"zfocal", "->", 
        SuperscriptBox["z", "*"]}], ",", 
       RowBox[{"zothers", "->", 
        SuperscriptBox["z", "*"]}], ",", 
       RowBox[{"zpop", "->", 
        SuperscriptBox["z", "*"]}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"TraditionalForm", "[", 
  RowBox[{"-", "cmz"}], "]"}]}], "Input",
 CellChangeTimes->{{3.915177161684618*^9, 3.9151771773356667`*^9}, {
   3.916481483253688*^9, 3.916481552430945*^9}, {3.91648160244484*^9, 
   3.9164816118925*^9}, {3.916481759966824*^9, 3.916481788106379*^9}, 
   3.916481934096526*^9, {3.9164822989840403`*^9, 3.9164823223519583`*^9}, {
   3.916482356877144*^9, 3.916482367589439*^9}, {3.916897535989539*^9, 
   3.9168975825045357`*^9}, {3.916897664196308*^9, 3.916897685271616*^9}, {
   3.916924011307473*^9, 3.916924066960389*^9}, {3.918198007902854*^9, 
   3.918198033799238*^9}, {3.9181980765527563`*^9, 3.918198079100031*^9}},
 CellLabel->"In[10]:=",ExpressionUUID->"0304be7e-5bac-4c13-934a-12ae91bffa6d"],

Cell[BoxData[
 FormBox[
  RowBox[{"-", 
   FractionBox[
    RowBox[{
     RowBox[{"-", 
      RowBox[{"N", " ", 
       RowBox[{"(", 
        RowBox[{"p", "-", "1"}], ")"}], " ", 
       SuperscriptBox["z", "*"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"b", " ", "s", " ", 
          SuperscriptBox["y", "*"]}], "+", "c"}], ")"}]}]}], "-", 
     RowBox[{"b", " ", 
      RowBox[{"(", 
       RowBox[{"N", "-", "1"}], ")"}], " ", "p", " ", 
      SuperscriptBox["y", "*"], " ", 
      RowBox[{"(", 
       RowBox[{"d", "-", "s"}], ")"}]}], "+", 
     RowBox[{"c", " ", "N", " ", "p"}]}], 
    RowBox[{
     RowBox[{
      SuperscriptBox["x", "*"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"N", " ", 
         RowBox[{"(", 
          RowBox[{"p", "-", "1"}], ")"}], " ", 
         SuperscriptBox["z", "*"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"b", " ", "s", " ", 
            SuperscriptBox["y", "*"]}], "+", "c"}], ")"}]}], "+", 
        RowBox[{"b", " ", 
         RowBox[{"(", 
          RowBox[{"N", "-", "1"}], ")"}], " ", "p", " ", 
         SuperscriptBox["y", "*"], " ", 
         RowBox[{"(", 
          RowBox[{"d", "-", "s"}], ")"}]}], "-", 
        RowBox[{"c", " ", "N", " ", "p"}]}], ")"}]}], "+", 
     RowBox[{"N", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"b", " ", 
         RowBox[{"(", 
          RowBox[{"-", "d"}], ")"}], " ", "p"}], "+", "b", "+", "1"}], 
       ")"}]}]}]]}], TraditionalForm]], "Output",
 CellChangeTimes->{{3.915175743038382*^9, 3.915175768128035*^9}, 
   3.915175936434854*^9, 3.915177190897686*^9, 3.915177506724401*^9, 
   3.91517759649308*^9, 3.915185308457467*^9, 3.9151854454804688`*^9, 
   3.9152057318463173`*^9, 3.916481442342709*^9, {3.9164815393717117`*^9, 
   3.916481552674883*^9}, {3.916481586104621*^9, 3.9164816546079397`*^9}, {
   3.9164817755564833`*^9, 3.916481808975319*^9}, {3.9164819310673447`*^9, 
   3.9164819343561277`*^9}, 3.9164821102923717`*^9, 3.916482441344426*^9, 
   3.91681723672745*^9, 3.916897391167815*^9, {3.91689755154731*^9, 
   3.916897582715363*^9}, {3.916897667376539*^9, 3.916897685486547*^9}, 
   3.916924190750946*^9, 3.917008688450069*^9, 3.9170727057502193`*^9, 
   3.9171696231830893`*^9, 3.91819794315339*^9, {3.9181980104219923`*^9, 
   3.91819803435643*^9}, 3.918198079819512*^9, 3.918198364594121*^9, {
   3.91820504013135*^9, 3.918205042710225*^9}, 3.918536998934144*^9, 
   3.922175215475767*^9, 3.922176986004188*^9},
 CellLabel->
  "Out[11]//TraditionalForm=",ExpressionUUID->"b2db2ffe-3307-425f-9ad5-\
1e91920e57ec"],

Cell[BoxData[
 FormBox[
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{"N", "-", "1"}], ")"}], " ", 
    SuperscriptBox["x", "*"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"N", "-", "1"}], ")"}], " ", "p", " ", 
       RowBox[{"(", 
        RowBox[{"d", "-", "s"}], ")"}]}], "+", 
      RowBox[{"N", " ", 
       RowBox[{"(", 
        RowBox[{"p", "-", "1"}], ")"}], " ", "s", " ", 
       SuperscriptBox["z", "*"]}]}], ")"}]}], 
   RowBox[{"N", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SuperscriptBox["x", "*"], " ", 
       SuperscriptBox["y", "*"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"N", "-", "1"}], ")"}], " ", "p", " ", 
          RowBox[{"(", 
           RowBox[{"d", "-", "s"}], ")"}]}], "+", 
         RowBox[{"N", " ", 
          RowBox[{"(", 
           RowBox[{"p", "-", "1"}], ")"}], " ", "s", " ", 
          SuperscriptBox["z", "*"]}]}], ")"}]}], "-", 
      RowBox[{"d", " ", "N", " ", "p"}], "+", "N"}], ")"}]}]], 
  TraditionalForm]], "Output",
 CellChangeTimes->{{3.915175743038382*^9, 3.915175768128035*^9}, 
   3.915175936434854*^9, 3.915177190897686*^9, 3.915177506724401*^9, 
   3.91517759649308*^9, 3.915185308457467*^9, 3.9151854454804688`*^9, 
   3.9152057318463173`*^9, 3.916481442342709*^9, {3.9164815393717117`*^9, 
   3.916481552674883*^9}, {3.916481586104621*^9, 3.9164816546079397`*^9}, {
   3.9164817755564833`*^9, 3.916481808975319*^9}, {3.9164819310673447`*^9, 
   3.9164819343561277`*^9}, 3.9164821102923717`*^9, 3.916482441344426*^9, 
   3.91681723672745*^9, 3.916897391167815*^9, {3.91689755154731*^9, 
   3.916897582715363*^9}, {3.916897667376539*^9, 3.916897685486547*^9}, 
   3.916924190750946*^9, 3.917008688450069*^9, 3.9170727057502193`*^9, 
   3.9171696231830893`*^9, 3.91819794315339*^9, {3.9181980104219923`*^9, 
   3.91819803435643*^9}, 3.918198079819512*^9, 3.918198364594121*^9, {
   3.91820504013135*^9, 3.918205042710225*^9}, 3.918536998934144*^9, 
   3.922175215475767*^9, 3.922176986079563*^9},
 CellLabel->
  "Out[13]//TraditionalForm=",ExpressionUUID->"71342afd-266e-49b6-8986-\
52ac49dda380"],

Cell[BoxData[
 FormBox[
  FractionBox[
   RowBox[{"N", " ", 
    RowBox[{"(", 
     RowBox[{"p", "-", "1"}], ")"}], " ", 
    SuperscriptBox["x", "*"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"b", " ", "s", " ", 
       SuperscriptBox["y", "*"]}], "+", "c"}], ")"}]}], 
   RowBox[{
    RowBox[{
     SuperscriptBox["x", "*"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"N", " ", 
        RowBox[{"(", 
         RowBox[{"p", "-", "1"}], ")"}], " ", 
        SuperscriptBox["z", "*"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"b", " ", "s", " ", 
           SuperscriptBox["y", "*"]}], "+", "c"}], ")"}]}], "+", 
       RowBox[{"b", " ", 
        RowBox[{"(", 
         RowBox[{"N", "-", "1"}], ")"}], " ", "p", " ", 
        SuperscriptBox["y", "*"], " ", 
        RowBox[{"(", 
         RowBox[{"d", "-", "s"}], ")"}]}], "-", 
       RowBox[{"c", " ", "N", " ", "p"}]}], ")"}]}], "+", 
    RowBox[{"N", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"b", " ", 
        RowBox[{"(", 
         RowBox[{"-", "d"}], ")"}], " ", "p"}], "+", "b", "+", "1"}], 
      ")"}]}]}]], TraditionalForm]], "Output",
 CellChangeTimes->{{3.915175743038382*^9, 3.915175768128035*^9}, 
   3.915175936434854*^9, 3.915177190897686*^9, 3.915177506724401*^9, 
   3.91517759649308*^9, 3.915185308457467*^9, 3.9151854454804688`*^9, 
   3.9152057318463173`*^9, 3.916481442342709*^9, {3.9164815393717117`*^9, 
   3.916481552674883*^9}, {3.916481586104621*^9, 3.9164816546079397`*^9}, {
   3.9164817755564833`*^9, 3.916481808975319*^9}, {3.9164819310673447`*^9, 
   3.9164819343561277`*^9}, 3.9164821102923717`*^9, 3.916482441344426*^9, 
   3.91681723672745*^9, 3.916897391167815*^9, {3.91689755154731*^9, 
   3.916897582715363*^9}, {3.916897667376539*^9, 3.916897685486547*^9}, 
   3.916924190750946*^9, 3.917008688450069*^9, 3.9170727057502193`*^9, 
   3.9171696231830893`*^9, 3.91819794315339*^9, {3.9181980104219923`*^9, 
   3.91819803435643*^9}, 3.918198079819512*^9, 3.918198364594121*^9, {
   3.91820504013135*^9, 3.918205042710225*^9}, 3.918536998934144*^9, 
   3.922175215475767*^9, 3.922176986104638*^9},
 CellLabel->
  "Out[15]//TraditionalForm=",ExpressionUUID->"d1425acd-df79-47df-94bc-\
9f6c6e8c9094"]
}, Open  ]],

Cell["\<\
The derivative of focal fungus fitness, with respect to the average signal \
investment of other fungi on the deme, evaluated at monomorphic equilibrium, \
is written below as bmx. This is Equation N25 in the SI. (Note that this is \
trivially zero because there is only one fungus per deme.) The derivative of \
focal plant fitness, with respect to the average signal-response level of \
other plants on the deme, evaluated at monomorphic equilibrium, is written \
below as bmy. This is Equation N17 in the SI. The derivative of focal fungus \
fitness, with respect to the average signal dishonesty level of other fungi \
on the deme, evaluated at monomorphic equilibrium, is written below as bmz. \
This is Equation N12 in the SI. (Note that this is trivially zero because \
there is only one fungus per deme.) Note that the \[OpenCurlyQuote]bm\
\[CloseCurlyQuote] notation is used to represent the \
\[OpenCurlyQuote]marginal benefit\[CloseCurlyQuote] of Hamilton\
\[CloseCurlyQuote]s Rule. \
\>", "Text",
 CellChangeTimes->{{3.915175418488715*^9, 3.915175518937564*^9}, 
   3.915175722238924*^9, {3.915175920186359*^9, 3.915175930914809*^9}, {
   3.915201863902808*^9, 3.9152018640063953`*^9}, {3.916924737050666*^9, 
   3.916924834839422*^9}, {3.917169140804325*^9, 3.917169197401903*^9}, {
   3.922176100796133*^9, 3.9221761067971497`*^9}, {3.9221761828668633`*^9, 
   3.9221763270045433`*^9}, {3.9430038648045893`*^9, 
   3.9430038726374693`*^9}},ExpressionUUID->"52f0249d-eedf-4daa-8580-\
6e628d1cfad7"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"TraditionalForm", "[", 
  RowBox[{"bmx", "=", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{
       OverscriptBox["w", "~"], ",", "xothers"}], "]"}], "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"xfocal", "->", 
        SuperscriptBox["x", "*"]}], ",", 
       RowBox[{"xothers", "->", 
        SuperscriptBox["x", "*"]}], ",", 
       RowBox[{"xpop", "->", 
        SuperscriptBox["x", "*"]}], ",", 
       RowBox[{"yfocal", "->", 
        SuperscriptBox["y", "*"]}], ",", 
       RowBox[{"yothers", "->", 
        SuperscriptBox["y", "*"]}], ",", 
       RowBox[{"ypop", "->", 
        SuperscriptBox["y", "*"]}], ",", 
       RowBox[{"zfocal", "->", 
        SuperscriptBox["z", "*"]}], ",", 
       RowBox[{"zothers", "->", 
        SuperscriptBox["z", "*"]}], ",", 
       RowBox[{"zpop", "->", 
        SuperscriptBox["z", "*"]}]}], "}"}]}], "]"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"TraditionalForm", "[", 
  RowBox[{"bmy", "=", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{"w", ",", "yothers"}], "]"}], "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"xfocal", "->", 
        SuperscriptBox["x", "*"]}], ",", 
       RowBox[{"xothers", "->", 
        SuperscriptBox["x", "*"]}], ",", 
       RowBox[{"xpop", "->", 
        SuperscriptBox["x", "*"]}], ",", 
       RowBox[{"yfocal", "->", 
        SuperscriptBox["y", "*"]}], ",", 
       RowBox[{"yothers", "->", 
        SuperscriptBox["y", "*"]}], ",", 
       RowBox[{"ypop", "->", 
        SuperscriptBox["y", "*"]}], ",", 
       RowBox[{"zfocal", "->", 
        SuperscriptBox["z", "*"]}], ",", 
       RowBox[{"zothers", "->", 
        SuperscriptBox["z", "*"]}], ",", 
       RowBox[{"zpop", "->", 
        SuperscriptBox["z", "*"]}]}], "}"}]}], "]"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"TraditionalForm", "[", 
  RowBox[{"bmz", "=", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{
       OverscriptBox["w", "~"], ",", "zothers"}], "]"}], "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"xfocal", "->", 
        SuperscriptBox["x", "*"]}], ",", 
       RowBox[{"xothers", "->", 
        SuperscriptBox["x", "*"]}], ",", 
       RowBox[{"xpop", "->", 
        SuperscriptBox["x", "*"]}], ",", 
       RowBox[{"yfocal", "->", 
        SuperscriptBox["y", "*"]}], ",", 
       RowBox[{"yothers", "->", 
        SuperscriptBox["y", "*"]}], ",", 
       RowBox[{"ypop", "->", 
        SuperscriptBox["y", "*"]}], ",", 
       RowBox[{"zfocal", "->", 
        SuperscriptBox["z", "*"]}], ",", 
       RowBox[{"zothers", "->", 
        SuperscriptBox["z", "*"]}], ",", 
       RowBox[{"zpop", "->", 
        SuperscriptBox["z", "*"]}]}], "}"}]}], "]"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.9081039414213743`*^9, 3.9081039435052147`*^9}, {
   3.90810406510456*^9, 3.908104073589612*^9}, {3.9081043026353397`*^9, 
   3.9081043339158287`*^9}, 3.908106925554028*^9, {3.911391003528234*^9, 
   3.9113910075287848`*^9}, {3.9115423725276537`*^9, 3.911542390599454*^9}, {
   3.915175399934017*^9, 3.915175400756152*^9}, 3.915175723845454*^9, {
   3.915177193413665*^9, 3.9151771935552893`*^9}, {3.9164819598739023`*^9, 
   3.916481970547638*^9}, 3.91648230585422*^9, {3.916482371868814*^9, 
   3.916482381088786*^9}, {3.916924211383026*^9, 3.916924219763884*^9}, {
   3.918198378385087*^9, 3.918198394951915*^9}},
 CellLabel->"In[16]:=",ExpressionUUID->"aa430174-3169-4e1a-9a57-beec633a9032"],

Cell[BoxData[
 FormBox["0", TraditionalForm]], "Output",
 CellChangeTimes->{{3.908104066438794*^9, 3.908104073995747*^9}, {
   3.908104334637701*^9, 3.908104339447672*^9}, 3.908104424387844*^9, 
   3.90810793331876*^9, 3.908268880209581*^9, 3.9083559231030807`*^9, 
   3.9108605734536858`*^9, 3.911376842118787*^9, 3.911377086620686*^9, 
   3.9113911571237173`*^9, 3.911471811646303*^9, 3.911542455073489*^9, 
   3.9115545156811333`*^9, 3.911555059549644*^9, 3.915175584540079*^9, 
   3.915175770181059*^9, {3.915175934655409*^9, 3.915175941825774*^9}, 
   3.915177194903661*^9, 3.915177508380785*^9, 3.915177613264398*^9, 
   3.9151854491434717`*^9, 3.915205736861938*^9, 3.91648197268186*^9, 
   3.916482112689074*^9, 3.916482454211854*^9, 3.916817238961383*^9, 
   3.916897399110004*^9, 3.916924221003422*^9, 3.917008690775882*^9, 
   3.917072844153636*^9, 3.9171696236729403`*^9, 3.9181983956677313`*^9, 
   3.918205044727825*^9, 3.918537000728552*^9, 3.922176986164645*^9},
 CellLabel->
  "Out[16]//TraditionalForm=",ExpressionUUID->"7bdf4d58-ca15-46f5-a154-\
3c40e9a1def8"],

Cell[BoxData[
 FormBox[
  RowBox[{"-", 
   FractionBox[
    RowBox[{
     RowBox[{"(", 
      RowBox[{"N", "-", "1"}], ")"}], " ", 
     SuperscriptBox["x", "*"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"N", "-", "1"}], ")"}], " ", "p", " ", 
        RowBox[{"(", 
         RowBox[{"d", "-", "s"}], ")"}]}], "+", 
       RowBox[{"N", " ", 
        RowBox[{"(", 
         RowBox[{"p", "-", "1"}], ")"}], " ", "s", " ", 
        SuperscriptBox["z", "*"]}]}], ")"}]}], 
    RowBox[{"N", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        SuperscriptBox["x", "*"], " ", 
        SuperscriptBox["y", "*"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"N", "-", "1"}], ")"}], " ", "p", " ", 
           RowBox[{"(", 
            RowBox[{"d", "-", "s"}], ")"}]}], "+", 
          RowBox[{"N", " ", 
           RowBox[{"(", 
            RowBox[{"p", "-", "1"}], ")"}], " ", "s", " ", 
           SuperscriptBox["z", "*"]}]}], ")"}]}], "-", 
       RowBox[{"d", " ", "N", " ", "p"}], "+", "N"}], ")"}]}]]}], 
  TraditionalForm]], "Output",
 CellChangeTimes->{{3.908104066438794*^9, 3.908104073995747*^9}, {
   3.908104334637701*^9, 3.908104339447672*^9}, 3.908104424387844*^9, 
   3.90810793331876*^9, 3.908268880209581*^9, 3.9083559231030807`*^9, 
   3.9108605734536858`*^9, 3.911376842118787*^9, 3.911377086620686*^9, 
   3.9113911571237173`*^9, 3.911471811646303*^9, 3.911542455073489*^9, 
   3.9115545156811333`*^9, 3.911555059549644*^9, 3.915175584540079*^9, 
   3.915175770181059*^9, {3.915175934655409*^9, 3.915175941825774*^9}, 
   3.915177194903661*^9, 3.915177508380785*^9, 3.915177613264398*^9, 
   3.9151854491434717`*^9, 3.915205736861938*^9, 3.91648197268186*^9, 
   3.916482112689074*^9, 3.916482454211854*^9, 3.916817238961383*^9, 
   3.916897399110004*^9, 3.916924221003422*^9, 3.917008690775882*^9, 
   3.917072844153636*^9, 3.9171696236729403`*^9, 3.9181983956677313`*^9, 
   3.918205044727825*^9, 3.918537000728552*^9, 3.922176986167626*^9},
 CellLabel->
  "Out[17]//TraditionalForm=",ExpressionUUID->"aac292d3-b743-42b8-b715-\
cabcba2e6cb2"],

Cell[BoxData[
 FormBox["0", TraditionalForm]], "Output",
 CellChangeTimes->{{3.908104066438794*^9, 3.908104073995747*^9}, {
   3.908104334637701*^9, 3.908104339447672*^9}, 3.908104424387844*^9, 
   3.90810793331876*^9, 3.908268880209581*^9, 3.9083559231030807`*^9, 
   3.9108605734536858`*^9, 3.911376842118787*^9, 3.911377086620686*^9, 
   3.9113911571237173`*^9, 3.911471811646303*^9, 3.911542455073489*^9, 
   3.9115545156811333`*^9, 3.911555059549644*^9, 3.915175584540079*^9, 
   3.915175770181059*^9, {3.915175934655409*^9, 3.915175941825774*^9}, 
   3.915177194903661*^9, 3.915177508380785*^9, 3.915177613264398*^9, 
   3.9151854491434717`*^9, 3.915205736861938*^9, 3.91648197268186*^9, 
   3.916482112689074*^9, 3.916482454211854*^9, 3.916817238961383*^9, 
   3.916897399110004*^9, 3.916924221003422*^9, 3.917008690775882*^9, 
   3.917072844153636*^9, 3.9171696236729403`*^9, 3.9181983956677313`*^9, 
   3.918205044727825*^9, 3.918537000728552*^9, 3.922176986169819*^9},
 CellLabel->
  "Out[18]//TraditionalForm=",ExpressionUUID->"607aff86-7874-4c07-8c4b-\
3ea25d13f063"]
}, Open  ]],

Cell["\<\
The overall marginal change in fungus neighbour-modulated fitness associated \
with a slight change in signalling investment is written below as margopenx. \
The overall marginal change in plant neighbour-modulated fitness associated \
with a slight change in signal-response is written below as margopeny. The \
overall marginal change in fungus neighbour-modulated fitness associated with \
a slight change in signal dishonesty is written below as margopenz. The \
\[OpenCurlyQuote]margopen\[CloseCurlyQuote] notation is used to represent the \
marginal fitness change, and the open model setting. \
\>", "Text",
 CellChangeTimes->{{3.915175958153467*^9, 3.915176040877063*^9}, {
  3.915177227882449*^9, 3.9151773535121117`*^9}, {3.9152019626637087`*^9, 
  3.915201962719282*^9}, {3.916924848430903*^9, 3.9169249480354433`*^9}, {
  3.922176351863515*^9, 
  3.922176377573915*^9}},ExpressionUUID->"ca492431-bb42-4fde-8106-\
fbc87ff7374a"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"TraditionalForm", "[", 
  RowBox[{"margopenx", "=", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{
     RowBox[{
      SuperscriptBox["r", "*"], " ", "bmx"}], " ", "-", " ", "cmx"}], "]"}]}],
   "]"}], "\[IndentingNewLine]", 
 RowBox[{"TraditionalForm", "[", 
  RowBox[{"margopeny", "=", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{
     RowBox[{
      SuperscriptBox["r", "*"], " ", "bmy"}], " ", "-", " ", "cmy"}], "]"}]}],
   "]"}], "\[IndentingNewLine]", 
 RowBox[{"TraditionalForm", "[", 
  RowBox[{"margopenz", "=", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{
     RowBox[{
      SuperscriptBox["r", "*"], " ", "bmz"}], " ", "-", " ", "cmz"}], "]"}]}],
   "]"}]}], "Input",
 CellChangeTimes->{{3.9081044477104807`*^9, 3.908104459241107*^9}, {
   3.908104492639288*^9, 3.9081044941536303`*^9}, {3.9081051452016487`*^9, 
   3.90810514887316*^9}, {3.9151758222548037`*^9, 3.9151758368976316`*^9}, {
   3.915177197160902*^9, 3.9151772227977467`*^9}, 3.915177266100378*^9, {
   3.91648233432502*^9, 3.916482342389292*^9}, {3.916482411368557*^9, 
   3.916482421649559*^9}, {3.917008695470492*^9, 3.917008702573369*^9}},
 CellLabel->"In[19]:=",ExpressionUUID->"a17dc7e4-9142-42f9-9fe4-d8906ebf42b2"],

Cell[BoxData[
 FormBox[
  FractionBox["1", 
   RowBox[{
    FractionBox[
     RowBox[{"N", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"b", " ", 
         RowBox[{"(", 
          RowBox[{"-", "d"}], ")"}], " ", "p"}], "+", "b", "+", "1"}], 
       ")"}]}], 
     RowBox[{
      RowBox[{"N", " ", 
       RowBox[{"(", 
        RowBox[{"p", "-", "1"}], ")"}], " ", 
       SuperscriptBox["z", "*"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"b", " ", "s", " ", 
          SuperscriptBox["y", "*"]}], "+", "c"}], ")"}]}], "+", 
      RowBox[{"b", " ", 
       RowBox[{"(", 
        RowBox[{"N", "-", "1"}], ")"}], " ", "p", " ", 
       SuperscriptBox["y", "*"], " ", 
       RowBox[{"(", 
        RowBox[{"d", "-", "s"}], ")"}]}], "-", 
      RowBox[{"c", " ", "N", " ", "p"}]}]], "+", 
    SuperscriptBox["x", "*"]}]], TraditionalForm]], "Output",
 CellChangeTimes->{
  3.9081044594986353`*^9, 3.908104494901422*^9, 3.908105149718433*^9, 
   3.9081079426689453`*^9, 3.908268887184318*^9, 3.908355930776684*^9, 
   3.910860606912422*^9, 3.911376884182818*^9, 3.9113771335928373`*^9, 
   3.911471977218416*^9, 3.91154771336239*^9, 3.911554641393799*^9, 
   3.9115551823599377`*^9, {3.9151758295380363`*^9, 3.915175837301425*^9}, 
   3.915175945948777*^9, 3.91517605612919*^9, 3.915177202186002*^9, 
   3.915177356595026*^9, 3.9151775111263103`*^9, 3.915177625624977*^9, 
   3.91518566158922*^9, 3.915186018478601*^9, 3.915205738524659*^9, 
   3.9164819989330893`*^9, 3.9164821167929287`*^9, 3.916482535622197*^9, 
   3.916817241448886*^9, 3.916924226240726*^9, 3.917008704527029*^9, 
   3.917169623881089*^9, 3.918198428271982*^9, 3.918205046274188*^9, 
   3.918537002670233*^9, 3.922176986314324*^9},
 CellLabel->
  "Out[19]//TraditionalForm=",ExpressionUUID->"36ac7f96-2c65-42c9-9bd0-\
6b670b376b3a"],

Cell[BoxData[
 FormBox[
  RowBox[{"-", 
   FractionBox[
    RowBox[{
     RowBox[{"(", 
      RowBox[{"N", "-", "1"}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["r", "*"], "-", "1"}], ")"}], " ", 
     SuperscriptBox["x", "*"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"N", "-", "1"}], ")"}], " ", "p", " ", 
        RowBox[{"(", 
         RowBox[{"d", "-", "s"}], ")"}]}], "+", 
       RowBox[{"N", " ", 
        RowBox[{"(", 
         RowBox[{"p", "-", "1"}], ")"}], " ", "s", " ", 
        SuperscriptBox["z", "*"]}]}], ")"}]}], 
    RowBox[{"N", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        SuperscriptBox["x", "*"], " ", 
        SuperscriptBox["y", "*"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"N", "-", "1"}], ")"}], " ", "p", " ", 
           RowBox[{"(", 
            RowBox[{"d", "-", "s"}], ")"}]}], "+", 
          RowBox[{"N", " ", 
           RowBox[{"(", 
            RowBox[{"p", "-", "1"}], ")"}], " ", "s", " ", 
           SuperscriptBox["z", "*"]}]}], ")"}]}], "-", 
       RowBox[{"d", " ", "N", " ", "p"}], "+", "N"}], ")"}]}]]}], 
  TraditionalForm]], "Output",
 CellChangeTimes->{
  3.9081044594986353`*^9, 3.908104494901422*^9, 3.908105149718433*^9, 
   3.9081079426689453`*^9, 3.908268887184318*^9, 3.908355930776684*^9, 
   3.910860606912422*^9, 3.911376884182818*^9, 3.9113771335928373`*^9, 
   3.911471977218416*^9, 3.91154771336239*^9, 3.911554641393799*^9, 
   3.9115551823599377`*^9, {3.9151758295380363`*^9, 3.915175837301425*^9}, 
   3.915175945948777*^9, 3.91517605612919*^9, 3.915177202186002*^9, 
   3.915177356595026*^9, 3.9151775111263103`*^9, 3.915177625624977*^9, 
   3.91518566158922*^9, 3.915186018478601*^9, 3.915205738524659*^9, 
   3.9164819989330893`*^9, 3.9164821167929287`*^9, 3.916482535622197*^9, 
   3.916817241448886*^9, 3.916924226240726*^9, 3.917008704527029*^9, 
   3.917169623881089*^9, 3.918198428271982*^9, 3.918205046274188*^9, 
   3.918537002670233*^9, 3.922176986356077*^9},
 CellLabel->
  "Out[20]//TraditionalForm=",ExpressionUUID->"fc2cbbd7-5e45-46ab-860b-\
6a626a4acd21"],

Cell[BoxData[
 FormBox[
  FractionBox[
   RowBox[{"N", " ", 
    RowBox[{"(", 
     RowBox[{"p", "-", "1"}], ")"}], " ", 
    SuperscriptBox["x", "*"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"b", " ", "s", " ", 
       SuperscriptBox["y", "*"]}], "+", "c"}], ")"}]}], 
   RowBox[{
    RowBox[{
     SuperscriptBox["x", "*"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"N", " ", 
        RowBox[{"(", 
         RowBox[{"p", "-", "1"}], ")"}], " ", 
        SuperscriptBox["z", "*"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"b", " ", "s", " ", 
           SuperscriptBox["y", "*"]}], "+", "c"}], ")"}]}], "+", 
       RowBox[{"b", " ", 
        RowBox[{"(", 
         RowBox[{"N", "-", "1"}], ")"}], " ", "p", " ", 
        SuperscriptBox["y", "*"], " ", 
        RowBox[{"(", 
         RowBox[{"d", "-", "s"}], ")"}]}], "-", 
       RowBox[{"c", " ", "N", " ", "p"}]}], ")"}]}], "+", 
    RowBox[{"N", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"b", " ", 
        RowBox[{"(", 
         RowBox[{"-", "d"}], ")"}], " ", "p"}], "+", "b", "+", "1"}], 
      ")"}]}]}]], TraditionalForm]], "Output",
 CellChangeTimes->{
  3.9081044594986353`*^9, 3.908104494901422*^9, 3.908105149718433*^9, 
   3.9081079426689453`*^9, 3.908268887184318*^9, 3.908355930776684*^9, 
   3.910860606912422*^9, 3.911376884182818*^9, 3.9113771335928373`*^9, 
   3.911471977218416*^9, 3.91154771336239*^9, 3.911554641393799*^9, 
   3.9115551823599377`*^9, {3.9151758295380363`*^9, 3.915175837301425*^9}, 
   3.915175945948777*^9, 3.91517605612919*^9, 3.915177202186002*^9, 
   3.915177356595026*^9, 3.9151775111263103`*^9, 3.915177625624977*^9, 
   3.91518566158922*^9, 3.915186018478601*^9, 3.915205738524659*^9, 
   3.9164819989330893`*^9, 3.9164821167929287`*^9, 3.916482535622197*^9, 
   3.916817241448886*^9, 3.916924226240726*^9, 3.917008704527029*^9, 
   3.917169623881089*^9, 3.918198428271982*^9, 3.918205046274188*^9, 
   3.918537002670233*^9, 3.922176986375149*^9},
 CellLabel->
  "Out[21]//TraditionalForm=",ExpressionUUID->"04cdf7a3-1e66-4b50-b2ac-\
f210ba65d788"]
}, Open  ]],

Cell[TextData[{
 "We obtain a condition for fungus signal-dishonesty being at an ESS by \
setting margopenz to equal zero, to obtain ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SuperscriptBox["y", "*"], "\[Rule]", 
    FractionBox[
     RowBox[{"c", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"g", " ", 
         RowBox[{"(", 
          RowBox[{"-", "N"}], ")"}]}], "+", "g", "+", "N"}], ")"}]}], "s"]}], 
   TraditionalForm]],
  CellChangeTimes->{3.9168193414187*^9, 3.9168275118005867`*^9, 
   3.916924240351778*^9},ExpressionUUID->
  "a4dde68f-10c2-4e66-abee-be22eae73d5d"],
 ". Signal-dishonesty is at an ESS (z=z*) when this condition is satisfied. \
Setting margopenz<0 gives the condition for signal-honesty to be favoured - \
this is equivalent to the LHS being greater than the RHS below - this is \
Equation N13 in the SI, and it is always satisfied, meaning signals evolve to \
be honest. "
}], "Text",
 CellChangeTimes->{{3.916925405730946*^9, 3.9169254139292717`*^9}, {
   3.9169254444444304`*^9, 3.916925444444467*^9}, {3.916925616595517*^9, 
   3.916925670890792*^9}, {3.916926403105534*^9, 3.916926421929783*^9}, {
   3.916926508876215*^9, 3.916926515776126*^9}, 3.916985469976035*^9, {
   3.917169375647493*^9, 3.91716946483741*^9}, 3.917169502590571*^9, {
   3.922176440920473*^9, 3.9221764598833*^9}, {3.922176505579728*^9, 
   3.9221766077875957`*^9}, {3.9430038830002127`*^9, 
   3.943003883047339*^9}},ExpressionUUID->"67d7d95e-75ff-473f-aaab-\
08f4330e982d"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"FullSimplify", "[", 
  RowBox[{"Solve", "[", 
   RowBox[{
    RowBox[{"margopenz", "==", "0"}], ",", 
    SuperscriptBox["y", "*"]}], "]"}], "]"}]], "Input",
 CellChangeTimes->{
  3.916819346510264*^9, {3.916827517292119*^9, 3.9168275197514668`*^9}, {
   3.91698549685701*^9, 3.91698550525738*^9}, {3.9169916289956493`*^9, 
   3.91699163084838*^9}},
 CellLabel->"In[22]:=",ExpressionUUID->"f62f987e-70e4-4c4c-b35f-d78a1ba595fd"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    SuperscriptBox["y", "*"], "\[Rule]", 
    RowBox[{"-", 
     FractionBox["c", 
      RowBox[{"b", " ", "s"}]]}]}], "}"}], "}"}]], "Output",
 CellChangeTimes->{3.9168193469289417`*^9, 3.916827520046818*^9, 
  3.9169242437882566`*^9, 3.9169254315367804`*^9, 3.916985506206353*^9, 
  3.916991631098401*^9, 3.917008711976697*^9, 3.917169624132285*^9, 
  3.918198440113426*^9, 3.918205051011924*^9, 3.918537007653759*^9, 
  3.922176986443144*^9},
 CellLabel->"Out[22]=",ExpressionUUID->"86b29536-3a1b-4171-b51d-0dd55a8c6f2f"]
}, Open  ]],

Cell[TextData[{
 "We obtain a condition for plant signal-response being at an ESS by setting \
margopeny to equal zero, to obtain ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SuperscriptBox["z", "*"], "\[Rule]", 
    FractionBox[
     RowBox[{"p", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "d"}], "+", "s"}], ")"}]}], 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "p"}], ")"}], " ", "s"}]]}], 
   TraditionalForm]],
  CellChangeTimes->{3.9168193414187*^9, 3.9168275118005867`*^9, 
   3.916924240351778*^9},ExpressionUUID->
  "f23e1088-7cb0-4dd3-800e-1b403e2d9ae0"],
 ". Signal-response is at an ESS (y=y*) when this condition is satisfied. \
Setting margopeny>0 gives the condition for signal-response to be favoured - \
this is equivalent to the RHS being greater than the LHS below - this is \
Equation N20 in the SI, and it is always satisfied, meaning signal response \
evolves."
}], "Text",
 CellChangeTimes->{{3.916925368926862*^9, 3.916925390412713*^9}, {
  3.917169489795814*^9, 3.917169539996696*^9}, {3.917170424492074*^9, 
  3.917170428290436*^9}, {3.922176465678137*^9, 3.92217647430525*^9}, {
  3.922176635856407*^9, 3.922176684459235*^9}, {3.943003888827327*^9, 
  3.943003888866806*^9}},ExpressionUUID->"ce2216de-818b-498e-b57c-\
5ce05675ab33"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"FullSimplify", "[", 
  RowBox[{"Solve", "[", 
   RowBox[{
    RowBox[{"margopeny", "==", "0"}], ",", 
    SuperscriptBox["z", "*"]}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.916819340783867*^9, 3.916819340845152*^9}, {
  3.916827508768277*^9, 3.916827511389678*^9}, {3.9169854843460693`*^9, 
  3.916985488809363*^9}, {3.916991623237121*^9, 3.916991625352806*^9}},
 CellLabel->"In[23]:=",ExpressionUUID->"ac8499da-d884-44b0-a2f1-195845237c1b"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    SuperscriptBox["z", "*"], "\[Rule]", 
    RowBox[{"-", 
     FractionBox[
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "N"}], ")"}], " ", "p", " ", 
       RowBox[{"(", 
        RowBox[{"d", "-", "s"}], ")"}]}], 
      RowBox[{"N", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "p"}], ")"}], " ", "s"}]]}]}], "}"}], 
  "}"}]], "Output",
 CellChangeTimes->{3.9168193414187*^9, 3.9168275118005867`*^9, 
  3.916924240351778*^9, 3.916985489760758*^9, 3.916991625582993*^9, 
  3.917008710583263*^9, 3.917169624202911*^9, 3.918198442619426*^9, 
  3.9182050526641808`*^9, 3.918537009920879*^9, 3.9221769865004253`*^9},
 CellLabel->"Out[23]=",ExpressionUUID->"529442ff-6fea-409e-a460-6cc10ef602c0"]
}, Open  ]],

Cell[TextData[{
 "We ask when a slight increase in signalling is favoured. To do so, we  set \
the margopenx to zero, substituting in our ESS signal-response and \
signal-dishonesty values,  ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SuperscriptBox["y", "*"], "=", "1"}], TraditionalForm]],ExpressionUUID->
  "8ecfec4c-5584-4ac3-85fe-3fad9b306619"],
 " and ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SuperscriptBox["z", "*"], "=", "0"}], TraditionalForm]],ExpressionUUID->
  "639130b9-fb1c-4d50-bf28-a2a1796b6ebb"],
 ", and obtain ",
 Cell[BoxData[
  RowBox[{"c", "\[Rule]", 
   FractionBox[
    RowBox[{"b", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "N"}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"d", "-", "s"}], ")"}]}], "N"]}]],
  CellChangeTimes->{
   3.91681932997968*^9, {3.9168193708872013`*^9, 3.916819377676259*^9}, 
    3.9169242352947397`*^9, 3.9169855635265627`*^9, 3.916991618814695*^9, 
    3.917008708959016*^9, {3.9171696291265182`*^9, 3.917169639164115*^9}, 
    3.917169845158881*^9, {3.9181984511654377`*^9, 3.918198477889913*^9}, 
    3.918205054001548*^9, {3.9182056481878633`*^9, 3.918205685673621*^9}, {
    3.918205761330102*^9, 3.918205792126769*^9}, {3.918205989508325*^9, 
    3.9182060620941*^9}, {3.918207817975911*^9, 3.918207837460101*^9}, 
    3.918208842452463*^9, 3.918537086030264*^9, {3.918537122471883*^9, 
    3.91853713391084*^9}, {3.918537210177211*^9, 3.9185372327620687`*^9}, {
    3.918537265067992*^9, 3.918537295582437*^9}, 3.918537370481636*^9, {
    3.9185374176913767`*^9, 3.918537436528325*^9}, 3.918537474860777*^9, {
    3.922176960959626*^9, 3.922176994039579*^9}, 3.922177042946683*^9, {
    3.922177627829069*^9, 3.922177645594857*^9}},ExpressionUUID->
  "273474da-4622-4436-bb7b-cc542ef4cf27"],
 ". Signalling is favoured when the RHS is greater than the LHS - this is \
Equation N26 in the SI."
}], "Text",
 CellChangeTimes->{{3.915176101958577*^9, 3.915176179387744*^9}, {
  3.915176229291583*^9, 3.915176243005365*^9}, {3.915177406063599*^9, 
  3.915177410206997*^9}, {3.915177643831272*^9, 3.915177649866047*^9}, {
  3.916925020263899*^9, 3.91692502865641*^9}, {3.91692516531522*^9, 
  3.916925175033794*^9}, {3.9169252289730663`*^9, 3.916925243873952*^9}, {
  3.916925313939077*^9, 3.916925356059578*^9}, {3.917169315385355*^9, 
  3.917169324958881*^9}, {3.9171695715163097`*^9, 3.917169574485723*^9}, {
  3.917169650175866*^9, 3.917169837557352*^9}, {3.922177692568845*^9, 
  3.9221778115546837`*^9}, {3.9430038991420937`*^9, 
  3.943003899197123*^9}},ExpressionUUID->"5380ce35-0fd2-42eb-b564-\
1bb807c279ba"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"FullSimplify", "[", 
  RowBox[{"Solve", "[", 
   RowBox[{
    RowBox[{"margopenx", "==", "0"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       SuperscriptBox["y", "*"], "\[Rule]", "1"}], ",", 
      RowBox[{
       SuperscriptBox["z", "*"], "\[Rule]", "0"}]}], "}"}]}], "]"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.9168192463935623`*^9, 3.916819258916613*^9}, {
   3.916819365377577*^9, 3.916819377273843*^9}, {3.916985544152729*^9, 
   3.916985562760304*^9}, {3.91699161642218*^9, 3.916991618562194*^9}, {
   3.917169599741001*^9, 3.9171696014622173`*^9}, {3.917169634646111*^9, 
   3.9171696384704*^9}, {3.91716984423207*^9, 3.9171698444705477`*^9}, {
   3.918198470969841*^9, 3.918198476374482*^9}, {3.918198663110408*^9, 
   3.9181986633479156`*^9}, {3.918205641422206*^9, 3.9182056850821333`*^9}, {
   3.918205751482445*^9, 3.918205791897534*^9}, {3.918205985143345*^9, 
   3.9182060615305347`*^9}, {3.918207817597617*^9, 3.918207837090818*^9}, {
   3.9182088184022293`*^9, 3.918208824530604*^9}, {3.918537075190569*^9, 
   3.918537133609775*^9}, {3.918537189343553*^9, 3.918537293754716*^9}, {
   3.918537330044055*^9, 3.918537369721301*^9}, {3.918537415812628*^9, 
   3.9185374352300777`*^9}, {3.918537473402893*^9, 3.918537474402861*^9}, 
   3.922176993555317*^9, {3.922177028899235*^9, 3.922177029018386*^9}, {
   3.922177622328856*^9, 3.922177644606228*^9}},
 CellLabel->"In[35]:=",ExpressionUUID->"637f418d-011a-42aa-8df3-fc1b6c508c5b"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"c", "\[Rule]", 
     FractionBox[
      RowBox[{"b", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "N"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"d", "-", "s"}], ")"}]}], "N"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"p", "\[Rule]", "0"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.91681932997968*^9, {3.9168193708872013`*^9, 3.916819377676259*^9}, 
   3.9169242352947397`*^9, 3.9169855635265627`*^9, 3.916991618814695*^9, 
   3.917008708959016*^9, {3.9171696291265182`*^9, 3.917169639164115*^9}, 
   3.917169845158881*^9, {3.9181984511654377`*^9, 3.918198477889913*^9}, 
   3.918205054001548*^9, {3.9182056481878633`*^9, 3.918205685673621*^9}, {
   3.918205761330102*^9, 3.918205792126769*^9}, {3.918205989508325*^9, 
   3.9182060620941*^9}, {3.918207817975911*^9, 3.918207837460101*^9}, 
   3.918208842452463*^9, 3.918537086030264*^9, {3.918537122471883*^9, 
   3.91853713391084*^9}, {3.918537210177211*^9, 3.9185372327620687`*^9}, {
   3.918537265067992*^9, 3.918537295582437*^9}, 3.918537370481636*^9, {
   3.9185374176913767`*^9, 3.918537436528325*^9}, 3.918537474860777*^9, {
   3.922176960959626*^9, 3.922176994039579*^9}, 3.922177042946683*^9, {
   3.922177627829069*^9, 3.922177645594857*^9}},
 CellLabel->"Out[35]=",ExpressionUUID->"4a67e863-e6db-4795-8fc0-6e6c6c642d07"]
}, Open  ]],

Cell["\<\
Note that the closed model analysis is the same as this open one, since \
relatedness (r*) drops out of all of the equations obtained by setting the \
selection differentials (margopenx, margopeny, margopenz) to zero.\
\>", "Text",
 CellChangeTimes->{{3.915176441285725*^9, 3.915176587713168*^9}, {
  3.915177463317815*^9, 3.9151774714126167`*^9}, {3.915201893168091*^9, 
  3.915201894284738*^9}, {3.915202007544639*^9, 3.9152020082622538`*^9}, {
  3.916995439095326*^9, 3.91699545870647*^9}, {3.9171698773127813`*^9, 
  3.917169945385906*^9}},ExpressionUUID->"6910fab8-656e-4e88-a7cc-\
be792c7e2cfe"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{3.918537990985846*^9, 
  3.918538023450403*^9},ExpressionUUID->"690a9262-dbd8-4cf9-a5d2-\
5a1bc30025f2"]
}, Closed]]
},
WindowSize->{Full, Full},
WindowMargins->{{12, Automatic}, {Automatic, 0}},
TaggingRules-><|"TryRealOnly" -> False|>,
FrontEndVersion->"13.1 for Mac OS X ARM (64-bit) (June 16, 2022)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"89cc4cca-b422-4822-ba7f-eeb7fa93491e"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 730, 12, 35, "Text",ExpressionUUID->"685cb5ce-8020-48ce-96b9-a75886698576"],
Cell[CellGroupData[{
Cell[1313, 36, 384, 7, 67, "Section",ExpressionUUID->"eef3e3db-99f7-470a-892d-dcbb5b19ef05"],
Cell[1700, 45, 356, 7, 35, "Text",ExpressionUUID->"45d5df5b-96cb-462e-9b49-9c92bba9c003"],
Cell[2059, 54, 3136, 86, 116, "Input",ExpressionUUID->"6ab4c242-b49a-4fa1-ae28-0ce77f725fde"],
Cell[5198, 142, 614, 10, 58, "Text",ExpressionUUID->"9bb87755-b4bb-4c9f-b40f-dfb9b9707cb4"],
Cell[CellGroupData[{
Cell[5837, 156, 840, 23, 52, "Input",ExpressionUUID->"24bf0ab3-3e66-438b-8020-e04921876f38"],
Cell[6680, 181, 1274, 40, 67, "Output",ExpressionUUID->"6383fd44-a9e5-4112-b386-6fa8931f4bf1"]
}, Open  ]],
Cell[7969, 224, 687, 12, 58, "Text",ExpressionUUID->"d05b3397-2c4e-443c-8583-32f09e2bcb9b"],
Cell[CellGroupData[{
Cell[8681, 240, 1125, 24, 30, "Input",ExpressionUUID->"a3605713-800e-4336-b1c7-0e4a604a5416"],
Cell[9809, 266, 1179, 38, 67, "Output",ExpressionUUID->"61cb4931-f527-4816-80a5-f4b81907a40e"]
}, Open  ]],
Cell[11003, 307, 615, 10, 58, "Text",ExpressionUUID->"f25a8219-dcda-4207-b4eb-94d684749939"],
Cell[CellGroupData[{
Cell[11643, 321, 710, 15, 30, "Input",ExpressionUUID->"05008782-7791-4357-a2a3-c1f9668e81c2"],
Cell[12356, 338, 1319, 42, 67, "Output",ExpressionUUID->"880ea228-91a1-43e5-b898-e636ecec134b"]
}, Open  ]],
Cell[13690, 383, 731, 12, 58, "Text",ExpressionUUID->"1c5fee6b-d001-4e42-9b27-a5410b7e9ee9"],
Cell[CellGroupData[{
Cell[14446, 399, 324, 7, 30, "Input",ExpressionUUID->"f73cbbdf-8f71-4505-a6c5-5fd2c217c1cd"],
Cell[14773, 408, 755, 24, 46, "Output",ExpressionUUID->"daf1c169-d624-4fc7-b42f-09c0d30380e4"]
}, Open  ]],
Cell[15543, 435, 1726, 34, 101, "Text",ExpressionUUID->"6a37b233-19a5-434c-a5a3-b4d6384a34e0"],
Cell[CellGroupData[{
Cell[17294, 473, 1042, 29, 30, "Input",ExpressionUUID->"501e4be6-f164-4fcd-81f3-e5b1586b63ad"],
Cell[18339, 504, 1492, 46, 67, "Output",ExpressionUUID->"c74482c2-af46-46cc-b40d-ebbf6bdb177a"]
}, Open  ]],
Cell[19846, 553, 610, 11, 58, "Text",ExpressionUUID->"3766a80a-e8dd-4ce5-86a6-6c26e8d93045"],
Cell[CellGroupData[{
Cell[20481, 568, 768, 13, 30, "Input",ExpressionUUID->"6d5f0305-1b66-4d15-a0f2-8af35835d611"],
Cell[21252, 583, 1154, 30, 44, "Output",ExpressionUUID->"1810a375-bb6c-4e5d-824e-242a79bb193f"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[22455, 619, 342, 7, 53, "Section",ExpressionUUID->"aa1c85bd-0246-49e0-a27e-a25648c6e879"],
Cell[22800, 628, 356, 7, 35, "Text",ExpressionUUID->"f5580ae9-2638-4cb4-a379-650590143669"],
Cell[23159, 637, 5991, 164, 222, "Input",ExpressionUUID->"a21b650b-5cbd-4bbc-a541-202c40a61cec"],
Cell[29153, 803, 614, 10, 58, "Text",ExpressionUUID->"a96f95d9-564e-4b5c-a70a-9626482de7a4"],
Cell[CellGroupData[{
Cell[29792, 817, 844, 23, 52, "Input",ExpressionUUID->"d67c21ef-3a92-4094-98b7-603032d7a27a"],
Cell[30639, 842, 1632, 52, 71, "Output",ExpressionUUID->"48103aa9-bbed-450b-862b-1e5ba978f7c3"]
}, Open  ]],
Cell[32286, 897, 662, 12, 58, "Text",ExpressionUUID->"7bb8876d-2031-40ad-a1c5-a0990cd0c3f0"],
Cell[CellGroupData[{
Cell[32973, 913, 1122, 24, 30, "Input",ExpressionUUID->"0f5499f3-9efa-4849-83aa-c55b74d53ebc"],
Cell[34098, 939, 1754, 54, 71, "Output",ExpressionUUID->"d56349f8-a26f-446b-9473-5f4217a0a005"]
}, Open  ]],
Cell[35867, 996, 612, 10, 58, "Text",ExpressionUUID->"1d642f2c-5c9d-4bb4-8ac9-93d16e2e2944"],
Cell[CellGroupData[{
Cell[36504, 1010, 714, 15, 30, "Input",ExpressionUUID->"49378176-ba94-42c9-b7eb-d34187383634"],
Cell[37221, 1027, 2605, 82, 71, "Output",ExpressionUUID->"8d3541ce-b8c2-4628-8cfc-a8284eff5a2c"]
}, Open  ]],
Cell[39841, 1112, 765, 12, 58, "Text",ExpressionUUID->"814091cb-f6e2-4a7e-940b-e6b192478abe"],
Cell[CellGroupData[{
Cell[40631, 1128, 329, 8, 30, "Input",ExpressionUUID->"719453b3-debd-4e1b-854d-89124d10b029"],
Cell[40963, 1138, 2372, 78, 61, "Output",ExpressionUUID->"e4f0778f-0861-4558-90ea-001bcbbbf9cf"]
}, Open  ]],
Cell[CellGroupData[{
Cell[43372, 1221, 1318, 25, 52, "Input",ExpressionUUID->"29864960-ef33-4814-bb7b-347be41625c6"],
Cell[44693, 1248, 1968, 51, 67, "Output",ExpressionUUID->"51c91f0e-bba8-4de5-acdc-422a357863c6"],
Cell[46664, 1301, 1455, 34, 46, "Output",ExpressionUUID->"db3a11b4-27f7-446b-a939-d3b74c0219e9"]
}, Open  ]],
Cell[48134, 1338, 1319, 28, 63, "Text",ExpressionUUID->"53ef27b6-ade9-45ec-ab9d-3668546edfd1"],
Cell[CellGroupData[{
Cell[49478, 1370, 1042, 23, 52, "Input",ExpressionUUID->"de382b43-3f17-4a3a-9c8e-9108952c42cc"],
Cell[50523, 1395, 1178, 35, 67, "Output",ExpressionUUID->"955c8e22-1fa2-439b-9706-b6714032e025"],
Cell[51704, 1432, 821, 24, 66, "Output",ExpressionUUID->"96051983-0782-4a0d-894b-e85956f00ec8"]
}, Open  ]],
Cell[52540, 1459, 1676, 33, 101, "Text",ExpressionUUID->"5ebf40e9-1778-43c5-be7a-7405ac196882"],
Cell[CellGroupData[{
Cell[54241, 1496, 993, 28, 30, "Input",ExpressionUUID->"ea10e739-a763-45e3-b542-84d1f16d9f27"],
Cell[55237, 1526, 1247, 40, 67, "Output",ExpressionUUID->"deeea19e-5d61-474a-91ff-0d66c8237132"]
}, Open  ]],
Cell[56499, 1569, 1070, 22, 43, "Text",ExpressionUUID->"7819eeb0-1f08-466f-b046-51cb1b22efc3"],
Cell[CellGroupData[{
Cell[57594, 1595, 770, 13, 30, "Input",ExpressionUUID->"8ffffd61-8406-434f-87f4-617d3d00c477"],
Cell[58367, 1610, 1023, 26, 64, "Output",ExpressionUUID->"1f08f3c4-5629-4ff9-83cd-98a6b72eda1f"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[59439, 1642, 407, 8, 53, "Section",ExpressionUUID->"3b985d79-fc23-4b0a-b79e-6233e3b177f0"],
Cell[59849, 1652, 504, 9, 35, "Text",ExpressionUUID->"c1f5f780-ebe2-4046-8288-a21fb6ad467a"],
Cell[60356, 1663, 7426, 196, 222, "Input",ExpressionUUID->"b3b30ec9-5b45-421d-abb6-2072348667a9"],
Cell[67785, 1861, 855, 14, 58, "Text",ExpressionUUID->"d8f4e8d4-caf4-45f9-85b6-2ae0c5289146"],
Cell[CellGroupData[{
Cell[68665, 1879, 1415, 37, 52, "Input",ExpressionUUID->"1918650e-1b62-4b36-8aea-e6e638806ec5"],
Cell[70083, 1918, 2105, 68, 74, "Output",ExpressionUUID->"ced27d83-53b7-4362-9dba-a164be397e5b"]
}, Open  ]],
Cell[72203, 1989, 710, 12, 58, "Text",ExpressionUUID->"febdf4cf-fa24-4bae-848c-fd86aa77dd8c"],
Cell[CellGroupData[{
Cell[72938, 2005, 1600, 38, 30, "Input",ExpressionUUID->"ba16fd83-18fc-46c3-909a-b698ab2cb643"],
Cell[74541, 2045, 2323, 70, 74, "Output",ExpressionUUID->"d20b65ae-cc75-4161-a85a-a9b3ca22b208"]
}, Open  ]],
Cell[76879, 2118, 722, 12, 58, "Text",ExpressionUUID->"8d71afb1-1db5-45ed-a925-7d02376f98e5"],
Cell[CellGroupData[{
Cell[77626, 2134, 901, 20, 30, "Input",ExpressionUUID->"82adc939-3108-4edd-9db0-c53f402953ff"],
Cell[78530, 2156, 1476, 43, 82, "Output",ExpressionUUID->"1c86a7c1-d009-43f8-9c22-c56c8e757708"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[80055, 2205, 247, 4, 53, "Section",ExpressionUUID->"c1f9b66c-6baa-4e2b-a38e-2016de8d788d"],
Cell[80305, 2211, 379, 7, 35, "Text",ExpressionUUID->"74088476-246c-41b5-8ecd-d3a219b8bef7"],
Cell[80687, 2220, 504, 13, 30, "Input",ExpressionUUID->"c7d7ad69-fc56-45fa-824b-045a916038f9"],
Cell[81194, 2235, 682, 11, 58, "Text",ExpressionUUID->"862fa872-8146-4779-b640-4ef5655d7989"],
Cell[CellGroupData[{
Cell[81901, 2250, 1258, 34, 52, "Input",ExpressionUUID->"8fecfcac-0065-4809-aaf8-6e3263b13428"],
Cell[83162, 2286, 748, 21, 44, "Output",ExpressionUUID->"3a5c65fc-de52-4679-9ad5-943999441572"]
}, Open  ]],
Cell[83925, 2310, 535, 10, 58, "Text",ExpressionUUID->"e4cb48ec-69a8-4bfa-a95b-adc310e69964"],
Cell[CellGroupData[{
Cell[84485, 2324, 636, 19, 52, "Input",ExpressionUUID->"88669d3d-444c-426c-a449-36faeba32723"],
Cell[85124, 2345, 583, 19, 44, "Output",ExpressionUUID->"e3cf372a-9eb8-4557-8851-5ebbdee35436"]
}, Open  ]],
Cell[85722, 2367, 502, 9, 35, "Text",ExpressionUUID->"41a47b91-24eb-43e9-9b7a-2e51f87e06d1"],
Cell[CellGroupData[{
Cell[86249, 2380, 945, 29, 47, "Input",ExpressionUUID->"2a45b3a3-ca94-4c66-a0ac-e2211c3da7d9"],
Cell[87197, 2411, 975, 31, 34, "Output",ExpressionUUID->"1312add7-ee87-4bf0-bf65-32a3ec97d317"]
}, Open  ]],
Cell[88187, 2445, 167, 3, 35, "Text",ExpressionUUID->"7a67705b-2bcc-41eb-9f9b-09c67338a597"],
Cell[88357, 2450, 282, 5, 136, "Input",ExpressionUUID->"91d0f52a-39b8-4766-bf26-854410abbf0b"]
}, Closed]],
Cell[CellGroupData[{
Cell[88676, 2460, 489, 9, 53, "Section",ExpressionUUID->"040398a3-4a45-46e3-9cd1-865e1abed546"],
Cell[89168, 2471, 323, 6, 35, "Text",ExpressionUUID->"50c16f6b-77bd-401d-81a4-4ae4d681c945"],
Cell[89494, 2479, 3165, 87, 92, "Input",ExpressionUUID->"4104c392-96b6-4c29-ab36-52d0aba19d49"],
Cell[92662, 2568, 642, 11, 58, "Text",ExpressionUUID->"a952d5f5-de64-4dce-92fd-00031a61f240"],
Cell[CellGroupData[{
Cell[93329, 2583, 842, 23, 52, "Input",ExpressionUUID->"fe76039b-3638-4c90-808f-c65e0a2cc2e9"],
Cell[94174, 2608, 1298, 40, 67, "Output",ExpressionUUID->"e234d016-ba81-4bbf-85b8-5e3d847f19c6"]
}, Open  ]],
Cell[95487, 2651, 684, 12, 58, "Text",ExpressionUUID->"4c2c2ffb-e217-490f-8eb3-5e5f469f813c"],
Cell[CellGroupData[{
Cell[96196, 2667, 1124, 24, 30, "Input",ExpressionUUID->"90659cd5-c69b-42dc-8612-66b47068ad11"],
Cell[97323, 2693, 1222, 39, 67, "Output",ExpressionUUID->"93026e50-c110-484e-9ef4-baa984c17757"]
}, Open  ]],
Cell[98560, 2735, 643, 11, 58, "Text",ExpressionUUID->"cddfbd31-7bed-42b9-bcc7-cd4999122f0a"],
Cell[CellGroupData[{
Cell[99228, 2750, 660, 14, 30, "Input",ExpressionUUID->"0af63682-ff07-472f-86b3-c74d732ea5ea"],
Cell[99891, 2766, 1287, 42, 67, "Output",ExpressionUUID->"67982d37-1cd5-4429-a9b9-c50ef1fd809d"]
}, Open  ]],
Cell[101193, 2811, 907, 14, 58, "Text",ExpressionUUID->"30346f09-b0fa-4497-a9f2-d5ce3da08d84"],
Cell[CellGroupData[{
Cell[102125, 2829, 322, 7, 30, "Input",ExpressionUUID->"92a151a7-dca6-4277-b18f-2a6a59b34fc0"],
Cell[102450, 2838, 674, 21, 46, "Output",ExpressionUUID->"71875b7a-85b2-4fce-8edc-6183f9e1f4cc"]
}, Open  ]],
Cell[103139, 2862, 1752, 34, 101, "Text",ExpressionUUID->"9841d958-651f-40e3-8193-0acb8b57e09b"],
Cell[CellGroupData[{
Cell[104916, 2900, 993, 28, 30, "Input",ExpressionUUID->"9f8da327-e8ab-4d0b-9265-46ebb86d51ca"],
Cell[105912, 2930, 1561, 50, 67, "Output",ExpressionUUID->"69cc473f-1c3b-4c55-a837-fc02b045383a"]
}, Open  ]],
Cell[107488, 2983, 962, 15, 58, "Text",ExpressionUUID->"00d7ef1d-e8ae-44e1-8141-fd0e3cf02d64"],
Cell[CellGroupData[{
Cell[108475, 3002, 324, 7, 30, "Input",ExpressionUUID->"4a7206e0-0de6-4437-a6b8-70035634ac0c"],
Cell[108802, 3011, 707, 22, 44, "Output",ExpressionUUID->"d02061ca-5fbc-4d0e-a470-014304158daa"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[109558, 3039, 415, 8, 53, "Section",ExpressionUUID->"5e6dbf40-4a8f-4fe4-93ed-1ed86cbee34d"],
Cell[109976, 3049, 304, 6, 35, "Text",ExpressionUUID->"179394d0-db8a-43a2-8181-6dfaa582789e"],
Cell[110283, 3057, 5886, 168, 200, "Input",ExpressionUUID->"c9b86c00-c65a-4e56-9b5f-c789e091a106"],
Cell[116172, 3227, 642, 11, 58, "Text",ExpressionUUID->"725accf9-794f-475c-b7b9-29ca28733c18"],
Cell[CellGroupData[{
Cell[116839, 3242, 841, 23, 52, "Input",ExpressionUUID->"c4be2823-9b43-489e-80e0-b90c9ed5ef61"],
Cell[117683, 3267, 1767, 56, 71, "Output",ExpressionUUID->"37802015-4885-4194-91c1-28c0653d234c"]
}, Open  ]],
Cell[119465, 3326, 686, 12, 58, "Text",ExpressionUUID->"d8f09699-d5da-46db-bba5-ad240c940a93"],
Cell[CellGroupData[{
Cell[120176, 3342, 1128, 24, 30, "Input",ExpressionUUID->"adc28761-8fbb-4d25-b2d6-06cc58d79bc4"],
Cell[121307, 3368, 1897, 59, 71, "Output",ExpressionUUID->"4c25de8b-843b-406e-9eca-d08eed543b94"]
}, Open  ]],
Cell[123219, 3430, 641, 11, 58, "Text",ExpressionUUID->"4b7fc4aa-a658-49b6-8cca-d93440e90155"],
Cell[CellGroupData[{
Cell[123885, 3445, 660, 14, 30, "Input",ExpressionUUID->"0225feb0-71ca-4190-b536-c9cbee7cacb3"],
Cell[124548, 3461, 2680, 86, 71, "Output",ExpressionUUID->"5a569d19-da13-4fda-9056-95e67b2cd310"]
}, Open  ]],
Cell[127243, 3550, 1866, 39, 66, "Text",ExpressionUUID->"f9e653d0-4271-46db-8c5f-f52d1960fd8e"],
Cell[CellGroupData[{
Cell[129134, 3593, 1265, 24, 52, "Input",ExpressionUUID->"64b5d706-b0a7-4a82-bf91-c0e42723d69e"],
Cell[130402, 3619, 1803, 47, 67, "Output",ExpressionUUID->"d8b03890-cb79-4e63-a00c-78ffd7f4d541"],
Cell[132208, 3668, 1858, 48, 66, "Output",ExpressionUUID->"3b6b8d4d-63f3-4f66-aedb-64411c336881"]
}, Closed]],
Cell[134081, 3719, 978, 16, 54, "Text",ExpressionUUID->"55c2aa31-f5bf-43bb-bb55-1c34a3a80b43"],
Cell[CellGroupData[{
Cell[135084, 3739, 647, 14, 30, "Input",ExpressionUUID->"677d8d81-1c11-4a10-8af1-2befe2e38179"],
Cell[135734, 3755, 672, 21, 46, "Output",ExpressionUUID->"9916b4d4-0fe1-479a-9f2e-e4acc7849823"]
}, Open  ]],
Cell[136421, 3779, 1701, 34, 101, "Text",ExpressionUUID->"896dd8e5-f168-4eb7-ab14-135cb5ea234b"],
Cell[CellGroupData[{
Cell[138147, 3817, 995, 28, 30, "Input",ExpressionUUID->"9cac7589-1abc-41d4-8acb-6f3b95750918"],
Cell[139145, 3847, 1453, 46, 67, "Output",ExpressionUUID->"f0aa47be-5fba-4d80-b4bb-b323efdc45b7"]
}, Open  ]],
Cell[140613, 3896, 1044, 21, 43, "Text",ExpressionUUID->"e1479d8b-1cd7-4569-aa43-c1acec44fa44"],
Cell[CellGroupData[{
Cell[141682, 3921, 697, 12, 30, "Input",ExpressionUUID->"298abba8-bee2-4107-bcf1-5eee032e0b0d"],
Cell[142382, 3935, 1049, 27, 64, "Output",ExpressionUUID->"07a369d1-d046-47d3-a957-ba8ecc5f0047"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[143480, 3968, 600, 11, 53, "Section",ExpressionUUID->"600d8c9a-9480-4c1c-94b8-ccb9d1a53acb"],
Cell[144083, 3981, 503, 9, 35, "Text",ExpressionUUID->"52096bc2-8450-4cc3-ab49-055ac6c35be8"],
Cell[144589, 3992, 4556, 134, 230, "Input",ExpressionUUID->"d743a551-f29e-461f-98d6-9dce6216e767"],
Cell[149148, 4128, 1251, 19, 81, "Text",ExpressionUUID->"fce3e85e-8fb1-496d-a817-8d857d339c45"],
Cell[CellGroupData[{
Cell[150424, 4151, 3649, 100, 136, "Input",ExpressionUUID->"eb4e5a5e-1e19-473b-85b6-9bb00a5dd6e2"],
Cell[154076, 4253, 2972, 80, 67, "Output",ExpressionUUID->"73f3151c-a334-48f1-89f8-eaaf57830500"],
Cell[157051, 4335, 2457, 66, 70, "Output",ExpressionUUID->"81cd7004-feec-4113-b18d-353d00c6c2ba"],
Cell[159511, 4403, 2530, 68, 67, "Output",ExpressionUUID->"f9206fe0-ff18-41d2-aef7-24dc84d2857d"]
}, Open  ]],
Cell[162056, 4474, 1287, 20, 81, "Text",ExpressionUUID->"ae18ee5f-537b-42c2-986a-fcb68167ff09"],
Cell[CellGroupData[{
Cell[163368, 4498, 3434, 89, 73, "Input",ExpressionUUID->"39673324-5332-4b28-ad78-d5381040ef45"],
Cell[166805, 4589, 2950, 81, 67, "Output",ExpressionUUID->"a9d2faf8-51a9-474a-9470-6c79f88ff4ed"],
Cell[169758, 4672, 2569, 67, 70, "Output",ExpressionUUID->"3161d497-ae08-40ca-93bf-2032ba97a920"],
Cell[172330, 4741, 2654, 70, 67, "Output",ExpressionUUID->"403d3a08-6444-405c-a41f-98a3494e38a2"]
}, Open  ]],
Cell[174999, 4814, 880, 14, 81, "Text",ExpressionUUID->"b72be7b4-4cfd-417f-ab29-81581f670046"],
Cell[CellGroupData[{
Cell[175904, 4832, 1228, 28, 73, "Input",ExpressionUUID->"6f7794fb-7f9c-466e-be51-fe277bb00d5c"],
Cell[177135, 4862, 2971, 84, 67, "Output",ExpressionUUID->"79f86600-add3-4bf0-a438-de161778c5d0"],
Cell[180109, 4948, 2597, 70, 70, "Output",ExpressionUUID->"2198b3ca-b497-49f0-b3ca-3a8bca4d935f"],
Cell[182709, 5020, 2607, 72, 67, "Output",ExpressionUUID->"de7ec33f-680e-4c9c-bff8-29dcc7bed96e"]
}, Open  ]],
Cell[185331, 5095, 1182, 28, 41, "Text",ExpressionUUID->"1a512985-5fff-4041-a9e5-e702c66675a1"],
Cell[CellGroupData[{
Cell[186538, 5127, 452, 10, 30, "Input",ExpressionUUID->"d009c62b-bb35-4c68-8c74-a52f0bfa684f"],
Cell[186993, 5139, 559, 13, 50, "Output",ExpressionUUID->"89008f56-d965-46f4-965a-d9a5d7c5e00a"]
}, Open  ]],
Cell[187567, 5155, 1012, 27, 45, "Text",ExpressionUUID->"5cbbf18a-a18d-4401-b02e-f9ebee2fa215"],
Cell[CellGroupData[{
Cell[188604, 5186, 472, 9, 30, "Input",ExpressionUUID->"ecb3cc8e-1fe9-4b11-b343-64bab0747cda"],
Cell[189079, 5197, 624, 18, 53, "Output",ExpressionUUID->"5cf877e0-4dd1-4ea3-a9f0-40c74da97446"]
}, Open  ]],
Cell[189718, 5218, 3590, 96, 82, "Text",ExpressionUUID->"53748a7d-4843-43f4-bcd1-a786586ca1bf"],
Cell[CellGroupData[{
Cell[193333, 5318, 1292, 34, 75, "Input",ExpressionUUID->"f5948c10-ce5e-4680-9bd2-81685c03947d"],
Cell[194628, 5354, 1235, 36, 53, "Output",ExpressionUUID->"50e20c20-2735-41cc-aae5-7e30b9d3853c"],
Cell[195866, 5392, 1173, 34, 53, "Output",ExpressionUUID->"da8cd3e6-23b0-44e2-9992-e36407a2862f"]
}, Open  ]],
Cell[197054, 5429, 611, 10, 35, "Text",ExpressionUUID->"92d4765b-5a60-47c4-bae9-bdd20646c8da"]
}, Closed]],
Cell[CellGroupData[{
Cell[197702, 5444, 647, 11, 53, "Section",ExpressionUUID->"b6ebd33b-1ca5-453f-bd09-41f0e66e202f"],
Cell[198352, 5457, 605, 10, 35, "Text",ExpressionUUID->"41eb204a-abc1-4ef2-8090-823f031e2b81"],
Cell[198960, 5469, 6313, 189, 292, "Input",ExpressionUUID->"2a4fb119-634d-42e6-ada1-22d7b7884096"],
Cell[205276, 5660, 1247, 19, 81, "Text",ExpressionUUID->"6061d38e-9f3e-478f-afab-95501fdd65c9"],
Cell[CellGroupData[{
Cell[206548, 5683, 3645, 99, 136, "Input",ExpressionUUID->"7644ce82-8180-466f-8a3c-0b55c7d17920"],
Cell[210196, 5784, 3349, 89, 71, "Output",ExpressionUUID->"ed249a36-db34-4eba-8c2f-f8d652f661e5"],
Cell[213548, 5875, 2853, 73, 71, "Output",ExpressionUUID->"4380cb98-ec9c-4083-b353-0d1aceeb5b12"],
Cell[216404, 5950, 3062, 82, 71, "Output",ExpressionUUID->"d0a9d745-0a5a-45ea-8bc0-8b5f6f355ec5"]
}, Open  ]],
Cell[219481, 6035, 1283, 20, 81, "Text",ExpressionUUID->"26feaadb-42c4-4ba1-a5b8-9055876ffc4c"],
Cell[CellGroupData[{
Cell[220789, 6059, 3434, 89, 73, "Input",ExpressionUUID->"701e2b4a-563e-4289-91c9-9f9b2e1e0961"],
Cell[224226, 6150, 3488, 94, 71, "Output",ExpressionUUID->"f5400d9f-2c88-44dd-99b2-937efa2fd472"],
Cell[227717, 6246, 2873, 73, 70, "Output",ExpressionUUID->"7fe0caba-0e10-4ded-86a0-0c1c9dac51c0"],
Cell[230593, 6321, 3251, 85, 71, "Output",ExpressionUUID->"4b569dae-63c9-474d-b135-e4ad821c90c9"]
}, Open  ]],
Cell[233859, 6409, 904, 14, 81, "Text",ExpressionUUID->"9a454de3-d58e-408b-801a-4867065fda69"],
Cell[CellGroupData[{
Cell[234788, 6427, 1232, 28, 73, "Input",ExpressionUUID->"4d208711-404e-4bec-88cb-ace1bb82c375"],
Cell[236023, 6457, 4606, 131, 71, "Output",ExpressionUUID->"68f68416-fc64-43a8-b679-4a5669b82cf3"],
Cell[240632, 6590, 3110, 83, 71, "Output",ExpressionUUID->"c5caaae1-6457-4213-95b1-b0c56b0cf1b0"],
Cell[243745, 6675, 3909, 107, 71, "Output",ExpressionUUID->"d651c83c-2aa4-433f-8c8e-b6007d909f32"]
}, Open  ]],
Cell[247669, 6785, 1129, 29, 68, "Text",ExpressionUUID->"e8c2e3ce-9ce9-4884-b6ea-ac58a9283ee5"],
Cell[CellGroupData[{
Cell[248823, 6818, 423, 9, 30, "Input",ExpressionUUID->"af0c4b2a-8a0a-4854-847d-9a3d80d443b8"],
Cell[249249, 6829, 669, 20, 67, "Output",ExpressionUUID->"1221e068-114b-4b55-814c-e2aead13657d"]
}, Open  ]],
Cell[249933, 6852, 4261, 114, 73, "Text",ExpressionUUID->"ec472916-8991-4cfd-9480-c889a7587422"],
Cell[CellGroupData[{
Cell[254219, 6970, 583, 9, 30, "Input",ExpressionUUID->"f807c18f-1aea-4185-90c3-6023ceb08b07"],
Cell[254805, 6981, 3523, 103, 71, "Output",ExpressionUUID->"9d8ce422-2a20-40b7-ac03-6676e208d000"]
}, Open  ]],
Cell[258343, 7087, 3721, 100, 54, "Text",ExpressionUUID->"395e4e00-c51e-43e5-ae18-b957467ab50a"],
Cell[CellGroupData[{
Cell[262089, 7191, 597, 12, 30, "Input",ExpressionUUID->"f90543e0-45f2-4671-850d-5790f43da9db"],
Cell[262689, 7205, 2858, 86, 74, "Output",ExpressionUUID->"f3d19847-4628-476c-a67f-5e9b9e58c515"]
}, Open  ]],
Cell[265562, 7294, 778, 13, 35, "Text",ExpressionUUID->"0de5a5ef-4c88-4ef5-9255-1a2c10ad59b9"],
Cell[CellGroupData[{
Cell[266365, 7311, 4068, 128, 84, "Input",ExpressionUUID->"5f6fb6e2-4039-482b-9dce-2a7c660a2821"],
Cell[270436, 7441, 1997, 62, 46, "Output",ExpressionUUID->"7c7ca250-9f97-44c9-9519-c5fd6a7e2384"],
Cell[272436, 7505, 2183, 68, 70, "Output",ExpressionUUID->"bc839327-a4ca-450a-a6fa-caad9a465d77"]
}, Open  ]],
Cell[274634, 7576, 473, 8, 35, "Text",ExpressionUUID->"dfc3b888-f650-44a6-8cd6-684eb89229e7"]
}, Closed]],
Cell[CellGroupData[{
Cell[275144, 7589, 740, 13, 53, "Section",ExpressionUUID->"13812067-9e28-4c3d-a005-9e82cde75ae9"],
Cell[275887, 7604, 2098, 33, 35, "Text",ExpressionUUID->"44b9399c-44bf-4968-ab2e-bed546233f65"],
Cell[277988, 7639, 5421, 151, 328, "Input",ExpressionUUID->"27d86ab9-67c4-46ce-ba21-801f30b4192f"],
Cell[283412, 7792, 1370, 21, 81, "Text",ExpressionUUID->"d8296425-ca3e-4b63-a992-40a464f88a9d"],
Cell[CellGroupData[{
Cell[284807, 7817, 3751, 101, 140, "Input",ExpressionUUID->"0304be7e-5bac-4c13-934a-12ae91bffa6d"],
Cell[288561, 7920, 2598, 64, 67, "Output",ExpressionUUID->"b2db2ffe-3307-425f-9ad5-1e91920e57ec"],
Cell[291162, 7986, 2198, 53, 67, "Output",ExpressionUUID->"71342afd-266e-49b6-8986-52ac49dda380"],
Cell[293363, 8041, 2242, 54, 67, "Output",ExpressionUUID->"d1425acd-df79-47df-94bc-9f6c6e8c9094"]
}, Open  ]],
Cell[295620, 8098, 1521, 23, 104, "Text",ExpressionUUID->"52f0249d-eedf-4daa-8580-6e628d1cfad7"],
Cell[CellGroupData[{
Cell[297166, 8125, 3540, 92, 77, "Input",ExpressionUUID->"aa430174-3169-4e1a-9a57-beec633a9032"],
Cell[300709, 8219, 1079, 17, 44, "Output",ExpressionUUID->"7bdf4d58-ca15-46f5-a154-3c40e9a1def8"],
Cell[301791, 8238, 2186, 53, 67, "Output",ExpressionUUID->"aac292d3-b743-42b8-b715-cabcba2e6cb2"],
Cell[303980, 8293, 1079, 17, 44, "Output",ExpressionUUID->"607aff86-7874-4c07-8c4b-3ea25d13f063"]
}, Open  ]],
Cell[305074, 8313, 949, 15, 81, "Text",ExpressionUUID->"ca492431-bb42-4fde-8106-fbc87ff7374a"],
Cell[CellGroupData[{
Cell[306048, 8332, 1228, 28, 73, "Input",ExpressionUUID->"a17dc7e4-9142-42f9-9fe4-d8906ebf42b2"],
Cell[307279, 8362, 1832, 44, 80, "Output",ExpressionUUID->"36ac7f96-2c65-42c9-9bd0-6b670b376b3a"],
Cell[309114, 8408, 2208, 56, 67, "Output",ExpressionUUID->"fc2cbbd7-5e45-46ab-860b-6a626a4acd21"],
Cell[311325, 8466, 2108, 53, 67, "Output",ExpressionUUID->"04cdf7a3-1e66-4b50-b2ac-f210ba65d788"]
}, Open  ]],
Cell[313448, 8522, 1497, 32, 64, "Text",ExpressionUUID->"67d7d95e-75ff-473f-aaab-08f4330e982d"],
Cell[CellGroupData[{
Cell[314970, 8558, 452, 10, 30, "Input",ExpressionUUID->"f62f987e-70e4-4c4c-b35f-d78a1ba595fd"],
Cell[315425, 8570, 581, 13, 48, "Output",ExpressionUUID->"86b29536-3a1b-4171-b51d-0dd55a8c6f2f"]
}, Open  ]],
Cell[316021, 8586, 1318, 31, 68, "Text",ExpressionUUID->"ce2216de-818b-498e-b57c-5ce05675ab33"],
Cell[CellGroupData[{
Cell[317364, 8621, 472, 9, 30, "Input",ExpressionUUID->"ac8499da-d884-44b0-a2f1-195845237c1b"],
Cell[317839, 8632, 825, 22, 53, "Output",ExpressionUUID->"529442ff-6fea-409e-a460-6cc10ef602c0"]
}, Open  ]],
Cell[318679, 8657, 2611, 53, 63, "Text",ExpressionUUID->"5380ce35-0fd2-42eb-b564-1bb807c279ba"],
Cell[CellGroupData[{
Cell[321315, 8714, 1489, 27, 30, "Input",ExpressionUUID->"637f418d-011a-42aa-8df3-fc1b6c508c5b"],
Cell[322807, 8743, 1407, 28, 50, "Output",ExpressionUUID->"4a67e863-e6db-4795-8fc0-6e6c6c642d07"]
}, Open  ]],
Cell[324229, 8774, 611, 10, 35, "Text",ExpressionUUID->"6910fab8-656e-4e88-a7cc-be792c7e2cfe"],
Cell[324843, 8786, 150, 3, 30, "Input",ExpressionUUID->"690a9262-dbd8-4cf9-a5d2-5a1bc30025f2"]
}, Closed]]
}
]
*)

